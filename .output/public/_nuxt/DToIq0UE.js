import{_ as te}from"./D4g1_bQ7.js";import{r as g,e as w,q as se,Q as oe,c as d,a as t,V as re,E as le,b as n,j as u,F as E,k as L,h as C,t as a,v as ie,P as ne,x as B,R as D,y as v,d as z,w as M,o as m}from"./DEsTSaKd.js";import{I as ae}from"./4T928kbW.js";import{C as de,a as ue}from"./CkuNl3aW.js";import{D as me}from"./ClT_iCD-.js";import{T as ce}from"./C-pOhJ0D.js";import{I as pe}from"./MvNwXCJb.js";import{R as ge}from"./Bh8kGaIw.js";import{A as S}from"./Bluep4Ee.js";import{M as ve}from"./BVbWQf7J.js";import{H as fe}from"./ZC22Qqbx.js";import"./wERbHxDK.js";const be={class:"max-w-8xl mx-auto"},xe={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},he={class:"space-y-4"},ye={class:"bg-card border border-border rounded-lg p-6"},we={class:"mt-4"},_e={class:"grid grid-cols-4 gap-2"},ke=["onClick"],Ue=["src","alt"],Ce={class:"bg-card border border-border rounded-lg p-6"},Ie={class:"space-y-4"},Pe={class:"mt-2 space-y-2"},ze={class:"flex items-center justify-between"},Me={class:"text-sm font-mono"},Se={class:"mt-2 grid grid-cols-2 gap-2"},Fe=["onClick"],Ge={class:"mt-4"},Re={class:"mt-3 space-y-3"},je={class:"flex items-center gap-2"},We={class:"flex items-center gap-2"},Ee={class:"space-y-4"},Le={key:0,class:"bg-card border border-border rounded-lg p-6"},Be={class:"grid grid-cols-2 gap-4"},De={class:"p-4 bg-muted rounded-lg"},Ne={class:"text-xl font-bold"},$e={class:"p-4 bg-muted rounded-lg"},Ve={class:"text-xl font-bold text-primary"},He={class:"p-4 bg-muted rounded-lg"},qe={class:"text-xl font-bold text-green-600"},Ae={class:"p-4 bg-muted rounded-lg"},Je={class:"text-xl font-bold text-blue-600"},Te={key:1,class:"bg-card border border-border rounded-lg p-6"},Oe={key:0,class:"mb-4"},Xe={class:"flex items-center justify-between"},Ke=["disabled"],Qe={class:"text-sm text-muted-foreground"},Ye=["disabled"],Ze={key:1,class:"space-y-4"},et={class:"grid grid-cols-2 gap-4"},tt={class:"relative group"},st=["src","alt"],ot={class:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center"},rt={class:"mt-2 text-xs text-muted-foreground"},lt={class:"relative group"},it=["src","alt"],nt={key:1,class:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center"},at={key:2,class:"w-full h-48 bg-muted rounded-lg flex items-center justify-center"},dt={key:0,class:"mt-2 text-xs text-muted-foreground"},ut={key:2,class:"bg-card border border-border rounded-lg p-6"},mt={class:"grid grid-cols-2 gap-3"},ct={class:"mt-12 space-y-6"},pt={class:"bg-card border border-border rounded-lg p-6"},gt={class:"text-lg font-semibold mb-4 flex items-center gap-2"},vt={class:"bg-card border border-border rounded-lg p-6"},ft={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},St={__name:"image-compress",setup(bt){const l=g([]),c=g(0),_=g(!1),b=g(80),k=g("original"),F=g(!0),G=g(!1),R=g(null),N=[{id:1,name:"示例1",url:"https://picsum.photos/400/300?random=1"},{id:2,name:"示例2",url:"https://picsum.photos/400/300?random=2"},{id:3,name:"示例3",url:"https://picsum.photos/400/300?random=3"},{id:4,name:"示例4",url:"https://picsum.photos/400/300?random=4"}],$=[{name:"高清",quality:95},{name:"标准",quality:80},{name:"平衡",quality:60},{name:"高速",quality:40}],i=w(()=>l.value[c.value]||null),U=w(()=>l.value.reduce((s,e)=>s+e.originalSize,0)),I=w(()=>l.value.reduce((s,e)=>s+(e.compressedSize||0),0)),V=w(()=>{const s=U.value-I.value;return h(s)}),H=w(()=>U.value===0?0:Math.round((1-I.value/U.value)*100)),q=s=>{const e=Array.from(s.target.files);j(e)},A=s=>{s.preventDefault(),_.value=!1;const e=Array.from(s.dataTransfer.files);j(e)},j=async s=>{const e=s.filter(r=>r.type.startsWith("image/"));for(const r of e){const o=new FileReader;o.onload=p=>{const f=new Image;f.onload=()=>{const y={id:Date.now()+Math.random(),name:r.name,file:r,originalUrl:p.target.result,originalSize:r.size,originalWidth:f.width,originalHeight:f.height,compressedUrl:null,compressedSize:null,compressedWidth:null,compressedHeight:null};l.value.push(y),P(y)},f.src=p.target.result},o.readAsDataURL(r)}},P=async s=>{const e=document.createElement("canvas"),r=e.getContext("2d");e.width=s.originalWidth,e.height=s.originalHeight,r.drawImage(s.file?await J(s.file):new Image,0,0),e.toBlob(o=>{const p=URL.createObjectURL(o);s.compressedUrl=p,s.compressedSize=o.size,s.compressedWidth=e.width,s.compressedHeight=e.height},T(),b.value/100)},J=s=>new Promise(e=>{const r=new Image;r.onload=()=>e(r),r.src=URL.createObjectURL(s)}),T=()=>{const s=k.value;return s==="original"?"image/jpeg":s==="png"?"image/png":s==="webp"?"image/webp":s==="avif"?"image/avif":"image/jpeg"},x=()=>{l.value.forEach(s=>{s.compressedUrl&&URL.revokeObjectURL(s.compressedUrl),P(s)})},O=s=>{b.value=s.quality,x()},X=async s=>{const e=new Image;e.crossOrigin="anonymous",e.onload=()=>{const r=document.createElement("canvas");r.width=e.width,r.height=e.height,r.getContext("2d").drawImage(e,0,0),r.toBlob(p=>{const f=new File([p],`${s.name}.jpg`,{type:"image/jpeg"}),y={id:Date.now()+Math.random(),name:s.name,file:f,originalUrl:s.url,originalSize:p.size,originalWidth:e.width,originalHeight:e.height,compressedUrl:null,compressedSize:null,compressedWidth:null,compressedHeight:null};l.value.push(y),P(y)},"image/jpeg",.9)},e.src=s.url},K=s=>{const e=document.createElement("a");e.href=s.originalUrl,e.download=`original_${s.name}`,e.click()},W=s=>{const e=document.createElement("a");e.href=s.compressedUrl,e.download=`compressed_${s.name.split(".")[0]}.${Q()}`,e.click()},Q=()=>{const s=k.value;return s==="original"?"jpg":s},Y=async()=>{for(const s of l.value)s.compressedUrl&&await new Promise(e=>{setTimeout(()=>{W(s),e()},100)})},Z=()=>{l.value.forEach(s=>{s.compressedUrl&&URL.revokeObjectURL(s.compressedUrl)}),l.value=[],c.value=0},h=s=>{if(s===0)return"0 B";const e=1024,r=["B","KB","MB","GB"],o=Math.floor(Math.log(s)/Math.log(e));return parseFloat((s/Math.pow(e,o)).toFixed(2))+" "+r[o]},ee=()=>{R.value.click()};return se({title:"图片压缩 - 在线图片压缩工具",description:"免费在线图片压缩工具，支持JPG、PNG、WebP格式，可自定义压缩质量，保持画质的同时减小文件大小。",keywords:["图片压缩","在线压缩","JPG压缩","PNG压缩","图片优化","图片大小"]}),oe(l,s=>{s.length!==0&&s.forEach((e,r)=>{r!==c.value&&e.compressedUrl&&Math.abs(r-c.value)>2&&(URL.revokeObjectURL(e.compressedUrl),e.compressedUrl=null,e.compressedSize=null)})}),(s,e)=>{const r=te;return m(),d("div",be,[e[42]||(e[42]=t("div",{class:"mt-4 mb-8"},[t("h1",{class:"text-3xl font-bold mb-3"},"图片压缩"),t("p",{class:"text-muted-foreground"},"在线压缩图片，支持多种格式和质量调节")],-1)),t("div",xe,[t("div",he,[t("div",ye,[e[14]||(e[14]=t("h2",{class:"text-lg font-semibold mb-4"},"上传图片",-1)),t("div",{class:le(["border-2 border-dashed rounded-lg p-8 text-center hover:border-primary transition-colors cursor-pointer",{"border-primary bg-primary/5":_.value}]),onDrop:A,onDragover:e[0]||(e[0]=re(o=>_.value=!0,["prevent"])),onDragleave:e[1]||(e[1]=o=>_.value=!1),onClick:ee},[t("input",{ref_key:"fileInput",ref:R,type:"file",class:"hidden",accept:"image/*",multiple:"",onChange:q},null,544),n(u(ae),{class:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e[10]||(e[10]=t("p",{class:"text-lg font-medium mb-2"},"拖拽图片到这里上传",-1)),e[11]||(e[11]=t("p",{class:"text-sm text-muted-foreground mb-4"},"或者点击选择文件",-1)),e[12]||(e[12]=t("p",{class:"text-xs text-muted-foreground"},"支持 JPG、PNG、WebP、GIF 格式",-1))],34),t("div",we,[e[13]||(e[13]=t("p",{class:"text-sm font-medium mb-2"},"快速示例",-1)),t("div",_e,[(m(),d(E,null,L(N,o=>t("button",{key:o.id,onClick:p=>X(o),class:"aspect-square rounded-lg overflow-hidden hover:ring-2 hover:ring-primary transition-all"},[t("img",{src:o.url,alt:o.name,class:"w-full h-full object-cover"},null,8,Ue)],8,ke)),64))])])]),t("div",Ce,[e[23]||(e[23]=t("h2",{class:"text-lg font-semibold mb-4"},"压缩设置",-1)),t("div",Ie,[t("div",null,[e[16]||(e[16]=t("label",{class:"text-sm font-medium"},"压缩质量",-1)),t("div",Pe,[t("div",ze,[e[15]||(e[15]=t("span",{class:"text-sm text-muted-foreground"},"质量",-1)),t("span",Me,a(b.value)+"%",1)]),C(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>b.value=o),type:"range",min:"10",max:"100",step:"5",class:"w-full",onInput:x},null,544),[[ie,b.value]])])]),t("div",null,[e[18]||(e[18]=t("label",{class:"text-sm font-medium"},"输出格式",-1)),C(t("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>k.value=o),class:"w-full mt-2 px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary",onChange:x},[...e[17]||(e[17]=[B('<option value="original">保持原格式</option><option value="jpeg">JPEG</option><option value="png">PNG</option><option value="webp">WebP</option><option value="avif">AVIF (实验性)</option>',5)])],544),[[ne,k.value]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"text-sm font-medium"},"快速预设",-1)),t("div",Se,[(m(),d(E,null,L($,o=>t("button",{key:o.name,onClick:p=>O(o),class:"px-3 py-2 bg-muted hover:bg-muted/80 rounded-md transition-colors text-sm"},a(o.name),9,Fe)),64))])]),t("details",Ge,[e[22]||(e[22]=t("summary",{class:"text-sm font-medium cursor-pointer"},"高级选项",-1)),t("div",Re,[t("label",je,[C(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>F.value=o),type:"checkbox",class:"rounded",onChange:x},null,544),[[D,F.value]]),e[20]||(e[20]=t("span",{class:"text-sm"},"移除EXIF元数据",-1))]),t("label",We,[C(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>G.value=o),type:"checkbox",class:"rounded",onChange:x},null,544),[[D,G.value]]),e[21]||(e[21]=t("span",{class:"text-sm"},"渐进式JPEG",-1))])])])])])]),t("div",Ee,[l.value.length>0?(m(),d("div",Le,[e[28]||(e[28]=t("h2",{class:"text-lg font-semibold mb-4"},"压缩统计",-1)),t("div",Be,[t("div",De,[e[24]||(e[24]=t("div",{class:"text-sm text-muted-foreground mb-1"},"原始大小",-1)),t("div",Ne,a(h(U.value)),1)]),t("div",$e,[e[25]||(e[25]=t("div",{class:"text-sm text-muted-foreground mb-1"},"压缩后大小",-1)),t("div",Ve,a(h(I.value)),1)]),t("div",He,[e[26]||(e[26]=t("div",{class:"text-sm text-muted-foreground mb-1"},"节省空间",-1)),t("div",qe,a(V.value),1)]),t("div",Ae,[e[27]||(e[27]=t("div",{class:"text-sm text-muted-foreground mb-1"},"压缩率",-1)),t("div",Je,a(H.value)+"%",1)])])])):v("",!0),l.value.length>0?(m(),d("div",Te,[e[32]||(e[32]=t("h2",{class:"text-lg font-semibold mb-4"},"预览对比",-1)),l.value.length>1?(m(),d("div",Oe,[t("div",Xe,[t("button",{onClick:e[6]||(e[6]=o=>c.value=Math.max(0,c.value-1)),disabled:c.value===0,class:"p-2 rounded hover:bg-muted transition-colors disabled:opacity-50"},[n(u(de),{class:"w-5 h-5"})],8,Ke),t("span",Qe,a(c.value+1)+" / "+a(l.value.length),1),t("button",{onClick:e[7]||(e[7]=o=>c.value=Math.min(l.value.length-1,c.value+1)),disabled:c.value===l.value.length-1,class:"p-2 rounded hover:bg-muted transition-colors disabled:opacity-50"},[n(u(ue),{class:"w-5 h-5"})],8,Ye)])])):v("",!0),i.value?(m(),d("div",Ze,[t("div",et,[t("div",null,[e[29]||(e[29]=t("h3",{class:"text-sm font-medium mb-2"},"原图",-1)),t("div",tt,[t("img",{src:i.value.originalUrl,alt:i.value.name,class:"w-full rounded-lg border"},null,8,st),t("div",ot,[t("button",{onClick:e[8]||(e[8]=o=>K(i.value)),class:"px-4 py-2 bg-white text-black rounded-md hover:bg-gray-100 transition-colors"}," 下载原图 ")])]),t("div",rt,a(i.value.originalWidth)+" × "+a(i.value.originalHeight)+" • "+a(h(i.value.originalSize)),1)]),t("div",null,[e[31]||(e[31]=t("h3",{class:"text-sm font-medium mb-2"},"压缩后",-1)),t("div",lt,[i.value.compressedUrl?(m(),d("img",{key:0,src:i.value.compressedUrl,alt:i.value.name,class:"w-full rounded-lg border"},null,8,it)):v("",!0),i.value.compressedUrl?(m(),d("div",nt,[t("button",{onClick:e[9]||(e[9]=o=>W(i.value)),class:"px-4 py-2 bg-white text-black rounded-md hover:bg-gray-100 transition-colors"}," 下载压缩图 ")])):(m(),d("div",at,[...e[30]||(e[30]=[t("span",{class:"text-muted-foreground"},"压缩中...",-1)])]))]),i.value.compressedSize?(m(),d("div",dt,a(i.value.compressedWidth)+" × "+a(i.value.compressedHeight)+" • "+a(h(i.value.compressedSize)),1)):v("",!0)])])])):v("",!0)])):v("",!0),l.value.length>0?(m(),d("div",ut,[e[35]||(e[35]=t("h2",{class:"text-lg font-semibold mb-4"},"批量操作",-1)),t("div",mt,[t("button",{onClick:Y,class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors flex items-center justify-center gap-2"},[n(u(me),{class:"w-4 h-4"}),e[33]||(e[33]=z(" 下载所有 ",-1))]),t("button",{onClick:Z,class:"px-4 py-2 border border-destructive text-destructive rounded-md hover:bg-destructive/5 transition-colors flex items-center justify-center gap-2"},[n(u(ce),{class:"w-4 h-4"}),e[34]||(e[34]=z(" 清空所有 ",-1))])])])):v("",!0)])]),t("div",ct,[t("div",pt,[t("h3",gt,[n(u(pe),{class:"w-5 h-5 text-primary"}),e[36]||(e[36]=z(" 使用说明 ",-1))]),e[37]||(e[37]=B('<div class="space-y-4 text-sm text-muted-foreground"><div><h4 class="font-medium text-foreground mb-2">支持的格式</h4><ul class="list-disc list-inside space-y-1 ml-4"><li>输入：JPG、PNG、WebP、GIF、BMP、TIFF</li><li>输出：JPG、PNG、WebP、AVIF（实验性）</li></ul></div><div><h4 class="font-medium text-foreground mb-2">压缩提示</h4><ul class="list-disc list-inside space-y-1 ml-4"><li>质量越低，文件越小，但画质损失越大</li><li>JPG适合照片，PNG适合透明图像</li><li>WebP格式在保持画质的同时有更好的压缩率</li><li>移除EXIF可以进一步减小文件大小</li></ul></div></div>',1))]),t("div",vt,[e[41]||(e[41]=t("h3",{class:"text-lg font-semibold mb-4"},"相关工具",-1)),t("div",ft,[n(r,{to:"/tools/image-convert",class:"flex items-center gap-3 p-3 bg-muted rounded-lg hover:bg-muted/80 transition-colors group"},{default:M(()=>[n(u(ge),{class:"w-5 h-5 text-primary"}),e[38]||(e[38]=t("div",null,[t("p",{class:"font-medium group-hover:text-primary"},"图片格式转换"),t("p",{class:"text-xs text-muted-foreground"},"转换图片格式")],-1)),n(u(S),{class:"w-4 h-4 ml-auto text-muted-foreground group-hover:text-primary"})]),_:1}),n(r,{to:"/tools/image-resize",class:"flex items-center gap-3 p-3 bg-muted rounded-lg hover:bg-muted/80 transition-colors group"},{default:M(()=>[n(u(ve),{class:"w-5 h-5 text-primary"}),e[39]||(e[39]=t("div",null,[t("p",{class:"font-medium group-hover:text-primary"},"图片尺寸调整"),t("p",{class:"text-xs text-muted-foreground"},"调整图片尺寸")],-1)),n(u(S),{class:"w-4 h-4 ml-auto text-muted-foreground group-hover:text-primary"})]),_:1}),n(r,{to:"/tools/base64-image",class:"flex items-center gap-3 p-3 bg-muted rounded-lg hover:bg-muted/80 transition-colors group"},{default:M(()=>[n(u(fe),{class:"w-5 h-5 text-primary"}),e[40]||(e[40]=t("div",null,[t("p",{class:"font-medium group-hover:text-primary"},"Base64图片"),t("p",{class:"text-xs text-muted-foreground"},"图片与Base64互转")],-1)),n(u(S),{class:"w-4 h-4 ml-auto text-muted-foreground group-hover:text-primary"})]),_:1})])])])])}}};export{St as default};
