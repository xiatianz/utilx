{"file":"json-to-csv-BCAVoTLI.js","mappings":"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","names":["_ssrRenderAttrs","_mergeProps","_ssrRenderList","_ssrInterpolate","_ssrRenderAttr","_ssrRenderComponent","_unref","_push","_parent","_ssrRenderVNode","_createVNode","_resolveDynamicComponent","_createBlock","_toDisplayString"],"sources":["../../../../src/pages/tools/json-to-csv.vue"],"sourcesContent":["<template>\n  <div class=\"max-w-8xl mx-auto\">\n    <!-- 面包屑导航 -->\n    <!-- <Breadcrumb :category=\"category\" :tool=\"tool\" /> -->\n\n    <!-- Hero 头部区 -->\n    <div class=\"mb-8\">\n      <h1 class=\"text-3xl font-bold text-foreground mb-3\">JSON转CSV - 在线JSON转CSV格式转换工具</h1>\n      <p class=\"text-muted-foreground \">一款免费的在线 JSON to CSV Converter。支持将 JSON 数组或对象转换为 CSV 格式，自定义分隔符，支持嵌套数据处理。纯本地计算，数据隐私绝对安全。</p>\n    </div>\n\n    <!-- 工具交互区 -->\n    <div class=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8\">\n      <!-- 输入区域 -->\n      <div class=\"flex flex-col h-full\">\n        <div class=\"flex items-center justify-between mb-3\">\n          <label class=\"text-sm font-medium text-foreground\">输入JSON</label>\n          <div class=\"flex gap-2\">\n            <button\n              class=\"text-xs px-2 py-1 bg-muted hover:bg-muted/80 rounded text-muted-foreground\"\n              @click=\"clearInput\"\n            >\n              清空\n            </button>\n            <button\n              class=\"text-xs px-2 py-1 bg-muted hover:bg-muted/80 rounded text-muted-foreground\"\n              @click=\"pasteFromClipboard\"\n            >\n              粘贴\n            </button>\n            <button\n              class=\"text-xs px-2 py-1 bg-muted hover:bg-muted/80 rounded text-muted-foreground\"\n              @click=\"loadSample\"\n            >\n              示例数据\n            </button>\n          </div>\n        </div>\n        <div class=\"flex items-center justify-between mb-2\">\n          <div class=\"flex items-center gap-2\">\n            <label class=\"text-xs text-muted-foreground\">分隔符:</label>\n            <select\n              v-model=\"delimiter\"\n              class=\"text-xs bg-muted border border-border rounded px-2 py-1\"\n            >\n              <option value=\",\">逗号 (,)</option>\n              <option value=\";\">分号 (;)</option>\n              <option value=\"\\t\">制表符 (\\t)</option>\n              <option value=\"|\">竖线 (|)</option>\n            </select>\n          </div>\n          <div class=\"flex items-center gap-2\">\n            <label class=\"text-xs text-muted-foreground\">包含表头:</label>\n            <input\n              type=\"checkbox\"\n              v-model=\"includeHeader\"\n              class=\"rounded\"\n            />\n          </div>\n        </div>\n        <textarea\n          v-model=\"inputJSON\"\n          class=\"flex-1 w-full min-h-[300px] p-4 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none font-mono text-sm\"\n          placeholder=\"在此输入JSON数据（数组格式或包含数组的对象）...\"\n          @keydown.ctrl.enter=\"convert\"\n          @keydown.meta.enter=\"convert\"\n        ></textarea>\n        <div v-if=\"inputError\" class=\"mt-2 p-2 bg-destructive/20 text-destructive text-sm rounded\">\n          {{ inputError }}\n        </div>\n      </div>\n\n      <!-- 输出区域 -->\n      <div class=\"flex flex-col h-full\">\n        <div class=\"flex items-center justify-between mb-3\">\n          <label class=\"text-sm font-medium text-foreground\">CSV输出</label>\n          <div class=\"flex gap-2\">\n            <button\n              class=\"text-xs px-2 py-1 bg-muted hover:bg-muted/80 rounded text-muted-foreground\"\n              @click=\"copyOutput\"\n            >\n              复制\n            </button>\n            <button\n              class=\"text-xs px-2 py-1 bg-muted hover:bg-muted/80 rounded text-muted-foreground\"\n              @click=\"downloadOutput\"\n            >\n              下载CSV\n            </button>\n            <button\n              class=\"text-xs px-2 py-1 bg-muted hover:bg-muted/80 rounded text-muted-foreground\"\n              @click=\"toggleFullscreen\"\n            >\n              全屏模式\n            </button>\n          </div>\n        </div>\n        <pre\n          ref=\"outputPre\"\n          class=\"flex-1 w-full min-h-[300px] p-4 bg-muted border border-border rounded-lg overflow-auto font-mono text-sm whitespace-pre-wrap\"\n        >{{ outputCSV }}</pre>\n      </div>\n    </div>\n\n    <!-- 转换按钮 -->\n    <div class=\"flex justify-center mb-12\">\n      <button\n        @click=\"convert\"\n        class=\"px-6 py-3 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors font-medium\"\n      >\n        转换为 CSV\n      </button>\n    </div>\n\n    <!-- 预览区 -->\n    <div v-if=\"csvPreview.length\" class=\"mb-12\">\n      <h2 class=\"text-xl font-bold text-foreground mb-4\">CSV 预览</h2>\n      <div class=\"overflow-auto border border-border rounded-lg\">\n        <table class=\"min-w-full divide-y divide-border\">\n          <thead class=\"bg-muted\">\n            <tr>\n              <th\n                v-for=\"header in csvPreview[0]\"\n                :key=\"header\"\n                class=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\"\n              >\n                {{ header }}\n              </th>\n            </tr>\n          </thead>\n          <tbody class=\"bg-card divide-y divide-border\">\n            <tr v-for=\"(row, index) in csvPreview.slice(1, 6)\" :key=\"index\">\n              <td\n                v-for=\"(cell, cellIndex) in row\"\n                :key=\"cellIndex\"\n                class=\"px-6 py-4 whitespace-nowrap text-sm text-foreground\"\n              >\n                {{ cell }}\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <p v-if=\"csvPreview.length > 6\" class=\"text-sm text-muted-foreground mt-2\">\n        显示前 5 行数据，共 {{ csvPreview.length - 1 }} 行\n      </p>\n    </div>\n\n    <!-- SEO 内容长尾区 -->\n    <div class=\"p-6 mb-12 relative\">\n      <!-- 折叠按钮 -->\n      <button\n        @click=\"toggleSeoContent\"\n        class=\"absolute top-4 right-4 text-muted-foreground hover:text-foreground transition-colors\"\n        :title=\"isSeoContentVisible ? '折叠内容' : '展开内容'\"\n      >\n        <HelpCircle v-if=\"!isSeoContentVisible\" class=\"w-5 h-5\" />\n        <ChevronUp v-else class=\"w-5 h-5\" />\n      </button>\n\n      <!-- 内容区域 -->\n      <div v-show=\"isSeoContentVisible\">\n        <h2 class=\"text-2xl font-bold text-foreground mb-4 flex items-center\">\n          <span class=\"text-primary mr-2\">#</span>\n          什么是 JSON 转 CSV？\n        </h2>\n        <p class=\"text-muted-foreground mb-4\">\n          JSON（JavaScript Object Notation）和 CSV（Comma-Separated Values）是两种常用的数据格式。\n          JSON 转 CSV 是将 JSON 数据转换为表格形式的 CSV 格式的过程。CSV 是一种简单的文本格式，\n          使用逗号或其他分隔符分隔值，每行代表一条记录，非常适合在 Excel 等表格软件中处理。\n        </p>\n        <p class=\"text-muted-foreground\">\n          转换过程中，JSON 的对象结构会被扁平化，嵌套的对象会被展开为单独的列。\n          数组会被转换为多行数据，使得数据可以在表格软件中轻松查看和分析。\n        </p>\n\n        <h2 class=\"text-2xl font-bold text-foreground mt-8 mb-4 flex items-center\">\n          <span class=\"text-primary mr-2\">#</span>\n          如何使用本工具\n        </h2>\n        <ol class=\"list-decimal list-inside space-y-2 text-muted-foreground mb-6\">\n          <li>将您的 JSON 数据粘贴到左侧输入框（必须是数组格式）</li>\n          <li>选择 CSV 分隔符（逗号、分号、制表符等）</li>\n          <li>选择是否包含表头行</li>\n          <li>点击\"转换为 CSV\"按钮或使用快捷键 Ctrl+Enter</li>\n          <li>查看右侧转换结果和下方预览表格</li>\n        </ol>\n\n        <h2 class=\"text-2xl font-bold text-foreground mt-8 mb-4 flex items-center\">\n          <span class=\"text-primary mr-2\">#</span>\n          转换规则\n        </h2>\n        <ul class=\"list-disc list-inside space-y-2 text-muted-foreground mb-6\">\n          <li><strong>数组转换</strong>: JSON 数组的每个元素转换为 CSV 的一行</li>\n          <li><strong>扁平化处理</strong>: 嵌套对象会被扁平化，使用点号连接键名</li>\n          <li><strong>键名提取</strong>: 所有对象的键会被提取作为 CSV 的列名</li>\n          <li><strong>缺失值处理</strong>: 如果某行缺少某列的值，会留空</li>\n          <li><strong>特殊字符转义</strong>: 包含分隔符或换行符的值会被引号包围</li>\n        </ul>\n\n        <h2 class=\"text-2xl font-bold text-foreground mt-8 mb-4 flex items-center\">\n          <span class=\"text-primary mr-2\">#</span>\n          常见问题 (FAQ)\n        </h2>\n        <div class=\"space-y-4\">\n          <div>\n            <h3 class=\"text-lg font-semibold text-foreground\">可以转换嵌套的 JSON 对象吗？</h3>\n            <p class=\"text-muted-foreground mt-1\">\n              可以。本工具会自动扁平化嵌套对象，使用点号连接键名。例如，\n              {\"user\": {\"name\": \"John\"}} 会被转换为列名 \"user.name\"。\n            </p>\n          </div>\n          <div>\n            <h3 class=\"text-lg font-semibold text-foreground\">JSON 数组中的元素结构不同怎么办？</h3>\n            <p class=\"text-muted-foreground mt-1\">\n              工具会收集所有对象的键作为列名。如果某行缺少某个键，对应的列会留空。\n              这确保了所有数据都能正确转换，即使结构不完全一致。\n            </p>\n          </div>\n          <div>\n            <h3 class=\"text-lg font-semibold text-foreground\">为什么需要 JSON 转 CSV？</h3>\n            <p class=\"text-muted-foreground mt-1\">\n              CSV 格式广泛应用于数据分析、报表生成、Excel 处理等场景。\n              转换为 CSV 后可以：在 Excel 中打开和分析数据、导入到数据库、\n              用于数据可视化工具、与他人共享数据等。\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- 相关推荐区 -->\n    <section class=\"mb-12\">\n      <h2 class=\"text-2xl font-bold text-foreground mb-4\">您可能还需要...</h2>\n      <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        <NuxtLink\n          v-for=\"relatedTool in relatedTools\"\n          :key=\"relatedTool.id\"\n          :to=\"`/tools/${relatedTool.id}/`\"\n          class=\"block p-4 bg-card border border-border rounded-lg hover:bg-accent transition-colors\"\n        >\n          <div class=\"flex items-center gap-2 mb-2\">\n            <component\n              :is=\"iconMap[relatedTool.icon]\"\n              class=\"w-5 h-5 text-primary\"\n            />\n            <span class=\"font-medium text-foreground\">{{ relatedTool.name }}</span>\n          </div>\n          <p class=\"text-sm text-muted-foreground line-clamp-2\">{{ relatedTool.description }}</p>\n        </NuxtLink>\n      </div>\n    </section>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport { useRouter } from 'vue-router'\nimport {\n  FileJson, Database, Copy, Download, RotateCcw,\n  FileText, Lock, Shield, Clock, Type, Wifi, Image, Code,\n  Link, Hash, Timer, Regex, FileDiff,\n  Globe, FolderOpen, GitBranch, ChevronUp, ChevronDown, HelpCircle\n} from 'lucide-vue-next'\nimport { tools } from '~/data/tools'\nimport { categories } from '~/data/categories'\nimport { addRecentTool } from '~/composables/useTools'\nimport ToolCard from '~/components/ToolCard.vue'\nimport Breadcrumb from '~/components/Breadcrumb.vue'\n\n// SEO 配置\nuseSeoMeta({\n  title: 'JSON转CSV - 在线JSON转CSV格式转换工具',\n  description: '免费在线 JSON to CSV 转换工具，支持将 JSON 数组或对象转换为 CSV 格式，自定义分隔符，支持嵌套数据处理。纯本地计算，数据安全。',\n  keywords: 'JSON转CSV, JSON to CSV, JSON CSV转换, 数据格式转换, 表格数据, 在线工具',\n  author: 'Util工具箱',\n  ogTitle: 'JSON转CSV - 在线JSON转CSV格式转换工具',\n  ogDescription: '免费在线 JSON to CSV 转换工具，支持将 JSON 数组或对象转换为 CSV 格式。',\n  ogType: 'website',\n  twitterCard: 'summary_large_image',\n})\n\n// Schema.org 结构化数据\nuseHead({\n  script: [\n    {\n      type: 'application/ld+json',\n      children: JSON.stringify({\n        '@context': 'https://schema.org',\n        '@type': 'WebApplication',\n        name: 'JSON转CSV工具',\n        description: '免费在线 JSON to CSV 转换工具，支持将 JSON 数组或对象转换为 CSV 格式',\n        url: 'https://util.example.com/tools/json-to-csv',\n        applicationCategory: 'DeveloperApplication',\n        operatingSystem: 'Any',\n        offers: {\n          '@type': 'Offer',\n          price: '0',\n          priceCurrency: 'USD'\n        },\n        featureList: [\n          'JSON转CSV',\n          '自定义分隔符',\n          '嵌套数据处理',\n          '包含表头选项',\n          '本地处理'\n        ]\n      })\n    }\n  ]\n})\n\ndefinePageMeta({\n  layout: 'default'\n})\n\nconst router = useRouter()\n\n// 定义当前工具和分类\nconst tool = tools.find(t => t.id === 'json-to-csv')\nconst category = categories.find(c => c.id === 'format')\n\n// 输入输出数据\nconst inputJSON = ref('')\nconst outputCSV = ref('')\nconst inputError = ref('')\nconst delimiter = ref(',')\nconst includeHeader = ref(true)\nconst csvPreview = ref([])\n\n// SEO内容折叠状态\nconst isSeoContentVisible = ref(true)\n\n// 全屏相关\nconst outputPre = ref(null)\nconst isFullscreen = ref(false)\n\n// 图标映射\nconst iconMap = {\n  FileText, Lock, Shield, Clock, Type, Wifi, Image, Code,\n  FileJson, Database, Link, Hash, Timer, Regex, FileDiff,\n  Globe, FolderOpen, GitBranch\n}\n\n// 相关工具\nconst relatedTools = computed(() => {\n  // 获取相关工具：同一分类下的其他工具 + 推荐工具\n  const sameCategory = tools.filter(t =>\n    t.category === 'format' && t.id !== 'json-to-csv'\n  ).slice(0, 3)\n\n  // 添加一些推荐工具\n  const recommended = [\n    tools.find(t => t.id === 'csv-formatter'),\n    tools.find(t => t.id === 'json-formatter'),\n    tools.find(t => t.id === 'json-to-xml'),\n    tools.find(t => t.id === 'json-to-yaml')\n  ].filter(Boolean)\n\n  return [...sameCategory, ...recommended].slice(0, 4)\n})\n\n// JSON 转 CSV\nconst convert = () => {\n  if (!inputJSON.value) return\n\n  try {\n    inputError.value = ''\n    const jsonData = JSON.parse(inputJSON.value)\n\n    // 检查是否是数组\n    if (!Array.isArray(jsonData)) {\n      // 尝试找到数组\n      const arrayKey = findArrayKey(jsonData)\n      if (arrayKey) {\n        convertToCSV(jsonData[arrayKey])\n      } else {\n        throw new Error('输入必须是数组格式')\n      }\n    } else {\n      convertToCSV(jsonData)\n    }\n  } catch (error) {\n    inputError.value = `转换失败: ${error.message}`\n    outputCSV.value = ''\n    csvPreview.value = []\n  }\n}\n\n// 查找对象中的数组\nconst findArrayKey = (obj) => {\n  for (const key in obj) {\n    if (Array.isArray(obj[key])) {\n      return key\n    }\n  }\n  return null\n}\n\n// 转换为 CSV\nconst convertToCSV = (data) => {\n  if (!data.length) {\n    outputCSV.value = ''\n    csvPreview.value = []\n    return\n  }\n\n  // 扁平化数据并收集所有键\n  const flattenedData = data.map(item => flattenObject(item))\n  const allKeys = [...new Set(flattenedData.flatMap(item => Object.keys(item)))]\n\n  // 生成 CSV\n  const csvRows = []\n\n  // 添加表头\n  if (includeHeader.value) {\n    csvRows.push(allKeys.join(delimiter.value))\n  }\n\n  // 添加数据行\n  for (const item of flattenedData) {\n    const row = allKeys.map(key => {\n      const value = item[key] || ''\n      return escapeCSVValue(String(value))\n    })\n    csvRows.push(row.join(delimiter.value))\n  }\n\n  outputCSV.value = csvRows.join('\\n')\n\n  // 生成预览数据\n  generatePreview(allKeys, csvRows)\n}\n\n// 扁平化对象\nconst flattenObject = (obj, prefix = '', result = {}) => {\n  for (const key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      const newKey = prefix ? `${prefix}.${key}` : key\n\n      if (typeof obj[key] === 'object' && obj[key] !== null && !Array.isArray(obj[key])) {\n        flattenObject(obj[key], newKey, result)\n      } else if (Array.isArray(obj[key])) {\n        // 处理数组，将其转换为字符串\n        result[newKey] = obj[key].join('; ')\n      } else {\n        result[newKey] = obj[key]\n      }\n    }\n  }\n  return result\n}\n\n// 转义 CSV 值\nconst escapeCSVValue = (value) => {\n  // 如果值包含分隔符、换行符或引号，需要用引号包围\n  if (value.includes(delimiter.value) || value.includes('\\n') || value.includes('\"')) {\n    // 转义内部的引号\n    const escaped = value.replace(/\"/g, '\"\"')\n    return `\"${escaped}\"`\n  }\n  return value\n}\n\n// 生成预览\nconst generatePreview = (headers, csvRows) => {\n  const preview = []\n\n  // 添加表头\n  if (includeHeader.value) {\n    preview.push(headers)\n  }\n\n  // 解析数据行\n  const parser = new CSVParser(delimiter.value)\n  for (let i = includeHeader.value ? 1 : 0; i < Math.min(csvRows.length, 6); i++) {\n    const row = parser.parseLine(csvRows[i])\n    preview.push(row)\n  }\n\n  csvPreview.value = preview\n}\n\n// CSV 解析器（用于预览）\nclass CSVParser {\n  constructor(delimiter) {\n    this.delimiter = delimiter\n  }\n\n  parseLine(line) {\n    const result = []\n    let current = ''\n    let inQuotes = false\n    let i = 0\n\n    while (i < line.length) {\n      const char = line[i]\n\n      if (char === '\"') {\n        if (inQuotes && line[i + 1] === '\"') {\n          current += '\"'\n          i += 2\n        } else {\n          inQuotes = !inQuotes\n          i++\n        }\n      } else if (char === this.delimiter && !inQuotes) {\n        result.push(current)\n        current = ''\n        i++\n      } else {\n        current += char\n        i++\n      }\n    }\n\n    result.push(current)\n    return result\n  }\n}\n\n// 清空输入\nconst clearInput = () => {\n  inputJSON.value = ''\n  outputCSV.value = ''\n  inputError.value = ''\n  csvPreview.value = []\n}\n\n// 粘贴剪贴板内容\nconst pasteFromClipboard = async () => {\n  try {\n    const text = await navigator.clipboard.readText()\n    inputJSON.value = text\n  } catch (error) {\n    console.error('粘贴失败:', error)\n  }\n}\n\n// 加载示例数据\nconst loadSample = () => {\n  inputJSON.value = `[\n  {\n    \"id\": 1,\n    \"name\": \"John Doe\",\n    \"email\": \"john@example.com\",\n    \"age\": 30,\n    \"address\": {\n      \"street\": \"123 Main St\",\n      \"city\": \"New York\",\n      \"country\": \"USA\"\n    },\n    \"hobbies\": [\"reading\", \"swimming\", \"coding\"],\n    \"active\": true\n  },\n  {\n    \"id\": 2,\n    \"name\": \"Jane Smith\",\n    \"email\": \"jane@example.com\",\n    \"age\": 25,\n    \"address\": {\n      \"street\": \"456 Oak Ave\",\n      \"city\": \"Los Angeles\",\n      \"country\": \"USA\"\n    },\n    \"hobbies\": [\"painting\", \"yoga\"],\n    \"active\": true\n  },\n  {\n    \"id\": 3,\n    \"name\": \"Bob Johnson\",\n    \"email\": \"bob@example.com\",\n    \"age\": 35,\n    \"address\": {\n      \"street\": \"789 Pine Rd\",\n      \"city\": \"Chicago\",\n      \"country\": \"USA\"\n    },\n    \"hobbies\": [\"gaming\", \"cooking\", \"traveling\"],\n    \"active\": false\n  }\n]`\n}\n\n// 复制输出\nconst copyOutput = async () => {\n  if (!outputCSV.value) return\n\n  try {\n    await navigator.clipboard.writeText(outputCSV.value)\n    // 这里可以添加复制成功的提示\n  } catch (error) {\n    console.error('复制失败:', error)\n  }\n}\n\n// 下载输出\nconst downloadOutput = () => {\n  if (!outputCSV.value) return\n\n  const blob = new Blob([outputCSV.value], { type: 'text/csv' })\n  const url = URL.createObjectURL(blob)\n  const a = document.createElement('a')\n  a.href = url\n  a.download = 'converted.csv'\n  document.body.appendChild(a)\n  a.click()\n  document.body.removeChild(a)\n  URL.revokeObjectURL(url)\n}\n\n// 切换全屏模式\nconst toggleFullscreen = () => {\n  if (!outputPre.value) return\n\n  if (!isFullscreen.value) {\n    if (outputPre.value.requestFullscreen) {\n      outputPre.value.requestFullscreen()\n    } else if (outputPre.value.webkitRequestFullscreen) {\n      outputPre.value.webkitRequestFullscreen()\n    } else if (outputPre.value.msRequestFullscreen) {\n      outputPre.value.msRequestFullscreen()\n    }\n  } else {\n    if (document.exitFullscreen) {\n      document.exitFullscreen()\n    } else if (document.webkitExitFullscreen) {\n      document.webkitExitFullscreen()\n    } else if (document.msExitFullscreen) {\n      document.msExitFullscreen()\n    }\n  }\n  isFullscreen.value = !isFullscreen.value\n}\n\n// 切换SEO内容显示状态\nconst toggleSeoContent = () => {\n  isSeoContentVisible.value = !isSeoContentVisible.value\n}\n\nconst handleToolSelect = (selectedTool) => {\n  // 跳转到具体工具页面\n  router.push(`/tools/${selectedTool.id}/`)\n  // 添加到最近使用\n  addRecentTool(selectedTool.id)\n}\n\n// 添加到最近使用\nif (tool) {\n  addRecentTool(tool.id)\n}\n\n// 监听全屏变化事件\nonMounted(() => {\n  document.addEventListener('fullscreenchange', () => {\n    isFullscreen.value = !!document.fullscreenElement\n  })\n  document.addEventListener('webkitfullscreenchange', () => {\n    isFullscreen.value = !!document.webkitFullscreenElement\n  })\n  document.addEventListener('msfullscreenchange', () => {\n    isFullscreen.value = !!document.msFullscreenElement\n  })\n})\n</script>"],"version":3}