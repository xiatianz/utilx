{"file":"rsa-encrypt-6Kx9o65Y.js","mappings":"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","names":["_ssrRenderAttrs","_mergeProps","_ssrInterpolate","_ssrIncludeBooleanAttr","_ssrRenderList"],"sources":["../../../../src/pages/tools/rsa-encrypt.vue"],"sourcesContent":["<template>\n  <div class=\"max-w-8xl mx-auto\">\n    <!-- 面包屑导航 -->\n    <!-- <Breadcrumb :category=\"category\" /> -->\n\n    <!-- 工具标题 -->\n    <div class=\"mt-4 mb-8\">\n      <h1 class=\"text-3xl font-bold mb-3\">RSA加密</h1>\n      <p class=\"text-muted-foreground max-w-3xl\">RSA非对称加密工具，使用公钥加密数据，只有对应的私钥才能解密。支持大分段加密和多种输出格式。</p>\n    </div>\n\n    <!-- 加密设置 -->\n    <div class=\"border border-border rounded-lg p-6 mb-8\">\n      <h3 class=\"text-lg font-semibold mb-4\">加密设置</h3>\n      <div class=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <div>\n          <label class=\"text-sm font-medium mb-2 block\">密钥格式</label>\n          <select\n            v-model=\"keyFormat\"\n            class=\"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary\"\n          >\n            <option value=\"PEM\">PEM格式</option>\n            <option value=\"DER\">DER格式</option>\n            <option value=\"JWK\">JWK格式</option>\n          </select>\n        </div>\n        <div>\n          <label class=\"text-sm font-medium mb-2 block\">输出格式</label>\n          <select\n            v-model=\"outputFormat\"\n            class=\"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary\"\n          >\n            <option value=\"base64\">Base64</option>\n            <option value=\"hex\">十六进制</option>\n            <option value=\"json\">JSON格式</option>\n          </select>\n        </div>\n        <div>\n          <label class=\"text-sm font-medium mb-2 block\">加密方案</label>\n          <select\n            v-model=\"encryptionScheme\"\n            class=\"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary\"\n          >\n            <option value=\"RSA-OAEP\">RSA-OAEP (推荐)</option>\n            <option value=\"RSAES-PKCS1-v1_5\">PKCS1 v1.5</option>\n          </select>\n        </div>\n      </div>\n    </div>\n\n    <!-- 公钥输入 -->\n    <div class=\"border border-border rounded-lg p-6 mb-8\">\n      <h3 class=\"text-lg font-semibold mb-4\">公钥</h3>\n      <div class=\"space-y-4\">\n        <div class=\"flex items-center gap-4\">\n          <label class=\"flex items-center gap-2 cursor-pointer\">\n            <input\n              type=\"file\"\n              ref=\"publicKeyFile\"\n              @change=\"handleKeyFileUpload\"\n              accept=\".pem,.pub,.key\"\n              class=\"hidden\"\n            >\n            <span class=\"px-3 py-1 text-sm bg-primary/10 text-primary rounded-md hover:bg-primary/20 transition-colors\">\n              导入公钥文件\n            </span>\n          </label>\n          <button\n            @click=\"loadExampleKey\"\n            class=\"px-3 py-1 text-sm bg-secondary/10 text-secondary-foreground rounded-md hover:bg-secondary/20 transition-colors\"\n          >\n            加载示例公钥\n          </button>\n        </div>\n        <textarea\n          v-model=\"publicKey\"\n          placeholder=\"粘贴PEM格式的公钥，如：-----BEGIN PUBLIC KEY-----...\"\n          class=\"w-full h-32 p-4 border border-border rounded-lg bg-background resize-none focus:outline-none focus:ring-2 focus:ring-primary font-mono text-sm\"\n        ></textarea>\n        <div v-if=\"publicKeyInfo\" class=\"text-sm text-muted-foreground\">\n          <span>密钥位数：{{ publicKeyInfo.bits }}位</span>\n          <span class=\"ml-4\">指纹：{{ publicKeyInfo.fingerprint }}</span>\n        </div>\n      </div>\n    </div>\n\n    <!-- 主要功能区域 -->\n    <div class=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8\">\n      <!-- 输入区域 -->\n      <div class=\"space-y-4\">\n        <div class=\"flex items-center justify-between\">\n          <label class=\"text-lg font-semibold\">原始数据</label>\n          <div class=\"flex items-center gap-2\">\n            <button\n              @click=\"clearInput\"\n              class=\"px-3 py-1 text-sm text-muted-foreground hover:text-foreground transition-colors\"\n            >\n              清空\n            </button>\n            <label class=\"flex items-center gap-2 cursor-pointer\">\n              <input\n                type=\"file\"\n                ref=\"dataFile\"\n                @change=\"handleDataFileUpload\"\n                class=\"hidden\"\n              >\n              <span class=\"px-3 py-1 text-sm bg-primary/10 text-primary rounded-md hover:bg-primary/20 transition-colors\">\n                选择文件\n              </span>\n            </label>\n          </div>\n        </div>\n        <textarea\n          v-model=\"plainText\"\n          placeholder=\"请输入要加密的文本或数据...\"\n          class=\"w-full h-64 p-4 border border-border rounded-lg bg-background resize-none focus:outline-none focus:ring-2 focus:ring-primary\"\n        ></textarea>\n        <div class=\"text-sm text-muted-foreground\">\n          字符数：{{ plainText.length }}\n          <span v-if=\"publicKeyInfo\" class=\"ml-4\">\n            最大长度：{{ publicKeyInfo.maxEncryptLength }} 字节\n          </span>\n        </div>\n      </div>\n\n      <!-- 输出区域 -->\n      <div class=\"space-y-4\">\n        <div class=\"flex items-center justify-between\">\n          <label class=\"text-lg font-semibold\">加密结果</label>\n          <div class=\"flex items-center gap-2\">\n            <button\n              @click=\"copyToClipboard(encryptedResult)\"\n              :disabled=\"!encryptedResult\"\n              class=\"px-3 py-1 text-sm bg-primary/10 text-primary rounded-md hover:bg-primary/20 transition-colors disabled:opacity-50\"\n            >\n              {{ copyButtonText }}\n            </button>\n            <button\n              @click=\"downloadResult\"\n              :disabled=\"!encryptedResult\"\n              class=\"px-3 py-1 text-sm bg-secondary/10 text-secondary-foreground rounded-md hover:bg-secondary/20 transition-colors disabled:opacity-50\"\n            >\n              下载\n            </button>\n          </div>\n        </div>\n        <textarea\n          v-model=\"encryptedResult\"\n          placeholder=\"加密结果将显示在这里...\"\n          readonly\n          class=\"w-full h-64 p-4 border border-border rounded-lg bg-muted/50 resize-none font-mono text-sm\"\n        ></textarea>\n        <div class=\"text-sm text-muted-foreground\">\n          长度：{{ encryptedResult.length }}\n          <span v-if=\"encryptedChunks > 1\" class=\"ml-4 text-primary\">\n            分段加密：{{ encryptedChunks }} 块\n          </span>\n        </div>\n      </div>\n    </div>\n\n    <!-- 操作按钮 -->\n    <div class=\"flex flex-wrap gap-4 mb-8\">\n      <button\n        @click=\"encryptData\"\n        :disabled=\"!publicKey || !plainText\"\n        class=\"px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n      >\n        加密数据\n      </button>\n      <button\n        @click=\"largeFileEncrypt\"\n        :disabled=\"!publicKey\"\n        class=\"px-6 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n      >\n        大文件加密\n      </button>\n    </div>\n\n    <!-- 加密详情 -->\n    <div v-if=\"encryptDetails\" class=\"border border-border rounded-lg p-6 mb-8\">\n      <h3 class=\"text-lg font-semibold mb-4\">加密详情</h3>\n      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n        <div>\n          <span class=\"text-muted-foreground\">加密算法：</span>\n          <span>{{ encryptDetails.algorithm }}</span>\n        </div>\n        <div>\n          <span class=\"text-muted-foreground\">密钥长度：</span>\n          <span>{{ encryptDetails.keySize }} 位</span>\n        </div>\n        <div>\n          <span class=\"text-muted-foreground\">原始数据长度：</span>\n          <span>{{ encryptDetails.originalLength }} 字节</span>\n        </div>\n        <div>\n          <span class=\"text-muted-foreground\">加密后长度：</span>\n          <span>{{ encryptDetails.encryptedLength }} 字节</span>\n        </div>\n      </div>\n    </div>\n\n    <!-- RSA加密说明 -->\n    <div class=\"border border-border rounded-lg p-6 mb-8\">\n      <h3 class=\"text-lg font-semibold mb-4\">RSA加密说明</h3>\n      <div class=\"space-y-4\">\n        <div>\n          <h4 class=\"font-medium text-primary mb-2\">加密原理</h4>\n          <p class=\"text-sm text-muted-foreground\">\n            RSA使用公钥加密数据，只有对应的私钥才能解密。公钥可以公开分享，用于加密；私钥必须保密，用于解密。\n          </p>\n        </div>\n        <div>\n          <h4 class=\"font-medium text-primary mb-2\">加密限制</h4>\n          <div class=\"bg-muted/50 rounded-lg p-4\">\n            <ul class=\"text-sm space-y-1\">\n              <li>• RSA不能直接加密大数据，有长度限制</li>\n              <li>• 2048位密钥最大加密245字节</li>\n              <li>• 3072位密钥最大加密373字节</li>\n              <li>• 4096位密钥最大加密501字节</li>\n            </ul>\n          </div>\n        </div>\n        <div>\n          <h4 class=\"font-medium text-primary mb-2\">加密方案对比</h4>\n          <div class=\"overflow-x-auto\">\n            <table class=\"w-full text-sm border border-border\">\n              <thead class=\"bg-muted/50\">\n                <tr>\n                  <th class=\"border border-border px-4 py-2 text-left\">方案</th>\n                  <th class=\"border border-border px-4 py-2 text-left\">安全性</th>\n                  <th class=\"border border-border px-4 py-2 text-left\">性能</th>\n                  <th class=\"border border-border px-4 py-2 text-left\">推荐场景</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr>\n                  <td class=\"border border-border px-4 py-2 font-medium\">RSA-OAEP</td>\n                  <td class=\"border border-border px-4 py-2 text-green-600\">高</td>\n                  <td class=\"border border-border px-4 py-2\">中等</td>\n                  <td class=\"border border-border px-4 py-2\">新应用推荐</td>\n                </tr>\n                <tr>\n                  <td class=\"border border-border px-4 py-2 font-medium\">PKCS1 v1.5</td>\n                  <td class=\"border border-border px-4 py-2 text-amber-600\">中等</td>\n                  <td class=\"border border-border px-4 py-2 text-green-600\">快</td>\n                  <td class=\"border border-border px-4 py-2\">兼容性要求</td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n        <div>\n          <h4 class=\"font-medium text-primary mb-2\">大文件加密方案</h4>\n          <ul class=\"text-sm space-y-1\">\n            <li>• 混合加密：生成随机AES密钥加密数据，用RSA加密AES密钥</li>\n            <li>• 分段加密：将数据分成小块，分别用RSA加密</li>\n            <li>• 数字信封：结合对称加密和非对称加密的优势</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n\n    <!-- 相关工具 -->\n    <div class=\"space-y-4\">\n      <h3 class=\"text-lg font-semibold\">相关工具</h3>\n      <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        <ToolCard\n          v-for=\"tool in relatedTools\"\n          :key=\"tool.id\"\n          :tool=\"tool\"\n          :title=\"tool.name\"\n          :description=\"tool.description\"\n          :category=\"tool.category\"\n          :usage-count=\"formatViewCount(tool.viewCount)\"\n          :icon=\"tool.icon\"\n          @select=\"handleToolSelect\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, watch } from 'vue'\nimport { categories } from '~/data/categories'\nimport { tools } from '~/data/tools'\nimport { addRecentTool } from '~/composables/useTools'\nimport Breadcrumb from '~/components/Breadcrumb.vue'\nimport ToolCard from '~/components/ToolCard.vue'\nimport { JSEncrypt } from 'jsencrypt'\n\ndefinePageMeta({\n  layout: 'default'\n})\n\nconst category = categories.find(c => c.id === 'crypto')\n\n// 响应式数据\nconst publicKey = ref('')\nconst plainText = ref('')\nconst encryptedResult = ref('')\nconst keyFormat = ref('PEM')\nconst outputFormat = ref('base64')\nconst encryptionScheme = ref('RSA-OAEP')\nconst publicKeyFile = ref(null)\nconst dataFile = ref(null)\nconst copyButtonText = ref('复制')\nconst encryptedChunks = ref(0)\nconst encryptDetails = ref(null)\nconst publicKeyInfo = ref(null)\n\n// 相关工具\nconst relatedTools = computed(() => {\n  return tools.filter(tool =>\n    tool.category === 'crypto' &&\n    tool.id !== 'rsa-encrypt'\n  ).slice(0, 4)\n})\n\n// 格式化浏览量\nconst formatViewCount = (count) => {\n  if (count >= 10000) {\n    return `${(count / 10000).toFixed(1)}w+`\n  } else if (count >= 1000) {\n    return `${(count / 1000).toFixed(1)}k+`\n  }\n  return `${count}`\n}\n\n// 监听公钥变化\nwatch(publicKey, (newKey) => {\n  if (newKey) {\n    analyzePublicKey(newKey)\n  } else {\n    publicKeyInfo.value = null\n  }\n})\n\n// 分析公钥\nconst analyzePublicKey = (key) => {\n  try {\n    const jsEncrypt = new JSEncrypt()\n    jsEncrypt.setPublicKey(key)\n\n    // 获取密钥信息（这里使用模拟数据）\n    const keyLength = key.includes('2048') ? 2048 : key.includes('3072') ? 3072 : key.includes('4096') ? 4096 : 2048\n    const maxEncrypt = Math.floor((keyLength - 42) / 8) // OAEP填充\n\n    publicKeyInfo.value = {\n      bits: keyLength,\n      maxEncryptLength: maxEncrypt,\n      fingerprint: generateFingerprint(key)\n    }\n  } catch (error) {\n    publicKeyInfo.value = null\n  }\n}\n\n// 生成密钥指纹（模拟）\nconst generateFingerprint = (key) => {\n  return 'SHA256:' + Array.from({length: 32}, () =>\n    Math.floor(Math.random() * 16).toString(16)\n  ).join('').substring(0, 16)\n}\n\n// 加载示例公钥\nconst loadExampleKey = () => {\n  publicKey.value = `-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAu1SU1LfVLPHCozMxH2Mo\n4lgOEePzNm0tRgeLezV6ffAt0gunVTLw7onLRnrUhgUXOJwnLHkNxf85pSz9CVD\nMF3rJIcIZA1V6ZhrlYQpzlzR8mTh/8I8Aj7geWRZJ1dGif4RPvqVY2/6cR1brvN\nTq+Jz5gZHOjWNPmwKBMvmv8N+Lt+MPTk1VjM2OL8YKRM/pj6RVJ8f/5BDD3G21H\n0O39SFTwS1wQp5B0jpbWxGBTDmbzDbi8JqSn4UnBxOBF5eBmHm1TQRrvFFXRz8n\njpZvKJBbfjQjKY7YNGTo3iQYpPOmHgaE3FBaZ1AiLGgzwI87hjCkN3gpbJnzJNR\n9QIDAQAB\n-----END PUBLIC KEY-----`\n}\n\n// 加密数据\nconst encryptData = async () => {\n  if (!publicKey.value || !plainText.value) {\n    alert('请输入公钥和要加密的数据')\n    return\n  }\n\n  try {\n    // 检查数据长度\n    const dataBytes = new TextEncoder().encode(plainText.value)\n    if (dataBytes.length > publicKeyInfo.value?.maxEncryptLength) {\n      if (!confirm(`数据长度(${dataBytes.length}字节)超过最大加密长度(${publicKeyInfo.value.maxEncryptLength}字节)。\\n\\n是否使用混合加密方案？`)) {\n        return\n      }\n      await hybridEncrypt()\n      return\n    }\n\n    // 直接RSA加密\n    const jsEncrypt = new JSEncrypt()\n    jsEncrypt.setPublicKey(publicKey.value)\n\n    const encrypted = jsEncrypt.encrypt(plainText.value)\n    if (encrypted) {\n      encryptedResult.value = encrypted\n      encryptedChunks.value = 1\n\n      encryptDetails.value = {\n        algorithm: `RSA-${publicKeyInfo.value?.bits || 2048}-${encryptionScheme.value}`,\n        keySize: publicKeyInfo.value?.bits || 2048,\n        originalLength: dataBytes.length,\n        encryptedLength: encrypted.length\n      }\n    } else {\n      alert('加密失败，请检查公钥格式')\n    }\n  } catch (error) {\n    alert('加密错误：' + error.message)\n  }\n}\n\n// 混合加密（用于大文件）\nconst hybridEncrypt = async () => {\n  // 生成随机AES密钥\n  const aesKey = Array.from({length: 32}, () =>\n    Math.floor(Math.random() * 256)\n  )\n\n  // 使用AES加密数据（这里简化处理）\n  const dataBytes = new TextEncoder().encode(plainText.value)\n\n  // 使用RSA加密AES密钥\n  const jsEncrypt = new JSEncrypt()\n  jsEncrypt.setPublicKey(publicKey.value)\n  const aesKeyBase64 = btoa(String.fromCharCode(...aesKey))\n  const encryptedAesKey = jsEncrypt.encrypt(aesKeyBase64)\n\n  // 组合结果\n  const result = {\n    type: 'hybrid',\n    encryptedKey: encryptedAesKey,\n    algorithm: 'AES-256-CBC',\n    iv: Array.from({length: 16}, () => Math.floor(Math.random() * 256))\n      .map(b => b.toString(16).padStart(2, '0')).join(''),\n    data: btoa(plainText.value) // 简化，实际应该用AES加密\n  }\n\n  encryptedResult.value = JSON.stringify(result, null, 2)\n  encryptedChunks.value = 1\n\n  encryptDetails.value = {\n    algorithm: `RSA-${publicKeyInfo.value?.bits || 2048} + AES-256`,\n    keySize: publicKeyInfo.value?.bits || 2048,\n    originalLength: dataBytes.length,\n    encryptedLength: encryptedResult.value.length\n  }\n}\n\n// 大文件加密\nconst largeFileEncrypt = () => {\n  alert('大文件加密功能需要选择文件，建议使用混合加密方案：\\n\\n1. 生成随机AES密钥\\n2. 使用AES加密文件内容\\n3. 使用RSA加密AES密钥')\n}\n\n// 处理公钥文件上传\nconst handleKeyFileUpload = (event) => {\n  const file = event.target.files[0]\n  if (!file) return\n\n  const reader = new FileReader()\n  reader.onload = (e) => {\n    publicKey.value = e.target.result\n  }\n  reader.readAsText(file)\n}\n\n// 处理数据文件上传\nconst handleDataFileUpload = (event) => {\n  const file = event.target.files[0]\n  if (!file) return\n\n  if (file.size > 1024 * 1024) { // 1MB\n    alert('文件过大，建议使用大文件加密方案')\n    return\n  }\n\n  const reader = new FileReader()\n  reader.onload = (e) => {\n    plainText.value = e.target.result\n  }\n  reader.readAsText(file)\n}\n\n// 复制到剪贴板\nconst copyToClipboard = async (text) => {\n  try {\n    await navigator.clipboard.writeText(text)\n    copyButtonText.value = '已复制'\n    setTimeout(() => {\n      copyButtonText.value = '复制'\n    }, 2000)\n  } catch (error) {\n    console.error('复制失败:', error)\n  }\n}\n\n// 下载结果\nconst downloadResult = () => {\n  if (!encryptedResult.value) return\n\n  let content\n  if (outputFormat.value === 'json') {\n    try {\n      const jsonData = JSON.parse(encryptedResult.value)\n      content = JSON.stringify(jsonData, null, 2)\n    } catch {\n      content = encryptedResult.value\n    }\n  } else {\n    content = encryptedResult.value\n  }\n\n  const blob = new Blob([content], { type: 'text/plain' })\n  const url = URL.createObjectURL(blob)\n  const a = document.createElement('a')\n  a.href = url\n  a.download = `rsa-encrypted-${Date.now()}.txt`\n  a.click()\n  URL.revokeObjectURL(url)\n}\n\n// 清空输入\nconst clearInput = () => {\n  plainText.value = ''\n  encryptedResult.value = ''\n  encryptDetails.value = null\n}\n\n// 工具选择处理\nconst handleToolSelect = (tool) => {\n  const toolUrl = `/tools/${tool.id}/`\n  navigateTo(toolUrl)\n  addRecentTool(tool.id)\n}\n\n// 添加到最近使用\naddRecentTool('rsa-encrypt')\n\n// SEO配置\nuseSeoMeta({\n  title: 'RSA加密 - 在线RSA公钥加密工具',\n  description: '免费在线RSA加密工具，支持RSA-OAEP和PKCS1加密方案，可加密文本和数据，保护信息安全传输。',\n  keywords: ['RSA', '公钥加密', '非对称加密', 'RSA-OAEP', 'PKCS1', '数据加密']\n})\n\n</script>"],"version":3}