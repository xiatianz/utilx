import{r as d,e as _,p as A,q as j,c as f,a as t,y,x as w,h as x,P as C,d as k,t as p,v as h,E as H,F as K,k as z,o as m,n as Z,U as X}from"./DEsTSaKd.js";import{c as q}from"./3IwUeceH.js";import{t as J}from"./B-fbZyPE.js";import{_ as W}from"./C71nLTaj.js";import{C as l}from"./JCzq_naB.js";import"./D4g1_bQ7.js";import"./B03HrVNV.js";import"./4T928kbW.js";import"./wERbHxDK.js";import"./DESX2TF9.js";import"./b4Up8kzW.js";import"./DbWJs76d.js";import"./BuCd20m7.js";import"./C-LEKrTT.js";import"./Bluep4Ee.js";import"./CE1G-McA.js";import"./TDtrdbi3.js";const Q={class:"max-w-8xl mx-auto"},Y={class:"border border-border rounded-lg p-6 mb-8"},ee={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},te=["disabled"],oe={class:"border border-border rounded-lg p-6 mb-8"},se={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},le={class:"text-sm font-medium mb-2 block"},re={class:"text-xs text-muted-foreground ml-2"},ne={class:"flex gap-2"},ae=["placeholder"],de={class:"mt-2 text-xs text-muted-foreground"},ie={key:0,class:"text-amber-600 ml-2"},ue={key:0},ce={class:"flex gap-2"},pe={class:"mt-2 text-xs text-muted-foreground"},me={key:0,class:"text-amber-600 ml-2"},ve={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},ge={class:"space-y-4"},be={class:"flex items-center justify-between"},fe={class:"flex items-center gap-2"},xe={class:"flex items-center gap-2 cursor-pointer"},ye=["placeholder"],Ce={class:"text-sm text-muted-foreground"},ke={class:"space-y-4"},he={class:"flex items-center justify-between"},Se={class:"flex items-center gap-2"},Be=["disabled"],we=["disabled"],Ee={class:"text-sm text-muted-foreground"},_e={class:"flex flex-wrap gap-4 mb-8"},Ae=["disabled"],Fe=["disabled"],Ie={key:0,class:"border border-border rounded-lg p-6 mb-8"},Ue={key:0,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ve={key:1,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},$e={class:"font-medium"},Te={class:"text-sm"},Ne={class:"space-y-4"},Oe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},tt={__name:"aes-decrypt",setup(Re){q.find(o=>o.id==="crypto");const n=d(""),r=d(""),v=d(""),u=d(""),c=d("256"),i=d("CBC"),S=d("PKCS7"),g=d("base64"),F=d(null),B=d("复制"),a=d(null),I=_(()=>J.filter(o=>o.category==="crypto"&&o.id!=="aes-decrypt").slice(0,4)),U=o=>o>=1e4?`${(o/1e4).toFixed(1)}w+`:o>=1e3?`${(o/1e3).toFixed(1)}k+`:`${o}`,E=_(()=>n.value&&v.value&&v.value.length*8===Number(c)&&(i.value==="ECB"||u.value&&u.value.length===16)),V=()=>{if(!n.value)return;const o=n.value.trim();if(o.match(/^[A-Za-z0-9+/]*={0,2}$/)&&o.length%4===0){g.value="base64",alert("检测为Base64格式");return}if(o.match(/^[0-9A-Fa-f]+$/)&&o.length%2===0){g.value="hex",alert("检测为Hex格式");return}g.value="utf8",alert("无法自动检测，使用UTF-8格式")},$=()=>{try{if(!E.value){a.value={success:!1,message:"请检查密钥和IV设置"};return}const o={mode:T(),padding:N()};i.value!=="ECB"&&(o.iv=l.enc.Hex.parse(u.value));let e;switch(g.value){case"base64":e=l.enc.Base64.parse(n.value);break;case"hex":e=l.enc.Hex.parse(n.value);break;case"utf8":e=l.enc.Utf8.parse(n.value);break}const b=l.AES.decrypt({ciphertext:e},l.enc.Hex.parse(v.value),o).toString(l.enc.Utf8);b?(r.value=b,a.value={success:!0,message:"解密成功"}):(r.value="",a.value={success:!1,message:"解密失败，可能是密钥或参数不正确"})}catch(o){r.value="",a.value={success:!1,message:"解密错误："+o.message}}},T=()=>({CBC:l.mode.CBC,ECB:l.mode.ECB,CFB:l.mode.CFB,OFB:l.mode.OFB,CTR:l.mode.CTR,GCM:l.mode.GCM})[i.value]||l.mode.CBC,N=()=>({PKCS7:l.pad.Pkcs7,ISO97971:l.pad.Iso97971,ANSIX923:l.pad.AnsiX923,ZERO:l.pad.ZeroPadding,NO_PADDING:l.pad.NoPadding})[S.value]||l.pad.Pkcs7,O=o=>{const e=o.target.files[0];if(!e)return;const s=new FileReader;s.onload=b=>{n.value=b.target.result},s.readAsText(e)},R=async o=>{try{await navigator.clipboard.writeText(o),B.value="已复制",setTimeout(()=>{B.value="复制"},2e3)}catch(e){console.error("复制失败:",e)}},D=()=>{if(!r.value)return;const o=`解密算法: AES-${c}-${i}
密钥长度: ${c}位
${i!=="ECB"?`IV: ${u.value}
`:""}输入格式: ${g.value}

解密结果:
${r.value}

解密时间: ${new Date().toLocaleString()}`,e=new Blob([o],{type:"text/plain"}),s=URL.createObjectURL(e),b=document.createElement("a");b.href=s,b.download=`aes-decrypted-${Date.now()}.txt`,b.click(),URL.revokeObjectURL(s)},M=()=>{n.value="",r.value="",a.value=null},P=()=>{v.value="",r.value="",a.value=null},G=()=>{u.value="",r.value="",a.value=null},L=o=>{const e=`/tools/${o.id}/`;X(e),A(o.id)};return A("aes-decrypt"),j({title:"AES解密 - 在线AES数据解密工具",description:"免费在线AES解密工具，支持AES-128/192/256，多种工作模式，快速解密AES加密的数据。",keywords:["AES","解密","对称解密","AES-256","AES-128"]}),(o,e)=>(m(),f("div",Q,[e[28]||(e[28]=t("div",{class:"mt-4 mb-8"},[t("h1",{class:"text-3xl font-bold mb-3"},"AES解密"),t("p",{class:"text-muted-foreground max-w-3xl"},"AES对称解密工具，支持AES-128/192/256，多种工作模式，可解密AES加密的文本和文件。")],-1)),t("div",Y,[e[17]||(e[17]=t("h3",{class:"text-lg font-semibold mb-4"},"解密设置",-1)),t("div",ee,[t("div",null,[e[10]||(e[10]=t("label",{class:"text-sm font-medium mb-2 block"},"密钥长度",-1)),x(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},[...e[9]||(e[9]=[t("option",{value:"128"},"AES-128 (128位)",-1),t("option",{value:"192"},"AES-192 (192位)",-1),t("option",{value:"256"},"AES-256 (256位)",-1)])],512),[[C,c.value]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"text-sm font-medium mb-2 block"},"工作模式",-1)),x(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>i.value=s),class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},[...e[11]||(e[11]=[w('<option value="CBC">CBC (密码块链接)</option><option value="ECB">ECB (电子密码本)</option><option value="CFB">CFB (密码反馈)</option><option value="OFB">OFB (输出反馈)</option><option value="CTR">CTR (计数器)</option><option value="GCM">GCM (伽罗瓦计数器)</option>',6)])],512),[[C,i.value]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"text-sm font-medium mb-2 block"},"填充方式",-1)),x(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>S.value=s),class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary",disabled:i.value==="CTR"||i.value==="GCM"},[...e[13]||(e[13]=[w('<option value="PKCS7">PKCS7</option><option value="ISO97971">ISO/IEC 9797-1</option><option value="ANSIX923">ANSI X9.23</option><option value="ZERO">Zero Padding</option><option value="NO_PADDING">无填充</option>',5)])],8,te),[[C,S.value]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"text-sm font-medium mb-2 block"},"输入格式",-1)),x(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>g.value=s),class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},[...e[15]||(e[15]=[t("option",{value:"base64"},"Base64",-1),t("option",{value:"hex"},"Hex",-1),t("option",{value:"utf8"},"UTF-8",-1)])],512),[[C,g.value]])])])]),t("div",oe,[e[20]||(e[20]=t("h3",{class:"text-lg font-semibold mb-4"},"密钥和初始向量",-1)),t("div",se,[t("div",null,[t("label",le,[e[18]||(e[18]=k(" 密钥 ",-1)),t("span",re,"("+p(c.value/8)+"字节)",1)]),t("div",ne,[x(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>v.value=s),type:"password",placeholder:`输入${c.value}位密钥`,class:"flex-1 px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},null,8,ae),[[h,v.value]]),t("button",{onClick:P,class:"px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80 transition-colors"}," 清空 ")]),t("div",de,[k(" 密钥长度："+p(v.value.length*8)+" 位 ",1),v.value.length*8!==Number(c.value)?(m(),f("span",ie," (需要 "+p(c.value)+" 位) ",1)):y("",!0)])]),i.value!=="ECB"?(m(),f("div",ue,[e[19]||(e[19]=t("label",{class:"text-sm font-medium mb-2 block"},[k(" 初始向量 (IV) "),t("span",{class:"text-xs text-muted-foreground ml-2"},"(16字节)")],-1)),t("div",ce,[x(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>u.value=s),type:"password",placeholder:"输入16字节初始向量",class:"flex-1 px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},null,512),[[h,u.value]]),t("button",{onClick:G,class:"px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80 transition-colors"}," 清空 ")]),t("div",pe,[k(" IV长度："+p(u.value.length*8)+" 位 ",1),u.value.length!==16?(m(),f("span",me," (需要 128 位/16 字节) ")):y("",!0)])])):y("",!0)])]),t("div",ve,[t("div",ge,[t("div",be,[e[22]||(e[22]=t("label",{class:"text-lg font-semibold"},"加密数据",-1)),t("div",fe,[t("button",{onClick:M,class:"px-3 py-1 text-sm text-muted-foreground hover:text-foreground transition-colors"}," 清空 "),t("label",xe,[t("input",{type:"file",ref_key:"fileInput",ref:F,onChange:O,accept:".txt,.enc,.aes",class:"hidden"},null,544),e[21]||(e[21]=t("span",{class:"px-3 py-1 text-sm bg-primary/10 text-primary rounded-md hover:bg-primary/20 transition-colors"}," 选择文件 ",-1))])])]),x(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=s=>n.value=s),placeholder:`请输入要解密的${g.value}格式数据...`,class:"w-full h-64 p-4 border border-border rounded-lg bg-background resize-none focus:outline-none focus:ring-2 focus:ring-primary font-mono text-sm"},null,8,ye),[[h,n.value]]),t("div",Ce," 数据长度："+p(n.value.length),1)]),t("div",ke,[t("div",he,[e[23]||(e[23]=t("label",{class:"text-lg font-semibold"},"解密结果",-1)),t("div",Se,[t("button",{onClick:e[7]||(e[7]=s=>R(r.value)),disabled:!r.value,class:"px-3 py-1 text-sm bg-primary/10 text-primary rounded-md hover:bg-primary/20 transition-colors disabled:opacity-50"},p(B.value),9,Be),t("button",{onClick:D,disabled:!r.value,class:"px-3 py-1 text-sm bg-secondary/10 text-secondary-foreground rounded-md hover:bg-secondary/20 transition-colors disabled:opacity-50"}," 下载 ",8,we)])]),x(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=s=>r.value=s),placeholder:"解密结果将显示在这里...",readonly:"",class:"w-full h-64 p-4 border border-border rounded-lg bg-muted/50 resize-none"},null,512),[[h,r.value]]),t("div",Ee," 长度："+p(r.value.length),1)])]),t("div",_e,[t("button",{onClick:$,disabled:!E.value,class:"px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 解密数据 ",8,Ae),t("button",{onClick:V,disabled:!n.value,class:"px-6 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80 transition-colors disabled:opacity-50"}," 自动检测格式 ",8,Fe)]),a.value?(m(),f("div",Ie,[e[26]||(e[26]=t("h3",{class:"text-lg font-semibold mb-4"},"解密状态",-1)),t("div",{class:H(["flex items-center gap-3",a.value.success?"text-green-600":"text-red-600"])},[a.value.success?(m(),f("svg",Ue,[...e[24]||(e[24]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):(m(),f("svg",Ve,[...e[25]||(e[25]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)])])),t("div",null,[t("div",$e,p(a.value.success?"解密成功":"解密失败"),1),t("div",Te,p(a.value.message),1)])],2)])):y("",!0),e[29]||(e[29]=w('<div class="border border-border rounded-lg p-6 mb-8"><h3 class="text-lg font-semibold mb-4">AES解密说明</h3><div class="space-y-4"><div><h4 class="font-medium text-primary mb-2">解密要求</h4><ul class="text-sm space-y-1"><li>• 密钥必须与加密时使用的密钥完全一致</li><li>• 工作模式、填充方式必须与加密时相同</li><li>• CBC、CFB、OFB、GCM模式需要正确的初始向量(IV)</li><li>• 输入数据格式必须正确（Base64或Hex编码）</li></ul></div><div><h4 class="font-medium text-primary mb-2">常见错误</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"><div><h5 class="font-medium text-amber-600 mb-1">Wrong padding</h5><p class="text-muted-foreground">填充方式不正确或密钥错误</p></div><div><h5 class="font-medium text-amber-600 mb-1">Invalid data</h5><p class="text-muted-foreground">输入格式错误或数据损坏</p></div><div><h5 class="font-medium text-amber-600 mb-1">Bad key length</h5><p class="text-muted-foreground">密钥长度与设置不符</p></div><div><h5 class="font-medium text-amber-600 mb-1">Empty result</h5><p class="text-muted-foreground">解密结果为空，可能是密钥错误</p></div></div></div><div><h4 class="font-medium text-primary mb-2">安全建议</h4><ul class="text-sm space-y-1 text-amber-600"><li>• 密钥应通过安全渠道传输，不要明文发送</li><li>• 解密后及时清除内存中的敏感数据</li><li>• 使用强密钥（至少AES-256）</li><li>• 定期更换密钥以提高安全性</li></ul></div></div></div>',1)),t("div",Ne,[e[27]||(e[27]=t("h3",{class:"text-lg font-semibold"},"相关工具",-1)),t("div",Oe,[(m(!0),f(K,null,z(I.value,s=>(m(),Z(W,{key:s.id,tool:s,title:s.name,description:s.description,category:s.category,"usage-count":U(s.viewCount),icon:s.icon,onSelect:L},null,8,["tool","title","description","category","usage-count","icon"]))),128))])])]))}};export{tt as default};
