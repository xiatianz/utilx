import{r as n,e as $,Q,p as w,q as Y,c as b,a as t,y,x as G,h as m,P as h,v as S,t as i,d as k,F as H,k as Z,o as p,n as q,U as W}from"./DEsTSaKd.js";import{c as X}from"./3IwUeceH.js";import{t as ee}from"./B-fbZyPE.js";import{_ as te}from"./C71nLTaj.js";import{J as A}from"./BR9uVBAU.js";import"./D4g1_bQ7.js";import"./B03HrVNV.js";import"./4T928kbW.js";import"./wERbHxDK.js";import"./DESX2TF9.js";import"./b4Up8kzW.js";import"./DbWJs76d.js";import"./BuCd20m7.js";import"./C-LEKrTT.js";import"./Bluep4Ee.js";const re={class:"max-w-8xl mx-auto"},oe={class:"border border-border rounded-lg p-6 mb-8"},se={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},le={class:"border border-border rounded-lg p-6 mb-8"},ne={class:"space-y-4"},ae={class:"flex items-center gap-4"},de={class:"flex items-center gap-2 cursor-pointer"},ie={key:0,class:"text-sm text-muted-foreground"},ue={class:"ml-4"},ce={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},pe={class:"space-y-4"},be={class:"flex items-center justify-between"},me={class:"flex items-center gap-2"},ge={class:"flex items-center gap-2 cursor-pointer"},ye={class:"text-sm text-muted-foreground"},ve={key:0,class:"ml-4"},fe={class:"space-y-4"},xe={class:"flex items-center justify-between"},he={class:"flex items-center gap-2"},Se=["disabled"],Ae=["disabled"],Ee={class:"text-sm text-muted-foreground"},Re={key:0,class:"ml-4 text-primary"},we={class:"flex flex-wrap gap-4 mb-8"},ke=["disabled"],Ce=["disabled"],Be={key:0,class:"border border-border rounded-lg p-6 mb-8"},Ke={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},Pe={class:"space-y-4"},Le={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Ge={__name:"rsa-encrypt",setup(je){X.find(r=>r.id==="crypto");const u=n(""),a=n(""),s=n(""),E=n("PEM"),v=n("base64"),f=n("RSA-OAEP"),C=n(null),B=n(null),x=n("复制"),g=n(0),c=n(null),l=n(null),K=$(()=>ee.filter(r=>r.category==="crypto"&&r.id!=="rsa-encrypt").slice(0,4)),P=r=>r>=1e4?`${(r/1e4).toFixed(1)}w+`:r>=1e3?`${(r/1e3).toFixed(1)}k+`:`${r}`;Q(u,r=>{r?L(r):l.value=null});const L=r=>{try{new A().setPublicKey(r);const o=r.includes("2048")?2048:r.includes("3072")?3072:r.includes("4096")?4096:2048,d=Math.floor((o-42)/8);l.value={bits:o,maxEncryptLength:d,fingerprint:j(r)}}catch{l.value=null}},j=r=>"SHA256:"+Array.from({length:32},()=>Math.floor(Math.random()*16).toString(16)).join("").substring(0,16),F=()=>{u.value=`-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAu1SU1LfVLPHCozMxH2Mo
4lgOEePzNm0tRgeLezV6ffAt0gunVTLw7onLRnrUhgUXOJwnLHkNxf85pSz9CVD
MF3rJIcIZA1V6ZhrlYQpzlzR8mTh/8I8Aj7geWRZJ1dGif4RPvqVY2/6cR1brvN
Tq+Jz5gZHOjWNPmwKBMvmv8N+Lt+MPTk1VjM2OL8YKRM/pj6RVJ8f/5BDD3G21H
0O39SFTwS1wQp5B0jpbWxGBTDmbzDbi8JqSn4UnBxOBF5eBmHm1TQRrvFFXRz8n
jpZvKJBbfjQjKY7YNGTo3iQYpPOmHgaE3FBaZ1AiLGgzwI87hjCkN3gpbJnzJNR
9QIDAQAB
-----END PUBLIC KEY-----`},M=async()=>{if(!u.value||!a.value){alert("请输入公钥和要加密的数据");return}try{const r=new TextEncoder().encode(a.value);if(r.length>l.value?.maxEncryptLength){if(!confirm(`数据长度(${r.length}字节)超过最大加密长度(${l.value.maxEncryptLength}字节)。

是否使用混合加密方案？`))return;await T();return}const e=new A;e.setPublicKey(u.value);const o=e.encrypt(a.value);o?(s.value=o,g.value=1,c.value={algorithm:`RSA-${l.value?.bits||2048}-${f.value}`,keySize:l.value?.bits||2048,originalLength:r.length,encryptedLength:o.length}):alert("加密失败，请检查公钥格式")}catch(r){alert("加密错误："+r.message)}},T=async()=>{const r=Array.from({length:32},()=>Math.floor(Math.random()*256)),e=new TextEncoder().encode(a.value),o=new A;o.setPublicKey(u.value);const d=btoa(String.fromCharCode(...r)),J={type:"hybrid",encryptedKey:o.encrypt(d),algorithm:"AES-256-CBC",iv:Array.from({length:16},()=>Math.floor(Math.random()*256)).map(D=>D.toString(16).padStart(2,"0")).join(""),data:btoa(a.value)};s.value=JSON.stringify(J,null,2),g.value=1,c.value={algorithm:`RSA-${l.value?.bits||2048} + AES-256`,keySize:l.value?.bits||2048,originalLength:e.length,encryptedLength:s.value.length}},U=()=>{alert(`大文件加密功能需要选择文件，建议使用混合加密方案：

1. 生成随机AES密钥
2. 使用AES加密文件内容
3. 使用RSA加密AES密钥`)},N=r=>{const e=r.target.files[0];if(!e)return;const o=new FileReader;o.onload=d=>{u.value=d.target.result},o.readAsText(e)},O=r=>{const e=r.target.files[0];if(!e)return;if(e.size>1024*1024){alert("文件过大，建议使用大文件加密方案");return}const o=new FileReader;o.onload=d=>{a.value=d.target.result},o.readAsText(e)},_=async r=>{try{await navigator.clipboard.writeText(r),x.value="已复制",setTimeout(()=>{x.value="复制"},2e3)}catch(e){console.error("复制失败:",e)}},z=()=>{if(!s.value)return;let r;if(v.value==="json")try{const R=JSON.parse(s.value);r=JSON.stringify(R,null,2)}catch{r=s.value}else r=s.value;const e=new Blob([r],{type:"text/plain"}),o=URL.createObjectURL(e),d=document.createElement("a");d.href=o,d.download=`rsa-encrypted-${Date.now()}.txt`,d.click(),URL.revokeObjectURL(o)},V=()=>{a.value="",s.value="",c.value=null},I=r=>{const e=`/tools/${r.id}/`;W(e),w(r.id)};return w("rsa-encrypt"),Y({title:"RSA加密 - 在线RSA公钥加密工具",description:"免费在线RSA加密工具，支持RSA-OAEP和PKCS1加密方案，可加密文本和数据，保护信息安全传输。",keywords:["RSA","公钥加密","非对称加密","RSA-OAEP","PKCS1","数据加密"]}),(r,e)=>(p(),b("div",re,[e[25]||(e[25]=t("div",{class:"mt-4 mb-8"},[t("h1",{class:"text-3xl font-bold mb-3"},"RSA加密"),t("p",{class:"text-muted-foreground max-w-3xl"},"RSA非对称加密工具，使用公钥加密数据，只有对应的私钥才能解密。支持大分段加密和多种输出格式。")],-1)),t("div",oe,[e[13]||(e[13]=t("h3",{class:"text-lg font-semibold mb-4"},"加密设置",-1)),t("div",se,[t("div",null,[e[8]||(e[8]=t("label",{class:"text-sm font-medium mb-2 block"},"密钥格式",-1)),m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>E.value=o),class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},[...e[7]||(e[7]=[t("option",{value:"PEM"},"PEM格式",-1),t("option",{value:"DER"},"DER格式",-1),t("option",{value:"JWK"},"JWK格式",-1)])],512),[[h,E.value]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"text-sm font-medium mb-2 block"},"输出格式",-1)),m(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>v.value=o),class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},[...e[9]||(e[9]=[t("option",{value:"base64"},"Base64",-1),t("option",{value:"hex"},"十六进制",-1),t("option",{value:"json"},"JSON格式",-1)])],512),[[h,v.value]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"text-sm font-medium mb-2 block"},"加密方案",-1)),m(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>f.value=o),class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},[...e[11]||(e[11]=[t("option",{value:"RSA-OAEP"},"RSA-OAEP (推荐)",-1),t("option",{value:"RSAES-PKCS1-v1_5"},"PKCS1 v1.5",-1)])],512),[[h,f.value]])])])]),t("div",le,[e[15]||(e[15]=t("h3",{class:"text-lg font-semibold mb-4"},"公钥",-1)),t("div",ne,[t("div",ae,[t("label",de,[t("input",{type:"file",ref_key:"publicKeyFile",ref:C,onChange:N,accept:".pem,.pub,.key",class:"hidden"},null,544),e[14]||(e[14]=t("span",{class:"px-3 py-1 text-sm bg-primary/10 text-primary rounded-md hover:bg-primary/20 transition-colors"}," 导入公钥文件 ",-1))]),t("button",{onClick:F,class:"px-3 py-1 text-sm bg-secondary/10 text-secondary-foreground rounded-md hover:bg-secondary/20 transition-colors"}," 加载示例公钥 ")]),m(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=o=>u.value=o),placeholder:"粘贴PEM格式的公钥，如：-----BEGIN PUBLIC KEY-----...",class:"w-full h-32 p-4 border border-border rounded-lg bg-background resize-none focus:outline-none focus:ring-2 focus:ring-primary font-mono text-sm"},null,512),[[S,u.value]]),l.value?(p(),b("div",ie,[t("span",null,"密钥位数："+i(l.value.bits)+"位",1),t("span",ue,"指纹："+i(l.value.fingerprint),1)])):y("",!0)])]),t("div",ce,[t("div",pe,[t("div",be,[e[17]||(e[17]=t("label",{class:"text-lg font-semibold"},"原始数据",-1)),t("div",me,[t("button",{onClick:V,class:"px-3 py-1 text-sm text-muted-foreground hover:text-foreground transition-colors"}," 清空 "),t("label",ge,[t("input",{type:"file",ref_key:"dataFile",ref:B,onChange:O,class:"hidden"},null,544),e[16]||(e[16]=t("span",{class:"px-3 py-1 text-sm bg-primary/10 text-primary rounded-md hover:bg-primary/20 transition-colors"}," 选择文件 ",-1))])])]),m(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=o=>a.value=o),placeholder:"请输入要加密的文本或数据...",class:"w-full h-64 p-4 border border-border rounded-lg bg-background resize-none focus:outline-none focus:ring-2 focus:ring-primary"},null,512),[[S,a.value]]),t("div",ye,[k(" 字符数："+i(a.value.length)+" ",1),l.value?(p(),b("span",ve," 最大长度："+i(l.value.maxEncryptLength)+" 字节 ",1)):y("",!0)])]),t("div",fe,[t("div",xe,[e[18]||(e[18]=t("label",{class:"text-lg font-semibold"},"加密结果",-1)),t("div",he,[t("button",{onClick:e[5]||(e[5]=o=>_(s.value)),disabled:!s.value,class:"px-3 py-1 text-sm bg-primary/10 text-primary rounded-md hover:bg-primary/20 transition-colors disabled:opacity-50"},i(x.value),9,Se),t("button",{onClick:z,disabled:!s.value,class:"px-3 py-1 text-sm bg-secondary/10 text-secondary-foreground rounded-md hover:bg-secondary/20 transition-colors disabled:opacity-50"}," 下载 ",8,Ae)])]),m(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=o=>s.value=o),placeholder:"加密结果将显示在这里...",readonly:"",class:"w-full h-64 p-4 border border-border rounded-lg bg-muted/50 resize-none font-mono text-sm"},null,512),[[S,s.value]]),t("div",Ee,[k(" 长度："+i(s.value.length)+" ",1),g.value>1?(p(),b("span",Re," 分段加密："+i(g.value)+" 块 ",1)):y("",!0)])])]),t("div",we,[t("button",{onClick:M,disabled:!u.value||!a.value,class:"px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 加密数据 ",8,ke),t("button",{onClick:U,disabled:!u.value,class:"px-6 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 大文件加密 ",8,Ce)]),c.value?(p(),b("div",Be,[e[23]||(e[23]=t("h3",{class:"text-lg font-semibold mb-4"},"加密详情",-1)),t("div",Ke,[t("div",null,[e[19]||(e[19]=t("span",{class:"text-muted-foreground"},"加密算法：",-1)),t("span",null,i(c.value.algorithm),1)]),t("div",null,[e[20]||(e[20]=t("span",{class:"text-muted-foreground"},"密钥长度：",-1)),t("span",null,i(c.value.keySize)+" 位",1)]),t("div",null,[e[21]||(e[21]=t("span",{class:"text-muted-foreground"},"原始数据长度：",-1)),t("span",null,i(c.value.originalLength)+" 字节",1)]),t("div",null,[e[22]||(e[22]=t("span",{class:"text-muted-foreground"},"加密后长度：",-1)),t("span",null,i(c.value.encryptedLength)+" 字节",1)])])])):y("",!0),e[26]||(e[26]=G('<div class="border border-border rounded-lg p-6 mb-8"><h3 class="text-lg font-semibold mb-4">RSA加密说明</h3><div class="space-y-4"><div><h4 class="font-medium text-primary mb-2">加密原理</h4><p class="text-sm text-muted-foreground"> RSA使用公钥加密数据，只有对应的私钥才能解密。公钥可以公开分享，用于加密；私钥必须保密，用于解密。 </p></div><div><h4 class="font-medium text-primary mb-2">加密限制</h4><div class="bg-muted/50 rounded-lg p-4"><ul class="text-sm space-y-1"><li>• RSA不能直接加密大数据，有长度限制</li><li>• 2048位密钥最大加密245字节</li><li>• 3072位密钥最大加密373字节</li><li>• 4096位密钥最大加密501字节</li></ul></div></div><div><h4 class="font-medium text-primary mb-2">加密方案对比</h4><div class="overflow-x-auto"><table class="w-full text-sm border border-border"><thead class="bg-muted/50"><tr><th class="border border-border px-4 py-2 text-left">方案</th><th class="border border-border px-4 py-2 text-left">安全性</th><th class="border border-border px-4 py-2 text-left">性能</th><th class="border border-border px-4 py-2 text-left">推荐场景</th></tr></thead><tbody><tr><td class="border border-border px-4 py-2 font-medium">RSA-OAEP</td><td class="border border-border px-4 py-2 text-green-600">高</td><td class="border border-border px-4 py-2">中等</td><td class="border border-border px-4 py-2">新应用推荐</td></tr><tr><td class="border border-border px-4 py-2 font-medium">PKCS1 v1.5</td><td class="border border-border px-4 py-2 text-amber-600">中等</td><td class="border border-border px-4 py-2 text-green-600">快</td><td class="border border-border px-4 py-2">兼容性要求</td></tr></tbody></table></div></div><div><h4 class="font-medium text-primary mb-2">大文件加密方案</h4><ul class="text-sm space-y-1"><li>• 混合加密：生成随机AES密钥加密数据，用RSA加密AES密钥</li><li>• 分段加密：将数据分成小块，分别用RSA加密</li><li>• 数字信封：结合对称加密和非对称加密的优势</li></ul></div></div></div>',1)),t("div",Pe,[e[24]||(e[24]=t("h3",{class:"text-lg font-semibold"},"相关工具",-1)),t("div",Le,[(p(!0),b(H,null,Z(K.value,o=>(p(),q(te,{key:o.id,tool:o,title:o.name,description:o.description,category:o.category,"usage-count":P(o.viewCount),icon:o.icon,onSelect:I},null,8,["tool","title","description","category","usage-count","icon"]))),128))])])]))}};export{Ge as default};
