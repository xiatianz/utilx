import{r as m,p as T,q,c as p,a as e,y as H,x as $,h as A,P as K,v as S,d as G,t as d,F as D,k as R,j as Q,o as i,n as X,U as Y}from"./DEsTSaKd.js";import{c as Z}from"./3IwUeceH.js";import{t as ee}from"./B-fbZyPE.js";import{_ as te}from"./C71nLTaj.js";import"./D4g1_bQ7.js";import"./B03HrVNV.js";import"./4T928kbW.js";import"./wERbHxDK.js";import"./DESX2TF9.js";import"./b4Up8kzW.js";import"./DbWJs76d.js";import"./BuCd20m7.js";import"./C-LEKrTT.js";import"./Bluep4Ee.js";const oe={class:"max-w-8xl mx-auto"},se={class:"border border-border rounded-lg p-6 mb-8"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ae={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},le={class:"space-y-4"},ne={class:"text-sm text-muted-foreground"},de={key:0,class:"text-amber-600 ml-2"},ie={class:"space-y-4"},ce={class:"flex items-center justify-between"},ue={class:"flex items-center gap-2"},me={class:"flex items-center gap-2 cursor-pointer"},pe={class:"text-sm text-muted-foreground"},be={class:"flex flex-wrap gap-4 mb-8"},ve=["disabled"],ge=["disabled"],ye={key:0,class:"border border-border rounded-lg p-6 mb-8"},xe={class:"flex items-center justify-between mb-4"},fe={class:"text-lg font-semibold"},he={class:"flex items-center gap-2"},Ae={class:"bg-muted/50 rounded-lg p-4"},Ce={class:"text-sm font-mono break-all"},He={class:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},we={key:1,class:"border border-border rounded-lg p-6 mb-8"},ke={key:0,class:"flex items-center gap-3 text-green-600"},Me={key:1,class:"flex items-center gap-3 text-red-600"},Se={class:"border border-border rounded-lg p-6 mb-8"},_e={class:"space-y-4"},Ue=["disabled"],Te={key:0,class:"mt-4"},$e={class:"overflow-x-auto"},Ke={class:"w-full text-sm border border-border"},De={class:"border border-border px-4 py-2"},Re={class:"border border-border px-4 py-2 max-w-xs truncate"},Be={class:"border border-border px-4 py-2"},Ve={class:"text-xs"},je={class:"border border-border px-4 py-2"},Le=["onClick"],Fe={class:"space-y-4"},Ee={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ot={__name:"hmac-generator",setup(Ie){Z.find(s=>s.id==="crypto");const l=m(""),n=m(""),c=m("SHA-256"),v=m("hex"),r=m(""),x=m(null),f=m(""),w=m([]),k=m("复制"),B=m(null),V=ee.filter(s=>s.category==="crypto"&&s.id!=="hmac-generator").slice(0,4),j=s=>s>=1e4?`${(s/1e4).toFixed(1)}w+`:s>=1e3?`${(s/1e3).toFixed(1)}k+`:`${s}`,L=async()=>{try{const s=new TextEncoder,t=s.encode(l.value),o=s.encode(n.value),a=await crypto.subtle.importKey("raw",t,{name:"HMAC",hash:{name:c.value}},!1,["sign","verify"]),u=await crypto.subtle.sign("HMAC",a,o),b=Array.from(new Uint8Array(u));switch(v.value){case"hex":r.value=b.map(y=>y.toString(16).padStart(2,"0")).join("");break;case"base64":r.value=btoa(String.fromCharCode(...b));break;case"base64url":const g=btoa(String.fromCharCode(...b));r.value=g.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");break;case"binary":r.value=String.fromCharCode(...b);break}}catch(s){alert("HMAC生成失败："+s.message)}},F=async()=>{try{const s=new TextEncoder,t=s.encode(l.value),o=s.encode(n.value),a=await crypto.subtle.importKey("raw",t,{name:"HMAC",hash:{name:c.value}},!1,["sign","verify"]);let u;switch(v.value){case"hex":u=new Uint8Array(r.value.match(/.{2}/g).map(h=>parseInt(h,16)));break;case"base64":const g=atob(r.value);u=new Uint8Array(g.length).map((h,M)=>g.charCodeAt(M));break;case"base64url":const y=r.value.replace(/-/g,"+").replace(/_/g,"/"),U=y+"=".repeat((4-y.length%4)%4),C=atob(U);u=new Uint8Array(C.length).map((h,M)=>C.charCodeAt(M));break;case"binary":u=new TextEncoder().encode(r.value);break}const b=await crypto.subtle.verify("HMAC",a,u.buffer,o);x.value={valid:b}}catch(s){alert("HMAC验证失败："+s.message)}},E=async()=>{if(!l.value||!f.value)return;const s=f.value.split(`
`).filter(o=>o.trim()),t=[];for(const o of s)if(o.trim())try{const a=new TextEncoder,u=a.encode(l.value),b=a.encode(o.trim()),g=await crypto.subtle.importKey("raw",u,{name:"HMAC",hash:{name:c.value}},!1,["sign"]),y=await crypto.subtle.sign("HMAC",g,b),C=Array.from(new Uint8Array(y)).map(h=>h.toString(16).padStart(2,"0")).join("");t.push({message:o.trim(),hmac:C})}catch(a){console.error("批量生成失败:",a)}w.value=t},I=()=>{const t=new Uint8Array(32);crypto.getRandomValues(t),l.value=Array.from(t,o=>o.toString(16).padStart(2,"0")).join("")},N=s=>{const t=s.target.files[0];if(!t)return;const o=new FileReader;o.onload=a=>{n.value=a.target.result},o.readAsText(t)},_=async s=>{try{await navigator.clipboard.writeText(s),k.value="已复制",setTimeout(()=>{k.value="复制"},2e3)}catch(t){console.error("复制失败:",t)}},z=()=>{if(!r.value)return;const s=`算法: HMAC-${c.value}
消息: ${n.value}
密钥: ${l.value}
HMAC: ${r.value}
格式: ${v.value}
生成时间: ${new Date().toLocaleString()}`,t=new Blob([s],{type:"text/plain"}),o=URL.createObjectURL(t),a=document.createElement("a");a.href=o,a.download=`hmac-${c.value}-${Date.now()}.txt`,a.click(),URL.revokeObjectURL(o)},O=()=>{l.value="",r.value="",x.value=null},P=()=>{n.value="",r.value="",x.value=null},J=()=>{const s=l.value;l.value=n.value,n.value=s},W=s=>{const t=`/tools/${s.id}/`;Y(t),T(s.id)};return T("hmac-generator"),q({title:"HMAC生成器 - 在线HMAC哈希计算工具",description:"免费在线HMAC生成器，支持SHA-1/SHA-256/SHA-512等多种算法，用于消息认证和完整性验证。",keywords:["HMAC","消息认证码","SHA","哈希","认证","完整性验证"]}),(s,t)=>(i(),p("div",oe,[t[27]||(t[27]=e("div",{class:"mt-4 mb-8"},[e("h1",{class:"text-3xl font-bold mb-3"},"HMAC生成器"),e("p",{class:"text-muted-foreground max-w-3xl"},"HMAC（Hash-based Message Authentication Code）在线生成器，支持多种哈希算法，用于消息认证和完整性验证。")],-1)),e("div",se,[t[11]||(t[11]=e("h3",{class:"text-lg font-semibold mb-4"},"算法设置",-1)),e("div",re,[e("div",null,[t[7]||(t[7]=e("label",{class:"text-sm font-medium mb-2 block"},"哈希算法",-1)),A(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>c.value=o),class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},[...t[6]||(t[6]=[$('<option value="SHA-1">HMAC-SHA1 (160位)</option><option value="SHA-256">HMAC-SHA256 (256位) - 推荐</option><option value="SHA-384">HMAC-SHA384 (384位)</option><option value="SHA-512">HMAC-SHA512 (512位)</option><option value="MD5">HMAC-MD5 (128位) - 不推荐</option>',5)])],512),[[K,c.value]]),t[8]||(t[8]=e("div",{class:"mt-2 text-xs text-muted-foreground"}," 推荐：SHA-256或更高 ",-1))]),e("div",null,[t[10]||(t[10]=e("label",{class:"text-sm font-medium mb-2 block"},"输出格式",-1)),A(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>v.value=o),class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},[...t[9]||(t[9]=[e("option",{value:"hex"},"十六进制 (Hex)",-1),e("option",{value:"base64"},"Base64",-1),e("option",{value:"base64url"},"Base64 URL安全",-1),e("option",{value:"binary"},"二进制",-1)])],512),[[K,v.value]])])])]),e("div",ae,[e("div",le,[e("div",{class:"flex items-center justify-between"},[t[12]||(t[12]=e("label",{class:"text-lg font-semibold"},"密钥 (Secret Key)",-1)),e("div",{class:"flex items-center gap-2"},[e("button",{onClick:I,class:"px-3 py-1 text-sm bg-secondary/10 text-secondary-foreground rounded-md hover:bg-secondary/20 transition-colors"}," 生成随机密钥 "),e("button",{onClick:O,class:"px-3 py-1 text-sm text-muted-foreground hover:text-foreground transition-colors"}," 清空 ")])]),A(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=o=>l.value=o),placeholder:"请输入HMAC密钥...",class:"w-full h-32 p-4 border border-border rounded-lg bg-background resize-none focus:outline-none focus:ring-2 focus:ring-primary font-mono text-sm"},null,512),[[S,l.value]]),e("div",ne,[G(" 密钥长度："+d(l.value.length)+" 字符 ",1),c.value==="SHA-256"&&l.value.length<32?(i(),p("span",de," (建议至少32字符) ")):H("",!0)])]),e("div",ie,[e("div",ce,[t[14]||(t[14]=e("label",{class:"text-lg font-semibold"},"消息 (Message)",-1)),e("div",ue,[e("label",me,[e("input",{type:"file",ref_key:"fileInput",ref:B,onChange:N,class:"hidden"},null,544),t[13]||(t[13]=e("span",{class:"px-3 py-1 text-sm bg-primary/10 text-primary rounded-md hover:bg-primary/20 transition-colors"}," 选择文件 ",-1))]),e("button",{onClick:P,class:"px-3 py-1 text-sm text-muted-foreground hover:text-foreground transition-colors"}," 清空 ")])]),A(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=o=>n.value=o),placeholder:"请输入要计算HMAC的消息...",class:"w-full h-32 p-4 border border-border rounded-lg bg-background resize-none focus:outline-none focus:ring-2 focus:ring-primary"},null,512),[[S,n.value]]),e("div",pe," 消息长度："+d(n.value.length)+" 字符 ",1)])]),e("div",be,[e("button",{onClick:L,disabled:!l.value||!n.value,class:"px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 生成HMAC ",8,ve),e("button",{onClick:F,disabled:!l.value||!n.value||!r.value,class:"px-6 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 验证HMAC ",8,ge),e("button",{onClick:J,class:"px-6 py-2 border border-border rounded-lg hover:bg-muted transition-colors"}," 交换数据 ")]),r.value?(i(),p("div",ye,[e("div",xe,[e("h3",fe," HMAC-"+d(c.value.replace("SHA-",""))+" 结果 ",1),e("div",he,[e("button",{onClick:t[4]||(t[4]=o=>_(r.value)),class:"px-3 py-1 text-sm bg-primary/10 text-primary rounded-md hover:bg-primary/20 transition-colors"},d(k.value),1),e("button",{onClick:z,class:"px-3 py-1 text-sm bg-secondary/10 text-secondary-foreground rounded-md hover:bg-secondary/20 transition-colors"}," 下载 ")])]),e("div",Ae,[e("pre",Ce,d(r.value),1)]),e("div",He,[e("div",null,[t[15]||(t[15]=e("span",{class:"text-muted-foreground"},"算法：",-1)),e("span",null,"HMAC-"+d(c.value),1)]),e("div",null,[t[16]||(t[16]=e("span",{class:"text-muted-foreground"},"输出长度：",-1)),e("span",null,d(r.value.length*8/2)+" 位",1)]),e("div",null,[t[17]||(t[17]=e("span",{class:"text-muted-foreground"},"格式：",-1)),e("span",null,d(v.value.toUpperCase()),1)]),e("div",null,[t[18]||(t[18]=e("span",{class:"text-muted-foreground"},"字符数：",-1)),e("span",null,d(r.value.length),1)])])])):H("",!0),x.value?(i(),p("div",we,[t[21]||(t[21]=e("h3",{class:"text-lg font-semibold mb-4"},"验证结果",-1)),x.value.valid?(i(),p("div",ke,[...t[19]||(t[19]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),e("div",null,[e("div",{class:"font-medium"},"HMAC验证成功"),e("div",{class:"text-sm"},"消息完整性得到保证")],-1)])])):(i(),p("div",Me,[...t[20]||(t[20]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),e("div",null,[e("div",{class:"font-medium"},"HMAC验证失败"),e("div",{class:"text-sm"},"消息可能被篡改或密钥不正确")],-1)])]))])):H("",!0),e("div",Se,[t[25]||(t[25]=e("h3",{class:"text-lg font-semibold mb-4"},"批量生成HMAC",-1)),e("div",_e,[e("div",null,[t[22]||(t[22]=e("label",{class:"text-sm font-medium mb-2 block"},"消息列表（每行一条）",-1)),A(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=o=>f.value=o),placeholder:"输入多条消息，每行一条...",class:"w-full h-32 p-3 border border-border rounded-lg bg-background resize-none focus:outline-none focus:ring-2 focus:ring-primary"},null,512),[[S,f.value]])]),e("button",{onClick:E,disabled:!l.value||!f.value,class:"px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 批量生成 ",8,Ue),w.value.length>0?(i(),p("div",Te,[t[24]||(t[24]=e("h4",{class:"font-medium mb-2"},"批量生成结果",-1)),e("div",$e,[e("table",Ke,[t[23]||(t[23]=e("thead",{class:"bg-muted/50"},[e("tr",null,[e("th",{class:"border border-border px-4 py-2 text-left"},"#"),e("th",{class:"border border-border px-4 py-2 text-left"},"消息"),e("th",{class:"border border-border px-4 py-2 text-left"},"HMAC"),e("th",{class:"border border-border px-4 py-2 text-left"},"操作")])],-1)),e("tbody",null,[(i(!0),p(D,null,R(w.value,(o,a)=>(i(),p("tr",{key:a,class:"border-b border-border"},[e("td",De,d(a+1),1),e("td",Re,d(o.message),1),e("td",Be,[e("code",Ve,d(o.hmac.substring(0,40))+"...",1)]),e("td",je,[e("button",{onClick:u=>_(o.hmac),class:"text-primary hover:text-primary/80 text-sm"}," 复制 ",8,Le)])]))),128))])])])])):H("",!0)])]),t[28]||(t[28]=$('<div class="border border-border rounded-lg p-6 mb-8"><h3 class="text-lg font-semibold mb-4">关于HMAC</h3><div class="space-y-4"><div><h4 class="font-medium text-primary mb-2">什么是HMAC？</h4><p class="text-sm text-muted-foreground"> HMAC（Hash-based Message Authentication Code）是一种使用密码学哈希函数和密钥来生成消息认证码的机制。 它可以验证消息的完整性和真实性，防止消息在传输过程中被篡改。 </p></div><div><h4 class="font-medium text-primary mb-2">HMAC特点</h4><ul class="text-sm space-y-1"><li>• 使用密钥进行认证，防止伪造</li><li>• 基于安全的哈希函数（SHA-256等）</li><li>• 长度固定，与消息长度无关</li><li>• 计算速度快，适合大规模使用</li><li>• 抗碰撞性，难以伪造相同HMAC的不同消息</li></ul></div><div><h4 class="font-medium text-primary mb-2">HMAC计算公式</h4><div class="bg-muted/50 rounded-lg p-4 font-mono text-sm"> HMAC(K, m) = H((K ⊕ opad) || H((K ⊕ ipad) || m)) </div><div class="mt-2 text-xs text-muted-foreground"> 其中：K是密钥，m是消息，H是哈希函数，⊕是异或，||是连接，ipad和opad是常量 </div></div><div><h4 class="font-medium text-primary mb-2">应用场景</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"><div><h5 class="font-medium mb-1">API认证</h5><p class="text-muted-foreground">验证API请求的合法性</p></div><div><h5 class="font-medium mb-1">数据完整性</h5><p class="text-muted-foreground">确保数据未被篡改</p></div><div><h5 class="font-medium mb-1">JWT签名</h5><p class="text-muted-foreground">JSON Web Token的签名方案</p></div><div><h5 class="font-medium mb-1">支付验证</h5><p class="text-muted-foreground">支付网关的请求验证</p></div></div></div><div><h4 class="font-medium text-primary mb-2">安全最佳实践</h4><ul class="text-sm space-y-1 text-amber-600"><li>• 使用足够长度的密钥（至少32字节）</li><li>• 优先使用SHA-256或更强的哈希算法</li><li>• 密钥应随机生成并妥善保管</li><li>• 定期轮换密钥以提高安全性</li></ul></div></div></div>',1)),e("div",Fe,[t[26]||(t[26]=e("h3",{class:"text-lg font-semibold"},"相关工具",-1)),e("div",Ee,[(i(!0),p(D,null,R(Q(V),o=>(i(),X(te,{key:o.id,tool:o,title:o.name,description:o.description,category:o.category,"usage-count":j(o.viewCount),icon:o.icon,onSelect:W},null,8,["tool","title","description","category","usage-count","icon"]))),128))])])]))}};export{ot as default};
