<!doctype html><html lang=zh-cn dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>DDoSé˜²æŠ¤å®Œå…¨æŒ‡å—ï¼šä»åŸç†åˆ†æåˆ°å®æˆ˜éƒ¨ç½²çš„å®Œæ•´é˜²æŠ¤ä½“ç³» | æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·</title><meta name=keywords content="DDoSé˜²æŠ¤,ç½‘ç»œå®‰å…¨,DDoSæ”»å‡»,Webå®‰å…¨,é˜²æŠ¤ç­–ç•¥"><meta name=description content="å…¨é¢è§£æDDoSæ”»å‡»çš„ç±»å‹ã€åŸç†å’Œé˜²æŠ¤ç­–ç•¥ï¼ŒåŒ…æ‹¬ç½‘ç»œå±‚é˜²æŠ¤ã€åº”ç”¨å±‚é˜²æŠ¤ã€äº‘åŸç”Ÿå®‰å…¨æ–¹æ¡ˆå’Œåº”æ€¥å“åº”æµç¨‹ï¼Œå¸®åŠ©ä¼ä¸šæ„å»ºå¤šå±‚æ¬¡ã€æ™ºèƒ½åŒ–çš„DDoSé˜²æŠ¤ä½“ç³»ã€‚"><meta name=author content="util.cn Team"><link rel=canonical href=/blog/articles/ddos%E9%98%B2%E6%8A%A4%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E4%BB%8E%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%E5%88%B0%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E7%9A%84%E5%AE%8C%E6%95%B4%E9%98%B2%E6%8A%A4%E4%BD%93%E7%B3%BB/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.7e8505b7cdf8bb22ab2305e53c2700bb06c7e64faeb72cd3468823a9a3bd3d6e.css integrity="sha256-foUFt834uyKrIwXlPCcAuwbH5k+utyzTRogjqaO9PW4=" rel="preload stylesheet" as=style><link rel=icon href=/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/blog/favicon-32x32.png><link rel=apple-touch-icon href=/blog/apple-touch-icon.png><link rel=mask-icon href=/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=/blog/articles/ddos%E9%98%B2%E6%8A%A4%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E4%BB%8E%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%E5%88%B0%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E7%9A%84%E5%AE%8C%E6%95%B4%E9%98%B2%E6%8A%A4%E4%BD%93%E7%B3%BB/feed.xml title=rss><link rel=alternate hreflang=zh-cn href=/blog/articles/ddos%E9%98%B2%E6%8A%A4%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E4%BB%8E%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%E5%88%B0%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E7%9A%84%E5%AE%8C%E6%95%B4%E9%98%B2%E6%8A%A4%E4%BD%93%E7%B3%BB/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><script src=/js/external-link-config.js></script><script src=/js/external-link-interceptor.js></script><link rel=stylesheet href=/blog/css/custom.css media=screen><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«","url":"https://www.util.cn/blog/","description":"æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚æä¾›JSONæ ¼å¼åŒ–ã€SQLä¼˜åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰åœ¨çº¿å·¥å…·çš„è¯¦ç»†ä½¿ç”¨æŒ‡å—ï¼Œå¸®åŠ©å¼€å‘è€…æå‡å·¥ä½œæ•ˆç‡ã€‚","publisher":{"@type":"Organization","name":"æœ‰æ¡å·¥å…·","url":"https://www.util.cn","logo":{"@type":"ImageObject","url":"https://www.util.cn/blog/logo/logo-256.png","width":256,"height":256}},"potentialAction":[{"@type":"SearchAction","target":"https://www.util.cn/blog/search?q={search_term_string}","query-input":"required name=search_term_string"}]}</script><meta property="og:type" content="website"><meta property="og:title" content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«"><meta property="og:description" content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚æä¾›JSONæ ¼å¼åŒ–ã€SQLä¼˜åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰åœ¨çº¿å·¥å…·çš„è¯¦ç»†ä½¿ç”¨æŒ‡å—ï¼Œå¸®åŠ©å¼€å‘è€…æå‡å·¥ä½œæ•ˆç‡ã€‚"><meta property="og:url" content="https://www.util.cn/blog/"><meta property="og:site_name" content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢"><meta property="og:image" content="https://www.util.cn/blog/logo/logo-256.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«"><meta name=twitter:description content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚"><meta name=twitter:image content="https://www.util.cn/blog/logo/logo-256.png"><meta name=baidu-site-verification content><meta name=category content="æŠ€æœ¯åšå®¢,å¼€å‘è€…å·¥å…·,ç¼–ç¨‹æ•™ç¨‹"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=rating content="General"><script id=51la_code async crossorigin=anonymous src="https://sdk.51.la/js-sdk-pro.min.js?id=3OM52V0xJAPv6ozF&hash=pro"></script><script>window.addEventListener("load",function(){setTimeout(function(){typeof la!="undefined"?console.log("51laç»Ÿè®¡å·²åŠ è½½"):(console.warn("51laç»Ÿè®¡åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ"),function(){var e=document.createElement("script");e.src="https://sdk.51.la/js-sdk-pro.min.js?id=3OM52V0xJAPv6ozF&hash=backup",e.async=!0,document.head.appendChild(e)}())},3e3)})</script><meta property="og:url" content="/blog/articles/ddos%E9%98%B2%E6%8A%A4%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E4%BB%8E%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%E5%88%B0%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E7%9A%84%E5%AE%8C%E6%95%B4%E9%98%B2%E6%8A%A4%E4%BD%93%E7%B3%BB/"><meta property="og:site_name" content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·"><meta property="og:title" content="DDoSé˜²æŠ¤å®Œå…¨æŒ‡å—ï¼šä»åŸç†åˆ†æåˆ°å®æˆ˜éƒ¨ç½²çš„å®Œæ•´é˜²æŠ¤ä½“ç³»"><meta property="og:description" content="å…¨é¢è§£æDDoSæ”»å‡»çš„ç±»å‹ã€åŸç†å’Œé˜²æŠ¤ç­–ç•¥ï¼ŒåŒ…æ‹¬ç½‘ç»œå±‚é˜²æŠ¤ã€åº”ç”¨å±‚é˜²æŠ¤ã€äº‘åŸç”Ÿå®‰å…¨æ–¹æ¡ˆå’Œåº”æ€¥å“åº”æµç¨‹ï¼Œå¸®åŠ©ä¼ä¸šæ„å»ºå¤šå±‚æ¬¡ã€æ™ºèƒ½åŒ–çš„DDoSé˜²æŠ¤ä½“ç³»ã€‚"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-22T13:00:00+08:00"><meta property="article:modified_time" content="2025-12-22T13:00:00+08:00"><meta property="article:tag" content="DDoSé˜²æŠ¤"><meta property="article:tag" content="ç½‘ç»œå®‰å…¨"><meta property="article:tag" content="DDoSæ”»å‡»"><meta property="article:tag" content="Webå®‰å…¨"><meta property="article:tag" content="é˜²æŠ¤ç­–ç•¥"><meta name=twitter:card content="summary"><meta name=twitter:title content="DDoSé˜²æŠ¤å®Œå…¨æŒ‡å—ï¼šä»åŸç†åˆ†æåˆ°å®æˆ˜éƒ¨ç½²çš„å®Œæ•´é˜²æŠ¤ä½“ç³»"><meta name=twitter:description content="å…¨é¢è§£æDDoSæ”»å‡»çš„ç±»å‹ã€åŸç†å’Œé˜²æŠ¤ç­–ç•¥ï¼ŒåŒ…æ‹¬ç½‘ç»œå±‚é˜²æŠ¤ã€åº”ç”¨å±‚é˜²æŠ¤ã€äº‘åŸç”Ÿå®‰å…¨æ–¹æ¡ˆå’Œåº”æ€¥å“åº”æµç¨‹ï¼Œå¸®åŠ©ä¼ä¸šæ„å»ºå¤šå±‚æ¬¡ã€æ™ºèƒ½åŒ–çš„DDoSé˜²æŠ¤ä½“ç³»ã€‚"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"æ‰€æœ‰æ–‡ç« ","item":"/blog/posts/"},{"@type":"ListItem","position":2,"name":"DDoSé˜²æŠ¤å®Œå…¨æŒ‡å—ï¼šä»åŸç†åˆ†æåˆ°å®æˆ˜éƒ¨ç½²çš„å®Œæ•´é˜²æŠ¤ä½“ç³»","item":"/blog/articles/ddos%E9%98%B2%E6%8A%A4%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E4%BB%8E%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%E5%88%B0%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E7%9A%84%E5%AE%8C%E6%95%B4%E9%98%B2%E6%8A%A4%E4%BD%93%E7%B3%BB/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"DDoSé˜²æŠ¤å®Œå…¨æŒ‡å—ï¼šä»åŸç†åˆ†æåˆ°å®æˆ˜éƒ¨ç½²çš„å®Œæ•´é˜²æŠ¤ä½“ç³»","name":"DDoSé˜²æŠ¤å®Œå…¨æŒ‡å—ï¼šä»åŸç†åˆ†æåˆ°å®æˆ˜éƒ¨ç½²çš„å®Œæ•´é˜²æŠ¤ä½“ç³»","description":"å…¨é¢è§£æDDoSæ”»å‡»çš„ç±»å‹ã€åŸç†å’Œé˜²æŠ¤ç­–ç•¥ï¼ŒåŒ…æ‹¬ç½‘ç»œå±‚é˜²æŠ¤ã€åº”ç”¨å±‚é˜²æŠ¤ã€äº‘åŸç”Ÿå®‰å…¨æ–¹æ¡ˆå’Œåº”æ€¥å“åº”æµç¨‹ï¼Œå¸®åŠ©ä¼ä¸šæ„å»ºå¤šå±‚æ¬¡ã€æ™ºèƒ½åŒ–çš„DDoSé˜²æŠ¤ä½“ç³»ã€‚","keywords":["DDoSé˜²æŠ¤","ç½‘ç»œå®‰å…¨","DDoSæ”»å‡»","Webå®‰å…¨","é˜²æŠ¤ç­–ç•¥"],"articleBody":"åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡ï¼ˆDDoSï¼‰æ”»å‡»æ˜¯å½“ä»Šäº’è”ç½‘é¢ä¸´çš„æœ€ä¸¥é‡å®‰å…¨å¨èƒä¹‹ä¸€ã€‚éšç€æ”»å‡»æ‰‹æ®µçš„ä¸æ–­è¿›åŒ–ï¼Œä¼ä¸šéœ€è¦æ„å»ºå¤šå±‚æ¬¡ã€æ™ºèƒ½åŒ–çš„é˜²æŠ¤ä½“ç³»ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨DDoSæ”»å‡»çš„å„ç§ç±»å‹ã€é˜²æŠ¤åŸç†å’Œå®æˆ˜éƒ¨ç½²æ–¹æ¡ˆã€‚\nDDoSæ”»å‡»ç±»å‹ä¸åŸç† ç½‘ç»œå±‚DDoSæ”»å‡» ç½‘ç»œå±‚æ”»å‡»ä¸»è¦é€šè¿‡æ¶ˆè€—ç½‘ç»œå¸¦å®½å’ŒæœåŠ¡å™¨èµ„æºæ¥ç˜«ç—ªç›®æ ‡æœåŠ¡ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 // DDoSæ”»å‡»ç±»å‹è¯†åˆ«ç³»ç»Ÿ class DDoSAttackDetector { constructor() { this.attackPatterns = { // SYN Floodæ”»å‡»æ£€æµ‹ synFlood: { thresholds: { synRate: 1000, // æ¯ç§’SYNåŒ…æ•°é‡ synAckRatio: 10, // SYN/SYN-ACKæ¯”ç‡ connectionHalfOpen: 5000 // åŠè¿æ¥æ•° }, detection: this.detectSYNFlood.bind(this) }, // UDP Floodæ”»å‡»æ£€æµ‹ udpFlood: { thresholds: { udpRate: 5000, // æ¯ç§’UDPåŒ…æ•°é‡ udpPortSpread: 100 // UDPç«¯å£åˆ†å¸ƒæ•° }, detection: this.detectUDPFlood.bind(this) }, // ICMP Floodæ”»å‡»æ£€æµ‹ icmpFlood: { thresholds: { icmpRate: 1000, // æ¯ç§’ICMPåŒ…æ•°é‡ icmpSize: 1500 // ICMPåŒ…å¤§å° }, detection: this.detectICMPFlood.bind(this) } }; this.trafficStats = new Map(); } // SYN Floodæ”»å‡»æ£€æµ‹ detectSYNFlood(trafficData) { const recentTraffic = this.getRecentTraffic(5000); // æœ€è¿‘5ç§’ const synPackets = recentTraffic.filter(p =\u003e p.type === 'SYN'); const synAckPackets = recentTraffic.filter(p =\u003e p.type === 'SYN-ACK'); const synRate = synPackets.length / 5; const synAckRatio = synPackets.length / Math.max(synAckPackets.length, 1); const halfOpenConnections = this.getHalfOpenConnections(); return { isAttack: synRate \u003e this.attackPatterns.synFlood.thresholds.synRate || synAckRatio \u003e this.attackPatterns.synFlood.thresholds.synAckRatio || halfOpenConnections \u003e this.attackPatterns.synFlood.thresholds.connectionHalfOpen, confidence: this.calculateConfidence([ synRate / this.attackPatterns.synFlood.thresholds.synRate, synAckRatio / this.attackPatterns.synFlood.thresholds.synAckRatio, halfOpenConnections / this.attackPatterns.synFlood.thresholds.connectionHalfOpen ]), details: { synRate, synAckRatio, halfOpenConnections } }; } // UDP Floodæ”»å‡»æ£€æµ‹ detectUDPFlood(trafficData) { const recentTraffic = this.getRecentTraffic(5000); const udpPackets = recentTraffic.filter(p =\u003e p.protocol === 'UDP'); const uniquePorts = new Set(udpPackets.map(p =\u003e p.destinationPort)); const udpRate = udpPackets.length / 5; const portSpread = uniquePorts.size; return { isAttack: udpRate \u003e this.attackPatterns.udpFlood.thresholds.udpRate || portSpread \u003e this.attackPatterns.udpFlood.thresholds.udpPortSpread, confidence: this.calculateConfidence([ udpRate / this.attackPatterns.udpFlood.thresholds.udpRate, portSpread / this.attackPatterns.udpFlood.thresholds.udpPortSpread ]), details: { udpRate, portSpread } }; } // ICMP Floodæ”»å‡»æ£€æµ‹ detectICMPFlood(trafficData) { const recentTraffic = this.getRecentTraffic(5000); const icmpPackets = recentTraffic.filter(p =\u003e p.protocol === 'ICMP'); const avgPacketSize = icmpPackets.reduce((sum, p) =\u003e sum + p.size, 0) / icmpPackets.length; const icmpRate = icmpPackets.length / 5; return { isAttack: icmpRate \u003e this.attackPatterns.icmpFlood.thresholds.icmpRate \u0026\u0026 avgPacketSize \u003e this.attackPatterns.icmpFlood.thresholds.icmpSize, confidence: this.calculateConfidence([ icmpRate / this.attackPatterns.icmpFlood.thresholds.icmpRate, avgPacketSize / this.attackPatterns.icmpFlood.thresholds.icmpSize ]), details: { icmpRate, avgPacketSize } }; } calculateConfidence(ratios) { return Math.min(1.0, ratios.reduce((sum, r) =\u003e sum + Math.min(r, 1.0), 0) / ratios.length); } } åº”ç”¨å±‚DDoSæ”»å‡» åº”ç”¨å±‚æ”»å‡»ä¸»è¦é’ˆå¯¹åº”ç”¨åè®®å’Œä¸šåŠ¡é€»è¾‘ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 // åº”ç”¨å±‚æ”»å‡»æ£€æµ‹ class ApplicationLayerDDoSDetector { constructor() { this.httpStats = { requests: new Map(), userAgents: new Map(), ips: new Map(), endpoints: new Map() }; this.attackThresholds = { // HTTP Floodæ”»å‡»é˜ˆå€¼ httpFlood: { requestsPerSecond: 1000, requestsPerIP: 100, suspiciousUserAgents: [ /bot/i, /crawler/i, /scraper/i, /^$/, /python/i, /curl/i ] }, // Slowlorisæ”»å‡»é˜ˆå€¼ slowloris: { maxConnections: 1000, slowConnectionThreshold: 30000, // 30ç§’ minHeadersPerConnection: 1 }, // HTTP GET/POST Floodé˜ˆå€¼ httpGetPostFlood: { getRequestsPerSecond: 500, postRequestsPerSecond: 100, largePayloadThreshold: 1024 * 1024 // 1MB } }; } // HTTPè¯·æ±‚åˆ†æ analyzeHTTPRequest(request, timestamp) { const ip = request.ip; const userAgent = request.headers['user-agent'] || ''; const method = request.method; const endpoint = request.path; const payloadSize = request.contentLength || 0; // è®°å½•è¯·æ±‚ç»Ÿè®¡ this.recordRequestStats(ip, userAgent, method, endpoint, payloadSize, timestamp); // æ£€æµ‹å„ç§æ”»å‡»æ¨¡å¼ return { httpFlood: this.detectHTTPFlood(timestamp), slowloris: this.detectSlowlorisAttack(timestamp), httpGetPostFlood: this.detectHTTPGetPostFlood(timestamp), suspiciousPatterns: this.detectSuspiciousPatterns(request) }; } // HTTP Floodæ”»å‡»æ£€æµ‹ detectHTTPFlood(timestamp) { const recentRequests = this.getRecentRequests(timestamp, 1000); // æœ€è¿‘1ç§’ const requestRate = recentRequests.length; const requestsPerIP = this.calculateRequestsPerIP(recentRequests); const suspiciousUARequests = this.countSuspiciousUserAgents(recentRequests); const isAttack = requestRate \u003e this.attackThresholds.httpFlood.requestsPerSecond || Array.from(requestsPerIP.values()).some(count =\u003e count \u003e this.attackThresholds.httpFlood.requestsPerIP ) || suspiciousUARequests \u003e requestRate * 0.5; return { isAttack, confidence: this.calculateHTTPFloodConfidence(requestRate, requestsPerIP, suspiciousUARequests), details: { requestRate, requestsPerIP, suspiciousUARequests } }; } // Slowlorisæ”»å‡»æ£€æµ‹ detectSlowlorisAttack(timestamp) { const activeConnections = this.getActiveConnections(timestamp); const slowConnections = activeConnections.filter(conn =\u003e timestamp - conn.startTime \u003e this.attackThresholds.slowloris.slowConnectionThreshold \u0026\u0026 conn.headersReceived \u003c= this.attackThresholds.slowloris.minHeadersPerConnection ); const isAttack = activeConnections.length \u003e this.attackThresholds.slowloris.maxConnections || slowConnections.length \u003e activeConnections.length * 0.7; return { isAttack, confidence: isAttack ? Math.max(0.8, slowConnections.length / Math.max(activeConnections.length, 1)) : 0, details: { totalConnections: activeConnections.length, slowConnections: slowConnections.length, suspiciousIPs: [...new Set(slowConnections.map(c =\u003e c.ip))] } }; } // æ£€æµ‹å¯ç–‘è¯·æ±‚æ¨¡å¼ detectSuspiciousPatterns(request) { const patterns = { // éšæœºUser-Agent randomUserAgent: this.isRandomUserAgent(request.headers['user-agent'] || ''), // å¼‚å¸¸è¯·æ±‚å¤´ unusualHeaders: this.detectUnusualHeaders(request.headers), // SQLæ³¨å…¥å°è¯• sqlInjection: this.detectSQLInjection(request.url, request.body), // XSSå°è¯• xssAttempt: this.detectXSS(request.url, request.body), // è·¯å¾„éå† pathTraversal: this.detectPathTraversal(request.url), // æš´åŠ›ç ´è§£æ¨¡å¼ bruteForce: this.detectBruteForcePattern(request.ip, request.path) }; return { hasSuspiciousPattern: Object.values(patterns).some(p =\u003e p.detected), patterns }; } // æ£€æµ‹éšæœºUser-Agent isRandomUserAgent(userAgent) { // æ£€æµ‹User-Agentæ˜¯å¦ä¸ºéšæœºå­—ç¬¦ä¸² const randomPattern = /^[a-zA-Z0-9]{8,}$/; const commonPatterns = [ /Mozilla/i, /Chrome/i, /Firefox/i, /Safari/i, /Edge/i, /Opera/i ]; return randomPattern.test(userAgent) \u0026\u0026 !commonPatterns.some(pattern =\u003e pattern.test(userAgent)); } // æ£€æµ‹å¼‚å¸¸è¯·æ±‚å¤´ detectUnusualHeaders(headers) { const suspiciousHeaders = [ /^X-Forwarded-For:\\s*\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$/, /^X-Real-IP:\\s*\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$/, /^X-Originating-IP:/i ]; return { detected: suspiciousHeaders.some(pattern =\u003e Object.keys(headers).some(key =\u003e pattern.test(`${key}: ${headers[key]}`)) ), suspiciousHeaders: Object.keys(headers).filter(key =\u003e suspiciousHeaders.some(pattern =\u003e pattern.test(`${key}: ${headers[key]}`)) ) }; } } é˜²æŠ¤ç­–ç•¥ä¸æ¶æ„ å¤šå±‚é˜²æŠ¤æ¶æ„ æ„å»ºå®Œæ•´çš„DDoSé˜²æŠ¤ä½“ç³»ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 # DDoSé˜²æŠ¤æ¶æ„é…ç½® ddos_protection: layers: # ç¬¬ä¸€å±‚ï¼šç½‘ç»œè¾¹ç•Œé˜²æŠ¤ network_boundary: hardware_firewall: vendor: \"Cisco ASA\" features: - \"SYN Flood Protection\" - \"UDP Flood Protection\" - \"ICMP Rate Limiting\" - \"IP Reputation Filtering\" configuration: syn_flood_threshold: 10000 udp_flood_threshold: 50000 icmp_rate_limit: 1000 ddos_mitigation_device: vendor: \"Arbors Pravail\" capabilities: - \"Real-time Traffic Analysis\" - \"Behavioral Attack Detection\" - \"Automatic Traffic Scrubbing\" deployment_mode: \"inline\" # ç¬¬äºŒå±‚ï¼šCDNå’Œäº‘é˜²æŠ¤ cdn_protection: provider: \"Cloudflare\" services: - \"DDoS Protection\" - \"Web Application Firewall\" - \"Rate Limiting\" - \"IP Reputation\" settings: security_level: \"high\" rate_limiting: requests_per_minute: 1000 burst_size: 200 # ç¬¬ä¸‰å±‚ï¼šåº”ç”¨å±‚é˜²æŠ¤ application_layer: web_application_firewall: rules_engine: \"ModSecurity\" rule_sets: - \"OWASP Core Rule Set\" - \"Custom DDoS Rules\" custom_rules: - \"Rate limiting by IP\" - \"Session-based protection\" - \"CAPTCHA integration\" rate_limiting: implementation: \"Redis + Nginx\" strategies: global_rate_limit: requests: 1000 window: 60s per_ip_rate_limit: requests: 100 window: 60s endpoint_rate_limit: \"/api/v1/users\": 10/minute \"/api/v1/auth\": 5/minute # ç¬¬å››å±‚ï¼šä¸šåŠ¡é€»è¾‘é˜²æŠ¤ business_logic: anomaly_detection: machine_learning_model: \"isolation_forest\" features: - \"request_rate\" - \"session_duration\" - \"click_patterns\" - \"conversion_rates\" adaptive_protection: auto_scaling: min_instances: 5 max_instances: 50 scale_up_threshold: \"cpu \u003e 80% or requests_per_second \u003e 1000\" scale_down_threshold: \"cpu \u003c 30% for 5 minutes\" æ™ºèƒ½é™æµç®—æ³• å®ç°åŠ¨æ€å’Œæ™ºèƒ½çš„é™æµç­–ç•¥ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 // æ™ºèƒ½é™æµç³»ç»Ÿ class IntelligentRateLimiter { constructor() { this.redis = require('redis').createClient(); this.limiters = new Map(); this.adaptiveThresholds = new Map(); this.mlModel = null; } // åˆå§‹åŒ–æœºå™¨å­¦ä¹ æ¨¡å‹ async initializeMLModel() { // ä½¿ç”¨TensorFlow.jsåŠ è½½é¢„è®­ç»ƒæ¨¡å‹ const tf = require('@tensorflow/tfjs-node'); this.mlModel = await tf.loadLayersModel('file://./models/ddos_detection_model.h5'); } // æ»‘åŠ¨çª—å£é™æµå™¨ async slidingWindowRateLimit(key, limit, windowMs) { const now = Date.now(); const windowStart = now - windowMs; const pipeline = this.redis.pipeline(); // æ¸…ç†è¿‡æœŸè®°å½• pipeline.zremrangebyscore(key, 0, windowStart); // è·å–å½“å‰çª—å£å†…çš„è¯·æ±‚æ•° pipeline.zcard(key); // æ·»åŠ å½“å‰è¯·æ±‚ pipeline.zadd(key, now, `${now}-${Math.random()}`); // è®¾ç½®è¿‡æœŸæ—¶é—´ pipeline.expire(key, Math.ceil(windowMs / 1000)); const results = await pipeline.exec(); const currentCount = results[1][1]; return { allowed: currentCount \u003c limit, remaining: Math.max(0, limit - currentCount - 1), resetTime: now + windowMs, currentCount }; } // ä»¤ç‰Œæ¡¶é™æµå™¨ async tokenBucketRateLimit(key, capacity, refillRate) { const now = Date.now(); const script = ` local key = KEYS[1] local capacity = tonumber(ARGV[1]) local tokens = tonumber(ARGV[2]) local interval = tonumber(ARGV[3]) local now = tonumber(ARGV[4]) local bucket = redis.call('hmget', key, 'tokens', 'last_refill') local current_tokens = tonumber(bucket[1]) or capacity local last_refill = tonumber(bucket[2]) or now -- è®¡ç®—éœ€è¦è¡¥å……çš„ä»¤ç‰Œæ•° local elapsed = now - last_refill local tokens_to_add = math.floor(elapsed / interval * tokens) current_tokens = math.min(capacity, current_tokens + tokens_to_add) -- æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„ä»¤ç‰Œ if current_tokens \u003e= 1 then current_tokens = current_tokens - 1 redis.call('hmset', key, 'tokens', current_tokens, 'last_refill', now) redis.call('expire', key, math.ceil(capacity / tokens * interval)) return {1, current_tokens} else redis.call('hmset', key, 'tokens', current_tokens, 'last_refill', now) redis.call('expire', key, math.ceil(capacity / tokens * interval)) return {0, current_tokens} end `; const result = await this.redis.eval(script, 1, key, capacity, refillRate, 1000, now); return { allowed: result[0] === 1, remaining: result[1], capacity }; } // è‡ªé€‚åº”é™æµå™¨ async adaptiveRateLimit(ip, endpoint, requestData) { const key = `adaptive:${ip}:${endpoint}`; // è·å–å†å²æ•°æ® const history = await this.getRequestHistory(key, 3600000); // æœ€è¿‘1å°æ—¶ // ä½¿ç”¨æœºå™¨å­¦ä¹ æ¨¡å‹é¢„æµ‹æ”»å‡»æ¦‚ç‡ const attackProbability = await this.predictAttackProbability(history, requestData); // æ ¹æ®æ”»å‡»æ¦‚ç‡è°ƒæ•´é™æµé˜ˆå€¼ const baseLimit = this.getBaseLimit(endpoint); const adaptiveLimit = Math.max(1, Math.floor(baseLimit * (1 - attackProbability))); console.log(`Attack probability for ${ip}: ${attackProbability}, adaptive limit: ${adaptiveLimit}`); return await this.slidingWindowRateLimit(key, adaptiveLimit, 60000); } // é¢„æµ‹æ”»å‡»æ¦‚ç‡ async predictAttackProbability(history, requestData) { if (!this.mlModel) { // å¦‚æœæ¨¡å‹æœªåŠ è½½ï¼Œä½¿ç”¨ç®€å•çš„å¯å‘å¼è§„åˆ™ return this.heuristicAttackDetection(history, requestData); } const tf = require('@tensorflow/tfjs-node'); // æå–ç‰¹å¾ const features = this.extractFeatures(history, requestData); // é¢„æµ‹ const prediction = this.mlModel.predict(tf.tensor2d([features])); const probability = prediction.dataSync()[0]; return probability; } // å¯å‘å¼æ”»å‡»æ£€æµ‹ heuristicAttackDetection(history, requestData) { const recentRequests = history.filter(req =\u003e Date.now() - req.timestamp \u003c 60000); const requestRate = recentRequests.length; // æ£€æµ‹å¼‚å¸¸é«˜çš„è¯·æ±‚é€Ÿç‡ if (requestRate \u003e 100) return 0.8; // æ£€æµ‹å¯ç–‘çš„User-Agent if (this.isSuspiciousUserAgent(requestData.userAgent)) return 0.6; // æ£€æµ‹å¼‚å¸¸è¯·æ±‚æ¨¡å¼ if (this.hasAbnormalPattern(recentRequests)) return 0.7; return 0.1; // åŸºç¡€æ”»å‡»æ¦‚ç‡ } // æå–ç‰¹å¾ç”¨äºæœºå™¨å­¦ä¹  extractFeatures(history, requestData) { const recentMinute = history.filter(req =\u003e Date.now() - req.timestamp \u003c 60000); const recentHour = history.filter(req =\u003e Date.now() - req.timestamp \u003c 3600000); return [ recentMinute.length / 60, // æ¯ç§’è¯·æ±‚æ•°ï¼ˆæœ€è¿‘1åˆ†é’Ÿï¼‰ recentHour.length / 3600, // æ¯ç§’è¯·æ±‚æ•°ï¼ˆæœ€è¿‘1å°æ—¶ï¼‰ this.calculateUniqueIPs(recentHour), // å”¯ä¸€IPæ•° this.calculateUniqueEndpoints(recentHour), // å”¯ä¸€ç«¯ç‚¹æ•° this.averageResponseTime(recentMinute), // å¹³å‡å“åº”æ—¶é—´ this.errorRate(recentMinute), // é”™è¯¯ç‡ this.suspiciousUserAgentRatio(recentMinute), // å¯ç–‘User-Agentæ¯”ä¾‹ this.requestSizeVariance(recentMinute), // è¯·æ±‚å¤§å°æ–¹å·® this.calculateEntropy(recentMinute), // è¯·æ±‚ç†µ this.calculateBurstiness(recentMinute) // è¯·æ±‚çªå‘æ€§ ]; } // é›†ç¾¤é™æµå™¨ async clusterRateLimit(key, limit, windowMs) { const nodeId = process.env.NODE_ID || 'node1'; const clusterKey = `cluster:${key}`; // ä½¿ç”¨Redisçš„åŸå­æ“ä½œå®ç°é›†ç¾¤é™æµ const script = ` local key = KEYS[1] local window = tonumber(ARGV[1]) local limit = tonumber(ARGV[2]) local now = tonumber(ARGV[3]) local node_id = ARGV[4] -- æ¸…ç†è¿‡æœŸè®°å½• redis.call('zremrangebyscore', key, 0, now - window) -- è·å–å½“å‰è®¡æ•° local current = redis.call('zcard', key) -- æ£€æŸ¥æ˜¯å¦è¶…è¿‡é™åˆ¶ if current \u003c limit then -- æ·»åŠ å½“å‰è¯·æ±‚è®°å½• redis.call('zadd', key, now, node_id .. ':' .. now) redis.call('expire', key, math.ceil(window / 1000)) return {1, limit - current - 1} else return {0, 0} end `; const result = await this.redis.eval(script, 1, clusterKey, windowMs, limit, Date.now(), nodeId); return { allowed: result[0] === 1, remaining: result[1] }; } } åº”æ€¥å“åº”æµç¨‹ DDoSæ”»å‡»åº”æ€¥å“åº” å»ºç«‹å®Œå–„çš„åº”æ€¥å“åº”æœºåˆ¶ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 // DDoSåº”æ€¥å“åº”ç³»ç»Ÿ class DDoSResponseSystem { constructor() { this.responsePlan = { detection: { alerting: this.setupAlerting(), automated_response: this.enableAutomatedResponse() }, mitigation: { immediate_actions: [ 'enable_scrubbing', 'activate_rate_limiting', 'block_malicious_ips', 'enable_captcha' ], escalation_actions: [ 'activate_additional_bandwidth', 'enable_cloudflare_under_attack_mode', 'contact_ddos_mitigation_provider' ] }, recovery: { post_attack_analysis: this.setupPostAttackAnalysis(), system_hardening: this.hardenSystems() } }; this.alertChannels = [ 'email', 'slack', 'sms', 'webhook' ]; this.mitigationStrategies = new Map(); this.initializeMitigationStrategies(); } // è®¾ç½®å‘Šè­¦ç³»ç»Ÿ setupAlerting() { return { thresholds: { // æµé‡é˜ˆå€¼ traffic_increase: 300, // æµé‡å¢é•¿300% request_rate_increase: 500, // è¯·æ±‚ç‡å¢é•¿500% // é”™è¯¯ç‡é˜ˆå€¼ error_rate_threshold: 10, // é”™è¯¯ç‡è¶…è¿‡10% response_time_threshold: 5000, // å“åº”æ—¶é—´è¶…è¿‡5ç§’ // è¿æ¥æ•°é˜ˆå€¼ concurrent_connections: 10000, // å¹¶å‘è¿æ¥æ•° half_open_connections: 5000 // åŠè¿æ¥æ•° }, alert_levels: { info: { color: '#36a64f', prefix: 'â„¹ï¸' }, warning: { color: '#ff9500', prefix: 'âš ï¸' }, critical: { color: '#ff0000', prefix: 'ğŸš¨' } }, cooldown_periods: { info: 300000, // 5åˆ†é’Ÿ warning: 600000, // 10åˆ†é’Ÿ critical: 0 // ç«‹å³ } }; } // æ£€æµ‹åˆ°æ”»å‡»æ—¶çš„å“åº” async handleAttackDetection(attackData) { console.log(`DDoS Attack Detected: ${JSON.stringify(attackData)}`); // 1. å‘é€å‘Šè­¦ await this.sendAlert('critical', 'DDoS Attack Detected', attackData); // 2. è®°å½•æ”»å‡»ä¿¡æ¯ await this.logAttackIncident(attackData); // 3. ç¡®å®šæ”»å‡»ä¸¥é‡ç¨‹åº¦ const severity = this.assessAttackSeverity(attackData); // 4. æ‰§è¡Œè‡ªåŠ¨ç¼“è§£æªæ–½ await this.executeAutomatedMitigation(attackData, severity); // 5. é€šçŸ¥ç›¸å…³äººå‘˜ await this.notifyPersonnel(severity); // 6. å¼€å§‹ç›‘æ§ç¼“è§£æ•ˆæœ this.startMitigationMonitoring(attackData); } // æ‰§è¡Œè‡ªåŠ¨ç¼“è§£æªæ–½ async executeAutomatedMitigation(attackData, severity) { const actions = this.getMitigationActions(severity); for (const action of actions) { try { await this.executeMitigationAction(action, attackData); console.log(`Executed mitigation action: ${action.name}`); } catch (error) { console.error(`Failed to execute action ${action.name}:`, error); await this.sendAlert('warning', 'Mitigation Action Failed', { action: action.name, error: error.message }); } } } // è·å–ç¼“è§£æªæ–½ getMitigationActions(severity) { const baseActions = [ { name: 'enable_rate_limiting', priority: 1, delay: 0 }, { name: 'enable_captcha', priority: 2, delay: 30000 }, { name: 'cache_static_content', priority: 3, delay: 0 } ]; if (severity \u003e= 5) { baseActions.push( { name: 'block_malicious_ips', priority: 1, delay: 0 }, { name: 'enable_scrubbing', priority: 2, delay: 0 }, { name: 'activate_cloudflare_mode', priority: 3, delay: 60000 } ); } if (severity \u003e= 8) { baseActions.push( { name: 'emergency_bypass_mode', priority: 1, delay: 0 }, { name: 'activate_additional_bandwidth', priority: 2, delay: 30000 }, { name: 'contact_mitigation_provider', priority: 3, delay: 120000 } ); } return baseActions.sort((a, b) =\u003e a.priority - b.priority); } // æ‰§è¡Œå…·ä½“çš„ç¼“è§£åŠ¨ä½œ async executeMitigationAction(action, attackData) { switch (action.name) { case 'enable_rate_limiting': await this.enableRateLimiting(attackData); break; case 'block_malicious_ips': await this.blockMaliciousIPs(attackData); break; case 'enable_captcha': await this.enableCaptcha(); break; case 'activate_cloudflare_mode': await this.activateCloudflareUnderAttackMode(); break; case 'enable_scrubbing': await this.enableTrafficScrubbing(); break; case 'emergency_bypass_mode': await this.activateEmergencyBypassMode(); break; default: console.warn(`Unknown mitigation action: ${action.name}`); } // è®°å½•æ‰§è¡Œçš„åŠ¨ä½œ await this.logMitigationAction(action, attackData); } // å¯ç”¨é€Ÿç‡é™åˆ¶ async enableRateLimiting(attackData) { const rateLimiter = new IntelligentRateLimiter(); // æ ¹æ®æ”»å‡»ç±»å‹è°ƒæ•´é™æµå‚æ•° if (attackData.type === 'HTTP_FLOOD') { // å¯¹æ‰€æœ‰IPå®æ–½ä¸¥æ ¼é™æµ await rateLimiter.updateGlobalLimits({ requests_per_minute: 1000, burst_size: 200 }); } else if (attackData.type === 'SLOWLORIS') { // é™åˆ¶è¿æ¥æŒç»­æ—¶é—´ await this.updateConnectionTimeouts({ client_body_timeout: 10, client_header_timeout: 10, keepalive_timeout: 10 }); } } // é˜»æ­¢æ¶æ„IP async blockMaliciousIPs(attackData) { const maliciousIPs = this.identifyMaliciousIPs(attackData); for (const ip of maliciousIPs) { // åœ¨é˜²ç«å¢™ä¸­é˜»æ­¢IP await this.blockIPInFirewall(ip); // åœ¨åº”ç”¨å±‚é˜»æ­¢IP await this.blockIPInApplication(ip); // æ·»åŠ åˆ°IPé»‘åå• await this.addToIPBlacklist(ip, 'DDoS attack', 3600); // 1å°æ—¶ } console.log(`Blocked ${maliciousIPs.length} malicious IPs`); } // æ¿€æ´»Cloudflare Under Attack Mode async activateCloudflareUnderAttackMode() { const cloudflareAPI = require('cloudflare-api'); try { // è®¾ç½®å®‰å…¨çº§åˆ«ä¸º \"Under Attack\" await cloudflareAPI.setSecurityLevel('under_attack'); // å¯ç”¨é«˜çº§DDoSé˜²æŠ¤ await cloudflareAPI.enableAdvancedDDoSProtection(); // å¯ç”¨é€Ÿç‡é™åˆ¶ await cloudflareAPI.enableRateLimiting({ requests_per_minute: 100, burst_size: 20 }); console.log('Cloudflare Under Attack Mode activated'); } catch (error) { console.error('Failed to activate Cloudflare Under Attack Mode:', error); throw error; } } // ç›‘æ§ç¼“è§£æ•ˆæœ startMitigationMonitoring(attackData) { const monitoringInterval = setInterval(async () =\u003e { try { const currentStatus = await this.getCurrentSystemStatus(); const mitigationEffectiveness = this.calculateMitigationEffectiveness(attackData, currentStatus); if (mitigationEffectiveness.isEffective) { console.log('Mitigation is effective, attack is subsiding'); if (mitigationEffectiveness.attackEnded) { // æ”»å‡»å·²ç»“æŸï¼Œå¼€å§‹æ¢å¤æµç¨‹ clearInterval(monitoringInterval); await this.startRecoveryProcess(); } } else { console.log('Mitigation not effective, escalating response'); await this.escalateResponse(attackData, currentStatus); } // å‘é€çŠ¶æ€æ›´æ–° await this.sendStatusUpdate(mitigationEffectiveness); } catch (error) { console.error('Error in mitigation monitoring:', error); } }, 30000); // æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡ // è®¾ç½®è¶…æ—¶æ¸…ç† setTimeout(() =\u003e { clearInterval(monitoringInterval); console.log('Mitigation monitoring timeout, stopping monitoring'); }, 3600000); // 1å°æ—¶ååœæ­¢ç›‘æ§ } // è®¡ç®—ç¼“è§£æ•ˆæœ calculateMitigationEffectiveness(attackData, currentStatus) { const initialTraffic = attackData.peakTraffic; const currentTraffic = currentStatus.currentTraffic; const trafficReduction = ((initialTraffic - currentTraffic) / initialTraffic) * 100; const initialErrorRate = attackData.errorRate || 0; const currentErrorRate = currentStatus.errorRate; const errorRateImprovement = initialErrorRate - currentErrorRate; const isEffective = trafficReduction \u003e 50 \u0026\u0026 errorRateImprovement \u003e 5; const attackEnded = currentTraffic \u003c (initialTraffic * 0.2) \u0026\u0026 currentErrorRate \u003c 5; return { isEffective, attackEnded, trafficReduction, errorRateImprovement, currentStatus }; } } ç›‘æ§ä¸åˆ†æ å®æ—¶æ”»å‡»ç›‘æ§ å»ºç«‹å…¨é¢çš„DDoSæ”»å‡»ç›‘æ§ä½“ç³»ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 // DDoSæ”»å‡»ç›‘æ§ç³»ç»Ÿ class DDoSMonitoringSystem { constructor() { this.metrics = { traffic: { inbound: 0, outbound: 0, dropped: 0 }, connections: { total: 0, active: 0, half_open: 0 }, requests: { total: 0, legitimate: 0, suspicious: 0, blocked: 0 }, attacks: { ongoing: 0, total_today: 0, mitigated: 0 } }; this.alertThresholds = { traffic_spike: 200, // æµé‡çªå¢200% error_rate: 10, // é”™è¯¯ç‡è¶…è¿‡10% response_time: 5000, // å“åº”æ—¶é—´è¶…è¿‡5ç§’ connection_flood: 10000 // è¿æ¥æ•°è¶…è¿‡10000 }; this.startMonitoring(); } startMonitoring() { // ç›‘æ§ç½‘ç»œæµé‡ this.monitorNetworkTraffic(); // ç›‘æ§åº”ç”¨æŒ‡æ ‡ this.monitorApplicationMetrics(); // ç›‘æ§ç³»ç»Ÿèµ„æº this.monitorSystemResources(); // ç›‘æ§æ”»å‡»æ¨¡å¼ this.monitorAttackPatterns(); } // ç›‘æ§ç½‘ç»œæµé‡ monitorNetworkTraffic() { setInterval(() =\u003e { this.collectNetworkMetrics() .then(metrics =\u003e { this.metrics.traffic = metrics; this.analyzeTrafficPatterns(metrics); }) .catch(error =\u003e { console.error('Error collecting network metrics:', error); }); }, 5000); // æ¯5ç§’æ”¶é›†ä¸€æ¬¡ } // ç›‘æ§åº”ç”¨æŒ‡æ ‡ monitorApplicationMetrics() { setInterval(() =\u003e { this.collectApplicationMetrics() .then(metrics =\u003e { this.metrics.requests = metrics; this.analyzeRequestPatterns(metrics); }) .catch(error =\u003e { console.error('Error collecting application metrics:', error); }); }, 2000); // æ¯2ç§’æ”¶é›†ä¸€æ¬¡ } // åˆ†ææµé‡æ¨¡å¼ analyzeTrafficPatterns(trafficMetrics) { const baseline = this.getTrafficBaseline(); const currentTraffic = trafficMetrics.inbound; const spikePercentage = ((currentTraffic - baseline) / baseline) * 100; if (spikePercentage \u003e this.alertThresholds.traffic_spike) { this.triggerAlert('TRAFFIC_SPIKE', { current: currentTraffic, baseline: baseline, spike: spikePercentage }); } // æ£€æµ‹æµé‡å¼‚å¸¸æ¨¡å¼ this.detectTrafficAnomalies(trafficMetrics); } // æ£€æµ‹æµé‡å¼‚å¸¸ detectTrafficAnomalies(trafficMetrics) { const recentTraffic = this.getRecentTrafficHistory(300000); // æœ€è¿‘5åˆ†é’Ÿ // ä½¿ç”¨ç»Ÿè®¡æ–¹æ³•æ£€æµ‹å¼‚å¸¸ const mean = this.calculateMean(recentTraffic); const stdDev = this.calculateStandardDeviation(recentTraffic, mean); const current = trafficMetrics.inbound; // å¦‚æœå½“å‰æµé‡è¶…å‡º3ä¸ªæ ‡å‡†å·®ï¼Œè®¤ä¸ºæ˜¯å¼‚å¸¸ if (Math.abs(current - mean) \u003e 3 * stdDev) { this.triggerAlert('TRAFFIC_ANOMALY', { current: current, mean: mean, standardDeviation: stdDev, zScore: (current - mean) / stdDev }); } } // ç”Ÿæˆå®æ—¶ä»ªè¡¨æ¿æ•°æ® getDashboardData() { return { overview: { totalRequests: this.metrics.requests.total, blockedRequests: this.metrics.requests.blocked, attackStatus: this.metrics.attacks.ongoing \u003e 0 ? 'under_attack' : 'normal', systemLoad: this.getSystemLoadPercentage() }, traffic: { inbound: this.metrics.traffic.inbound, outbound: this.metrics.traffic.outbound, dropped: this.metrics.traffic.dropped, chart: this.getTrafficChartData() }, attacks: { ongoing: this.metrics.attacks.ongoing, today: this.metrics.attacks.total_today, mitigated: this.metrics.attacks.mitigated, recent: this.getRecentAttacks() }, performance: { averageResponseTime: this.getAverageResponseTime(), errorRate: this.getErrorRate(), throughput: this.getThroughput() }, topAttackers: this.getTopAttackers(), blockedIPs: this.getBlockedIPs() }; } // è·å–æµé‡å›¾è¡¨æ•°æ® getTrafficChartData() { const now = Date.now(); const timeRange = 3600000; // æœ€è¿‘1å°æ—¶ const interval = 60000; // 1åˆ†é’Ÿé—´éš” const data = []; for (let i = timeRange; i \u003e= 0; i -= interval) { const timestamp = now - i; const traffic = this.getTrafficAtTimestamp(timestamp); data.push({ timestamp: new Date(timestamp), inbound: traffic.inbound, outbound: traffic.outbound, legitimate: traffic.legitimate, malicious: traffic.malicious }); } return data; } // è·å–æœ€è¿‘çš„æ”»å‡»è®°å½• getRecentAttacks() { return this.recentAttacks .filter(attack =\u003e Date.now() - attack.startTime \u003c 86400000) // æœ€è¿‘24å°æ—¶ .map(attack =\u003e ({ id: attack.id, type: attack.type, severity: attack.severity, startTime: new Date(attack.startTime), duration: attack.endTime ? attack.endTime - attack.startTime : Date.now() - attack.startTime, peakTraffic: attack.peakTraffic, status: attack.status })) .sort((a, b) =\u003e b.startTime - a.startTime) .slice(0, 10); // æœ€è¿‘10æ¬¡æ”»å‡» } // è·å–é¡¶çº§æ”»å‡»è€…IP getTopAttackers() { const ipStats = this.getIPStatistics(); return Object.entries(ipStats) .map(([ip, stats]) =\u003e ({ ip: ip, requests: stats.total, blocked: stats.blocked, suspiciousScore: stats.suspiciousScore, country: stats.country, lastSeen: stats.lastSeen })) .sort((a, b) =\u003e b.suspiciousScore - a.suspiciousScore) .slice(0, 20); // å‰20ä¸ªå¯ç–‘IP } // è·å–è¢«é˜»æ­¢çš„IPåˆ—è¡¨ getBlockedIPs() { return this.blockedIPs .map(ip =\u003e ({ address: ip.address, reason: ip.reason, blockedAt: new Date(ip.blockedAt), expiresAt: ip.expiresAt ? new Date(ip.expiresAt) : null, blockedRequests: ip.blockedRequests })) .filter(ip =\u003e !ip.expiresAt || ip.expiresAt \u003e Date.now()) .sort((a, b) =\u003e b.blockedAt - a.blockedAt); } } æ€»ç»“ DDoSé˜²æŠ¤æ˜¯ä¸€ä¸ªå¤šå±‚æ¬¡ã€æŒç»­è¿›åŒ–çš„å®‰å…¨é¢†åŸŸã€‚é€šè¿‡æ„å»ºå®Œæ•´çš„é˜²æŠ¤ä½“ç³»ï¼š\næ£€æµ‹èƒ½åŠ›ï¼šå®æ—¶ç›‘æ§å’Œæ™ºèƒ½è¯†åˆ«å„ç§DDoSæ”»å‡»æ¨¡å¼ é˜²æŠ¤ç­–ç•¥ï¼šç½‘ç»œå±‚ã€åº”ç”¨å±‚å’Œä¸šåŠ¡å±‚çš„å¤šå±‚é˜²æŠ¤æœºåˆ¶ åº”æ€¥å“åº”ï¼šè‡ªåŠ¨åŒ–å’Œäººå·¥ç›¸ç»“åˆçš„å¿«é€Ÿå“åº”æµç¨‹ æŒç»­æ”¹è¿›ï¼šåŸºäºå†å²æ•°æ®çš„é˜²æŠ¤ç­–ç•¥ä¼˜åŒ– è®°ä½ï¼ŒDDoSé˜²æŠ¤ä¸æ˜¯ä¸€æ¬¡æ€§çš„éƒ¨ç½²ï¼Œè€Œæ˜¯ä¸€ä¸ªæŒç»­å¯¹æŠ—å’Œä¼˜åŒ–çš„è¿‡ç¨‹ã€‚åªæœ‰é€šè¿‡æŠ€æœ¯ã€æµç¨‹å’Œäººå‘˜çš„æœ‰æœºç»“åˆï¼Œæ‰èƒ½æ„å»ºçœŸæ­£æœ‰æ•ˆçš„DDoSé˜²æŠ¤ä½“ç³»ï¼Œä¿æŠ¤ä¸šåŠ¡çš„è¿ç»­æ€§å’Œå¯ç”¨æ€§ã€‚\n","wordCount":"3657","inLanguage":"zh-cn","datePublished":"2025-12-22T13:00:00+08:00","dateModified":"2025-12-22T13:00:00+08:00","author":{"@type":"Person","name":"util.cn Team"},"mainEntityOfPage":{"@type":"WebPage","@id":"/blog/articles/ddos%E9%98%B2%E6%8A%A4%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E4%BB%8E%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%E5%88%B0%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E7%9A%84%E5%AE%8C%E6%95%B4%E9%98%B2%E6%8A%A4%E4%BD%93%E7%B3%BB/"},"publisher":{"@type":"Organization","name":"æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·","logo":{"@type":"ImageObject","url":"/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=/blog/ accesskey=h title="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· (Alt + H)">æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=/blog/posts/ title="æ‰€æœ‰æ–‡ç« åˆ—è¡¨ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŸ¥çœ‹æ‰€æœ‰æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹"><span>æ–‡ç« </span></a></li><li><a href=https://www.util.cn title="æœ‰æ¡å·¥å…· - å¼€å‘è€…çš„å¸¸ç”¨å·¥å…·é›†åˆï¼šæ— å¹¿å‘Š Â· æœ¬åœ°è®¡ç®— Â· å³å¼€å³ç”¨çš„åœ¨çº¿å·¥å…·å¹³å°ï¼Œæä¾›JSONæ ¼å¼åŒ–ã€SQLæ ¼å¼åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰å®ç”¨å·¥å…·"><span>æœ‰æ¡å·¥å…·</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=/blog/categories/ title="æ–‡ç« åˆ†ç±» - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŒ‰æŠ€æœ¯é¢†åŸŸåˆ†ç±»çš„ä¼˜è´¨æ–‡ç« ï¼ŒåŒ…æ‹¬å‰ç«¯å¼€å‘ã€å·¥å…·ä½¿ç”¨ã€ç¼–ç¨‹æŠ€å·§ç­‰"><span>åˆ†ç±»</span></a></li><li><a href=/blog/tags/ title="æ ‡ç­¾äº‘ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šé€šè¿‡æ ‡ç­¾å¿«é€Ÿæ‰¾åˆ°æ„Ÿå…´è¶£çš„æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹"><span>æ ‡ç­¾</span></a></li><li><a href=/blog/archives/ title="æ–‡ç« å½’æ¡£ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŒ‰æ—¶é—´æŸ¥çœ‹å†å²æ–‡ç« "><span>å½’æ¡£</span></a></li><li><a href=/blog/search/ title="æœç´¢æ–‡ç«  - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šé€šè¿‡å…³é”®è¯æœç´¢æ‰¾åˆ°æ„Ÿå…´è¶£çš„æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹ï¼Œæ”¯æŒæ ‡é¢˜ã€å†…å®¹ã€åˆ†ç±»å’Œæ ‡ç­¾æœç´¢"><span>æœç´¢</span></a></li></ul></nav></header><main class=main><article class=post-single><div class=post-content-wrapper><main class=post-content-main><header class=post-header-main><h1 class="post-title entry-hint-parent">DDoSé˜²æŠ¤å®Œå…¨æŒ‡å—ï¼šä»åŸç†åˆ†æåˆ°å®æˆ˜éƒ¨ç½²çš„å®Œæ•´é˜²æŠ¤ä½“ç³»</h1><div class=post-meta><div class=post-meta-content><div class=post-categories-inline><a href=/blog/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/ class=category-link>ç½‘ç»œå®‰å…¨</a></div><span class=post-date>2025-12-22</span><span class=post-author>util.cn Team</span></div><style>.post-meta-content{display:flex;align-items:center;flex-wrap:wrap;gap:.75rem;font-family:sf mono,monaco,courier new,monospace;font-size:.875rem;color:#9ca3af !important}.post-categories-inline{display:inline-flex;align-items:center;gap:.5rem}.category-link{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .75rem;background:rgba(255,255,255,.1);color:#e5e7eb !important;text-decoration:none;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;border:1px solid rgba(255,255,255,.2);border-radius:0;transition:all .3s ease;white-space:nowrap}.category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3);transform:translateY(-1px)}.category-link::before{content:'ğŸ“';font-size:.7rem;opacity:.8}.post-date,.post-reading-time,.post-word-count,.post-author{color:#9ca3af !important}[data-theme=dark] .post-meta-content{color:#9ca3af !important}[data-theme=dark] .category-link{background:rgba(255,255,255,.1);color:#e5e7eb !important;border-color:rgba(255,255,255,.2)}[data-theme=dark] .category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3)}[data-theme=dark] .post-date,[data-theme=dark] .post-reading-time,[data-theme=dark] .post-word-count,[data-theme=dark] .post-author{color:#9ca3af !important}[data-theme=light] .post-meta-content{color:#6c757d !important}[data-theme=light] .category-link{background:rgba(0,0,0,5%);color:#495057 !important;border-color:rgba(0,0,0,.15)}[data-theme=light] .category-link:hover{background:rgba(0,102,204,.1);color:#212529 !important;border-color:rgba(0,102,204,.3)}[data-theme=light] .post-date,[data-theme=light] .post-reading-time,[data-theme=light] .post-word-count,[data-theme=light] .post-author{color:#6c757d !important}@media(max-width:768px){.post-meta-content{gap:.5rem;font-size:.8rem}.category-link{padding:.2rem .6rem;font-size:.7rem}}</style></div></header><div class=post-content><p>åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡ï¼ˆDDoSï¼‰æ”»å‡»æ˜¯å½“ä»Šäº’è”ç½‘é¢ä¸´çš„æœ€ä¸¥é‡å®‰å…¨å¨èƒä¹‹ä¸€ã€‚éšç€æ”»å‡»æ‰‹æ®µçš„ä¸æ–­è¿›åŒ–ï¼Œä¼ä¸šéœ€è¦æ„å»ºå¤šå±‚æ¬¡ã€æ™ºèƒ½åŒ–çš„é˜²æŠ¤ä½“ç³»ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨DDoSæ”»å‡»çš„å„ç§ç±»å‹ã€é˜²æŠ¤åŸç†å’Œå®æˆ˜éƒ¨ç½²æ–¹æ¡ˆã€‚</p><h2 id=ddosæ”»å‡»ç±»å‹ä¸åŸç†>DDoSæ”»å‡»ç±»å‹ä¸åŸç†<a hidden class=anchor aria-hidden=true href=#ddosæ”»å‡»ç±»å‹ä¸åŸç†>#</a></h2><h3 id=ç½‘ç»œå±‚ddosæ”»å‡»>ç½‘ç»œå±‚DDoSæ”»å‡»<a hidden class=anchor aria-hidden=true href=#ç½‘ç»œå±‚ddosæ”»å‡»>#</a></h3><p>ç½‘ç»œå±‚æ”»å‡»ä¸»è¦é€šè¿‡æ¶ˆè€—ç½‘ç»œå¸¦å®½å’ŒæœåŠ¡å™¨èµ„æºæ¥ç˜«ç—ªç›®æ ‡æœåŠ¡ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// DDoSæ”»å‡»ç±»å‹è¯†åˆ«ç³»ç»Ÿ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>class</span> DDoSAttackDetector {
</span></span><span style=display:flex><span>  constructor() {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>this</span>.attackPatterns <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// SYN Floodæ”»å‡»æ£€æµ‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      synFlood<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        thresholds<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>          synRate<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>1000</span>,        <span style=color:#8b949e;font-style:italic>// æ¯ç§’SYNåŒ…æ•°é‡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>          synAckRatio<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>10</span>,      <span style=color:#8b949e;font-style:italic>// SYN/SYN-ACKæ¯”ç‡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>          connectionHalfOpen<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>5000</span>  <span style=color:#8b949e;font-style:italic>// åŠè¿æ¥æ•°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        },
</span></span><span style=display:flex><span>        detection<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.detectSYNFlood.bind(<span style=color:#ff7b72>this</span>)
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// UDP Floodæ”»å‡»æ£€æµ‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      udpFlood<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        thresholds<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>          udpRate<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>5000</span>,        <span style=color:#8b949e;font-style:italic>// æ¯ç§’UDPåŒ…æ•°é‡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>          udpPortSpread<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>100</span>    <span style=color:#8b949e;font-style:italic>// UDPç«¯å£åˆ†å¸ƒæ•°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        },
</span></span><span style=display:flex><span>        detection<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.detectUDPFlood.bind(<span style=color:#ff7b72>this</span>)
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// ICMP Floodæ”»å‡»æ£€æµ‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      icmpFlood<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        thresholds<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>          icmpRate<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>1000</span>,       <span style=color:#8b949e;font-style:italic>// æ¯ç§’ICMPåŒ…æ•°é‡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>          icmpSize<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>1500</span>        <span style=color:#8b949e;font-style:italic>// ICMPåŒ…å¤§å°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        },
</span></span><span style=display:flex><span>        detection<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.detectICMPFlood.bind(<span style=color:#ff7b72>this</span>)
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>this</span>.trafficStats <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> Map();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// SYN Floodæ”»å‡»æ£€æµ‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  detectSYNFlood(trafficData) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> recentTraffic <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.getRecentTraffic(<span style=color:#a5d6ff>5000</span>); <span style=color:#8b949e;font-style:italic>// æœ€è¿‘5ç§’
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>const</span> synPackets <span style=color:#ff7b72;font-weight:700>=</span> recentTraffic.filter(p =&gt; p.type <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;SYN&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> synAckPackets <span style=color:#ff7b72;font-weight:700>=</span> recentTraffic.filter(p =&gt; p.type <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;SYN-ACK&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> synRate <span style=color:#ff7b72;font-weight:700>=</span> synPackets.length <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#a5d6ff>5</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> synAckRatio <span style=color:#ff7b72;font-weight:700>=</span> synPackets.length <span style=color:#ff7b72;font-weight:700>/</span> Math.max(synAckPackets.length, <span style=color:#a5d6ff>1</span>);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> halfOpenConnections <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.getHalfOpenConnections();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>      isAttack<span style=color:#ff7b72;font-weight:700>:</span> synRate <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72>this</span>.attackPatterns.synFlood.thresholds.synRate <span style=color:#ff7b72;font-weight:700>||</span>
</span></span><span style=display:flex><span>                synAckRatio <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72>this</span>.attackPatterns.synFlood.thresholds.synAckRatio <span style=color:#ff7b72;font-weight:700>||</span>
</span></span><span style=display:flex><span>                halfOpenConnections <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72>this</span>.attackPatterns.synFlood.thresholds.connectionHalfOpen,
</span></span><span style=display:flex><span>      confidence<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.calculateConfidence([
</span></span><span style=display:flex><span>        synRate <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#ff7b72>this</span>.attackPatterns.synFlood.thresholds.synRate,
</span></span><span style=display:flex><span>        synAckRatio <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#ff7b72>this</span>.attackPatterns.synFlood.thresholds.synAckRatio,
</span></span><span style=display:flex><span>        halfOpenConnections <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#ff7b72>this</span>.attackPatterns.synFlood.thresholds.connectionHalfOpen
</span></span><span style=display:flex><span>      ]),
</span></span><span style=display:flex><span>      details<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        synRate,
</span></span><span style=display:flex><span>        synAckRatio,
</span></span><span style=display:flex><span>        halfOpenConnections
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// UDP Floodæ”»å‡»æ£€æµ‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  detectUDPFlood(trafficData) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> recentTraffic <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.getRecentTraffic(<span style=color:#a5d6ff>5000</span>);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> udpPackets <span style=color:#ff7b72;font-weight:700>=</span> recentTraffic.filter(p =&gt; p.protocol <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;UDP&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> uniquePorts <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> Set(udpPackets.map(p =&gt; p.destinationPort));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> udpRate <span style=color:#ff7b72;font-weight:700>=</span> udpPackets.length <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#a5d6ff>5</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> portSpread <span style=color:#ff7b72;font-weight:700>=</span> uniquePorts.size;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>      isAttack<span style=color:#ff7b72;font-weight:700>:</span> udpRate <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72>this</span>.attackPatterns.udpFlood.thresholds.udpRate <span style=color:#ff7b72;font-weight:700>||</span>
</span></span><span style=display:flex><span>                portSpread <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72>this</span>.attackPatterns.udpFlood.thresholds.udpPortSpread,
</span></span><span style=display:flex><span>      confidence<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.calculateConfidence([
</span></span><span style=display:flex><span>        udpRate <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#ff7b72>this</span>.attackPatterns.udpFlood.thresholds.udpRate,
</span></span><span style=display:flex><span>        portSpread <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#ff7b72>this</span>.attackPatterns.udpFlood.thresholds.udpPortSpread
</span></span><span style=display:flex><span>      ]),
</span></span><span style=display:flex><span>      details<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        udpRate,
</span></span><span style=display:flex><span>        portSpread
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// ICMP Floodæ”»å‡»æ£€æµ‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  detectICMPFlood(trafficData) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> recentTraffic <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.getRecentTraffic(<span style=color:#a5d6ff>5000</span>);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> icmpPackets <span style=color:#ff7b72;font-weight:700>=</span> recentTraffic.filter(p =&gt; p.protocol <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;ICMP&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> avgPacketSize <span style=color:#ff7b72;font-weight:700>=</span> icmpPackets.reduce((sum, p) =&gt; sum <span style=color:#ff7b72;font-weight:700>+</span> p.size, <span style=color:#a5d6ff>0</span>) <span style=color:#ff7b72;font-weight:700>/</span> icmpPackets.length;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> icmpRate <span style=color:#ff7b72;font-weight:700>=</span> icmpPackets.length <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#a5d6ff>5</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>      isAttack<span style=color:#ff7b72;font-weight:700>:</span> icmpRate <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72>this</span>.attackPatterns.icmpFlood.thresholds.icmpRate <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span>
</span></span><span style=display:flex><span>                avgPacketSize <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72>this</span>.attackPatterns.icmpFlood.thresholds.icmpSize,
</span></span><span style=display:flex><span>      confidence<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.calculateConfidence([
</span></span><span style=display:flex><span>        icmpRate <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#ff7b72>this</span>.attackPatterns.icmpFlood.thresholds.icmpRate,
</span></span><span style=display:flex><span>        avgPacketSize <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#ff7b72>this</span>.attackPatterns.icmpFlood.thresholds.icmpSize
</span></span><span style=display:flex><span>      ]),
</span></span><span style=display:flex><span>      details<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        icmpRate,
</span></span><span style=display:flex><span>        avgPacketSize
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  calculateConfidence(ratios) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> Math.min(<span style=color:#a5d6ff>1.0</span>, ratios.reduce((sum, r) =&gt; sum <span style=color:#ff7b72;font-weight:700>+</span> Math.min(r, <span style=color:#a5d6ff>1.0</span>), <span style=color:#a5d6ff>0</span>) <span style=color:#ff7b72;font-weight:700>/</span> ratios.length);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=åº”ç”¨å±‚ddosæ”»å‡»>åº”ç”¨å±‚DDoSæ”»å‡»<a hidden class=anchor aria-hidden=true href=#åº”ç”¨å±‚ddosæ”»å‡»>#</a></h3><p>åº”ç”¨å±‚æ”»å‡»ä¸»è¦é’ˆå¯¹åº”ç”¨åè®®å’Œä¸šåŠ¡é€»è¾‘ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">165
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">166
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">167
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">168
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">169
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">170
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">171
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// åº”ç”¨å±‚æ”»å‡»æ£€æµ‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>class</span> ApplicationLayerDDoSDetector {
</span></span><span style=display:flex><span>  constructor() {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>this</span>.httpStats <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>      requests<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>new</span> Map(),
</span></span><span style=display:flex><span>      userAgents<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>new</span> Map(),
</span></span><span style=display:flex><span>      ips<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>new</span> Map(),
</span></span><span style=display:flex><span>      endpoints<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>new</span> Map()
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>this</span>.attackThresholds <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// HTTP Floodæ”»å‡»é˜ˆå€¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      httpFlood<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        requestsPerSecond<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>1000</span>,
</span></span><span style=display:flex><span>        requestsPerIP<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>100</span>,
</span></span><span style=display:flex><span>        suspiciousUserAgents<span style=color:#ff7b72;font-weight:700>:</span> [
</span></span><span style=display:flex><span>          <span style=color:#79c0ff>/bot/i</span>,
</span></span><span style=display:flex><span>          <span style=color:#79c0ff>/crawler/i</span>,
</span></span><span style=display:flex><span>          <span style=color:#79c0ff>/scraper/i</span>,
</span></span><span style=display:flex><span>          <span style=color:#79c0ff>/^$/</span>,
</span></span><span style=display:flex><span>          <span style=color:#79c0ff>/python/i</span>,
</span></span><span style=display:flex><span>          <span style=color:#79c0ff>/curl/i</span>
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// Slowlorisæ”»å‡»é˜ˆå€¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      slowloris<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        maxConnections<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>1000</span>,
</span></span><span style=display:flex><span>        slowConnectionThreshold<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>30000</span>, <span style=color:#8b949e;font-style:italic>// 30ç§’
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        minHeadersPerConnection<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>1</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// HTTP GET/POST Floodé˜ˆå€¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      httpGetPostFlood<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        getRequestsPerSecond<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>500</span>,
</span></span><span style=display:flex><span>        postRequestsPerSecond<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>100</span>,
</span></span><span style=display:flex><span>        largePayloadThreshold<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>1024</span> <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>1024</span> <span style=color:#8b949e;font-style:italic>// 1MB
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// HTTPè¯·æ±‚åˆ†æ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  analyzeHTTPRequest(request, timestamp) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> ip <span style=color:#ff7b72;font-weight:700>=</span> request.ip;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> userAgent <span style=color:#ff7b72;font-weight:700>=</span> request.headers[<span style=color:#a5d6ff>&#39;user-agent&#39;</span>] <span style=color:#ff7b72;font-weight:700>||</span> <span style=color:#a5d6ff>&#39;&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> method <span style=color:#ff7b72;font-weight:700>=</span> request.method;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> endpoint <span style=color:#ff7b72;font-weight:700>=</span> request.path;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> payloadSize <span style=color:#ff7b72;font-weight:700>=</span> request.contentLength <span style=color:#ff7b72;font-weight:700>||</span> <span style=color:#a5d6ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// è®°å½•è¯·æ±‚ç»Ÿè®¡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>this</span>.recordRequestStats(ip, userAgent, method, endpoint, payloadSize, timestamp);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// æ£€æµ‹å„ç§æ”»å‡»æ¨¡å¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>      httpFlood<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.detectHTTPFlood(timestamp),
</span></span><span style=display:flex><span>      slowloris<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.detectSlowlorisAttack(timestamp),
</span></span><span style=display:flex><span>      httpGetPostFlood<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.detectHTTPGetPostFlood(timestamp),
</span></span><span style=display:flex><span>      suspiciousPatterns<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.detectSuspiciousPatterns(request)
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// HTTP Floodæ”»å‡»æ£€æµ‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  detectHTTPFlood(timestamp) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> recentRequests <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.getRecentRequests(timestamp, <span style=color:#a5d6ff>1000</span>); <span style=color:#8b949e;font-style:italic>// æœ€è¿‘1ç§’
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>const</span> requestRate <span style=color:#ff7b72;font-weight:700>=</span> recentRequests.length;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> requestsPerIP <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.calculateRequestsPerIP(recentRequests);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> suspiciousUARequests <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.countSuspiciousUserAgents(recentRequests);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> isAttack <span style=color:#ff7b72;font-weight:700>=</span> requestRate <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72>this</span>.attackThresholds.httpFlood.requestsPerSecond <span style=color:#ff7b72;font-weight:700>||</span>
</span></span><span style=display:flex><span>                    Array.from(requestsPerIP.values()).some(count =&gt;
</span></span><span style=display:flex><span>                      count <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72>this</span>.attackThresholds.httpFlood.requestsPerIP
</span></span><span style=display:flex><span>                    ) <span style=color:#ff7b72;font-weight:700>||</span>
</span></span><span style=display:flex><span>                    suspiciousUARequests <span style=color:#ff7b72;font-weight:700>&gt;</span> requestRate <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>0.5</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>      isAttack,
</span></span><span style=display:flex><span>      confidence<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.calculateHTTPFloodConfidence(requestRate, requestsPerIP, suspiciousUARequests),
</span></span><span style=display:flex><span>      details<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        requestRate,
</span></span><span style=display:flex><span>        requestsPerIP,
</span></span><span style=display:flex><span>        suspiciousUARequests
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// Slowlorisæ”»å‡»æ£€æµ‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  detectSlowlorisAttack(timestamp) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> activeConnections <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.getActiveConnections(timestamp);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> slowConnections <span style=color:#ff7b72;font-weight:700>=</span> activeConnections.filter(conn =&gt;
</span></span><span style=display:flex><span>      timestamp <span style=color:#ff7b72;font-weight:700>-</span> conn.startTime <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72>this</span>.attackThresholds.slowloris.slowConnectionThreshold <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span>
</span></span><span style=display:flex><span>      conn.headersReceived <span style=color:#ff7b72;font-weight:700>&lt;=</span> <span style=color:#ff7b72>this</span>.attackThresholds.slowloris.minHeadersPerConnection
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> isAttack <span style=color:#ff7b72;font-weight:700>=</span> activeConnections.length <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72>this</span>.attackThresholds.slowloris.maxConnections <span style=color:#ff7b72;font-weight:700>||</span>
</span></span><span style=display:flex><span>                    slowConnections.length <span style=color:#ff7b72;font-weight:700>&gt;</span> activeConnections.length <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>0.7</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>      isAttack,
</span></span><span style=display:flex><span>      confidence<span style=color:#ff7b72;font-weight:700>:</span> isAttack <span style=color:#ff7b72;font-weight:700>?</span>
</span></span><span style=display:flex><span>        Math.max(<span style=color:#a5d6ff>0.8</span>, slowConnections.length <span style=color:#ff7b72;font-weight:700>/</span> Math.max(activeConnections.length, <span style=color:#a5d6ff>1</span>)) <span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span>,
</span></span><span style=display:flex><span>      details<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        totalConnections<span style=color:#ff7b72;font-weight:700>:</span> activeConnections.length,
</span></span><span style=display:flex><span>        slowConnections<span style=color:#ff7b72;font-weight:700>:</span> slowConnections.length,
</span></span><span style=display:flex><span>        suspiciousIPs<span style=color:#ff7b72;font-weight:700>:</span> [...<span style=color:#ff7b72>new</span> Set(slowConnections.map(c =&gt; c.ip))]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// æ£€æµ‹å¯ç–‘è¯·æ±‚æ¨¡å¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  detectSuspiciousPatterns(request) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> patterns <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// éšæœºUser-Agent
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      randomUserAgent<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.isRandomUserAgent(request.headers[<span style=color:#a5d6ff>&#39;user-agent&#39;</span>] <span style=color:#ff7b72;font-weight:700>||</span> <span style=color:#a5d6ff>&#39;&#39;</span>),
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// å¼‚å¸¸è¯·æ±‚å¤´
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      unusualHeaders<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.detectUnusualHeaders(request.headers),
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// SQLæ³¨å…¥å°è¯•
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      sqlInjection<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.detectSQLInjection(request.url, request.body),
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// XSSå°è¯•
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      xssAttempt<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.detectXSS(request.url, request.body),
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// è·¯å¾„éå†
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      pathTraversal<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.detectPathTraversal(request.url),
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// æš´åŠ›ç ´è§£æ¨¡å¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      bruteForce<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.detectBruteForcePattern(request.ip, request.path)
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>      hasSuspiciousPattern<span style=color:#ff7b72;font-weight:700>:</span> Object.values(patterns).some(p =&gt; p.detected),
</span></span><span style=display:flex><span>      patterns
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// æ£€æµ‹éšæœºUser-Agent
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  isRandomUserAgent(userAgent) {
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// æ£€æµ‹User-Agentæ˜¯å¦ä¸ºéšæœºå­—ç¬¦ä¸²
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>const</span> randomPattern <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>/^[a-zA-Z0-9]{8,}$/</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> commonPatterns <span style=color:#ff7b72;font-weight:700>=</span> [
</span></span><span style=display:flex><span>      <span style=color:#79c0ff>/Mozilla/i</span>,
</span></span><span style=display:flex><span>      <span style=color:#79c0ff>/Chrome/i</span>,
</span></span><span style=display:flex><span>      <span style=color:#79c0ff>/Firefox/i</span>,
</span></span><span style=display:flex><span>      <span style=color:#79c0ff>/Safari/i</span>,
</span></span><span style=display:flex><span>      <span style=color:#79c0ff>/Edge/i</span>,
</span></span><span style=display:flex><span>      <span style=color:#79c0ff>/Opera/i</span>
</span></span><span style=display:flex><span>    ];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> randomPattern.test(userAgent) <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span>
</span></span><span style=display:flex><span>           <span style=color:#ff7b72;font-weight:700>!</span>commonPatterns.some(pattern =&gt; pattern.test(userAgent));
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// æ£€æµ‹å¼‚å¸¸è¯·æ±‚å¤´
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  detectUnusualHeaders(headers) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> suspiciousHeaders <span style=color:#ff7b72;font-weight:700>=</span> [
</span></span><span style=display:flex><span>      <span style=color:#79c0ff>/^X-Forwarded-For:\s*\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/</span>,
</span></span><span style=display:flex><span>      <span style=color:#79c0ff>/^X-Real-IP:\s*\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/</span>,
</span></span><span style=display:flex><span>      <span style=color:#79c0ff>/^X-Originating-IP:/i</span>
</span></span><span style=display:flex><span>    ];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>      detected<span style=color:#ff7b72;font-weight:700>:</span> suspiciousHeaders.some(pattern =&gt;
</span></span><span style=display:flex><span>        Object.keys(headers).some(key =&gt; pattern.test(<span style=color:#a5d6ff>`</span><span style=color:#a5d6ff>${</span>key<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>: </span><span style=color:#a5d6ff>${</span>headers[key]<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>))
</span></span><span style=display:flex><span>      ),
</span></span><span style=display:flex><span>      suspiciousHeaders<span style=color:#ff7b72;font-weight:700>:</span> Object.keys(headers).filter(key =&gt;
</span></span><span style=display:flex><span>        suspiciousHeaders.some(pattern =&gt; pattern.test(<span style=color:#a5d6ff>`</span><span style=color:#a5d6ff>${</span>key<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>: </span><span style=color:#a5d6ff>${</span>headers[key]<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>))
</span></span><span style=display:flex><span>      )
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=é˜²æŠ¤ç­–ç•¥ä¸æ¶æ„>é˜²æŠ¤ç­–ç•¥ä¸æ¶æ„<a hidden class=anchor aria-hidden=true href=#é˜²æŠ¤ç­–ç•¥ä¸æ¶æ„>#</a></h2><h3 id=å¤šå±‚é˜²æŠ¤æ¶æ„>å¤šå±‚é˜²æŠ¤æ¶æ„<a hidden class=anchor aria-hidden=true href=#å¤šå±‚é˜²æŠ¤æ¶æ„>#</a></h3><p>æ„å»ºå®Œæ•´çš„DDoSé˜²æŠ¤ä½“ç³»ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">80
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8b949e;font-style:italic># DDoSé˜²æŠ¤æ¶æ„é…ç½®</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>ddos_protection</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>layers</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#8b949e;font-style:italic># ç¬¬ä¸€å±‚ï¼šç½‘ç»œè¾¹ç•Œé˜²æŠ¤</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>network_boundary</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>hardware_firewall</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>vendor</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;Cisco ASA&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>features</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>&#34;SYN Flood Protection&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>&#34;UDP Flood Protection&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>&#34;ICMP Rate Limiting&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>&#34;IP Reputation Filtering&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>configuration</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>syn_flood_threshold</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>10000</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>udp_flood_threshold</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>50000</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>icmp_rate_limit</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>1000</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>ddos_mitigation_device</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>vendor</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;Arbors Pravail&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>capabilities</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>&#34;Real-time Traffic Analysis&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>&#34;Behavioral Attack Detection&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>&#34;Automatic Traffic Scrubbing&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>deployment_mode</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;inline&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#8b949e;font-style:italic># ç¬¬äºŒå±‚ï¼šCDNå’Œäº‘é˜²æŠ¤</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>cdn_protection</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>provider</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;Cloudflare&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>services</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#34;DDoS Protection&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#34;Web Application Firewall&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#34;Rate Limiting&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#34;IP Reputation&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>settings</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>security_level</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;high&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>rate_limiting</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>requests_per_minute</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>1000</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>burst_size</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>200</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#8b949e;font-style:italic># ç¬¬ä¸‰å±‚ï¼šåº”ç”¨å±‚é˜²æŠ¤</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>application_layer</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>web_application_firewall</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>rules_engine</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;ModSecurity&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>rule_sets</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>&#34;OWASP Core Rule Set&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>&#34;Custom DDoS Rules&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>custom_rules</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>&#34;Rate limiting by IP&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>&#34;Session-based protection&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>&#34;CAPTCHA integration&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>rate_limiting</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>implementation</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;Redis + Nginx&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>strategies</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>global_rate_limit</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span><span style=color:#7ee787>requests</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>1000</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span><span style=color:#7ee787>window</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>60s</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>per_ip_rate_limit</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span><span style=color:#7ee787>requests</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>100</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span><span style=color:#7ee787>window</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>60s</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>endpoint_rate_limit</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span><span style=color:#7ee787>&#34;/api/v1/users&#34;: </span><span style=color:#a5d6ff>10</span><span style=color:#a5d6ff>/minute</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>            </span><span style=color:#7ee787>&#34;/api/v1/auth&#34;: </span><span style=color:#a5d6ff>5</span><span style=color:#a5d6ff>/minute</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#8b949e;font-style:italic># ç¬¬å››å±‚ï¼šä¸šåŠ¡é€»è¾‘é˜²æŠ¤</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>business_logic</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>anomaly_detection</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>machine_learning_model</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;isolation_forest&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>features</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>&#34;request_rate&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>&#34;session_duration&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>&#34;click_patterns&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>&#34;conversion_rates&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>adaptive_protection</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>auto_scaling</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>min_instances</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>5</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>max_instances</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>50</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>scale_up_threshold</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;cpu &gt; 80% or requests_per_second &gt; 1000&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>scale_down_threshold</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;cpu &lt; 30% for 5 minutes&#34;</span><span style=color:#6e7681>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=æ™ºèƒ½é™æµç®—æ³•>æ™ºèƒ½é™æµç®—æ³•<a hidden class=anchor aria-hidden=true href=#æ™ºèƒ½é™æµç®—æ³•>#</a></h3><p>å®ç°åŠ¨æ€å’Œæ™ºèƒ½çš„é™æµç­–ç•¥ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">165
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">166
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">167
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">168
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">169
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">170
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">171
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">172
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">173
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">174
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">175
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">176
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">177
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">178
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">179
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">180
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">181
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">182
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">183
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">184
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">185
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">186
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">187
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">188
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">189
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">190
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">191
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">192
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">193
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">194
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">195
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">196
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">197
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ™ºèƒ½é™æµç³»ç»Ÿ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>class</span> IntelligentRateLimiter {
</span></span><span style=display:flex><span>  constructor() {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>this</span>.redis <span style=color:#ff7b72;font-weight:700>=</span> require(<span style=color:#a5d6ff>&#39;redis&#39;</span>).createClient();
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>this</span>.limiters <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> Map();
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>this</span>.adaptiveThresholds <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> Map();
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>this</span>.mlModel <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>null</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// åˆå§‹åŒ–æœºå™¨å­¦ä¹ æ¨¡å‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  <span style=color:#ff7b72>async</span> initializeMLModel() {
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ä½¿ç”¨TensorFlow.jsåŠ è½½é¢„è®­ç»ƒæ¨¡å‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>const</span> tf <span style=color:#ff7b72;font-weight:700>=</span> require(<span style=color:#a5d6ff>&#39;@tensorflow/tfjs-node&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>this</span>.mlModel <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> tf.loadLayersModel(<span style=color:#a5d6ff>&#39;file://./models/ddos_detection_model.h5&#39;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// æ»‘åŠ¨çª—å£é™æµå™¨
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  <span style=color:#ff7b72>async</span> slidingWindowRateLimit(key, limit, windowMs) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> now <span style=color:#ff7b72;font-weight:700>=</span> Date.now();
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> windowStart <span style=color:#ff7b72;font-weight:700>=</span> now <span style=color:#ff7b72;font-weight:700>-</span> windowMs;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> pipeline <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.redis.pipeline();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// æ¸…ç†è¿‡æœŸè®°å½•
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    pipeline.zremrangebyscore(key, <span style=color:#a5d6ff>0</span>, windowStart);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// è·å–å½“å‰çª—å£å†…çš„è¯·æ±‚æ•°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    pipeline.zcard(key);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// æ·»åŠ å½“å‰è¯·æ±‚
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    pipeline.zadd(key, now, <span style=color:#a5d6ff>`</span><span style=color:#a5d6ff>${</span>now<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>-</span><span style=color:#a5d6ff>${</span>Math.random()<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// è®¾ç½®è¿‡æœŸæ—¶é—´
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    pipeline.expire(key, Math.ceil(windowMs <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#a5d6ff>1000</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> results <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> pipeline.exec();
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> currentCount <span style=color:#ff7b72;font-weight:700>=</span> results[<span style=color:#a5d6ff>1</span>][<span style=color:#a5d6ff>1</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>      allowed<span style=color:#ff7b72;font-weight:700>:</span> currentCount <span style=color:#ff7b72;font-weight:700>&lt;</span> limit,
</span></span><span style=display:flex><span>      remaining<span style=color:#ff7b72;font-weight:700>:</span> Math.max(<span style=color:#a5d6ff>0</span>, limit <span style=color:#ff7b72;font-weight:700>-</span> currentCount <span style=color:#ff7b72;font-weight:700>-</span> <span style=color:#a5d6ff>1</span>),
</span></span><span style=display:flex><span>      resetTime<span style=color:#ff7b72;font-weight:700>:</span> now <span style=color:#ff7b72;font-weight:700>+</span> windowMs,
</span></span><span style=display:flex><span>      currentCount
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// ä»¤ç‰Œæ¡¶é™æµå™¨
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  <span style=color:#ff7b72>async</span> tokenBucketRateLimit(key, capacity, refillRate) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> now <span style=color:#ff7b72;font-weight:700>=</span> Date.now();
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> script <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>`
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      local key = KEYS[1]
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      local capacity = tonumber(ARGV[1])
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      local tokens = tonumber(ARGV[2])
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      local interval = tonumber(ARGV[3])
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      local now = tonumber(ARGV[4])
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      local bucket = redis.call(&#39;hmget&#39;, key, &#39;tokens&#39;, &#39;last_refill&#39;)
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      local current_tokens = tonumber(bucket[1]) or capacity
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      local last_refill = tonumber(bucket[2]) or now
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      -- è®¡ç®—éœ€è¦è¡¥å……çš„ä»¤ç‰Œæ•°
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      local elapsed = now - last_refill
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      local tokens_to_add = math.floor(elapsed / interval * tokens)
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      current_tokens = math.min(capacity, current_tokens + tokens_to_add)
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      -- æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„ä»¤ç‰Œ
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      if current_tokens &gt;= 1 then
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        current_tokens = current_tokens - 1
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        redis.call(&#39;hmset&#39;, key, &#39;tokens&#39;, current_tokens, &#39;last_refill&#39;, now)
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        redis.call(&#39;expire&#39;, key, math.ceil(capacity / tokens * interval))
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        return {1, current_tokens}
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      else
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        redis.call(&#39;hmset&#39;, key, &#39;tokens&#39;, current_tokens, &#39;last_refill&#39;, now)
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        redis.call(&#39;expire&#39;, key, math.ceil(capacity / tokens * interval))
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        return {0, current_tokens}
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      end
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    `</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> result <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.redis.eval(script, <span style=color:#a5d6ff>1</span>, key, capacity, refillRate, <span style=color:#a5d6ff>1000</span>, now);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>      allowed<span style=color:#ff7b72;font-weight:700>:</span> result[<span style=color:#a5d6ff>0</span>] <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>1</span>,
</span></span><span style=display:flex><span>      remaining<span style=color:#ff7b72;font-weight:700>:</span> result[<span style=color:#a5d6ff>1</span>],
</span></span><span style=display:flex><span>      capacity
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// è‡ªé€‚åº”é™æµå™¨
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  <span style=color:#ff7b72>async</span> adaptiveRateLimit(ip, endpoint, requestData) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> key <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>`adaptive:</span><span style=color:#a5d6ff>${</span>ip<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>:</span><span style=color:#a5d6ff>${</span>endpoint<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// è·å–å†å²æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>const</span> history <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.getRequestHistory(key, <span style=color:#a5d6ff>3600000</span>); <span style=color:#8b949e;font-style:italic>// æœ€è¿‘1å°æ—¶
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ä½¿ç”¨æœºå™¨å­¦ä¹ æ¨¡å‹é¢„æµ‹æ”»å‡»æ¦‚ç‡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>const</span> attackProbability <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.predictAttackProbability(history, requestData);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// æ ¹æ®æ”»å‡»æ¦‚ç‡è°ƒæ•´é™æµé˜ˆå€¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>const</span> baseLimit <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.getBaseLimit(endpoint);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> adaptiveLimit <span style=color:#ff7b72;font-weight:700>=</span> Math.max(<span style=color:#a5d6ff>1</span>, Math.floor(baseLimit <span style=color:#ff7b72;font-weight:700>*</span> (<span style=color:#a5d6ff>1</span> <span style=color:#ff7b72;font-weight:700>-</span> attackProbability)));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    console.log(<span style=color:#a5d6ff>`Attack probability for </span><span style=color:#a5d6ff>${</span>ip<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>: </span><span style=color:#a5d6ff>${</span>attackProbability<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>, adaptive limit: </span><span style=color:#a5d6ff>${</span>adaptiveLimit<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.slidingWindowRateLimit(key, adaptiveLimit, <span style=color:#a5d6ff>60000</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// é¢„æµ‹æ”»å‡»æ¦‚ç‡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  <span style=color:#ff7b72>async</span> predictAttackProbability(history, requestData) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72;font-weight:700>!</span><span style=color:#ff7b72>this</span>.mlModel) {
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// å¦‚æœæ¨¡å‹æœªåŠ è½½ï¼Œä½¿ç”¨ç®€å•çš„å¯å‘å¼è§„åˆ™
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>return</span> <span style=color:#ff7b72>this</span>.heuristicAttackDetection(history, requestData);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> tf <span style=color:#ff7b72;font-weight:700>=</span> require(<span style=color:#a5d6ff>&#39;@tensorflow/tfjs-node&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// æå–ç‰¹å¾
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>const</span> features <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.extractFeatures(history, requestData);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// é¢„æµ‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>const</span> prediction <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.mlModel.predict(tf.tensor2d([features]));
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> probability <span style=color:#ff7b72;font-weight:700>=</span> prediction.dataSync()[<span style=color:#a5d6ff>0</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> probability;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// å¯å‘å¼æ”»å‡»æ£€æµ‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  heuristicAttackDetection(history, requestData) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> recentRequests <span style=color:#ff7b72;font-weight:700>=</span> history.filter(req =&gt; Date.now() <span style=color:#ff7b72;font-weight:700>-</span> req.timestamp <span style=color:#ff7b72;font-weight:700>&lt;</span> <span style=color:#a5d6ff>60000</span>);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> requestRate <span style=color:#ff7b72;font-weight:700>=</span> recentRequests.length;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// æ£€æµ‹å¼‚å¸¸é«˜çš„è¯·æ±‚é€Ÿç‡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>if</span> (requestRate <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>100</span>) <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>0.8</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// æ£€æµ‹å¯ç–‘çš„User-Agent
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72>this</span>.isSuspiciousUserAgent(requestData.userAgent)) <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>0.6</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// æ£€æµ‹å¼‚å¸¸è¯·æ±‚æ¨¡å¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72>this</span>.hasAbnormalPattern(recentRequests)) <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>0.7</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>0.1</span>; <span style=color:#8b949e;font-style:italic>// åŸºç¡€æ”»å‡»æ¦‚ç‡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// æå–ç‰¹å¾ç”¨äºæœºå™¨å­¦ä¹ 
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  extractFeatures(history, requestData) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> recentMinute <span style=color:#ff7b72;font-weight:700>=</span> history.filter(req =&gt; Date.now() <span style=color:#ff7b72;font-weight:700>-</span> req.timestamp <span style=color:#ff7b72;font-weight:700>&lt;</span> <span style=color:#a5d6ff>60000</span>);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> recentHour <span style=color:#ff7b72;font-weight:700>=</span> history.filter(req =&gt; Date.now() <span style=color:#ff7b72;font-weight:700>-</span> req.timestamp <span style=color:#ff7b72;font-weight:700>&lt;</span> <span style=color:#a5d6ff>3600000</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> [
</span></span><span style=display:flex><span>      recentMinute.length <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#a5d6ff>60</span>,                    <span style=color:#8b949e;font-style:italic>// æ¯ç§’è¯·æ±‚æ•°ï¼ˆæœ€è¿‘1åˆ†é’Ÿï¼‰
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      recentHour.length <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#a5d6ff>3600</span>,                    <span style=color:#8b949e;font-style:italic>// æ¯ç§’è¯·æ±‚æ•°ï¼ˆæœ€è¿‘1å°æ—¶ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>this</span>.calculateUniqueIPs(recentHour),         <span style=color:#8b949e;font-style:italic>// å”¯ä¸€IPæ•°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>this</span>.calculateUniqueEndpoints(recentHour),   <span style=color:#8b949e;font-style:italic>// å”¯ä¸€ç«¯ç‚¹æ•°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>this</span>.averageResponseTime(recentMinute),      <span style=color:#8b949e;font-style:italic>// å¹³å‡å“åº”æ—¶é—´
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>this</span>.errorRate(recentMinute),                <span style=color:#8b949e;font-style:italic>// é”™è¯¯ç‡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>this</span>.suspiciousUserAgentRatio(recentMinute), <span style=color:#8b949e;font-style:italic>// å¯ç–‘User-Agentæ¯”ä¾‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>this</span>.requestSizeVariance(recentMinute),      <span style=color:#8b949e;font-style:italic>// è¯·æ±‚å¤§å°æ–¹å·®
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>this</span>.calculateEntropy(recentMinute),         <span style=color:#8b949e;font-style:italic>// è¯·æ±‚ç†µ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>this</span>.calculateBurstiness(recentMinute)       <span style=color:#8b949e;font-style:italic>// è¯·æ±‚çªå‘æ€§
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    ];
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// é›†ç¾¤é™æµå™¨
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  <span style=color:#ff7b72>async</span> clusterRateLimit(key, limit, windowMs) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> nodeId <span style=color:#ff7b72;font-weight:700>=</span> process.env.NODE_ID <span style=color:#ff7b72;font-weight:700>||</span> <span style=color:#a5d6ff>&#39;node1&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> clusterKey <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>`cluster:</span><span style=color:#a5d6ff>${</span>key<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ä½¿ç”¨Redisçš„åŸå­æ“ä½œå®ç°é›†ç¾¤é™æµ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>const</span> script <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>`
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      local key = KEYS[1]
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      local window = tonumber(ARGV[1])
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      local limit = tonumber(ARGV[2])
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      local now = tonumber(ARGV[3])
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      local node_id = ARGV[4]
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      -- æ¸…ç†è¿‡æœŸè®°å½•
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      redis.call(&#39;zremrangebyscore&#39;, key, 0, now - window)
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      -- è·å–å½“å‰è®¡æ•°
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      local current = redis.call(&#39;zcard&#39;, key)
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      -- æ£€æŸ¥æ˜¯å¦è¶…è¿‡é™åˆ¶
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      if current &lt; limit then
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        -- æ·»åŠ å½“å‰è¯·æ±‚è®°å½•
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        redis.call(&#39;zadd&#39;, key, now, node_id .. &#39;:&#39; .. now)
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        redis.call(&#39;expire&#39;, key, math.ceil(window / 1000))
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        return {1, limit - current - 1}
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      else
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        return {0, 0}
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>      end
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    `</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> result <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.redis.eval(script, <span style=color:#a5d6ff>1</span>, clusterKey, windowMs, limit, Date.now(), nodeId);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>      allowed<span style=color:#ff7b72;font-weight:700>:</span> result[<span style=color:#a5d6ff>0</span>] <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>1</span>,
</span></span><span style=display:flex><span>      remaining<span style=color:#ff7b72;font-weight:700>:</span> result[<span style=color:#a5d6ff>1</span>]
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=åº”æ€¥å“åº”æµç¨‹>åº”æ€¥å“åº”æµç¨‹<a hidden class=anchor aria-hidden=true href=#åº”æ€¥å“åº”æµç¨‹>#</a></h2><h3 id=ddosæ”»å‡»åº”æ€¥å“åº”>DDoSæ”»å‡»åº”æ€¥å“åº”<a hidden class=anchor aria-hidden=true href=#ddosæ”»å‡»åº”æ€¥å“åº”>#</a></h3><p>å»ºç«‹å®Œå–„çš„åº”æ€¥å“åº”æœºåˆ¶ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">165
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">166
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">167
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">168
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">169
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">170
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">171
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">172
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">173
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">174
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">175
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">176
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">177
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">178
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">179
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">180
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">181
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">182
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">183
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">184
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">185
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">186
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">187
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">188
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">189
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">190
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">191
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">192
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">193
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">194
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">195
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">196
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">197
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">198
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">199
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">200
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">201
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">202
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">203
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">204
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">205
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">206
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">207
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">208
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">209
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">210
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">211
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">212
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">213
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">214
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">215
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">216
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">217
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">218
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">219
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">220
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">221
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">222
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">223
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">224
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">225
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">226
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">227
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">228
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">229
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">230
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">231
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">232
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">233
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">234
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">235
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">236
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">237
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">238
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">239
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">240
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">241
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">242
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">243
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">244
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">245
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">246
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">247
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">248
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">249
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">250
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">251
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">252
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">253
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">254
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">255
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">256
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">257
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">258
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">259
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">260
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">261
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">262
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">263
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">264
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">265
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">266
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">267
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">268
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">269
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">270
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">271
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">272
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">273
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">274
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">275
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">276
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">277
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">278
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">279
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">280
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">281
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">282
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">283
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">284
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">285
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">286
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">287
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">288
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">289
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">290
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">291
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">292
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// DDoSåº”æ€¥å“åº”ç³»ç»Ÿ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>class</span> DDoSResponseSystem {
</span></span><span style=display:flex><span>  constructor() {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>this</span>.responsePlan <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>      detection<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        alerting<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.setupAlerting(),
</span></span><span style=display:flex><span>        automated_response<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.enableAutomatedResponse()
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      mitigation<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        immediate_actions<span style=color:#ff7b72;font-weight:700>:</span> [
</span></span><span style=display:flex><span>          <span style=color:#a5d6ff>&#39;enable_scrubbing&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a5d6ff>&#39;activate_rate_limiting&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a5d6ff>&#39;block_malicious_ips&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a5d6ff>&#39;enable_captcha&#39;</span>
</span></span><span style=display:flex><span>        ],
</span></span><span style=display:flex><span>        escalation_actions<span style=color:#ff7b72;font-weight:700>:</span> [
</span></span><span style=display:flex><span>          <span style=color:#a5d6ff>&#39;activate_additional_bandwidth&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a5d6ff>&#39;enable_cloudflare_under_attack_mode&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a5d6ff>&#39;contact_ddos_mitigation_provider&#39;</span>
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      recovery<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        post_attack_analysis<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.setupPostAttackAnalysis(),
</span></span><span style=display:flex><span>        system_hardening<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.hardenSystems()
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>this</span>.alertChannels <span style=color:#ff7b72;font-weight:700>=</span> [
</span></span><span style=display:flex><span>      <span style=color:#a5d6ff>&#39;email&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a5d6ff>&#39;slack&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a5d6ff>&#39;sms&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a5d6ff>&#39;webhook&#39;</span>
</span></span><span style=display:flex><span>    ];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>this</span>.mitigationStrategies <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> Map();
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>this</span>.initializeMitigationStrategies();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// è®¾ç½®å‘Šè­¦ç³»ç»Ÿ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  setupAlerting() {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>      thresholds<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// æµé‡é˜ˆå€¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        traffic_increase<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>300</span>,        <span style=color:#8b949e;font-style:italic>// æµé‡å¢é•¿300%
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        request_rate_increase<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>500</span>,   <span style=color:#8b949e;font-style:italic>// è¯·æ±‚ç‡å¢é•¿500%
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// é”™è¯¯ç‡é˜ˆå€¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        error_rate_threshold<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>10</span>,     <span style=color:#8b949e;font-style:italic>// é”™è¯¯ç‡è¶…è¿‡10%
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        response_time_threshold<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>5000</span>, <span style=color:#8b949e;font-style:italic>// å“åº”æ—¶é—´è¶…è¿‡5ç§’
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// è¿æ¥æ•°é˜ˆå€¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        concurrent_connections<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>10000</span>, <span style=color:#8b949e;font-style:italic>// å¹¶å‘è¿æ¥æ•°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        half_open_connections<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>5000</span>   <span style=color:#8b949e;font-style:italic>// åŠè¿æ¥æ•°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      alert_levels<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        info<span style=color:#ff7b72;font-weight:700>:</span> { color<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;#36a64f&#39;</span>, prefix<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;â„¹ï¸&#39;</span> },
</span></span><span style=display:flex><span>        warning<span style=color:#ff7b72;font-weight:700>:</span> { color<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;#ff9500&#39;</span>, prefix<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;âš ï¸&#39;</span> },
</span></span><span style=display:flex><span>        critical<span style=color:#ff7b72;font-weight:700>:</span> { color<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;#ff0000&#39;</span>, prefix<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;ğŸš¨&#39;</span> }
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      cooldown_periods<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        info<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>300000</span>,     <span style=color:#8b949e;font-style:italic>// 5åˆ†é’Ÿ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        warning<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>600000</span>,  <span style=color:#8b949e;font-style:italic>// 10åˆ†é’Ÿ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        critical<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span>       <span style=color:#8b949e;font-style:italic>// ç«‹å³
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// æ£€æµ‹åˆ°æ”»å‡»æ—¶çš„å“åº”
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  <span style=color:#ff7b72>async</span> handleAttackDetection(attackData) {
</span></span><span style=display:flex><span>    console.log(<span style=color:#a5d6ff>`DDoS Attack Detected: </span><span style=color:#a5d6ff>${</span>JSON.stringify(attackData)<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// 1. å‘é€å‘Šè­¦
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.sendAlert(<span style=color:#a5d6ff>&#39;critical&#39;</span>, <span style=color:#a5d6ff>&#39;DDoS Attack Detected&#39;</span>, attackData);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// 2. è®°å½•æ”»å‡»ä¿¡æ¯
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.logAttackIncident(attackData);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// 3. ç¡®å®šæ”»å‡»ä¸¥é‡ç¨‹åº¦
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>const</span> severity <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.assessAttackSeverity(attackData);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// 4. æ‰§è¡Œè‡ªåŠ¨ç¼“è§£æªæ–½
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.executeAutomatedMitigation(attackData, severity);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// 5. é€šçŸ¥ç›¸å…³äººå‘˜
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.notifyPersonnel(severity);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// 6. å¼€å§‹ç›‘æ§ç¼“è§£æ•ˆæœ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>this</span>.startMitigationMonitoring(attackData);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// æ‰§è¡Œè‡ªåŠ¨ç¼“è§£æªæ–½
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  <span style=color:#ff7b72>async</span> executeAutomatedMitigation(attackData, severity) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> actions <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.getMitigationActions(severity);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>for</span> (<span style=color:#ff7b72>const</span> action <span style=color:#ff7b72>of</span> actions) {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.executeMitigationAction(action, attackData);
</span></span><span style=display:flex><span>        console.log(<span style=color:#a5d6ff>`Executed mitigation action: </span><span style=color:#a5d6ff>${</span>action.name<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>);
</span></span><span style=display:flex><span>      } <span style=color:#ff7b72>catch</span> (error) {
</span></span><span style=display:flex><span>        console.error(<span style=color:#a5d6ff>`Failed to execute action </span><span style=color:#a5d6ff>${</span>action.name<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>:`</span>, error);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.sendAlert(<span style=color:#a5d6ff>&#39;warning&#39;</span>, <span style=color:#a5d6ff>&#39;Mitigation Action Failed&#39;</span>, {
</span></span><span style=display:flex><span>          action<span style=color:#ff7b72;font-weight:700>:</span> action.name,
</span></span><span style=display:flex><span>          error<span style=color:#ff7b72;font-weight:700>:</span> error.message
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// è·å–ç¼“è§£æªæ–½
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  getMitigationActions(severity) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> baseActions <span style=color:#ff7b72;font-weight:700>=</span> [
</span></span><span style=display:flex><span>      { name<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;enable_rate_limiting&#39;</span>, priority<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>1</span>, delay<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span> },
</span></span><span style=display:flex><span>      { name<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;enable_captcha&#39;</span>, priority<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>2</span>, delay<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>30000</span> },
</span></span><span style=display:flex><span>      { name<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;cache_static_content&#39;</span>, priority<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>3</span>, delay<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span> }
</span></span><span style=display:flex><span>    ];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (severity <span style=color:#ff7b72;font-weight:700>&gt;=</span> <span style=color:#a5d6ff>5</span>) {
</span></span><span style=display:flex><span>      baseActions.push(
</span></span><span style=display:flex><span>        { name<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;block_malicious_ips&#39;</span>, priority<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>1</span>, delay<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span> },
</span></span><span style=display:flex><span>        { name<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;enable_scrubbing&#39;</span>, priority<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>2</span>, delay<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span> },
</span></span><span style=display:flex><span>        { name<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;activate_cloudflare_mode&#39;</span>, priority<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>3</span>, delay<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>60000</span> }
</span></span><span style=display:flex><span>      );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (severity <span style=color:#ff7b72;font-weight:700>&gt;=</span> <span style=color:#a5d6ff>8</span>) {
</span></span><span style=display:flex><span>      baseActions.push(
</span></span><span style=display:flex><span>        { name<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;emergency_bypass_mode&#39;</span>, priority<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>1</span>, delay<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span> },
</span></span><span style=display:flex><span>        { name<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;activate_additional_bandwidth&#39;</span>, priority<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>2</span>, delay<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>30000</span> },
</span></span><span style=display:flex><span>        { name<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;contact_mitigation_provider&#39;</span>, priority<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>3</span>, delay<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>120000</span> }
</span></span><span style=display:flex><span>      );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> baseActions.sort((a, b) =&gt; a.priority <span style=color:#ff7b72;font-weight:700>-</span> b.priority);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// æ‰§è¡Œå…·ä½“çš„ç¼“è§£åŠ¨ä½œ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  <span style=color:#ff7b72>async</span> executeMitigationAction(action, attackData) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>switch</span> (action.name) {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#39;enable_rate_limiting&#39;</span><span style=color:#ff7b72;font-weight:700>:</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.enableRateLimiting(attackData);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#39;block_malicious_ips&#39;</span><span style=color:#ff7b72;font-weight:700>:</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.blockMaliciousIPs(attackData);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#39;enable_captcha&#39;</span><span style=color:#ff7b72;font-weight:700>:</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.enableCaptcha();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#39;activate_cloudflare_mode&#39;</span><span style=color:#ff7b72;font-weight:700>:</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.activateCloudflareUnderAttackMode();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#39;enable_scrubbing&#39;</span><span style=color:#ff7b72;font-weight:700>:</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.enableTrafficScrubbing();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#39;emergency_bypass_mode&#39;</span><span style=color:#ff7b72;font-weight:700>:</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.activateEmergencyBypassMode();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>default</span><span style=color:#ff7b72;font-weight:700>:</span>
</span></span><span style=display:flex><span>        console.warn(<span style=color:#a5d6ff>`Unknown mitigation action: </span><span style=color:#a5d6ff>${</span>action.name<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// è®°å½•æ‰§è¡Œçš„åŠ¨ä½œ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.logMitigationAction(action, attackData);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// å¯ç”¨é€Ÿç‡é™åˆ¶
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  <span style=color:#ff7b72>async</span> enableRateLimiting(attackData) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> rateLimiter <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> IntelligentRateLimiter();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// æ ¹æ®æ”»å‡»ç±»å‹è°ƒæ•´é™æµå‚æ•°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>if</span> (attackData.type <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;HTTP_FLOOD&#39;</span>) {
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// å¯¹æ‰€æœ‰IPå®æ–½ä¸¥æ ¼é™æµ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>await</span> rateLimiter.updateGlobalLimits({
</span></span><span style=display:flex><span>        requests_per_minute<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>1000</span>,
</span></span><span style=display:flex><span>        burst_size<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>200</span>
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    } <span style=color:#ff7b72>else</span> <span style=color:#ff7b72>if</span> (attackData.type <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;SLOWLORIS&#39;</span>) {
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// é™åˆ¶è¿æ¥æŒç»­æ—¶é—´
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.updateConnectionTimeouts({
</span></span><span style=display:flex><span>        client_body_timeout<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>10</span>,
</span></span><span style=display:flex><span>        client_header_timeout<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>10</span>,
</span></span><span style=display:flex><span>        keepalive_timeout<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>10</span>
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// é˜»æ­¢æ¶æ„IP
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  <span style=color:#ff7b72>async</span> blockMaliciousIPs(attackData) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> maliciousIPs <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.identifyMaliciousIPs(attackData);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>for</span> (<span style=color:#ff7b72>const</span> ip <span style=color:#ff7b72>of</span> maliciousIPs) {
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// åœ¨é˜²ç«å¢™ä¸­é˜»æ­¢IP
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.blockIPInFirewall(ip);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// åœ¨åº”ç”¨å±‚é˜»æ­¢IP
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.blockIPInApplication(ip);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// æ·»åŠ åˆ°IPé»‘åå•
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.addToIPBlacklist(ip, <span style=color:#a5d6ff>&#39;DDoS attack&#39;</span>, <span style=color:#a5d6ff>3600</span>); <span style=color:#8b949e;font-style:italic>// 1å°æ—¶
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    console.log(<span style=color:#a5d6ff>`Blocked </span><span style=color:#a5d6ff>${</span>maliciousIPs.length<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff> malicious IPs`</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// æ¿€æ´»Cloudflare Under Attack Mode
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  <span style=color:#ff7b72>async</span> activateCloudflareUnderAttackMode() {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> cloudflareAPI <span style=color:#ff7b72;font-weight:700>=</span> require(<span style=color:#a5d6ff>&#39;cloudflare-api&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// è®¾ç½®å®‰å…¨çº§åˆ«ä¸º &#34;Under Attack&#34;
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>await</span> cloudflareAPI.setSecurityLevel(<span style=color:#a5d6ff>&#39;under_attack&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// å¯ç”¨é«˜çº§DDoSé˜²æŠ¤
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>await</span> cloudflareAPI.enableAdvancedDDoSProtection();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// å¯ç”¨é€Ÿç‡é™åˆ¶
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      <span style=color:#ff7b72>await</span> cloudflareAPI.enableRateLimiting({
</span></span><span style=display:flex><span>        requests_per_minute<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>100</span>,
</span></span><span style=display:flex><span>        burst_size<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>20</span>
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      console.log(<span style=color:#a5d6ff>&#39;Cloudflare Under Attack Mode activated&#39;</span>);
</span></span><span style=display:flex><span>    } <span style=color:#ff7b72>catch</span> (error) {
</span></span><span style=display:flex><span>      console.error(<span style=color:#a5d6ff>&#39;Failed to activate Cloudflare Under Attack Mode:&#39;</span>, error);
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>throw</span> error;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// ç›‘æ§ç¼“è§£æ•ˆæœ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  startMitigationMonitoring(attackData) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> monitoringInterval <span style=color:#ff7b72;font-weight:700>=</span> setInterval(<span style=color:#ff7b72>async</span> () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> currentStatus <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.getCurrentSystemStatus();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> mitigationEffectiveness <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.calculateMitigationEffectiveness(attackData, currentStatus);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> (mitigationEffectiveness.isEffective) {
</span></span><span style=display:flex><span>          console.log(<span style=color:#a5d6ff>&#39;Mitigation is effective, attack is subsiding&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#ff7b72>if</span> (mitigationEffectiveness.attackEnded) {
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic>// æ”»å‡»å·²ç»“æŸï¼Œå¼€å§‹æ¢å¤æµç¨‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>            clearInterval(monitoringInterval);
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.startRecoveryProcess();
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        } <span style=color:#ff7b72>else</span> {
</span></span><span style=display:flex><span>          console.log(<span style=color:#a5d6ff>&#39;Mitigation not effective, escalating response&#39;</span>);
</span></span><span style=display:flex><span>          <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.escalateResponse(attackData, currentStatus);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// å‘é€çŠ¶æ€æ›´æ–°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>this</span>.sendStatusUpdate(mitigationEffectiveness);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      } <span style=color:#ff7b72>catch</span> (error) {
</span></span><span style=display:flex><span>        console.error(<span style=color:#a5d6ff>&#39;Error in mitigation monitoring:&#39;</span>, error);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }, <span style=color:#a5d6ff>30000</span>); <span style=color:#8b949e;font-style:italic>// æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// è®¾ç½®è¶…æ—¶æ¸…ç†
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    setTimeout(() =&gt; {
</span></span><span style=display:flex><span>      clearInterval(monitoringInterval);
</span></span><span style=display:flex><span>      console.log(<span style=color:#a5d6ff>&#39;Mitigation monitoring timeout, stopping monitoring&#39;</span>);
</span></span><span style=display:flex><span>    }, <span style=color:#a5d6ff>3600000</span>); <span style=color:#8b949e;font-style:italic>// 1å°æ—¶ååœæ­¢ç›‘æ§
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// è®¡ç®—ç¼“è§£æ•ˆæœ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  calculateMitigationEffectiveness(attackData, currentStatus) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> initialTraffic <span style=color:#ff7b72;font-weight:700>=</span> attackData.peakTraffic;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> currentTraffic <span style=color:#ff7b72;font-weight:700>=</span> currentStatus.currentTraffic;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> trafficReduction <span style=color:#ff7b72;font-weight:700>=</span> ((initialTraffic <span style=color:#ff7b72;font-weight:700>-</span> currentTraffic) <span style=color:#ff7b72;font-weight:700>/</span> initialTraffic) <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>100</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> initialErrorRate <span style=color:#ff7b72;font-weight:700>=</span> attackData.errorRate <span style=color:#ff7b72;font-weight:700>||</span> <span style=color:#a5d6ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> currentErrorRate <span style=color:#ff7b72;font-weight:700>=</span> currentStatus.errorRate;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> errorRateImprovement <span style=color:#ff7b72;font-weight:700>=</span> initialErrorRate <span style=color:#ff7b72;font-weight:700>-</span> currentErrorRate;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> isEffective <span style=color:#ff7b72;font-weight:700>=</span> trafficReduction <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>50</span> <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> errorRateImprovement <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>5</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> attackEnded <span style=color:#ff7b72;font-weight:700>=</span> currentTraffic <span style=color:#ff7b72;font-weight:700>&lt;</span> (initialTraffic <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>0.2</span>) <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> currentErrorRate <span style=color:#ff7b72;font-weight:700>&lt;</span> <span style=color:#a5d6ff>5</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>      isEffective,
</span></span><span style=display:flex><span>      attackEnded,
</span></span><span style=display:flex><span>      trafficReduction,
</span></span><span style=display:flex><span>      errorRateImprovement,
</span></span><span style=display:flex><span>      currentStatus
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=ç›‘æ§ä¸åˆ†æ>ç›‘æ§ä¸åˆ†æ<a hidden class=anchor aria-hidden=true href=#ç›‘æ§ä¸åˆ†æ>#</a></h2><h3 id=å®æ—¶æ”»å‡»ç›‘æ§>å®æ—¶æ”»å‡»ç›‘æ§<a hidden class=anchor aria-hidden=true href=#å®æ—¶æ”»å‡»ç›‘æ§>#</a></h3><p>å»ºç«‹å…¨é¢çš„DDoSæ”»å‡»ç›‘æ§ä½“ç³»ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">165
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">166
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">167
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">168
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">169
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">170
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">171
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">172
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">173
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">174
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">175
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">176
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">177
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">178
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">179
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">180
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">181
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">182
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">183
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">184
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">185
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">186
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">187
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">188
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">189
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">190
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">191
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">192
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">193
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">194
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">195
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">196
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">197
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">198
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">199
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">200
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">201
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">202
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">203
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">204
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">205
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">206
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">207
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">208
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">209
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">210
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">211
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">212
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">213
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">214
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">215
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">216
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">217
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">218
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">219
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// DDoSæ”»å‡»ç›‘æ§ç³»ç»Ÿ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>class</span> DDoSMonitoringSystem {
</span></span><span style=display:flex><span>  constructor() {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>this</span>.metrics <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>      traffic<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        inbound<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span>,
</span></span><span style=display:flex><span>        outbound<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span>,
</span></span><span style=display:flex><span>        dropped<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      connections<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        total<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span>,
</span></span><span style=display:flex><span>        active<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span>,
</span></span><span style=display:flex><span>        half_open<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      requests<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        total<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span>,
</span></span><span style=display:flex><span>        legitimate<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span>,
</span></span><span style=display:flex><span>        suspicious<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span>,
</span></span><span style=display:flex><span>        blocked<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      attacks<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        ongoing<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span>,
</span></span><span style=display:flex><span>        total_today<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span>,
</span></span><span style=display:flex><span>        mitigated<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>this</span>.alertThresholds <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>      traffic_spike<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>200</span>,        <span style=color:#8b949e;font-style:italic>// æµé‡çªå¢200%
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      error_rate<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>10</span>,            <span style=color:#8b949e;font-style:italic>// é”™è¯¯ç‡è¶…è¿‡10%
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      response_time<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>5000</span>,       <span style=color:#8b949e;font-style:italic>// å“åº”æ—¶é—´è¶…è¿‡5ç§’
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      connection_flood<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>10000</span>    <span style=color:#8b949e;font-style:italic>// è¿æ¥æ•°è¶…è¿‡10000
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>this</span>.startMonitoring();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  startMonitoring() {
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ç›‘æ§ç½‘ç»œæµé‡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>this</span>.monitorNetworkTraffic();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ç›‘æ§åº”ç”¨æŒ‡æ ‡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>this</span>.monitorApplicationMetrics();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ç›‘æ§ç³»ç»Ÿèµ„æº
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>this</span>.monitorSystemResources();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ç›‘æ§æ”»å‡»æ¨¡å¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>this</span>.monitorAttackPatterns();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// ç›‘æ§ç½‘ç»œæµé‡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  monitorNetworkTraffic() {
</span></span><span style=display:flex><span>    setInterval(() =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>this</span>.collectNetworkMetrics()
</span></span><span style=display:flex><span>        .then(metrics =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#ff7b72>this</span>.metrics.traffic <span style=color:#ff7b72;font-weight:700>=</span> metrics;
</span></span><span style=display:flex><span>          <span style=color:#ff7b72>this</span>.analyzeTrafficPatterns(metrics);
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        .<span style=color:#ff7b72>catch</span>(error =&gt; {
</span></span><span style=display:flex><span>          console.error(<span style=color:#a5d6ff>&#39;Error collecting network metrics:&#39;</span>, error);
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    }, <span style=color:#a5d6ff>5000</span>); <span style=color:#8b949e;font-style:italic>// æ¯5ç§’æ”¶é›†ä¸€æ¬¡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// ç›‘æ§åº”ç”¨æŒ‡æ ‡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  monitorApplicationMetrics() {
</span></span><span style=display:flex><span>    setInterval(() =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>this</span>.collectApplicationMetrics()
</span></span><span style=display:flex><span>        .then(metrics =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#ff7b72>this</span>.metrics.requests <span style=color:#ff7b72;font-weight:700>=</span> metrics;
</span></span><span style=display:flex><span>          <span style=color:#ff7b72>this</span>.analyzeRequestPatterns(metrics);
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        .<span style=color:#ff7b72>catch</span>(error =&gt; {
</span></span><span style=display:flex><span>          console.error(<span style=color:#a5d6ff>&#39;Error collecting application metrics:&#39;</span>, error);
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    }, <span style=color:#a5d6ff>2000</span>); <span style=color:#8b949e;font-style:italic>// æ¯2ç§’æ”¶é›†ä¸€æ¬¡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// åˆ†ææµé‡æ¨¡å¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  analyzeTrafficPatterns(trafficMetrics) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> baseline <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.getTrafficBaseline();
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> currentTraffic <span style=color:#ff7b72;font-weight:700>=</span> trafficMetrics.inbound;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> spikePercentage <span style=color:#ff7b72;font-weight:700>=</span> ((currentTraffic <span style=color:#ff7b72;font-weight:700>-</span> baseline) <span style=color:#ff7b72;font-weight:700>/</span> baseline) <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>100</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (spikePercentage <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#ff7b72>this</span>.alertThresholds.traffic_spike) {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>this</span>.triggerAlert(<span style=color:#a5d6ff>&#39;TRAFFIC_SPIKE&#39;</span>, {
</span></span><span style=display:flex><span>        current<span style=color:#ff7b72;font-weight:700>:</span> currentTraffic,
</span></span><span style=display:flex><span>        baseline<span style=color:#ff7b72;font-weight:700>:</span> baseline,
</span></span><span style=display:flex><span>        spike<span style=color:#ff7b72;font-weight:700>:</span> spikePercentage
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// æ£€æµ‹æµé‡å¼‚å¸¸æ¨¡å¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>this</span>.detectTrafficAnomalies(trafficMetrics);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// æ£€æµ‹æµé‡å¼‚å¸¸
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  detectTrafficAnomalies(trafficMetrics) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> recentTraffic <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.getRecentTrafficHistory(<span style=color:#a5d6ff>300000</span>); <span style=color:#8b949e;font-style:italic>// æœ€è¿‘5åˆ†é’Ÿ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ä½¿ç”¨ç»Ÿè®¡æ–¹æ³•æ£€æµ‹å¼‚å¸¸
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>const</span> mean <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.calculateMean(recentTraffic);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> stdDev <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.calculateStandardDeviation(recentTraffic, mean);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> current <span style=color:#ff7b72;font-weight:700>=</span> trafficMetrics.inbound;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// å¦‚æœå½“å‰æµé‡è¶…å‡º3ä¸ªæ ‡å‡†å·®ï¼Œè®¤ä¸ºæ˜¯å¼‚å¸¸
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>if</span> (Math.abs(current <span style=color:#ff7b72;font-weight:700>-</span> mean) <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>3</span> <span style=color:#ff7b72;font-weight:700>*</span> stdDev) {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>this</span>.triggerAlert(<span style=color:#a5d6ff>&#39;TRAFFIC_ANOMALY&#39;</span>, {
</span></span><span style=display:flex><span>        current<span style=color:#ff7b72;font-weight:700>:</span> current,
</span></span><span style=display:flex><span>        mean<span style=color:#ff7b72;font-weight:700>:</span> mean,
</span></span><span style=display:flex><span>        standardDeviation<span style=color:#ff7b72;font-weight:700>:</span> stdDev,
</span></span><span style=display:flex><span>        zScore<span style=color:#ff7b72;font-weight:700>:</span> (current <span style=color:#ff7b72;font-weight:700>-</span> mean) <span style=color:#ff7b72;font-weight:700>/</span> stdDev
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// ç”Ÿæˆå®æ—¶ä»ªè¡¨æ¿æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  getDashboardData() {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>      overview<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        totalRequests<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.metrics.requests.total,
</span></span><span style=display:flex><span>        blockedRequests<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.metrics.requests.blocked,
</span></span><span style=display:flex><span>        attackStatus<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.metrics.attacks.ongoing <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span> <span style=color:#ff7b72;font-weight:700>?</span> <span style=color:#a5d6ff>&#39;under_attack&#39;</span> <span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;normal&#39;</span>,
</span></span><span style=display:flex><span>        systemLoad<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.getSystemLoadPercentage()
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      traffic<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        inbound<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.metrics.traffic.inbound,
</span></span><span style=display:flex><span>        outbound<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.metrics.traffic.outbound,
</span></span><span style=display:flex><span>        dropped<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.metrics.traffic.dropped,
</span></span><span style=display:flex><span>        chart<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.getTrafficChartData()
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      attacks<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        ongoing<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.metrics.attacks.ongoing,
</span></span><span style=display:flex><span>        today<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.metrics.attacks.total_today,
</span></span><span style=display:flex><span>        mitigated<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.metrics.attacks.mitigated,
</span></span><span style=display:flex><span>        recent<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.getRecentAttacks()
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      performance<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        averageResponseTime<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.getAverageResponseTime(),
</span></span><span style=display:flex><span>        errorRate<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.getErrorRate(),
</span></span><span style=display:flex><span>        throughput<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.getThroughput()
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      topAttackers<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.getTopAttackers(),
</span></span><span style=display:flex><span>      blockedIPs<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>this</span>.getBlockedIPs()
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// è·å–æµé‡å›¾è¡¨æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  getTrafficChartData() {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> now <span style=color:#ff7b72;font-weight:700>=</span> Date.now();
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> timeRange <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>3600000</span>; <span style=color:#8b949e;font-style:italic>// æœ€è¿‘1å°æ—¶
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>const</span> interval <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>60000</span>;    <span style=color:#8b949e;font-style:italic>// 1åˆ†é’Ÿé—´éš”
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> data <span style=color:#ff7b72;font-weight:700>=</span> [];
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>for</span> (<span style=color:#ff7b72>let</span> i <span style=color:#ff7b72;font-weight:700>=</span> timeRange; i <span style=color:#ff7b72;font-weight:700>&gt;=</span> <span style=color:#a5d6ff>0</span>; i <span style=color:#ff7b72;font-weight:700>-=</span> interval) {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>const</span> timestamp <span style=color:#ff7b72;font-weight:700>=</span> now <span style=color:#ff7b72;font-weight:700>-</span> i;
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>const</span> traffic <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.getTrafficAtTimestamp(timestamp);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      data.push({
</span></span><span style=display:flex><span>        timestamp<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>new</span> Date(timestamp),
</span></span><span style=display:flex><span>        inbound<span style=color:#ff7b72;font-weight:700>:</span> traffic.inbound,
</span></span><span style=display:flex><span>        outbound<span style=color:#ff7b72;font-weight:700>:</span> traffic.outbound,
</span></span><span style=display:flex><span>        legitimate<span style=color:#ff7b72;font-weight:700>:</span> traffic.legitimate,
</span></span><span style=display:flex><span>        malicious<span style=color:#ff7b72;font-weight:700>:</span> traffic.malicious
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> data;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// è·å–æœ€è¿‘çš„æ”»å‡»è®°å½•
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  getRecentAttacks() {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> <span style=color:#ff7b72>this</span>.recentAttacks
</span></span><span style=display:flex><span>      .filter(attack =&gt; Date.now() <span style=color:#ff7b72;font-weight:700>-</span> attack.startTime <span style=color:#ff7b72;font-weight:700>&lt;</span> <span style=color:#a5d6ff>86400000</span>) <span style=color:#8b949e;font-style:italic>// æœ€è¿‘24å°æ—¶
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      .map(attack =&gt; ({
</span></span><span style=display:flex><span>        id<span style=color:#ff7b72;font-weight:700>:</span> attack.id,
</span></span><span style=display:flex><span>        type<span style=color:#ff7b72;font-weight:700>:</span> attack.type,
</span></span><span style=display:flex><span>        severity<span style=color:#ff7b72;font-weight:700>:</span> attack.severity,
</span></span><span style=display:flex><span>        startTime<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>new</span> Date(attack.startTime),
</span></span><span style=display:flex><span>        duration<span style=color:#ff7b72;font-weight:700>:</span> attack.endTime <span style=color:#ff7b72;font-weight:700>?</span> attack.endTime <span style=color:#ff7b72;font-weight:700>-</span> attack.startTime <span style=color:#ff7b72;font-weight:700>:</span> Date.now() <span style=color:#ff7b72;font-weight:700>-</span> attack.startTime,
</span></span><span style=display:flex><span>        peakTraffic<span style=color:#ff7b72;font-weight:700>:</span> attack.peakTraffic,
</span></span><span style=display:flex><span>        status<span style=color:#ff7b72;font-weight:700>:</span> attack.status
</span></span><span style=display:flex><span>      }))
</span></span><span style=display:flex><span>      .sort((a, b) =&gt; b.startTime <span style=color:#ff7b72;font-weight:700>-</span> a.startTime)
</span></span><span style=display:flex><span>      .slice(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>10</span>); <span style=color:#8b949e;font-style:italic>// æœ€è¿‘10æ¬¡æ”»å‡»
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// è·å–é¡¶çº§æ”»å‡»è€…IP
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  getTopAttackers() {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> ipStats <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>.getIPStatistics();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> Object.entries(ipStats)
</span></span><span style=display:flex><span>      .map(([ip, stats]) =&gt; ({
</span></span><span style=display:flex><span>        ip<span style=color:#ff7b72;font-weight:700>:</span> ip,
</span></span><span style=display:flex><span>        requests<span style=color:#ff7b72;font-weight:700>:</span> stats.total,
</span></span><span style=display:flex><span>        blocked<span style=color:#ff7b72;font-weight:700>:</span> stats.blocked,
</span></span><span style=display:flex><span>        suspiciousScore<span style=color:#ff7b72;font-weight:700>:</span> stats.suspiciousScore,
</span></span><span style=display:flex><span>        country<span style=color:#ff7b72;font-weight:700>:</span> stats.country,
</span></span><span style=display:flex><span>        lastSeen<span style=color:#ff7b72;font-weight:700>:</span> stats.lastSeen
</span></span><span style=display:flex><span>      }))
</span></span><span style=display:flex><span>      .sort((a, b) =&gt; b.suspiciousScore <span style=color:#ff7b72;font-weight:700>-</span> a.suspiciousScore)
</span></span><span style=display:flex><span>      .slice(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>20</span>); <span style=color:#8b949e;font-style:italic>// å‰20ä¸ªå¯ç–‘IP
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// è·å–è¢«é˜»æ­¢çš„IPåˆ—è¡¨
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  getBlockedIPs() {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> <span style=color:#ff7b72>this</span>.blockedIPs
</span></span><span style=display:flex><span>      .map(ip =&gt; ({
</span></span><span style=display:flex><span>        address<span style=color:#ff7b72;font-weight:700>:</span> ip.address,
</span></span><span style=display:flex><span>        reason<span style=color:#ff7b72;font-weight:700>:</span> ip.reason,
</span></span><span style=display:flex><span>        blockedAt<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>new</span> Date(ip.blockedAt),
</span></span><span style=display:flex><span>        expiresAt<span style=color:#ff7b72;font-weight:700>:</span> ip.expiresAt <span style=color:#ff7b72;font-weight:700>?</span> <span style=color:#ff7b72>new</span> Date(ip.expiresAt) <span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#79c0ff>null</span>,
</span></span><span style=display:flex><span>        blockedRequests<span style=color:#ff7b72;font-weight:700>:</span> ip.blockedRequests
</span></span><span style=display:flex><span>      }))
</span></span><span style=display:flex><span>      .filter(ip =&gt; <span style=color:#ff7b72;font-weight:700>!</span>ip.expiresAt <span style=color:#ff7b72;font-weight:700>||</span> ip.expiresAt <span style=color:#ff7b72;font-weight:700>&gt;</span> Date.now())
</span></span><span style=display:flex><span>      .sort((a, b) =&gt; b.blockedAt <span style=color:#ff7b72;font-weight:700>-</span> a.blockedAt);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=æ€»ç»“>æ€»ç»“<a hidden class=anchor aria-hidden=true href=#æ€»ç»“>#</a></h2><p>DDoSé˜²æŠ¤æ˜¯ä¸€ä¸ªå¤šå±‚æ¬¡ã€æŒç»­è¿›åŒ–çš„å®‰å…¨é¢†åŸŸã€‚é€šè¿‡æ„å»ºå®Œæ•´çš„é˜²æŠ¤ä½“ç³»ï¼š</p><ol><li><strong>æ£€æµ‹èƒ½åŠ›</strong>ï¼šå®æ—¶ç›‘æ§å’Œæ™ºèƒ½è¯†åˆ«å„ç§DDoSæ”»å‡»æ¨¡å¼</li><li><strong>é˜²æŠ¤ç­–ç•¥</strong>ï¼šç½‘ç»œå±‚ã€åº”ç”¨å±‚å’Œä¸šåŠ¡å±‚çš„å¤šå±‚é˜²æŠ¤æœºåˆ¶</li><li><strong>åº”æ€¥å“åº”</strong>ï¼šè‡ªåŠ¨åŒ–å’Œäººå·¥ç›¸ç»“åˆçš„å¿«é€Ÿå“åº”æµç¨‹</li><li><strong>æŒç»­æ”¹è¿›</strong>ï¼šåŸºäºå†å²æ•°æ®çš„é˜²æŠ¤ç­–ç•¥ä¼˜åŒ–</li></ol><p>è®°ä½ï¼ŒDDoSé˜²æŠ¤ä¸æ˜¯ä¸€æ¬¡æ€§çš„éƒ¨ç½²ï¼Œè€Œæ˜¯ä¸€ä¸ªæŒç»­å¯¹æŠ—å’Œä¼˜åŒ–çš„è¿‡ç¨‹ã€‚åªæœ‰é€šè¿‡æŠ€æœ¯ã€æµç¨‹å’Œäººå‘˜çš„æœ‰æœºç»“åˆï¼Œæ‰èƒ½æ„å»ºçœŸæ­£æœ‰æ•ˆçš„DDoSé˜²æŠ¤ä½“ç³»ï¼Œä¿æŠ¤ä¸šåŠ¡çš„è¿ç»­æ€§å’Œå¯ç”¨æ€§ã€‚</p></div><footer class=post-footer-modern><div class=post-tags-modern><span class=tags-label>ğŸ·ï¸ æ ‡ç­¾</span><div class=tags-list><a href=/blog/tags/ddos%E9%98%B2%E6%8A%A4/ class=tag-pill>DDoSé˜²æŠ¤
</a><a href=/blog/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/ class=tag-pill>ç½‘ç»œå®‰å…¨
</a><a href=/blog/tags/ddos%E6%94%BB%E5%87%BB/ class=tag-pill>DDoSæ”»å‡»
</a><a href=/blog/tags/web%E5%AE%89%E5%85%A8/ class=tag-pill>Webå®‰å…¨
</a><a href=/blog/tags/%E9%98%B2%E6%8A%A4%E7%AD%96%E7%95%A5/ class=tag-pill>é˜²æŠ¤ç­–ç•¥</a></div></div><style>.post-footer-modern{margin-top:3rem;padding-top:2rem;border-top:1px solid var(--border,#333333)}.post-tags-modern{display:flex;align-items:center;gap:1rem;margin-bottom:2rem;flex-wrap:wrap}.tags-label{font-size:.875rem;font-weight:600;color:var(--secondary,#999999) !important;white-space:nowrap}.tags-list{display:flex;flex-wrap:wrap;gap:.5rem;flex:1}.tag-pill{display:inline-block;padding:.25rem .75rem;background:rgba(255,255,255,5%);border:1px solid var(--border,#333333);border-radius:0;color:var(--secondary,#cccccc) !important;text-decoration:none;font-size:.8rem;font-weight:500;transition:all .2s ease}.tag-pill:hover{background:var(--primary,#ffffff);color:var(--background,#000000) !important;border-color:var(--primary,#ffffff);transform:translateY(-1px)}.post-nav-modern{margin-top:2rem}.nav-grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.nav-card{display:flex;align-items:center;gap:1rem;padding:1.25rem;background:rgba(255,255,255,2%);border:1px solid var(--border,#333333);border-radius:12px;text-decoration:none;transition:all .2s ease;min-height:80px}.nav-card:hover{background:rgba(255,255,255,5%);border-color:var(--primary,#ffffff);transform:translateY(-2px)}.nav-card.nav-prev{justify-content:flex-start}.nav-card.nav-next{justify-content:flex-end;text-align:right}.nav-card.nav-next .nav-content{text-align:right}.nav-empty{display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,1%);border:1px dashed var(--border,#333333);color:var(--secondary,#666666)}.nav-arrow{font-size:1.5rem;color:var(--primary,#ffffff);font-weight:300}.nav-content{flex:1}.nav-title{font-size:.95rem;font-weight:600;color:var(--primary,#ffffff) !important;line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}[data-theme=light] .post-footer-modern{border-color:var(--border-light,#dee2e6)}[data-theme=light] .tags-label{color:var(--secondary-light,#6c757d) !important}[data-theme=light] .tag-pill{background:rgba(0,0,0,5%);border-color:var(--border-light,#dee2e6);color:var(--secondary-light,#495057) !important}[data-theme=light] .tag-pill:hover{background:var(--primary-light,#0066cc);color:var(--background-light,#ffffff) !important;border-color:var(--primary-light,#0066cc)}[data-theme=light] .nav-card{background:rgba(0,0,0,2%);border-color:var(--border-light,#dee2e6)}[data-theme=light] .nav-card:hover{background:rgba(0,102,204,5%);border-color:var(--primary-light,#0066cc)}[data-theme=light] .nav-empty{background:rgba(0,0,0,1%);border-color:var(--border-light,#dee2e6);color:var(--secondary-light,#6c757d)}[data-theme=light] .nav-arrow{color:var(--primary-light,#0066cc)}[data-theme=light] .nav-title{color:var(--primary-light,#212529) !important}@media(max-width:768px){.nav-grid{grid-template-columns:1fr;gap:.75rem}.nav-card{padding:1rem;min-height:70px}.nav-card.nav-next{text-align:left}.nav-card.nav-next .nav-content{text-align:left}.nav-title{font-size:.875rem}.post-tags-modern{flex-direction:column;gap:.75rem}}@media(max-width:480px){.nav-arrow{font-size:1.25rem}.nav-card{padding:.875rem}.nav-title{font-size:.8rem;-webkit-line-clamp:1}}</style><nav class=post-nav-modern><div class=nav-grid><a href=/blog/articles/%E5%AE%B9%E5%99%A8%E9%83%A8%E7%BD%B2%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E4%BB%8Edocker%E5%88%B0kubernetes%E7%9A%84%E5%AE%8C%E6%95%B4%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97/ class="nav-card nav-prev"><div class=nav-arrow>â†</div><div class=nav-content><div class=nav-title>å®¹å™¨éƒ¨ç½²æœ€ä½³å®è·µï¼šä»Dockeråˆ°Kubernetesçš„å®Œæ•´éƒ¨ç½²æŒ‡å—</div></div></a><a href=/blog/articles/%E7%8E%B0%E4%BB%A3%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E8%87%AA%E5%8A%A8%E5%8C%96%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%99%BA%E8%83%BD%E8%BF%90%E7%BB%B4%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/ class="nav-card nav-next"><div class=nav-content><div class=nav-title>ç°ä»£æœåŠ¡å™¨è¿ç»´å®Œå…¨æŒ‡å—ï¼šè‡ªåŠ¨åŒ–ç›‘æ§ä¸æ™ºèƒ½è¿ç»´æœ€ä½³å®è·µ</div></div><div class=nav-arrow>â†’</div></a></div></nav></footer></main><aside class=post-sidebar><div class=sidebar-toc id=sidebar-toc><div class=toc-header><div class=toc-title>ç›®å½•</div><button class=toc-toggle id=toc-toggle aria-label="Toggle TOC">
<svg class="toc-toggle-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18M6 6l12 12"/></svg></button></div><div class=toc-content id=toc-content><ul class=toc-list><li class="toc-item toc-h2"><a href=#h2-0 class=toc-item-link><span class=toc-item-text>DDoSæ”»å‡»ç±»å‹ä¸åŸç†</span></a></li><li class="toc-item toc-h2"><a href=#h2-1 class=toc-item-link><span class=toc-item-text>é˜²æŠ¤ç­–ç•¥ä¸æ¶æ„</span></a></li><li class="toc-item toc-h2"><a href=#h2-2 class=toc-item-link><span class=toc-item-text>åº”æ€¥å“åº”æµç¨‹</span></a></li><li class="toc-item toc-h2"><a href=#h2-3 class=toc-item-link><span class=toc-item-text>ç›‘æ§ä¸åˆ†æ</span></a></li><li class="toc-item toc-h2"><a href=#h2-4 class=toc-item-link><span class=toc-item-text>æ€»ç»“</span></a></li></ul></div></div><script>document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("sidebar-toc"),t=document.getElementById("toc-toggle"),o=document.getElementById("toc-content"),i=t?.querySelector(".toc-toggle-icon");if(!e)return;let n=!1;t&&t.addEventListener("click",function(){n=!n,n?(o.style.display="none",e.style.width="auto",i.innerHTML='<path d="M9 18l6-6-6-6"/>'):(o.style.display="block",e.style.width="200px",i.innerHTML='<path d="M18 6L6 18M6 6l12 12"/>')});const s=document.querySelector(".post-content");if(s){const e=s.querySelectorAll("h1");e.forEach((e,t)=>{e.id=`h1-${t}`});const t=s.querySelectorAll("h2");t.forEach((e,t)=>{e.id=`h2-${t}`})}const a=document.querySelectorAll(".toc-item-link");a.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const n=this.getAttribute("href").substring(1),t=document.getElementById(n);if(t){const e=document.querySelector(".post-header-main")?.offsetHeight||0,n=t.offsetTop-e-20;window.scrollTo({top:n,behavior:"smooth"})}})})})</script><style>.sidebar-toc{position:sticky;top:2rem;width:200px;background:#fff;border:1px solid #e5e7eb;border-radius:4px;overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,.1);z-index:100}.sidebar-toc.hidden{display:none}.toc-header{padding:12px 16px;border-bottom:1px solid #e5e7eb;background:#fafbfc;display:flex;align-items:center;justify-content:space-between}.toc-title{margin:0;font-size:13px;font-weight:500;color:#374151 !important;font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,sans-serif;text-transform:uppercase;letter-spacing:1px}.toc-toggle{background:0 0;border:none;cursor:pointer;padding:4px;border-radius:4px;display:flex;align-items:center;justify-content:center;transition:all .2s ease;color:#6b7280}.toc-toggle:hover{background:#e5e7eb;color:#374151}.toc-toggle-icon{transition:transform .2s ease}.toc-content{padding:12px 0}.toc-list{list-style:none;margin:0;padding:0}.toc-item{margin-bottom:4px;display:block !important;visibility:visible !important}.toc-h1,.toc-h2{display:block !important}.toc-h2{margin-left:0}.toc-item-link{display:flex;align-items:center;gap:8px;padding:8px 12px;color:#374151 !important;text-decoration:none;font-size:13px;line-height:1.4;border-radius:3px;transition:all .2s ease;font-weight:400}.toc-item-link:hover{background:#f8fafc;color:#1f2937 !important}.toc-item-link.active{background:#e0f2fe;color:#01579b !important;font-weight:500}.toc-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}.dot-red{background:#ef4444}.dot-blue{background:#2196f3}.toc-item-text{color:#1f2937 !important;font-weight:400;flex:1;display:inline !important;visibility:visible !important;opacity:1 !important;font-size:13px !important;line-height:1.4 !important}.toc-item-link .toc-item-text{color:#1f2937 !important;display:inline !important;visibility:visible !important;opacity:1 !important}.toc-item.active .dot-red{background:#d32f2f}.toc-item.active .dot-blue{background:#1976d2}[data-theme=dark] .sidebar-toc{background:#1f2937;border-color:#374151;box-shadow:0 1px 3px rgba(0,0,0,.3)}[data-theme=dark] .toc-header{background:#111827;border-color:#374151}[data-theme=dark] .toc-title{color:#f3f4f6 !important}[data-theme=dark] .toc-toggle{color:#9ca3af}[data-theme=dark] .toc-toggle:hover{background:#374151;color:#f3f4f6}[data-theme=dark] .toc-item-link{color:#e5e7eb !important}[data-theme=dark] .toc-item-link:hover{background:#374151;color:#f9fafb !important}[data-theme=dark] .toc-item-link.active{background:#0d47a1;color:#fff !important}[data-theme=dark] .toc-item-text{color:#f9fafb !important;display:inline !important;visibility:visible !important;opacity:1 !important}[data-theme=dark] .toc-item-link .toc-item-text{color:#f9fafb !important;display:inline !important;visibility:visible !important;opacity:1 !important}@media(max-width:1024px){.sidebar-toc{display:none}.post-content-wrapper{grid-template-columns:1fr !important;padding:0 1rem !important}}</style><style>.post-content-wrapper{display:grid;grid-template-columns:1fr 200px;gap:2rem;padding:0 2rem;max-width:100%}.post-content-main{min-width:0}.post-sidebar{position:sticky;top:2rem;height:fit-content;min-width:0}.post-header-main{margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid var(--border,#333333)}.post-header-main .post-title{color:var(--primary,#ffffff) !important;font-size:2.5rem;font-weight:700;line-height:1.2;margin-bottom:1rem}.post-header-main .post-description{color:var(--secondary,#cccccc) !important;font-size:1.1rem;line-height:1.6;margin-bottom:1rem}.post-header-main .post-meta{margin-bottom:0}@media(max-width:1024px){.post-content-wrapper{grid-template-columns:1fr !important;gap:1rem;padding:0 1rem !important}.post-sidebar{display:none}}@media(max-width:768px){.post-header-main .post-title{font-size:2rem}.post-header-main .post-description{font-size:1rem}}</style></aside></div></article></main><footer class=footer><span>Â© 2024-2025 æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢</span> Â·</footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>