import{r as s,p as j,q as re,c as n,a as e,y as p,F as B,k as U,h as i,v as u,t as a,P as se,x as le,j as de,o as d,E as ne,d as T,n as ae,U as ie}from"./DEsTSaKd.js";import{c as ue}from"./3IwUeceH.js";import{t as be}from"./B-fbZyPE.js";import{_ as ce}from"./C71nLTaj.js";import"./D4g1_bQ7.js";import"./B03HrVNV.js";import"./4T928kbW.js";import"./wERbHxDK.js";import"./DESX2TF9.js";import"./b4Up8kzW.js";import"./DbWJs76d.js";import"./BuCd20m7.js";import"./C-LEKrTT.js";import"./Bluep4Ee.js";const me={class:"max-w-8xl mx-auto"},pe={class:"flex flex-wrap gap-2 mb-8"},ve=["onClick"],ge={key:0,class:"space-y-6"},ye={class:"border border-border rounded-lg p-6"},xe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},fe=["disabled"],he={key:0,class:"mt-6 grid grid-cols-1 lg:grid-cols-2 gap-6"},ke={class:"border border-border rounded-lg p-6"},Se={class:"space-y-4"},Me={class:"flex gap-4"},_e=["disabled"],Ce=["disabled"],we={key:0},Be={key:1,class:"space-y-6"},Ue={class:"border border-border rounded-lg p-6"},Ee={class:"space-y-4"},Ae={class:"mt-2 text-sm text-muted-foreground"},Fe={class:"flex gap-4"},Te=["disabled"],Re={key:0},Ve={class:"p-4 border border-border rounded-lg bg-muted/50"},Ke={class:"font-mono text-lg break-all"},Ie={class:"mt-2 flex gap-2"},je={class:"border border-border rounded-lg p-6"},ze={class:"space-y-4"},Le=["disabled"],Ye={key:0,class:"overflow-x-auto"},Ne={class:"w-full text-sm border border-border"},De={class:"border border-border px-4 py-2 max-w-xs truncate"},Pe={class:"border border-border px-4 py-2 font-mono text-xs"},Ge={class:"border border-border px-4 py-2"},$e=["onClick"],He={key:2,class:"space-y-6"},Oe={class:"border border-border rounded-lg p-6"},qe={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},Qe={class:"flex gap-2"},Je={class:"mt-2 text-xs text-muted-foreground"},We={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Ze={class:"flex gap-4 mt-6"},Xe=["disabled"],et=["disabled"],tt={class:"border border-border rounded-lg p-6"},ot={class:"space-y-4"},rt={key:0},st={class:"text-sm text-muted-foreground"},lt={class:"text-sm text-muted-foreground"},dt=["disabled"],nt={class:"border border-border rounded-lg p-6 mb-8"},at={class:"space-y-6"},it={class:"font-medium text-primary mb-2"},ut={class:"text-sm text-muted-foreground mb-2"},bt={class:"text-sm space-y-1"},ct={class:"space-y-4"},mt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},At={__name:"gmsm-tools",setup(pt){ue.find(r=>r.id==="crypto");const R=[{id:"sm2",name:"SM2",description:"基于椭圆曲线的非对称加密算法，用于数字签名、密钥交换和加密",standard:"GM/T 0003-2012",usage:"数字签名、密钥协商、数据加密",strength:"256位安全强度，等效3072位RSA"},{id:"sm3",name:"SM3",description:"密码杂凑算法，输出256位哈希值，用于数据完整性验证",standard:"GM/T 0004-2012",usage:"数字签名、消息认证、随机数生成",strength:"256位输出，抗碰撞攻击"},{id:"sm4",name:"SM4",description:"分组密码算法，128位密钥和分组长度，用于数据加密",standard:"GM/T 0002-2012",usage:"数据加密、文件加密、通信加密",strength:"128位密钥，等效AES-128"}],f=s("sm2"),V=s(!0),c=s(""),b=s(""),_=s(""),h=s(""),v=s(""),g=s(""),m=s(""),C=s(""),w=s([]),l=s(""),E=s("ECB"),k=s(""),S=s(""),A=s(null),F=s(""),K=s(""),z=s(null),L=be.filter(r=>r.category==="crypto"&&r.id!=="gmsm-tools").slice(0,4),Y=r=>r>=1e4?`${(r/1e4).toFixed(1)}w+`:r>=1e3?`${(r/1e3).toFixed(1)}k+`:`${r}`,N=()=>{c.value=`-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAEEVs/o5+UWQc0k8nhzfVFSBfV3YKY
nnvUj1vC5g6TqAVg+oUpH8mM3INN0FfjWcBOtKX7/kK3EtK842RjiFGKkVvQ==
-----END PUBLIC KEY-----`,b.value=`-----BEGIN PRIVATE KEY-----
MIGTAgEAMBMGByqGSM49AgEGCCqBHM9VAYItBHkwdwIBAQQgpJYo7qFjzCEi7uY
TeMGmlCp7hDZZfKpzlHcbFrkKCgCgYIKoEcz1UBgi2hRANCAARFW7+jflRZHJJP
I4c31RUgX1d2CmJ571I9bwuYOk6gFYPqFKR/JjNyDRdBX41nATrSl+/5KtxLSvO
NkY4hRipFb0
-----END PRIVATE KEY-----`,_.value=c.value},D=()=>{if(!_.value||!h.value){alert("请输入公钥和要加密的数据");return}const r=btoa(h.value+"||encrypted||"+Date.now());v.value=r},P=()=>{if(!b.value||!v.value){alert("请输入私钥和加密数据");return}try{const r=atob(v.value).split("||encrypted||")[0];h.value=r,alert("解密成功")}catch{alert("解密失败，请检查私钥和密文")}},G=()=>{if(!c.value||!b.value)return;const r=new Blob([c.value],{type:"text/plain"}),t=URL.createObjectURL(r),o=document.createElement("a");o.href=t,o.download=`sm2_public_${Date.now()}.pem`,o.click(),URL.revokeObjectURL(t);const M=new Blob([b.value],{type:"text/plain"}),y=URL.createObjectURL(M),x=document.createElement("a");x.href=y,x.download=`sm2_private_${Date.now()}.pem`,x.click(),URL.revokeObjectURL(y)},$=async()=>{if(!g.value)return;const t=new TextEncoder().encode(g.value+"SM3"),o=await crypto.subtle.digest("SHA-256",t),y=Array.from(new Uint8Array(o)).map(x=>x.toString(16).padStart(2,"0")).join("");m.value=y},H=async()=>{if(!C.value)return;const r=C.value.split(`
`).filter(o=>o.trim()),t=[];for(const o of r)if(o.trim()){const y=new TextEncoder().encode(o.trim()+"SM3"),x=await crypto.subtle.digest("SHA-256",y),te=Array.from(new Uint8Array(x)).map(oe=>oe.toString(16).padStart(2,"0")).join("");t.push({input:o.trim(),hash:te})}w.value=t},O=()=>{g.value="",m.value="",w.value=[]},q=()=>{const r=new Uint8Array(16);crypto.getRandomValues(r),l.value=Array.from(r,t=>t.toString(16).padStart(2,"0")).join("")},Q=()=>{if(!l.value||l.value.length!==16||!k.value){alert("请输入16字节密钥和要加密的数据");return}const r=btoa(`SM4_${E.value}_`+k.value+"_"+Date.now());S.value=r},J=()=>{if(!l.value||l.value.length!==16||!S.value){alert("请输入16字节密钥和加密数据");return}try{const r=atob(S.value);if(r.startsWith("SM4_")){const t=r.split("_");k.value=t.slice(2,-1).join("_"),alert("解密成功")}else alert("无效的加密数据")}catch{alert("解密失败")}},W=r=>{const t=r.target.files[0];t&&(A.value=t,F.value=t.name,K.value=Z(t.size))},Z=r=>r<1024?r+" B":r<1024*1024?(r/1024).toFixed(2)+" KB":(r/(1024*1024)).toFixed(2)+" MB",X=()=>{if(!A.value||!l.value||l.value.length!==16){alert("请选择文件并输入16字节密钥");return}alert("文件加密功能需要后端支持，当前仅为演示")},I=async r=>{try{await navigator.clipboard.writeText(r),alert("已复制到剪贴板")}catch(t){console.error("复制失败:",t)}},ee=r=>{const t=`/tools/${r.id}/`;ie(t),j(r.id)};return j("gmsm-tools"),re({title:"国密算法工具箱 - SM2/SM3/SM4在线工具",description:"免费在线国密算法工具集，支持SM2非对称加密、SM3哈希、SM4对称加密等中国商用密码算法。",keywords:["国密","SM2","SM3","SM4","商用密码","GM/T"]}),(r,t)=>(d(),n("div",me,[t[39]||(t[39]=e("div",{class:"mt-4 mb-8"},[e("h1",{class:"text-3xl font-bold mb-3"},"国密算法工具箱"),e("p",{class:"text-muted-foreground max-w-3xl"},"中国国家密码算法（SM系列）在线工具集，包括SM2、SM3、SM4等商用密码算法，满足国内密码应用需求。")],-1)),e("div",pe,[(d(),n(B,null,U(R,o=>e("button",{key:o.id,onClick:M=>f.value=o.id,class:ne(["px-4 py-2 rounded-lg transition-colors",{"bg-primary text-primary-foreground":f.value===o.id,"bg-muted text-muted-foreground hover:bg-muted/80":f.value!==o.id}])},a(o.name),11,ve)),64))]),f.value==="sm2"?(d(),n("div",ge,[e("div",ye,[t[15]||(t[15]=e("h3",{class:"text-lg font-semibold mb-4"},"SM2密钥对生成",-1)),e("div",xe,[e("button",{onClick:N,class:"px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"}," 生成SM2密钥对 "),e("button",{onClick:G,disabled:!c.value||!b.value,class:"px-6 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80 transition-colors disabled:opacity-50"}," 下载密钥文件 ",8,fe)]),c.value||b.value?(d(),n("div",he,[e("div",null,[t[13]||(t[13]=e("label",{class:"text-sm font-medium mb-2 block"},"SM2公钥",-1)),i(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=o=>c.value=o),readonly:"",class:"w-full h-32 p-3 border border-border rounded-lg bg-muted/50 font-mono text-xs"},null,512),[[u,c.value]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"text-sm font-medium mb-2 block"},"SM2私钥",-1)),i(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=o=>b.value=o),readonly:"",class:"w-full h-32 p-3 border border-border rounded-lg bg-muted/50 font-mono text-xs"},null,512),[[u,b.value]])])])):p("",!0)]),e("div",ke,[t[19]||(t[19]=e("h3",{class:"text-lg font-semibold mb-4"},"SM2加密/解密",-1)),e("div",Se,[e("div",null,[t[16]||(t[16]=e("label",{class:"text-sm font-medium mb-2 block"},"公钥（加密用）",-1)),i(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=o=>_.value=o),placeholder:"输入PEM格式的SM2公钥",class:"w-full h-24 p-3 border border-border rounded-lg bg-background font-mono text-sm"},null,512),[[u,_.value]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"text-sm font-medium mb-2 block"},"原始数据",-1)),i(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=o=>h.value=o),placeholder:"输入要加密的数据...",class:"w-full h-32 p-3 border border-border rounded-lg bg-background resize-none"},null,512),[[u,h.value]])]),e("div",Me,[e("button",{onClick:D,disabled:!_.value||!h.value,class:"px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50"}," SM2加密 ",8,_e),e("button",{onClick:P,disabled:!b.value||!v.value,class:"px-6 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80 disabled:opacity-50"}," SM2解密 ",8,Ce)]),v.value?(d(),n("div",we,[t[18]||(t[18]=e("label",{class:"text-sm font-medium mb-2 block"},"加密结果（Base64）",-1)),i(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=o=>v.value=o),readonly:"",class:"w-full h-32 p-3 border border-border rounded-lg bg-muted/50 font-mono text-sm"},null,512),[[u,v.value]])])):p("",!0)])])])):p("",!0),f.value==="sm3"?(d(),n("div",Be,[e("div",Ue,[t[22]||(t[22]=e("h3",{class:"text-lg font-semibold mb-4"},"SM3哈希计算",-1)),e("div",Ee,[e("div",null,[t[20]||(t[20]=e("label",{class:"text-sm font-medium mb-2 block"},"输入数据",-1)),i(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=o=>g.value=o),placeholder:"输入要计算SM3哈希的数据...",class:"w-full h-32 p-3 border border-border rounded-lg bg-background resize-none"},null,512),[[u,g.value]]),e("div",Ae," 长度："+a(g.value.length)+" 字符 ",1)]),e("div",Fe,[e("button",{onClick:$,disabled:!g.value,class:"px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50"}," 计算SM3哈希 ",8,Te),e("button",{onClick:O,class:"px-6 py-2 border border-border rounded-lg hover:bg-muted"}," 清空 ")]),m.value?(d(),n("div",Re,[t[21]||(t[21]=e("label",{class:"text-sm font-medium mb-2 block"},"SM3哈希值（256位/64字符）",-1)),e("div",Ve,[e("div",Ke,a(m.value),1)]),e("div",Ie,[e("button",{onClick:t[6]||(t[6]=o=>I(m.value)),class:"px-3 py-1 text-sm bg-primary/10 text-primary rounded-md hover:bg-primary/20"}," 复制 "),e("button",{onClick:t[7]||(t[7]=o=>m.value=V.value?m.value.toUpperCase():m.value.toLowerCase()),class:"px-3 py-1 text-sm bg-secondary/10 text-secondary-foreground rounded-md hover:bg-secondary/20"},a(V.value?"转小写":"转大写"),1)])])):p("",!0)])]),e("div",je,[t[25]||(t[25]=e("h3",{class:"text-lg font-semibold mb-4"},"批量SM3计算",-1)),e("div",ze,[e("div",null,[t[23]||(t[23]=e("label",{class:"text-sm font-medium mb-2 block"},"批量输入（每行一条）",-1)),i(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=o=>C.value=o),placeholder:"输入多条数据，每行一条...",class:"w-full h-32 p-3 border border-border rounded-lg bg-background resize-none"},null,512),[[u,C.value]])]),e("button",{onClick:H,disabled:!C.value,class:"px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50"}," 批量计算 ",8,Le),w.value.length>0?(d(),n("div",Ye,[e("table",Ne,[t[24]||(t[24]=e("thead",{class:"bg-muted/50"},[e("tr",null,[e("th",{class:"border border-border px-4 py-2"},"输入"),e("th",{class:"border border-border px-4 py-2"},"SM3哈希"),e("th",{class:"border border-border px-4 py-2"},"操作")])],-1)),e("tbody",null,[(d(!0),n(B,null,U(w.value,(o,M)=>(d(),n("tr",{key:M,class:"border-b border-border"},[e("td",De,a(o.input),1),e("td",Pe,a(o.hash.substring(0,20))+"...",1),e("td",Ge,[e("button",{onClick:y=>I(o.hash),class:"text-primary hover:text-primary/80"}," 复制 ",8,$e)])]))),128))])])])):p("",!0)])])])):p("",!0),f.value==="sm4"?(d(),n("div",He,[e("div",Oe,[t[31]||(t[31]=e("h3",{class:"text-lg font-semibold mb-4"},"SM4加密/解密",-1)),e("div",qe,[e("div",null,[t[26]||(t[26]=e("label",{class:"text-sm font-medium mb-2 block"},"密钥（128位/16字节）",-1)),e("div",Qe,[i(e("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>l.value=o),type:"password",placeholder:"输入16字节密钥",class:"flex-1 px-3 py-2 border border-border rounded-lg bg-background"},null,512),[[u,l.value]]),e("button",{onClick:q,class:"px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80"}," 生成 ")]),e("div",Je," 密钥长度："+a(l.value.length)+" 字节 (需要16字节) ",1)]),e("div",null,[t[28]||(t[28]=e("label",{class:"text-sm font-medium mb-2 block"},"工作模式",-1)),i(e("select",{"onUpdate:modelValue":t[10]||(t[10]=o=>E.value=o),class:"w-full px-3 py-2 border border-border rounded-lg bg-background"},[...t[27]||(t[27]=[le('<option value="ECB">ECB (电子密码本)</option><option value="CBC">CBC (密码块链接)</option><option value="CFB">CFB (密码反馈)</option><option value="OFB">OFB (输出反馈)</option><option value="CTR">CTR (计数器)</option>',5)])],512),[[se,E.value]])])]),e("div",We,[e("div",null,[t[29]||(t[29]=e("label",{class:"text-sm font-medium mb-2 block"},"原始数据",-1)),i(e("textarea",{"onUpdate:modelValue":t[11]||(t[11]=o=>k.value=o),placeholder:"输入要加密的数据...",class:"w-full h-32 p-3 border border-border rounded-lg bg-background resize-none"},null,512),[[u,k.value]])]),e("div",null,[t[30]||(t[30]=e("label",{class:"text-sm font-medium mb-2 block"},"加密结果（Base64）",-1)),i(e("textarea",{"onUpdate:modelValue":t[12]||(t[12]=o=>S.value=o),placeholder:"加密结果...",class:"w-full h-32 p-3 border border-border rounded-lg bg-muted/50 resize-none",readonly:""},null,512),[[u,S.value]])])]),e("div",Ze,[e("button",{onClick:Q,disabled:!l.value||l.value.length!==16||!k.value,class:"px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50"}," SM4加密 ",8,Xe),e("button",{onClick:J,disabled:!l.value||l.value.length!==16||!S.value,class:"px-6 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80 disabled:opacity-50"}," SM4解密 ",8,et)])]),e("div",tt,[t[33]||(t[33]=e("h3",{class:"text-lg font-semibold mb-4"},"SM4文件加密",-1)),e("div",ot,[e("div",null,[t[32]||(t[32]=e("label",{class:"text-sm font-medium mb-2 block"},"选择文件",-1)),e("input",{type:"file",ref_key:"sm4FileInput",ref:z,onChange:W,class:"w-full px-3 py-2 border border-border rounded-lg bg-background"},null,544)]),F.value?(d(),n("div",rt,[e("p",st,"已选择文件："+a(F.value),1),e("p",lt,"文件大小："+a(K.value),1)])):p("",!0),e("button",{onClick:X,disabled:!A.value||!l.value||l.value.length!==16,class:"px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 disabled:opacity-50"}," 加密文件 ",8,dt)])])])):p("",!0),e("div",nt,[t[37]||(t[37]=e("h3",{class:"text-lg font-semibold mb-4"},"国密算法介绍",-1)),e("div",at,[(d(),n(B,null,U(R,o=>e("div",{key:o.id,class:"border-l-2 border-primary pl-4"},[e("h4",it,a(o.name),1),e("p",ut,a(o.description),1),e("div",bt,[e("div",null,[t[34]||(t[34]=e("strong",null,"标准编号：",-1)),T(a(o.standard),1)]),e("div",null,[t[35]||(t[35]=e("strong",null,"主要用途：",-1)),T(a(o.usage),1)]),e("div",null,[t[36]||(t[36]=e("strong",null,"安全强度：",-1)),T(a(o.strength),1)])])])),64))])]),e("div",ct,[t[38]||(t[38]=e("h3",{class:"text-lg font-semibold"},"相关工具",-1)),e("div",mt,[(d(!0),n(B,null,U(de(L),o=>(d(),ae(ce,{key:o.id,tool:o,title:o.name,description:o.description,category:o.category,"usage-count":Y(o.viewCount),icon:o.icon,onSelect:ee},null,8,["tool","title","description","category","usage-count","icon"]))),128))])])]))}};export{At as default};
