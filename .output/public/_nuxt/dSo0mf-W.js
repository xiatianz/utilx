import{r as i,e as E,p as T,q as j,c as b,a as o,y,x as w,h as m,P as C,d as k,t as v,v as S,F as X,k as Z,o as g,n as z,U as W}from"./DEsTSaKd.js";import{c as q}from"./3IwUeceH.js";import{t as J}from"./B-fbZyPE.js";import{_ as Q}from"./C71nLTaj.js";import{C as l}from"./JCzq_naB.js";import"./D4g1_bQ7.js";import"./B03HrVNV.js";import"./4T928kbW.js";import"./wERbHxDK.js";import"./DESX2TF9.js";import"./b4Up8kzW.js";import"./DbWJs76d.js";import"./BuCd20m7.js";import"./C-LEKrTT.js";import"./Bluep4Ee.js";import"./CE1G-McA.js";import"./TDtrdbi3.js";const Y={class:"max-w-8xl mx-auto"},ee={class:"border border-border rounded-lg p-6 mb-8"},oe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},te=["disabled"],se={class:"border border-border rounded-lg p-6 mb-8"},le={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},re={class:"text-sm font-medium mb-2 block"},ne={class:"text-xs text-muted-foreground ml-2"},de={class:"flex gap-2"},ae=["placeholder"],ie={class:"mt-2 text-xs text-muted-foreground"},ue={key:0,class:"text-amber-600 ml-2"},ce={key:0},pe={class:"flex gap-2"},me={class:"mt-2 text-xs text-muted-foreground"},ve={key:0,class:"text-amber-600 ml-2"},ge={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},be={class:"space-y-4"},xe={class:"flex items-center justify-between"},fe={class:"flex items-center gap-2"},ye={class:"flex items-center gap-2 cursor-pointer"},Ce={class:"text-sm text-muted-foreground"},ke={class:"space-y-4"},Se={class:"flex items-center justify-between"},he={class:"flex items-center gap-2"},Be={class:"text-sm text-muted-foreground"},Ee={class:"flex flex-wrap gap-4 mb-8"},we=["disabled"],Ae=["disabled"],_e={key:0,class:"border border-border rounded-lg p-6 mb-8"},Ie={class:"bg-muted/50 rounded-lg p-4"},Ve={class:"whitespace-pre-wrap text-sm"},Te={class:"space-y-4"},Fe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Je={__name:"aes-encrypt",setup(Ue){q.find(t=>t.id==="crypto");const c=i(""),r=i(""),p=i(null),n=i(""),d=i(""),u=i("256"),a=i("CBC"),h=i("PKCS7"),f=i("base64"),F=i(null),B=i("复制"),U=E(()=>J.filter(t=>t.category==="crypto"&&t.id!=="aes-encrypt").slice(0,4)),N=t=>t>=1e4?`${(t/1e4).toFixed(1)}w+`:t>=1e3?`${(t/1e3).toFixed(1)}k+`:`${t}`,A=E(()=>c.value&&n.value&&n.value.length*8===Number(u)&&(a.value==="ECB"||d.value&&d.value.length===16)),_=E(()=>r.value&&n.value&&n.value.length*8===Number(u)&&(a.value==="ECB"||d.value&&d.value.length===16)),$=()=>{const t=Number(u)/8,e=l.lib.WordArray.random(t);n.value=l.enc.Hex.stringify(e)},R=()=>{const t=l.lib.WordArray.random(16);d.value=l.enc.Hex.stringify(t)},O=()=>{try{if(!A.value){alert("请检查密钥和IV设置");return}const t={mode:I(),padding:V()};a.value!=="ECB"&&(t.iv=l.enc.Hex.parse(d.value));const e=l.AES.encrypt(c.value,l.enc.Hex.parse(n.value),t);switch(f.value){case"base64":r.value=e.toString();break;case"hex":r.value=e.ciphertext.toString(l.enc.Hex);break;case"utf8":r.value=e.toString(l.enc.Utf8);break}p.value=null}catch(t){alert("加密失败："+t.message)}},P=()=>{try{if(!_.value){alert("请检查密钥和IV设置");return}const t={mode:I(),padding:V()};a.value!=="ECB"&&(t.iv=l.enc.Hex.parse(d.value));const e=l.AES.decrypt(r.value,l.enc.Hex.parse(n.value),t);p.value=e.toString(l.enc.Utf8),p.value||alert("解密失败，可能是密钥或IV不正确")}catch(t){alert("解密失败："+t.message)}},I=()=>({CBC:l.mode.CBC,ECB:l.mode.ECB,CFB:l.mode.CFB,OFB:l.mode.OFB,CTR:l.mode.CTR,GCM:l.mode.GCM})[a.value]||l.mode.CBC,V=()=>({PKCS7:l.pad.Pkcs7,ISO97971:l.pad.Iso97971,ANSIX923:l.pad.AnsiX923,ZERO:l.pad.ZeroPadding,NO_PADDING:l.pad.NoPadding})[h.value]||l.pad.Pkcs7,D=async t=>{try{await navigator.clipboard.writeText(t),B.value="已复制",setTimeout(()=>{B.value="复制"},2e3)}catch(e){console.error("复制失败:",e)}},M=()=>{c.value="",r.value="",p.value=null},G=()=>{const t=c.value;c.value=p.value||"",p.value=t},H=()=>{if(!r.value)return;const t=`加密算法: AES-${u}-${a}
密钥: ${n.value}
${a!=="ECB"?`IV: ${d.value}
`:""}加密结果 (${f.value}): ${r.value}
生成时间: ${new Date().toLocaleString()}`,e=new Blob([t],{type:"text/plain"}),s=URL.createObjectURL(e),x=document.createElement("a");x.href=s,x.download=`aes-encrypted-${Date.now()}.txt`,x.click(),URL.revokeObjectURL(s)},K=t=>{const e=t.target.files[0];if(!e)return;const s=new FileReader;s.onload=x=>{c.value=x.target.result},s.readAsText(e)},L=t=>{const e=`/tools/${t.id}/`;W(e),T(t.id)};return T("aes-encrypt"),j({title:"AES加密解密 - 在线AES加密工具",description:"免费在线AES加密解密工具，支持AES-128/192/256，多种工作模式和填充方式。",keywords:["AES","加密","解密","对称加密","AES-256","AES-128"]}),(t,e)=>(g(),b("div",Y,[e[26]||(e[26]=o("div",{class:"mt-4 mb-8"},[o("h1",{class:"text-3xl font-bold mb-3"},"AES加密解密"),o("p",{class:"text-muted-foreground max-w-3xl"},"高级加密标准(AES)在线加密解密工具，支持AES-128、AES-192、AES-256，多种工作模式和填充方式。")],-1)),o("div",ee,[e[17]||(e[17]=o("h3",{class:"text-lg font-semibold mb-4"},"加密设置",-1)),o("div",oe,[o("div",null,[e[10]||(e[10]=o("label",{class:"text-sm font-medium mb-2 block"},"密钥长度",-1)),m(o("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},[...e[9]||(e[9]=[o("option",{value:"128"},"AES-128 (128位)",-1),o("option",{value:"192"},"AES-192 (192位)",-1),o("option",{value:"256"},"AES-256 (256位)",-1)])],512),[[C,u.value]])]),o("div",null,[e[12]||(e[12]=o("label",{class:"text-sm font-medium mb-2 block"},"工作模式",-1)),m(o("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>a.value=s),class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},[...e[11]||(e[11]=[w('<option value="CBC">CBC (密码块链接)</option><option value="ECB">ECB (电子密码本)</option><option value="CFB">CFB (密码反馈)</option><option value="OFB">OFB (输出反馈)</option><option value="CTR">CTR (计数器)</option><option value="GCM">GCM (伽罗瓦计数器)</option>',6)])],512),[[C,a.value]])]),o("div",null,[e[14]||(e[14]=o("label",{class:"text-sm font-medium mb-2 block"},"填充方式",-1)),m(o("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>h.value=s),class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary",disabled:a.value==="CTR"||a.value==="GCM"},[...e[13]||(e[13]=[w('<option value="PKCS7">PKCS7</option><option value="ISO97971">ISO/IEC 9797-1</option><option value="ANSIX923">ANSI X9.23</option><option value="ZERO">Zero Padding</option><option value="NO_PADDING">无填充</option>',5)])],8,te),[[C,h.value]])]),o("div",null,[e[16]||(e[16]=o("label",{class:"text-sm font-medium mb-2 block"},"输出格式",-1)),m(o("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>f.value=s),class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},[...e[15]||(e[15]=[o("option",{value:"base64"},"Base64",-1),o("option",{value:"hex"},"Hex",-1),o("option",{value:"utf8"},"UTF-8",-1)])],512),[[C,f.value]])])])]),o("div",se,[e[20]||(e[20]=o("h3",{class:"text-lg font-semibold mb-4"},"密钥和初始向量",-1)),o("div",le,[o("div",null,[o("label",re,[e[18]||(e[18]=k(" 密钥 ",-1)),o("span",ne,"("+v(u.value/8)+"字节)",1)]),o("div",de,[m(o("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>n.value=s),type:"password",placeholder:`输入${u.value}位密钥`,class:"flex-1 px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},null,8,ae),[[S,n.value]]),o("button",{onClick:$,class:"px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80 transition-colors"}," 生成密钥 ")]),o("div",ie,[k(" 密钥长度："+v(n.value.length*8)+" 位 ",1),n.value.length*8!==Number(u.value)?(g(),b("span",ue," (需要 "+v(u.value)+" 位) ",1)):y("",!0)])]),a.value!=="ECB"?(g(),b("div",ce,[e[19]||(e[19]=o("label",{class:"text-sm font-medium mb-2 block"},[k(" 初始向量 (IV) "),o("span",{class:"text-xs text-muted-foreground ml-2"},"(16字节)")],-1)),o("div",pe,[m(o("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>d.value=s),type:"password",placeholder:"输入16字节初始向量",class:"flex-1 px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},null,512),[[S,d.value]]),o("button",{onClick:R,class:"px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80 transition-colors"}," 生成IV ")]),o("div",me,[k(" IV长度："+v(d.value.length*8)+" 位 ",1),d.value.length!==16?(g(),b("span",ve," (需要 128 位/16 字节) ")):y("",!0)])])):y("",!0)])]),o("div",ge,[o("div",be,[o("div",xe,[e[22]||(e[22]=o("label",{class:"text-lg font-semibold"},"原始文本",-1)),o("div",fe,[o("button",{onClick:M,class:"px-3 py-1 text-sm text-muted-foreground hover:text-foreground transition-colors"}," 清空 "),o("label",ye,[o("input",{type:"file",ref_key:"fileInput",ref:F,onChange:K,class:"hidden"},null,544),e[21]||(e[21]=o("span",{class:"px-3 py-1 text-sm bg-primary/10 text-primary rounded-md hover:bg-primary/20 transition-colors"}," 选择文件 ",-1))])])]),m(o("textarea",{"onUpdate:modelValue":e[6]||(e[6]=s=>c.value=s),placeholder:"请输入要加密的文本...",class:"w-full h-64 p-4 border border-border rounded-lg bg-background resize-none focus:outline-none focus:ring-2 focus:ring-primary"},null,512),[[S,c.value]]),o("div",Ce," 字符数："+v(c.value.length),1)]),o("div",ke,[o("div",Se,[e[23]||(e[23]=o("label",{class:"text-lg font-semibold"},"加密结果",-1)),o("div",he,[o("button",{onClick:e[7]||(e[7]=s=>D(r.value)),class:"px-3 py-1 text-sm bg-primary/10 text-primary rounded-md hover:bg-primary/20 transition-colors"},v(B.value),1),o("button",{onClick:H,class:"px-3 py-1 text-sm bg-secondary/10 text-secondary-foreground rounded-md hover:bg-secondary/20 transition-colors"}," 下载 ")])]),m(o("textarea",{"onUpdate:modelValue":e[8]||(e[8]=s=>r.value=s),placeholder:"加密结果将显示在这里...",readonly:"",class:"w-full h-64 p-4 border border-border rounded-lg bg-muted/50 resize-none font-mono text-sm"},null,512),[[S,r.value]]),o("div",Be," 长度："+v(r.value.length),1)])]),o("div",Ee,[o("button",{onClick:O,disabled:!A.value,class:"px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 加密 ",8,we),o("button",{onClick:P,disabled:!_.value,class:"px-6 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 解密 ",8,Ae),o("button",{onClick:G,class:"px-6 py-2 border border-border rounded-lg hover:bg-muted transition-colors"}," 交换数据 ")]),p.value!==null?(g(),b("div",_e,[e[24]||(e[24]=o("h3",{class:"text-lg font-semibold mb-4"},"解密结果",-1)),o("div",Ie,[o("pre",Ve,v(p.value),1)])])):y("",!0),e[27]||(e[27]=w('<div class="border border-border rounded-lg p-6 mb-8"><h3 class="text-lg font-semibold mb-4">关于AES加密</h3><div class="space-y-4"><div><h4 class="font-medium text-primary mb-2">算法特点</h4><ul class="text-sm space-y-1"><li>• 对称加密算法，加密和解密使用相同的密钥</li><li>• 支持128、192、256位密钥长度</li><li>• 分组加密，块大小固定为128位</li><li>• 安全性高，被美国政府批准用于机密信息的加密</li></ul></div><div><h4 class="font-medium text-primary mb-2">工作模式说明</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"><div><h5 class="font-medium mb-1">CBC模式</h5><p class="text-muted-foreground">每个明文块先与前一个密文块进行异或操作，再加密</p></div><div><h5 class="font-medium mb-1">ECB模式</h5><p class="text-muted-foreground">相同的明文块会产生相同的密文块，安全性较低</p></div><div><h5 class="font-medium mb-1">CTR模式</h5><p class="text-muted-foreground">将计数器加密后与明文异或，无需填充，可并行处理</p></div><div><h5 class="font-medium mb-1">GCM模式</h5><p class="text-muted-foreground">提供认证加密，同时保证机密性和完整性</p></div></div></div><div><h4 class="font-medium text-primary mb-2">安全注意事项</h4><ul class="text-sm space-y-1 text-amber-600"><li>• 密钥必须保密，不要在不安全的通道传输</li><li>• ECB模式不安全，仅用于特殊场景</li><li>• CBC、CFB、OFB模式需要随机且唯一的IV</li><li>• 建议使用GCM模式或带认证的加密方案</li></ul></div></div></div>',1)),o("div",Te,[e[25]||(e[25]=o("h3",{class:"text-lg font-semibold"},"相关工具",-1)),o("div",Fe,[(g(!0),b(X,null,Z(U.value,s=>(g(),z(Q,{key:s.id,tool:s,title:s.name,description:s.description,category:s.category,"usage-count":N(s.viewCount),icon:s.icon,onSelect:L},null,8,["tool","title","description","category","usage-count","icon"]))),128))])])]))}};export{Je as default};
