<!doctype html><html lang=zh-cn dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ç°ä»£æœåŠ¡å™¨è¿ç»´å®Œå…¨æŒ‡å—ï¼šè‡ªåŠ¨åŒ–ç›‘æ§ä¸æ™ºèƒ½è¿ç»´æœ€ä½³å®è·µ | æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·</title><meta name=keywords content="æœåŠ¡å™¨è¿ç»´,DevOps,ç›‘æ§,è‡ªåŠ¨åŒ–,ç³»ç»Ÿç®¡ç†"><meta name=description content="å…¨é¢ä»‹ç»ç°ä»£æœåŠ¡å™¨è¿ç»´çš„æ ¸å¿ƒæŠ€æœ¯å’Œæœ€ä½³å®è·µï¼ŒåŒ…æ‹¬è‡ªåŠ¨åŒ–éƒ¨ç½²ã€ç›‘æ§å‘Šè­¦ã€æ€§èƒ½ä¼˜åŒ–ã€æ•…éšœæ’é™¤å’Œå®‰å…¨åŠ å›ºï¼Œå¸®åŠ©è¿ç»´å›¢é˜Ÿæ„å»ºé«˜æ•ˆã€å¯é çš„æœåŠ¡å™¨ç®¡ç†ä½“ç³»ã€‚"><meta name=author content="util.cn Team"><link rel=canonical href=/blog/articles/%E7%8E%B0%E4%BB%A3%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E8%87%AA%E5%8A%A8%E5%8C%96%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%99%BA%E8%83%BD%E8%BF%90%E7%BB%B4%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.7e8505b7cdf8bb22ab2305e53c2700bb06c7e64faeb72cd3468823a9a3bd3d6e.css integrity="sha256-foUFt834uyKrIwXlPCcAuwbH5k+utyzTRogjqaO9PW4=" rel="preload stylesheet" as=style><link rel=icon href=/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/blog/favicon-32x32.png><link rel=apple-touch-icon href=/blog/apple-touch-icon.png><link rel=mask-icon href=/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=/blog/articles/%E7%8E%B0%E4%BB%A3%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E8%87%AA%E5%8A%A8%E5%8C%96%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%99%BA%E8%83%BD%E8%BF%90%E7%BB%B4%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/feed.xml title=rss><link rel=alternate hreflang=zh-cn href=/blog/articles/%E7%8E%B0%E4%BB%A3%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E8%87%AA%E5%8A%A8%E5%8C%96%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%99%BA%E8%83%BD%E8%BF%90%E7%BB%B4%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><script src=/js/external-link-config.js></script><script src=/js/external-link-interceptor.js></script><link rel=stylesheet href=/blog/css/custom.css media=screen><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«","url":"https://www.util.cn/blog/","description":"æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚æä¾›JSONæ ¼å¼åŒ–ã€SQLä¼˜åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰åœ¨çº¿å·¥å…·çš„è¯¦ç»†ä½¿ç”¨æŒ‡å—ï¼Œå¸®åŠ©å¼€å‘è€…æå‡å·¥ä½œæ•ˆç‡ã€‚","publisher":{"@type":"Organization","name":"æœ‰æ¡å·¥å…·","url":"https://www.util.cn","logo":{"@type":"ImageObject","url":"https://www.util.cn/blog/logo/logo-256.png","width":256,"height":256}},"potentialAction":[{"@type":"SearchAction","target":"https://www.util.cn/blog/search?q={search_term_string}","query-input":"required name=search_term_string"}]}</script><meta property="og:type" content="website"><meta property="og:title" content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«"><meta property="og:description" content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚æä¾›JSONæ ¼å¼åŒ–ã€SQLä¼˜åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰åœ¨çº¿å·¥å…·çš„è¯¦ç»†ä½¿ç”¨æŒ‡å—ï¼Œå¸®åŠ©å¼€å‘è€…æå‡å·¥ä½œæ•ˆç‡ã€‚"><meta property="og:url" content="https://www.util.cn/blog/"><meta property="og:site_name" content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢"><meta property="og:image" content="https://www.util.cn/blog/logo/logo-256.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«"><meta name=twitter:description content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚"><meta name=twitter:image content="https://www.util.cn/blog/logo/logo-256.png"><meta name=baidu-site-verification content><meta name=category content="æŠ€æœ¯åšå®¢,å¼€å‘è€…å·¥å…·,ç¼–ç¨‹æ•™ç¨‹"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=rating content="General"><script id=51la_code async crossorigin=anonymous src="https://sdk.51.la/js-sdk-pro.min.js?id=3OM52V0xJAPv6ozF&hash=pro"></script><script>window.addEventListener("load",function(){setTimeout(function(){typeof la!="undefined"?console.log("51laç»Ÿè®¡å·²åŠ è½½"):(console.warn("51laç»Ÿè®¡åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ"),function(){var e=document.createElement("script");e.src="https://sdk.51.la/js-sdk-pro.min.js?id=3OM52V0xJAPv6ozF&hash=backup",e.async=!0,document.head.appendChild(e)}())},3e3)})</script><meta property="og:url" content="/blog/articles/%E7%8E%B0%E4%BB%A3%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E8%87%AA%E5%8A%A8%E5%8C%96%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%99%BA%E8%83%BD%E8%BF%90%E7%BB%B4%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"><meta property="og:site_name" content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·"><meta property="og:title" content="ç°ä»£æœåŠ¡å™¨è¿ç»´å®Œå…¨æŒ‡å—ï¼šè‡ªåŠ¨åŒ–ç›‘æ§ä¸æ™ºèƒ½è¿ç»´æœ€ä½³å®è·µ"><meta property="og:description" content="å…¨é¢ä»‹ç»ç°ä»£æœåŠ¡å™¨è¿ç»´çš„æ ¸å¿ƒæŠ€æœ¯å’Œæœ€ä½³å®è·µï¼ŒåŒ…æ‹¬è‡ªåŠ¨åŒ–éƒ¨ç½²ã€ç›‘æ§å‘Šè­¦ã€æ€§èƒ½ä¼˜åŒ–ã€æ•…éšœæ’é™¤å’Œå®‰å…¨åŠ å›ºï¼Œå¸®åŠ©è¿ç»´å›¢é˜Ÿæ„å»ºé«˜æ•ˆã€å¯é çš„æœåŠ¡å™¨ç®¡ç†ä½“ç³»ã€‚"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-22T14:00:00+08:00"><meta property="article:modified_time" content="2025-12-22T14:00:00+08:00"><meta property="article:tag" content="æœåŠ¡å™¨è¿ç»´"><meta property="article:tag" content="DevOps"><meta property="article:tag" content="ç›‘æ§"><meta property="article:tag" content="è‡ªåŠ¨åŒ–"><meta property="article:tag" content="ç³»ç»Ÿç®¡ç†"><meta name=twitter:card content="summary"><meta name=twitter:title content="ç°ä»£æœåŠ¡å™¨è¿ç»´å®Œå…¨æŒ‡å—ï¼šè‡ªåŠ¨åŒ–ç›‘æ§ä¸æ™ºèƒ½è¿ç»´æœ€ä½³å®è·µ"><meta name=twitter:description content="å…¨é¢ä»‹ç»ç°ä»£æœåŠ¡å™¨è¿ç»´çš„æ ¸å¿ƒæŠ€æœ¯å’Œæœ€ä½³å®è·µï¼ŒåŒ…æ‹¬è‡ªåŠ¨åŒ–éƒ¨ç½²ã€ç›‘æ§å‘Šè­¦ã€æ€§èƒ½ä¼˜åŒ–ã€æ•…éšœæ’é™¤å’Œå®‰å…¨åŠ å›ºï¼Œå¸®åŠ©è¿ç»´å›¢é˜Ÿæ„å»ºé«˜æ•ˆã€å¯é çš„æœåŠ¡å™¨ç®¡ç†ä½“ç³»ã€‚"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"æ‰€æœ‰æ–‡ç« ","item":"/blog/posts/"},{"@type":"ListItem","position":2,"name":"ç°ä»£æœåŠ¡å™¨è¿ç»´å®Œå…¨æŒ‡å—ï¼šè‡ªåŠ¨åŒ–ç›‘æ§ä¸æ™ºèƒ½è¿ç»´æœ€ä½³å®è·µ","item":"/blog/articles/%E7%8E%B0%E4%BB%A3%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E8%87%AA%E5%8A%A8%E5%8C%96%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%99%BA%E8%83%BD%E8%BF%90%E7%BB%B4%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ç°ä»£æœåŠ¡å™¨è¿ç»´å®Œå…¨æŒ‡å—ï¼šè‡ªåŠ¨åŒ–ç›‘æ§ä¸æ™ºèƒ½è¿ç»´æœ€ä½³å®è·µ","name":"ç°ä»£æœåŠ¡å™¨è¿ç»´å®Œå…¨æŒ‡å—ï¼šè‡ªåŠ¨åŒ–ç›‘æ§ä¸æ™ºèƒ½è¿ç»´æœ€ä½³å®è·µ","description":"å…¨é¢ä»‹ç»ç°ä»£æœåŠ¡å™¨è¿ç»´çš„æ ¸å¿ƒæŠ€æœ¯å’Œæœ€ä½³å®è·µï¼ŒåŒ…æ‹¬è‡ªåŠ¨åŒ–éƒ¨ç½²ã€ç›‘æ§å‘Šè­¦ã€æ€§èƒ½ä¼˜åŒ–ã€æ•…éšœæ’é™¤å’Œå®‰å…¨åŠ å›ºï¼Œå¸®åŠ©è¿ç»´å›¢é˜Ÿæ„å»ºé«˜æ•ˆã€å¯é çš„æœåŠ¡å™¨ç®¡ç†ä½“ç³»ã€‚","keywords":["æœåŠ¡å™¨è¿ç»´","DevOps","ç›‘æ§","è‡ªåŠ¨åŒ–","ç³»ç»Ÿç®¡ç†"],"articleBody":"ç°ä»£æœåŠ¡å™¨è¿ç»´å·²ç»ä»ä¼ ç»Ÿçš„æ‰‹åŠ¨æ“ä½œå‘å±•ä¸ºé«˜åº¦è‡ªåŠ¨åŒ–ã€æ™ºèƒ½åŒ–çš„ç®¡ç†ä½“ç³»ã€‚éšç€äº‘è®¡ç®—å’Œå®¹å™¨åŒ–æŠ€æœ¯çš„æ™®åŠï¼Œè¿ç»´å·¥ç¨‹å¸ˆéœ€è¦æŒæ¡æ›´å…ˆè¿›çš„å·¥å…·å’Œæ–¹æ³•è®ºã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ç°ä»£æœåŠ¡å™¨è¿ç»´çš„å„ä¸ªæ–¹é¢ï¼Œä»åŸºç¡€æ¶æ„åˆ°æ™ºèƒ½è¿ç»´å®è·µã€‚\nè‡ªåŠ¨åŒ–è¿ç»´åŸºç¡€ åŸºç¡€è®¾æ–½å³ä»£ç ï¼ˆIaCï¼‰ ä½¿ç”¨Terraformç®¡ç†åŸºç¡€è®¾æ–½ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 # terraform/main.tf provider \"aws\" { region = var.aws_region } # VPCé…ç½® resource \"aws_vpc\" \"main\" { cidr_block = \"10.0.0.0/16\" enable_dns_support = true enable_dns_hostnames = true tags = { Name = \"main-vpc\" Environment = var.environment ManagedBy = \"terraform\" } } # å…¬æœ‰å­ç½‘ resource \"aws_subnet\" \"public\" { count = length(var.availability_zones) vpc_id = aws_vpc.main.id cidr_block = \"10.0.${count.index + 1}.0/24\" availability_zone = var.availability_zones[count.index] map_public_ip_on_launch = true tags = { Name = \"public-subnet-${count.index + 1}\" Environment = var.environment Type = \"public\" } } # ç§æœ‰å­ç½‘ resource \"aws_subnet\" \"private\" { count = length(var.availability_zones) vpc_id = aws_vpc.main.id cidr_block = \"10.0.${count.index + 101}.0/24\" availability_zone = var.availability_zones[count.index] tags = { Name = \"private-subnet-${count.index + 1}\" Environment = var.environment Type = \"private\" } } # EC2å®ä¾‹é…ç½® resource \"aws_instance\" \"web_server\" { count = var.instance_count ami = var.ami_id instance_type = var.instance_type subnet_id = aws_subnet.private[count.index % length(aws_subnet.private)].id vpc_security_group_ids = [aws_security_group.web_server.id] key_name = var.key_name associate_public_ip_address = false root_block_device { volume_size = 30 volume_type = \"gp3\" delete_on_termination = true encrypted = true } user_data = base64encode(templatefile(\"${path.module}/user_data.sh\", { environment = var.environment region = var.aws_region })) tags = { Name = \"web-server-${count.index + 1}\" Environment = var.environment Role = \"web\" ManagedBy = \"terraform\" } } # è‡ªåŠ¨æ‰©å±•ç»„ resource \"aws_autoscaling_group\" \"web_servers\" { name = \"web-servers-asg\" vpc_zone_identifier = aws_subnet.private[*].id target_group_arns = [aws_lb_target_group.web_servers.arn] health_check_type = \"EC2\" health_check_grace_period = 300 min_size = var.min_instances max_size = var.max_instances desired_capacity = var.desired_instances launch_template { id = aws_launch_template.web_server.id version = \"$Latest\" } tag { key = \"Name\" value = \"web-server\" propagate_at_launch = true } tag { key = \"Environment\" value = var.environment propagate_at_launch = true } } # ç›‘æ§å’Œå‘Šè­¦ resource \"aws_cloudwatch_metric_alarm\" \"cpu_utilization\" { alarm_name = \"web-server-cpu-utilization\" comparison_operator = \"GreaterThanThreshold\" evaluation_periods = \"2\" metric_name = \"CPUUtilization\" namespace = \"AWS/EC2\" period = \"300\" statistic = \"Average\" threshold = \"80\" alarm_description = \"This metric monitors ec2 cpu utilization\" alarm_actions = [aws_sns_topic.alerts.arn] dimensions = { AutoScalingGroupName = aws_autoscaling_group.web_servers.name } tags = { Environment = var.environment } } é…ç½®ç®¡ç† ä½¿ç”¨Ansibleè¿›è¡ŒæœåŠ¡å™¨é…ç½®ç®¡ç†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 # ansible/playbooks/web_server.yml --- - name: Configure Web Servers hosts: webservers become: yes vars: app_user: appuser app_dir: /opt/myapp nginx_worker_processes: \"{{ ansible_processor_cores }}\" nginx_worker_connections: 1024 tasks: - name: Update apt packages apt: update_cache: yes upgrade: dist when: ansible_os_family == \"Debian\" - name: Update yum packages yum: name: \"*\" state: latest when: ansible_os_family == \"RedHat\" - name: Install required packages package: name: - nginx - nodejs - npm - git - htop - fail2ban - ufw state: present - name: Create application user user: name: \"{{ app_user }}\" shell: /bin/bash home: \"{{ app_dir }}\" create_home: yes system: yes - name: Create application directory file: path: \"{{ app_dir }}\" state: directory owner: \"{{ app_user }}\" group: \"{{ app_user }}\" mode: '0755' - name: Configure Nginx template: src: nginx.conf.j2 dest: /etc/nginx/nginx.conf owner: root group: root mode: '0644' notify: restart nginx - name: Configure Nginx site template: src: site.conf.j2 dest: /etc/nginx/sites-available/myapp owner: root group: root mode: '0644' notify: restart nginx - name: Enable Nginx site file: src: /etc/nginx/sites-available/myapp dest: /etc/nginx/sites-enabled/myapp state: link notify: restart nginx - name: Configure firewall ufw: rule: allow name: \"{{ item }}\" loop: - OpenSSH - 'Nginx Full' - name: Set firewall default policy ufw: state: enabled policy: deny - name: Configure fail2ban template: src: jail.local.j2 dest: /etc/fail2ban/jail.local owner: root group: root mode: '0644' notify: restart fail2ban - name: Deploy monitoring script template: src: monitor.sh.j2 dest: \"{{ app_dir }}/monitor.sh\" owner: \"{{ app_user }}\" group: \"{{ app_user }}\" mode: '0755' - name: Setup monitoring cron job cron: name: \"Application monitoring\" job: \"{{ app_dir }}/monitor.sh\" user: \"{{ app_user }}\" minute: \"*/5\" handlers: - name: restart nginx service: name: nginx state: restarted - name: restart fail2ban service: name: fail2ban state: restarted ç›‘æ§ä¸å‘Šè­¦ç³»ç»Ÿ Prometheusç›‘æ§ç³»ç»Ÿ é…ç½®å…¨æ–¹ä½çš„æœåŠ¡å™¨ç›‘æ§ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 # prometheus/prometheus.yml global: scrape_interval: 15s evaluation_interval: 15s rule_files: - \"rules/*.yml\" alerting: alertmanagers: - static_configs: - targets: - alertmanager:9093 scrape_configs: # æœåŠ¡å™¨èŠ‚ç‚¹ç›‘æ§ - job_name: 'node-exporter' static_configs: - targets: - 'server1:9100' - 'server2:9100' - 'server3:9100' scrape_interval: 30s # ç³»ç»ŸæœåŠ¡ç›‘æ§ - job_name: 'systemd-exporter' static_configs: - targets: - 'server1:9551' - 'server2:9551' - 'server3:9551' # MySQLæ•°æ®åº“ç›‘æ§ - job_name: 'mysql-exporter' static_configs: - targets: - 'db1:9104' - 'db2:9104' # Redisç›‘æ§ - job_name: 'redis-exporter' static_configs: - targets: - 'redis1:9121' - 'redis2:9121' # Nginxç›‘æ§ - job_name: 'nginx-exporter' static_configs: - targets: - 'server1:9113' - 'server2:9113' - 'server3:9113' # åº”ç”¨ç›‘æ§ - job_name: 'application' static_configs: - targets: - 'app1:3000' - 'app2:3000' - 'app3:3000' metrics_path: '/metrics' scrape_interval: 10s # å‘Šè­¦è§„åˆ™ # prometheus/rules/server_alerts.yml groups: - name: server_alerts rules: # CPUä½¿ç”¨ç‡å‘Šè­¦ - alert: HighCPUUsage expr: 100 - (avg by(instance) (irate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100) \u003e 80 for: 5m labels: severity: warning annotations: summary: \"High CPU usage on {{ $labels.instance }}\" description: \"CPU usage is above 80% for more than 5 minutes on {{ $labels.instance }}\" # å†…å­˜ä½¿ç”¨ç‡å‘Šè­¦ - alert: HighMemoryUsage expr: (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100 \u003e 90 for: 5m labels: severity: critical annotations: summary: \"High memory usage on {{ $labels.instance }}\" description: \"Memory usage is above 90% for more than 5 minutes on {{ $labels.instance }}\" # ç£ç›˜ç©ºé—´å‘Šè­¦ - alert: DiskSpaceLow expr: (1 - (node_filesystem_avail_bytes / node_filesystem_size_bytes)) * 100 \u003e 85 for: 10m labels: severity: warning annotations: summary: \"Disk space low on {{ $labels.instance }}\" description: \"Disk usage is above 85% on {{ $labels.instance }}:{{ $labels.mountpoint }}\" # ç½‘ç»œè¿æ¥æ•°å‘Šè­¦ - alert: TooManyConnections expr: node_netstat_Tcp_CurrEstab \u003e 10000 for: 5m labels: severity: warning annotations: summary: \"Too many TCP connections on {{ $labels.instance }}\" description: \"TCP connections count is {{ $value }} on {{ $labels.instance }}\" # ç³»ç»Ÿè´Ÿè½½å‘Šè­¦ - alert: HighSystemLoad expr: node_load15 \u003e (2 * node_cpu_cores) for: 5m labels: severity: warning annotations: summary: \"High system load on {{ $labels.instance }}\" description: \"15-minute load average is {{ $value }} on {{ $labels.instance }}\" Grafanaä»ªè¡¨æ¿ åˆ›å»ºç›´è§‚çš„ç›‘æ§ä»ªè¡¨æ¿ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 { \"dashboard\": { \"title\": \"Server Monitoring Dashboard\", \"tags\": [\"server\", \"monitoring\"], \"timezone\": \"browser\", \"panels\": [ { \"title\": \"System Overview\", \"type\": \"stat\", \"gridPos\": {\"h\": 8, \"w\": 12, \"x\": 0, \"y\": 0}, \"targets\": [ { \"expr\": \"up{job=\\\"node-exporter\\\"}\", \"legendFormat\": \"{{ instance }}\" } ], \"fieldConfig\": { \"defaults\": { \"mappings\": [ {\"options\": {\"0\": {\"text\": \"DOWN\", \"color\": \"red\"}}}, {\"options\": {\"1\": {\"text\": \"UP\", \"color\": \"green\"}}} ], \"thresholds\": { \"steps\": [ {\"color\": \"red\", \"value\": null}, {\"color\": \"green\", \"value\": 1} ] } } } }, { \"title\": \"CPU Usage\", \"type\": \"graph\", \"gridPos\": {\"h\": 8, \"w\": 12, \"x\": 12, \"y\": 0}, \"targets\": [ { \"expr\": \"100 - (avg by(instance) (irate(node_cpu_seconds_total{mode=\\\"idle\\\"}[5m])) * 100)\", \"legendFormat\": \"{{ instance }}\" } ], \"yAxes\": [ {\"max\": 100, \"min\": 0, \"unit\": \"percent\"} ] }, { \"title\": \"Memory Usage\", \"type\": \"graph\", \"gridPos\": {\"h\": 8, \"w\": 12, \"x\": 0, \"y\": 8}, \"targets\": [ { \"expr\": \"(1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100\", \"legendFormat\": \"{{ instance }}\" } ], \"yAxes\": [ {\"max\": 100, \"min\": 0, \"unit\": \"percent\"} ] }, { \"title\": \"Disk Usage\", \"type\": \"graph\", \"gridPos\": {\"h\": 8, \"w\": 12, \"x\": 12, \"y\": 8}, \"targets\": [ { \"expr\": \"(1 - (node_filesystem_avail_bytes / node_filesystem_size_bytes)) * 100\", \"legendFormat\": \"{{ instance }}:{{ mountpoint }}\" } ], \"yAxes\": [ {\"max\": 100, \"min\": 0, \"unit\": \"percent\"} ] } ] } } æ—¥å¿—ç®¡ç†ä¸åˆ†æ ELK Stackæ—¥å¿—æ”¶é›† é…ç½®é›†ä¸­å¼æ—¥å¿—ç®¡ç†ç³»ç»Ÿï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 # logstash/pipeline/server_logs.conf input { beats { port =\u003e 5044 } } filter { # è§£æNginxè®¿é—®æ—¥å¿— if [fields][service] == \"nginx\" { grok { match =\u003e { \"message\" =\u003e \"%{NGINXACCESS}\" } } date { match =\u003e [ \"timestamp\", \"dd/MMM/yyyy:HH:mm:ss Z\" ] } geoip { source =\u003e \"client_ip\" target =\u003e \"geoip\" } } # è§£æç³»ç»Ÿæ—¥å¿— if [fields][service] == \"system\" { grok { match =\u003e { \"message\" =\u003e \"%{SYSLOGBASE}\" } } date { match =\u003e [ \"timestamp\", \"MMM d HH:mm:ss\", \"MMM dd HH:mm:ss\" ] } } # è§£æåº”ç”¨æ—¥å¿— if [fields][service] == \"application\" { json { source =\u003e \"message\" } if [level] == \"error\" { mutate { add_tag =\u003e [\"error\"] } } } # æ·»åŠ åœ°ç†ä½ç½®ä¿¡æ¯ if [client_ip] { geoip { source =\u003e \"client_ip\" target =\u003e \"geoip\" } } # æ·»åŠ æ—¶é—´å­—æ®µ mutate { add_field =\u003e { \"log_date\" =\u003e \"%{@timestamp}\" } } } output { elasticsearch { hosts =\u003e [\"elasticsearch:9200\"] index =\u003e \"server-logs-%{+YYYY.MM.dd}\" template_name =\u003e \"server-logs\" template_pattern =\u003e \"server-logs-*\" } # é”™è¯¯æ—¥å¿—å‘Šè­¦ if \"error\" in [tags] { email { to =\u003e \"admin@example.com\" subject =\u003e \"Error Alert: %{[@metadata][beat][name]}\" body =\u003e \"Error occurred on %{[host][name]}: %{[message]}\" } } } è‡ªå®šä¹‰ç›‘æ§è„šæœ¬ ç¼–å†™æœåŠ¡å™¨å¥åº·æ£€æŸ¥è„šæœ¬ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 #!/bin/bash # scripts/server_health_check.sh # é…ç½®å˜é‡ ALERT_EMAIL=\"admin@example.com\" SLACK_WEBHOOK=\"https://hooks.slack.com/services/xxx/yyy/zzz\" LOG_FILE=\"/var/log/health_check.log\" # æ£€æŸ¥å‡½æ•° check_disk_space() { local threshold=85 local usage=$(df -h / | awk 'NR==2 {print $5}' | sed 's/%//') if [ $usage -gt $threshold ]; then send_alert \"Disk space critical\" \"Disk usage is ${usage}% on $(hostname)\" return 1 fi return 0 } check_memory_usage() { local threshold=90 local usage=$(free | awk 'NR==2{printf \"%.0f\", $3*100/$2}') if [ $usage -gt $threshold ]; then send_alert \"Memory usage critical\" \"Memory usage is ${usage}% on $(hostname)\" return 1 fi return 0 } check_cpu_load() { local threshold=$(nproc) local load=$(uptime | awk -F'load average:' '{print $2}' | awk '{print $1}' | sed 's/,//') if (( $(echo \"$load \u003e $threshold\" | bc -l) )); then send_alert \"CPU load critical\" \"CPU load is $load on $(hostname)\" return 1 fi return 0 } check_service_status() { local services=(\"nginx\" \"mysql\" \"redis-server\" \"nodejs\") for service in \"${services[@]}\"; do if ! systemctl is-active --quiet \"$service\"; then send_alert \"Service down\" \"$service is not running on $(hostname)\" return 1 fi done return 0 } check_network_connectivity() { local hosts=(\"8.8.8.8\" \"1.1.1.1\" \"google.com\") for host in \"${hosts[@]}\"; do if ! ping -c 1 -W 5 \"$host\" \u003e /dev/null 2\u003e\u00261; then send_alert \"Network issue\" \"Cannot reach $host from $(hostname)\" return 1 fi done return 0 } check_database_connection() { if ! mysql -e \"SELECT 1\" \u003e /dev/null 2\u003e\u00261; then send_alert \"Database connection failed\" \"Cannot connect to MySQL on $(hostname)\" return 1 fi return 0 } check_ssl_certificates() { local domains=(\"example.com\" \"api.example.com\") local warning_days=30 for domain in \"${domains[@]}\"; do local expiry=$(echo | openssl s_client -servername \"$domain\" -connect \"$domain:443\" 2\u003e/dev/null | openssl x509 -noout -enddate | cut -d= -f2) local expiry_timestamp=$(date -d \"$expiry\" +%s) local current_timestamp=$(date +%s) local days_until_expiry=$(( (expiry_timestamp - current_timestamp) / 86400 )) if [ $days_until_expiry -lt $warning_days ]; then send_alert \"SSL certificate expiring\" \"$domain SSL certificate expires in $days_until_expiry days\" return 1 fi done return 0 } # å‘Šè­¦å‘é€å‡½æ•° send_alert() { local subject=$1 local message=$2 local timestamp=$(date '+%Y-%m-%d %H:%M:%S') # è®°å½•åˆ°æ—¥å¿— echo \"[$timestamp] ALERT: $subject - $message\" \u003e\u003e $LOG_FILE # å‘é€é‚®ä»¶å‘Šè­¦ echo \"$message\" | mail -s \"[SERVER ALERT] $subject\" $ALERT_EMAIL # å‘é€Slackå‘Šè­¦ curl -X POST -H 'Content-type: application/json' \\ --data \"{\\\"text\\\":\\\"ğŸš¨ Server Alert\\n*Subject:* $subject\\n*Message:* $message\\n*Host:* $(hostname)\\n*Time:* $timestamp\\\"}\" \\ $SLACK_WEBHOOK } # ç”Ÿæˆå¥åº·æŠ¥å‘Š generate_health_report() { local report_file=\"/tmp/health_report_$(date +%Y%m%d_%H%M%S).txt\" { echo \"Server Health Report\" echo \"====================\" echo \"Host: $(hostname)\" echo \"Time: $(date)\" echo \"\" echo \"System Information:\" echo \"------------------\" echo \"OS: $(uname -s -r)\" echo \"Uptime: $(uptime -p)\" echo \"Load Average: $(uptime | awk -F'load average:' '{print $2}')\" echo \"\" echo \"Resource Usage:\" echo \"---------------\" echo \"Disk Usage:\" df -h | grep -E '^/dev/' echo \"\" echo \"Memory Usage:\" free -h echo \"\" echo \"CPU Usage:\" top -bn1 | grep \"Cpu(s)\" | awk '{print \"CPU: \" $2}' echo \"\" echo \"Service Status:\" echo \"---------------\" systemctl list-units --type=service --state=running | head -10 echo \"\" echo \"Network Connections:\" echo \"-------------------\" ss -tuln | head -10 echo \"\" echo \"Recent Log Entries:\" echo \"-------------------\" tail -20 /var/log/syslog | grep -i error } \u003e $report_file # å‘é€æŠ¥å‘Š mail -s \"Health Report for $(hostname)\" $ALERT_EMAIL \u003c $report_file # æ¸…ç†ä¸´æ—¶æ–‡ä»¶ rm $report_file } # ä¸»å‡½æ•° main() { echo \"Starting server health check on $(date)\" \u003e\u003e $LOG_FILE local failed_checks=0 # æ‰§è¡Œå„é¡¹æ£€æŸ¥ check_disk_space || ((failed_checks++)) check_memory_usage || ((failed_checks++)) check_cpu_load || ((failed_checks++)) check_service_status || ((failed_checks++)) check_network_connectivity || ((failed_checks++)) check_database_connection || ((failed_checks++)) check_ssl_certificates || ((failed_checks++)) # å¦‚æœæœ‰æ£€æŸ¥å¤±è´¥ï¼Œç”Ÿæˆè¯¦ç»†æŠ¥å‘Š if [ $failed_checks -gt 0 ]; then generate_health_report fi echo \"Health check completed. Failed checks: $failed_checks\" \u003e\u003e $LOG_FILE } # æ‰§è¡Œä¸»å‡½æ•° main \"$@\" æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ ç³»ç»Ÿè°ƒä¼˜ LinuxæœåŠ¡å™¨æ€§èƒ½ä¼˜åŒ–é…ç½®ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 #!/bin/bash # scripts/system_optimization.sh # ç½‘ç»œå‚æ•°ä¼˜åŒ– optimize_network() { echo \"Optimizing network parameters...\" # TCPå‚æ•°è°ƒä¼˜ cat \u003e\u003e /etc/sysctl.conf \u003c\u003c EOF # Network optimization net.core.rmem_max = 16777216 net.core.wmem_max = 16777216 net.ipv4.tcp_rmem = 4096 87380 16777216 net.ipv4.tcp_wmem = 4096 65536 16777216 net.ipv4.tcp_congestion_control = bbr net.core.netdev_max_backlog = 5000 net.ipv4.tcp_max_syn_backlog = 65536 net.ipv4.tcp_fin_timeout = 10 net.ipv4.tcp_keepalive_time = 1200 net.ipv4.tcp_max_tw_buckets = 5000 EOF # åº”ç”¨å‚æ•° sysctl -p echo \"Network optimization completed.\" } # æ–‡ä»¶ç³»ç»Ÿä¼˜åŒ– optimize_filesystem() { echo \"Optimizing filesystem...\" # è°ƒæ•´æ–‡ä»¶æè¿°ç¬¦é™åˆ¶ cat \u003e\u003e /etc/security/limits.conf \u003c\u003c EOF # Increase open files limit * soft nofile 65536 * hard nofile 65536 root soft nofile 65536 root hard nofile 65536 EOF # è°ƒæ•´å†…æ ¸å‚æ•° cat \u003e\u003e /etc/sysctl.conf \u003c\u003c EOF # Filesystem optimization fs.file-max = 2097152 fs.inotify.max_user_watches = 524288 vm.swappiness = 10 vm.dirty_ratio = 15 vm.dirty_background_ratio = 5 EOF sysctl -p echo \"Filesystem optimization completed.\" } # æ•°æ®åº“ä¼˜åŒ– optimize_database() { echo \"Optimizing MySQL configuration...\" cat \u003e\u003e /etc/mysql/mysql.conf.d/mysqld.cnf \u003c\u003c EOF # MySQL performance optimization [mysqld] # Memory settings innodb_buffer_pool_size = 2G innodb_log_file_size = 256M innodb_log_buffer_size = 16M key_buffer_size = 32M max_heap_table_size = 64M tmp_table_size = 64M # Connection settings max_connections = 500 max_connect_errors = 10000 # Query cache query_cache_type = 1 query_cache_size = 64M # Slow query log slow_query_log = 1 slow_query_log_file = /var/log/mysql/slow.log long_query_time = 2 EOF systemctl restart mysql echo \"Database optimization completed.\" } # åº”ç”¨æœåŠ¡å™¨ä¼˜åŒ– optimize_web_server() { echo \"Optimizing Nginx configuration...\" cat \u003e /etc/nginx/nginx.conf \u003c\u003c 'EOF' user nginx; worker_processes auto; worker_rlimit_nofile 65535; events { worker_connections 1024; use epoll; multi_accept on; } http { # Basic settings sendfile on; tcp_nopush on; tcp_nodelay on; keepalive_timeout 65; types_hash_max_size 2048; server_tokens off; # Gzip compression gzip on; gzip_vary on; gzip_min_length 1024; gzip_comp_level 6; gzip_types text/plain text/css text/xml text/javascript application/json application/javascript application/xml+rss application/atom+xml image/svg+xml; # Caching open_file_cache max=10000 inactive=20s; open_file_cache_valid 30s; open_file_cache_min_uses 2; open_file_cache_errors on; # Rate limiting limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s; limit_req_zone $binary_remote_addr zone=login:10m rate=1r/s; include /etc/nginx/conf.d/*.conf; include /etc/nginx/sites-enabled/*; } EOF nginx -t \u0026\u0026 systemctl reload nginx echo \"Web server optimization completed.\" } # æ‰§è¡Œæ‰€æœ‰ä¼˜åŒ– main() { echo \"Starting system optimization...\" optimize_network optimize_filesystem optimize_database optimize_web_server echo \"System optimization completed successfully!\" } main \"$@\" æ•…éšœæ’é™¤ä¸æ¢å¤ è‡ªåŠ¨åŒ–æ•…éšœè¯Šæ–­ æ™ºèƒ½æ•…éšœæ£€æµ‹å’Œè¯Šæ–­ç³»ç»Ÿï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 #!/usr/bin/env python3 # scripts/fault_diagnosis.py import os import subprocess import re import json import time import psutil from datetime import datetime from typing import Dict, List, Tuple class ServerDiagnostic: def __init__(self): self.results = {} self.thresholds = { 'cpu_usage': 80.0, 'memory_usage': 85.0, 'disk_usage': 90.0, 'load_average': 2.0, 'response_time': 5.0 } def diagnose_system(self) -\u003e Dict: \"\"\"æ‰§è¡Œå®Œæ•´çš„ç³»ç»Ÿè¯Šæ–­\"\"\" self.results['timestamp'] = datetime.now().isoformat() self.results['hostname'] = os.uname().nodename # åŸºç¡€ç³»ç»Ÿæ£€æŸ¥ self.results['cpu'] = self.check_cpu() self.results['memory'] = self.check_memory() self.results['disk'] = self.check_disk() self.results['network'] = self.check_network() self.results['processes'] = self.check_processes() self.results['services'] = self.check_services() self.results['logs'] = self.check_logs() # æ€§èƒ½æ£€æŸ¥ self.results['performance'] = self.check_performance() # å®‰å…¨æ£€æŸ¥ self.results['security'] = self.check_security() # ç”Ÿæˆè¯Šæ–­æŠ¥å‘Š self.results['summary'] = self.generate_summary() return self.results def check_cpu(self) -\u003e Dict: \"\"\"æ£€æŸ¥CPUçŠ¶æ€\"\"\" try: cpu_percent = psutil.cpu_percent(interval=1) load_avg = os.getloadavg() cpu_count = psutil.cpu_count() cpu_info = { 'usage_percent': cpu_percent, 'load_average': { '1min': load_avg[0], '5min': load_avg[1], '15min': load_avg[2] }, 'cpu_count': cpu_count, 'per_cpu_usage': psutil.cpu_percent(percpu=True) } # æ£€æŸ¥æ˜¯å¦æœ‰é—®é¢˜ cpu_info['issues'] = [] if cpu_percent \u003e self.thresholds['cpu_usage']: cpu_info['issues'].append(f\"High CPU usage: {cpu_percent}%\") if load_avg[0] \u003e self.thresholds['load_average'] * cpu_count: cpu_info['issues'].append(f\"High load average: {load_avg[0]}\") return cpu_info except Exception as e: return {'error': str(e)} def check_memory(self) -\u003e Dict: \"\"\"æ£€æŸ¥å†…å­˜çŠ¶æ€\"\"\" try: memory = psutil.virtual_memory() swap = psutil.swap_memory() memory_info = { 'total': memory.total, 'available': memory.available, 'used': memory.used, 'free': memory.free, 'usage_percent': memory.percent, 'swap': { 'total': swap.total, 'used': swap.used, 'free': swap.free, 'usage_percent': swap.percent } } memory_info['issues'] = [] if memory.percent \u003e self.thresholds['memory_usage']: memory_info['issues'].append(f\"High memory usage: {memory.percent}%\") if swap.percent \u003e 50: memory_info['issues'].append(f\"High swap usage: {swap.percent}%\") return memory_info except Exception as e: return {'error': str(e)} def check_disk(self) -\u003e Dict: \"\"\"æ£€æŸ¥ç£ç›˜çŠ¶æ€\"\"\" try: disk_partitions = psutil.disk_partitions() disk_info = {'partitions': [], 'issues': []} for partition in disk_partitions: try: usage = psutil.disk_usage(partition.mountpoint) partition_info = { 'device': partition.device, 'mountpoint': partition.mountpoint, 'fstype': partition.fstype, 'total': usage.total, 'used': usage.used, 'free': usage.free, 'usage_percent': (usage.used / usage.total) * 100 } if partition_info['usage_percent'] \u003e self.thresholds['disk_usage']: disk_info['issues'].append( f\"Low disk space on {partition.mountpoint}: {partition_info['usage_percent']:.1f}%\" ) disk_info['partitions'].append(partition_info) except PermissionError: continue return disk_info except Exception as e: return {'error': str(e)} def check_network(self) -\u003e Dict: \"\"\"æ£€æŸ¥ç½‘ç»œçŠ¶æ€\"\"\" try: network_info = { 'interfaces': [], 'connections': [], 'issues': [] } # æ£€æŸ¥ç½‘ç»œæ¥å£ net_io = psutil.net_io_counters(pernic=True) for interface, stats in net_io.items(): interface_info = { 'name': interface, 'bytes_sent': stats.bytes_sent, 'bytes_recv': stats.bytes_recv, 'packets_sent': stats.packets_sent, 'packets_recv': stats.packets_recv, 'errors_in': stats.errin, 'errors_out': stats.errout, 'drop_in': stats.dropin, 'drop_out': stats.dropout } network_info['interfaces'].append(interface_info) # æ£€æŸ¥ç½‘ç»œè¿æ¥ connections = psutil.net_connections() connection_stats = { 'established': 0, 'listening': 0, 'time_wait': 0, 'total': len(connections) } for conn in connections: if conn.status == 'ESTABLISHED': connection_stats['established'] += 1 elif conn.status == 'LISTEN': connection_stats['listening'] += 1 elif conn.status == 'TIME_WAIT': connection_stats['time_wait'] += 1 network_info['connection_stats'] = connection_stats # æ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸ if connection_stats['time_wait'] \u003e 1000: network_info['issues'].append(f\"Too many TIME_WAIT connections: {connection_stats['time_wait']}\") return network_info except Exception as e: return {'error': str(e)} def check_processes(self) -\u003e Dict: \"\"\"æ£€æŸ¥è¿›ç¨‹çŠ¶æ€\"\"\" try: processes = [] top_cpu = [] top_memory = [] for proc in psutil.process_iter(['pid', 'name', 'cpu_percent', 'memory_percent', 'status']): try: proc_info = proc.info processes.append(proc_info) # è®°å½•CPUä½¿ç”¨ç‡æœ€é«˜çš„è¿›ç¨‹ if len(top_cpu) \u003c 10: top_cpu.append(proc_info) else: min_proc = min(top_cpu, key=lambda x: x['cpu_percent']) if proc_info['cpu_percent'] \u003e min_proc['cpu_percent']: top_cpu.remove(min_proc) top_cpu.append(proc_info) # è®°å½•å†…å­˜ä½¿ç”¨ç‡æœ€é«˜çš„è¿›ç¨‹ if len(top_memory) \u003c 10: top_memory.append(proc_info) else: min_proc = min(top_memory, key=lambda x: x['memory_percent']) if proc_info['memory_percent'] \u003e min_proc['memory_percent']: top_memory.remove(min_proc) top_memory.append(proc_info) except (psutil.NoSuchProcess, psutil.AccessDenied): continue return { 'total_processes': len(processes), 'top_cpu_processes': sorted(top_cpu, key=lambda x: x['cpu_percent'], reverse=True), 'top_memory_processes': sorted(top_memory, key=lambda x: x['memory_percent'], reverse=True) } except Exception as e: return {'error': str(e)} def check_services(self) -\u003e Dict: \"\"\"æ£€æŸ¥å…³é”®æœåŠ¡çŠ¶æ€\"\"\" critical_services = ['nginx', 'mysql', 'redis-server', 'ssh'] service_status = {} for service in critical_services: try: # æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ result = subprocess.run( ['systemctl', 'is-active', service], capture_output=True, text=True ) service_status[service] = { 'status': result.stdout.strip(), 'active': result.stdout.strip() == 'active' } except Exception as e: service_status[service] = { 'status': 'unknown', 'active': False, 'error': str(e) } return service_status def check_logs(self) -\u003e Dict: \"\"\"æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—ä¸­çš„é”™è¯¯\"\"\" log_files = ['/var/log/syslog', '/var/log/auth.log', '/var/log/nginx/error.log'] log_errors = [] for log_file in log_files: if os.path.exists(log_file): try: # è¯»å–æœ€è¿‘çš„é”™è¯¯æ—¥å¿— result = subprocess.run( ['tail', '-100', log_file], capture_output=True, text=True ) errors = re.findall(r'.*error.*|.*ERROR.*|.*Error.*', result.stdout, re.IGNORECASE) if errors: log_errors.extend([ {'file': log_file, 'error': error.strip()} for error in errors[-10:] # æœ€è¿‘10ä¸ªé”™è¯¯ ]) except Exception as e: log_errors.append({'file': log_file, 'error': f'Failed to read log: {str(e)}'}) return {'errors': log_errors} def generate_summary(self) -\u003e Dict: \"\"\"ç”Ÿæˆè¯Šæ–­æ‘˜è¦\"\"\" issues = [] # æ”¶é›†æ‰€æœ‰é—®é¢˜ if 'cpu' in self.results and 'issues' in self.results['cpu']: issues.extend(self.results['cpu']['issues']) if 'memory' in self.results and 'issues' in self.results['memory']: issues.extend(self.results['memory']['issues']) if 'disk' in self.results and 'issues' in self.results['disk']: issues.extend(self.results['disk']['issues']) if 'network' in self.results and 'issues' in self.results['network']: issues.extend(self.results['network']['issues']) # æ£€æŸ¥æœåŠ¡çŠ¶æ€ if 'services' in self.results: for service, status in self.results['services'].items(): if not status.get('active', False): issues.append(f\"Service {service} is not running\") return { 'total_issues': len(issues), 'issues': issues, 'health_score': max(0, 100 - len(issues) * 10), 'recommendations': self.generate_recommendations(issues) } def generate_recommendations(self, issues: List[str]) -\u003e List[str]: \"\"\"æ ¹æ®é—®é¢˜ç”Ÿæˆå»ºè®®\"\"\" recommendations = [] for issue in issues: if 'CPU' in issue: recommendations.append(\"Consider upgrading CPU or optimizing CPU-intensive processes\") elif 'memory' in issue.lower(): recommendations.append(\"Add more RAM or optimize memory usage\") elif 'disk' in issue.lower(): recommendations.append(\"Clean up disk space or add more storage\") elif 'service' in issue.lower(): recommendations.append(\"Restart failed services or check service configuration\") elif 'network' in issue.lower(): recommendations.append(\"Check network configuration and bandwidth\") return list(set(recommendations)) # å»é‡ def main(): \"\"\"ä¸»å‡½æ•°\"\"\" diagnostic = ServerDiagnostic() results = diagnostic.diagnose_system() # ä¿å­˜è¯Šæ–­ç»“æœ timestamp = datetime.now().strftime('%Y%m%d_%H%M%S') output_file = f\"/tmp/server_diagnostic_{timestamp}.json\" with open(output_file, 'w') as f: json.dump(results, f, indent=2, default=str) print(f\"Diagnostic completed. Results saved to: {output_file}\") # å¦‚æœæœ‰é—®é¢˜ï¼Œå‘é€å‘Šè­¦ if results['summary']['total_issues'] \u003e 0: print(f\"Found {results['summary']['total_issues']} issues:\") for issue in results['summary']['issues']: print(f\" - {issue}\") if __name__ == '__main__': main() æ€»ç»“ ç°ä»£æœåŠ¡å™¨è¿ç»´æ˜¯ä¸€ä¸ªç»¼åˆæ€§çš„æŠ€æœ¯é¢†åŸŸï¼Œéœ€è¦æŒæ¡å¤šç§æŠ€èƒ½å’Œå·¥å…·ï¼š\nè‡ªåŠ¨åŒ–è¿ç»´ï¼šä½¿ç”¨IaCã€é…ç½®ç®¡ç†ç­‰å·¥å…·å®ç°åŸºç¡€è®¾æ–½è‡ªåŠ¨åŒ– ç›‘æ§å‘Šè­¦ï¼šå»ºç«‹å…¨é¢çš„ç›‘æ§ä½“ç³»å’Œæ™ºèƒ½å‘Šè­¦æœºåˆ¶ æ—¥å¿—ç®¡ç†ï¼šé›†ä¸­åŒ–æ—¥å¿—æ”¶é›†ã€åˆ†æå’Œå­˜å‚¨ æ€§èƒ½ä¼˜åŒ–ï¼šç³»ç»Ÿè°ƒä¼˜å’Œåº”ç”¨æ€§èƒ½ä¼˜åŒ– æ•…éšœæ’é™¤ï¼šå¿«é€Ÿå®šä½å’Œè§£å†³ç³»ç»Ÿé—®é¢˜ é€šè¿‡æŒç»­å­¦ä¹ å’Œå®è·µè¿™äº›æŠ€èƒ½ï¼Œè¿ç»´å›¢é˜Ÿå¯ä»¥æ„å»ºç¨³å®šã€é«˜æ•ˆã€å¯æ‰©å±•çš„æœåŠ¡å™¨è¿ç»´ä½“ç³»ï¼Œä¸ºä¸šåŠ¡çš„æŒç»­å‘å±•æä¾›åšå®çš„æŠ€æœ¯ä¿éšœã€‚\n","wordCount":"4297","inLanguage":"zh-cn","datePublished":"2025-12-22T14:00:00+08:00","dateModified":"2025-12-22T14:00:00+08:00","author":{"@type":"Person","name":"util.cn Team"},"mainEntityOfPage":{"@type":"WebPage","@id":"/blog/articles/%E7%8E%B0%E4%BB%A3%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E8%87%AA%E5%8A%A8%E5%8C%96%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%99%BA%E8%83%BD%E8%BF%90%E7%BB%B4%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"},"publisher":{"@type":"Organization","name":"æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·","logo":{"@type":"ImageObject","url":"/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=/blog/ accesskey=h title="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· (Alt + H)">æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=/blog/posts/ title="æ‰€æœ‰æ–‡ç« åˆ—è¡¨ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŸ¥çœ‹æ‰€æœ‰æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹"><span>æ–‡ç« </span></a></li><li><a href=https://www.util.cn title="æœ‰æ¡å·¥å…· - å¼€å‘è€…çš„å¸¸ç”¨å·¥å…·é›†åˆï¼šæ— å¹¿å‘Š Â· æœ¬åœ°è®¡ç®— Â· å³å¼€å³ç”¨çš„åœ¨çº¿å·¥å…·å¹³å°ï¼Œæä¾›JSONæ ¼å¼åŒ–ã€SQLæ ¼å¼åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰å®ç”¨å·¥å…·"><span>æœ‰æ¡å·¥å…·</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=/blog/categories/ title="æ–‡ç« åˆ†ç±» - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŒ‰æŠ€æœ¯é¢†åŸŸåˆ†ç±»çš„ä¼˜è´¨æ–‡ç« ï¼ŒåŒ…æ‹¬å‰ç«¯å¼€å‘ã€å·¥å…·ä½¿ç”¨ã€ç¼–ç¨‹æŠ€å·§ç­‰"><span>åˆ†ç±»</span></a></li><li><a href=/blog/tags/ title="æ ‡ç­¾äº‘ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šé€šè¿‡æ ‡ç­¾å¿«é€Ÿæ‰¾åˆ°æ„Ÿå…´è¶£çš„æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹"><span>æ ‡ç­¾</span></a></li><li><a href=/blog/archives/ title="æ–‡ç« å½’æ¡£ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŒ‰æ—¶é—´æŸ¥çœ‹å†å²æ–‡ç« "><span>å½’æ¡£</span></a></li><li><a href=/blog/search/ title="æœç´¢æ–‡ç«  - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šé€šè¿‡å…³é”®è¯æœç´¢æ‰¾åˆ°æ„Ÿå…´è¶£çš„æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹ï¼Œæ”¯æŒæ ‡é¢˜ã€å†…å®¹ã€åˆ†ç±»å’Œæ ‡ç­¾æœç´¢"><span>æœç´¢</span></a></li></ul></nav></header><main class=main><article class=post-single><div class=post-content-wrapper><main class=post-content-main><header class=post-header-main><h1 class="post-title entry-hint-parent">ç°ä»£æœåŠ¡å™¨è¿ç»´å®Œå…¨æŒ‡å—ï¼šè‡ªåŠ¨åŒ–ç›‘æ§ä¸æ™ºèƒ½è¿ç»´æœ€ä½³å®è·µ</h1><div class=post-meta><div class=post-meta-content><div class=post-categories-inline><a href=/blog/categories/devops/ class=category-link>DevOps</a></div><span class=post-date>2025-12-22</span><span class=post-author>util.cn Team</span></div><style>.post-meta-content{display:flex;align-items:center;flex-wrap:wrap;gap:.75rem;font-family:sf mono,monaco,courier new,monospace;font-size:.875rem;color:#9ca3af !important}.post-categories-inline{display:inline-flex;align-items:center;gap:.5rem}.category-link{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .75rem;background:rgba(255,255,255,.1);color:#e5e7eb !important;text-decoration:none;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;border:1px solid rgba(255,255,255,.2);border-radius:0;transition:all .3s ease;white-space:nowrap}.category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3);transform:translateY(-1px)}.category-link::before{content:'ğŸ“';font-size:.7rem;opacity:.8}.post-date,.post-reading-time,.post-word-count,.post-author{color:#9ca3af !important}[data-theme=dark] .post-meta-content{color:#9ca3af !important}[data-theme=dark] .category-link{background:rgba(255,255,255,.1);color:#e5e7eb !important;border-color:rgba(255,255,255,.2)}[data-theme=dark] .category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3)}[data-theme=dark] .post-date,[data-theme=dark] .post-reading-time,[data-theme=dark] .post-word-count,[data-theme=dark] .post-author{color:#9ca3af !important}[data-theme=light] .post-meta-content{color:#6c757d !important}[data-theme=light] .category-link{background:rgba(0,0,0,5%);color:#495057 !important;border-color:rgba(0,0,0,.15)}[data-theme=light] .category-link:hover{background:rgba(0,102,204,.1);color:#212529 !important;border-color:rgba(0,102,204,.3)}[data-theme=light] .post-date,[data-theme=light] .post-reading-time,[data-theme=light] .post-word-count,[data-theme=light] .post-author{color:#6c757d !important}@media(max-width:768px){.post-meta-content{gap:.5rem;font-size:.8rem}.category-link{padding:.2rem .6rem;font-size:.7rem}}</style></div></header><div class=post-content><p>ç°ä»£æœåŠ¡å™¨è¿ç»´å·²ç»ä»ä¼ ç»Ÿçš„æ‰‹åŠ¨æ“ä½œå‘å±•ä¸ºé«˜åº¦è‡ªåŠ¨åŒ–ã€æ™ºèƒ½åŒ–çš„ç®¡ç†ä½“ç³»ã€‚éšç€äº‘è®¡ç®—å’Œå®¹å™¨åŒ–æŠ€æœ¯çš„æ™®åŠï¼Œè¿ç»´å·¥ç¨‹å¸ˆéœ€è¦æŒæ¡æ›´å…ˆè¿›çš„å·¥å…·å’Œæ–¹æ³•è®ºã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ç°ä»£æœåŠ¡å™¨è¿ç»´çš„å„ä¸ªæ–¹é¢ï¼Œä»åŸºç¡€æ¶æ„åˆ°æ™ºèƒ½è¿ç»´å®è·µã€‚</p><h2 id=è‡ªåŠ¨åŒ–è¿ç»´åŸºç¡€>è‡ªåŠ¨åŒ–è¿ç»´åŸºç¡€<a hidden class=anchor aria-hidden=true href=#è‡ªåŠ¨åŒ–è¿ç»´åŸºç¡€>#</a></h2><h3 id=åŸºç¡€è®¾æ–½å³ä»£ç iac>åŸºç¡€è®¾æ–½å³ä»£ç ï¼ˆIaCï¼‰<a hidden class=anchor aria-hidden=true href=#åŸºç¡€è®¾æ–½å³ä»£ç iac>#</a></h3><p>ä½¿ç”¨Terraformç®¡ç†åŸºç¡€è®¾æ–½ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">129
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#8b949e;font-style:italic># terraform/main.tf
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>provider</span> <span style=color:#a5d6ff>&#34;aws&#34;</span> {
</span></span><span style=display:flex><span>  region <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>aws_region</span>
</span></span><span style=display:flex><span>}<span style=color:#8b949e;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># VPCé…ç½®
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>resource</span> <span style=color:#a5d6ff>&#34;aws_vpc&#34; &#34;main&#34;</span> {
</span></span><span style=display:flex><span>  cidr_block           <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;10.0.0.0/16&#34;</span>
</span></span><span style=display:flex><span>  enable_dns_support   <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>true</span>
</span></span><span style=display:flex><span>  enable_dns_hostnames <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>    Name        <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;main-vpc&#34;</span>
</span></span><span style=display:flex><span>    Environment <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>environment</span>
</span></span><span style=display:flex><span>    ManagedBy   <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;terraform&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}<span style=color:#8b949e;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># å…¬æœ‰å­ç½‘
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>resource</span> <span style=color:#a5d6ff>&#34;aws_subnet&#34; &#34;public&#34;</span> {
</span></span><span style=display:flex><span>  count             <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>length</span>(<span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>availability_zones</span>)
</span></span><span style=display:flex><span>  vpc_id            <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>aws_vpc</span>.<span style=color:#ff7b72>main</span>.<span style=color:#ff7b72>id</span>
</span></span><span style=display:flex><span>  cidr_block        <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;10.0.${count.index + 1}.0/24&#34;</span>
</span></span><span style=display:flex><span>  availability_zone <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>availability_zones</span>[<span style=color:#ff7b72>count</span>.<span style=color:#ff7b72>index</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  map_public_ip_on_launch <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>    Name        <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;public-subnet-${count.index + 1}&#34;</span>
</span></span><span style=display:flex><span>    Environment <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>environment</span>
</span></span><span style=display:flex><span>    Type        <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;public&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}<span style=color:#8b949e;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># ç§æœ‰å­ç½‘
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>resource</span> <span style=color:#a5d6ff>&#34;aws_subnet&#34; &#34;private&#34;</span> {
</span></span><span style=display:flex><span>  count             <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>length</span>(<span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>availability_zones</span>)
</span></span><span style=display:flex><span>  vpc_id            <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>aws_vpc</span>.<span style=color:#ff7b72>main</span>.<span style=color:#ff7b72>id</span>
</span></span><span style=display:flex><span>  cidr_block        <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;10.0.${count.index + 101}.0/24&#34;</span>
</span></span><span style=display:flex><span>  availability_zone <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>availability_zones</span>[<span style=color:#ff7b72>count</span>.<span style=color:#ff7b72>index</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>    Name        <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;private-subnet-${count.index + 1}&#34;</span>
</span></span><span style=display:flex><span>    Environment <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>environment</span>
</span></span><span style=display:flex><span>    Type        <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;private&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}<span style=color:#8b949e;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># EC2å®ä¾‹é…ç½®
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>resource</span> <span style=color:#a5d6ff>&#34;aws_instance&#34; &#34;web_server&#34;</span> {
</span></span><span style=display:flex><span>  count                       <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>instance_count</span>
</span></span><span style=display:flex><span>  ami                         <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>ami_id</span>
</span></span><span style=display:flex><span>  instance_type               <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>instance_type</span>
</span></span><span style=display:flex><span>  subnet_id                   <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>aws_subnet</span>.<span style=color:#ff7b72>private</span>[<span style=color:#ff7b72>count</span>.<span style=color:#ff7b72>index</span> <span style=color:#f85149>%</span> <span style=color:#ff7b72>length</span>(<span style=color:#ff7b72>aws_subnet</span>.<span style=color:#ff7b72>private</span>)].<span style=color:#ff7b72>id</span>
</span></span><span style=display:flex><span>  vpc_security_group_ids      <span style=color:#ff7b72;font-weight:700>=</span> [<span style=color:#ff7b72>aws_security_group</span>.<span style=color:#ff7b72>web_server</span>.<span style=color:#ff7b72>id</span>]
</span></span><span style=display:flex><span>  key_name                    <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>key_name</span>
</span></span><span style=display:flex><span>  associate_public_ip_address <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>false</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>root_block_device</span> {
</span></span><span style=display:flex><span>    volume_size           <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>30</span>
</span></span><span style=display:flex><span>    volume_type           <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;gp3&#34;</span>
</span></span><span style=display:flex><span>    delete_on_termination <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>true</span>
</span></span><span style=display:flex><span>    encrypted             <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>true</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  user_data <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>base64encode</span>(<span style=color:#ff7b72>templatefile</span>(<span style=color:#a5d6ff>&#34;${path.module}/user_data.sh&#34;</span>, {
</span></span><span style=display:flex><span>    environment <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>environment</span>
</span></span><span style=display:flex><span>    region      <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>aws_region</span>
</span></span><span style=display:flex><span>  }))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>    Name        <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;web-server-${count.index + 1}&#34;</span>
</span></span><span style=display:flex><span>    Environment <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>environment</span>
</span></span><span style=display:flex><span>    Role        <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;web&#34;</span>
</span></span><span style=display:flex><span>    ManagedBy   <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;terraform&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}<span style=color:#8b949e;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># è‡ªåŠ¨æ‰©å±•ç»„
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>resource</span> <span style=color:#a5d6ff>&#34;aws_autoscaling_group&#34; &#34;web_servers&#34;</span> {
</span></span><span style=display:flex><span>  name                <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;web-servers-asg&#34;</span>
</span></span><span style=display:flex><span>  vpc_zone_identifier <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>aws_subnet</span>.<span style=color:#ff7b72>private</span>[<span style=color:#f85149>*</span>].<span style=color:#ff7b72>id</span>
</span></span><span style=display:flex><span>  target_group_arns   <span style=color:#ff7b72;font-weight:700>=</span> [<span style=color:#ff7b72>aws_lb_target_group</span>.<span style=color:#ff7b72>web_servers</span>.<span style=color:#ff7b72>arn</span>]
</span></span><span style=display:flex><span>  health_check_type   <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;EC2&#34;</span>
</span></span><span style=display:flex><span>  health_check_grace_period <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>300</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  min_size         <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>min_instances</span>
</span></span><span style=display:flex><span>  max_size         <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>max_instances</span>
</span></span><span style=display:flex><span>  desired_capacity <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>desired_instances</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>launch_template</span> {
</span></span><span style=display:flex><span>    id      <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>aws_launch_template</span>.<span style=color:#ff7b72>web_server</span>.<span style=color:#ff7b72>id</span>
</span></span><span style=display:flex><span>    version <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;$Latest&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>tag</span> {
</span></span><span style=display:flex><span>    key                 <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;Name&#34;</span>
</span></span><span style=display:flex><span>    value               <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;web-server&#34;</span>
</span></span><span style=display:flex><span>    propagate_at_launch <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>true</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>tag</span> {
</span></span><span style=display:flex><span>    key                 <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;Environment&#34;</span>
</span></span><span style=display:flex><span>    value               <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>environment</span>
</span></span><span style=display:flex><span>    propagate_at_launch <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>true</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}<span style=color:#8b949e;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># ç›‘æ§å’Œå‘Šè­¦
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>resource</span> <span style=color:#a5d6ff>&#34;aws_cloudwatch_metric_alarm&#34; &#34;cpu_utilization&#34;</span> {
</span></span><span style=display:flex><span>  alarm_name          <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;web-server-cpu-utilization&#34;</span>
</span></span><span style=display:flex><span>  comparison_operator <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;GreaterThanThreshold&#34;</span>
</span></span><span style=display:flex><span>  evaluation_periods  <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;2&#34;</span>
</span></span><span style=display:flex><span>  metric_name         <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;CPUUtilization&#34;</span>
</span></span><span style=display:flex><span>  namespace           <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;AWS/EC2&#34;</span>
</span></span><span style=display:flex><span>  period              <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;300&#34;</span>
</span></span><span style=display:flex><span>  statistic           <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;Average&#34;</span>
</span></span><span style=display:flex><span>  threshold           <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;80&#34;</span>
</span></span><span style=display:flex><span>  alarm_description   <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#34;This metric monitors ec2 cpu utilization&#34;</span>
</span></span><span style=display:flex><span>  alarm_actions       <span style=color:#ff7b72;font-weight:700>=</span> [<span style=color:#ff7b72>aws_sns_topic</span>.<span style=color:#ff7b72>alerts</span>.<span style=color:#ff7b72>arn</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  dimensions <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>    AutoScalingGroupName <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>aws_autoscaling_group</span>.<span style=color:#ff7b72>web_servers</span>.<span style=color:#ff7b72>name</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  tags <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>    Environment <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>var</span>.<span style=color:#ff7b72>environment</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=é…ç½®ç®¡ç†>é…ç½®ç®¡ç†<a hidden class=anchor aria-hidden=true href=#é…ç½®ç®¡ç†>#</a></h3><p>ä½¿ç”¨Ansibleè¿›è¡ŒæœåŠ¡å™¨é…ç½®ç®¡ç†ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">124
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8b949e;font-style:italic># ansible/playbooks/web_server.yml</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#ff7b72>---</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Configure Web Servers</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>hosts</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>webservers</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>become</span>:<span style=color:#6e7681> </span><span style=color:#79c0ff>yes</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>vars</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>app_user</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>appuser</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>app_dir</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>/opt/myapp</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>nginx_worker_processes</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;{{ ansible_processor_cores }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>nginx_worker_connections</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>1024</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>tasks</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Update apt packages</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>apt</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>update_cache</span>:<span style=color:#6e7681> </span><span style=color:#79c0ff>yes</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>upgrade</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>dist</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>when</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>ansible_os_family == &#34;Debian&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Update yum packages</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>yum</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;*&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>state</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>latest</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>when</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>ansible_os_family == &#34;RedHat&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Install required packages</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>package</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>nginx</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>nodejs</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>npm</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>git</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>htop</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>fail2ban</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>ufw</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>state</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>present</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Create application user</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>user</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;{{ app_user }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>shell</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>/bin/bash</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>home</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;{{ app_dir }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>create_home</span>:<span style=color:#6e7681> </span><span style=color:#79c0ff>yes</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>system</span>:<span style=color:#6e7681> </span><span style=color:#79c0ff>yes</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Create application directory</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>file</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>path</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;{{ app_dir }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>state</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>directory</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>owner</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;{{ app_user }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>group</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;{{ app_user }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>mode</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#39;0755&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Configure Nginx</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>template</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>src</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>nginx.conf.j2</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>dest</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>/etc/nginx/nginx.conf</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>owner</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>root</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>group</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>root</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>mode</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#39;0644&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>notify</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>restart nginx</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Configure Nginx site</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>template</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>src</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>site.conf.j2</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>dest</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>/etc/nginx/sites-available/myapp</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>owner</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>root</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>group</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>root</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>mode</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#39;0644&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>notify</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>restart nginx</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Enable Nginx site</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>file</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>src</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>/etc/nginx/sites-available/myapp</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>dest</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>/etc/nginx/sites-enabled/myapp</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>state</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>link</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>notify</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>restart nginx</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Configure firewall</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>ufw</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>rule</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>allow</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;{{ item }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>loop</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>OpenSSH</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;Nginx Full&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Set firewall default policy</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>ufw</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>state</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>enabled</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>policy</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>deny</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Configure fail2ban</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>template</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>src</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>jail.local.j2</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>dest</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>/etc/fail2ban/jail.local</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>owner</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>root</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>group</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>root</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>mode</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#39;0644&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>notify</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>restart fail2ban</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Deploy monitoring script</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>template</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>src</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>monitor.sh.j2</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>dest</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;{{ app_dir }}/monitor.sh&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>owner</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;{{ app_user }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>group</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;{{ app_user }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>mode</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#39;0755&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Setup monitoring cron job</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>cron</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;Application monitoring&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>job</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;{{ app_dir }}/monitor.sh&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>user</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;{{ app_user }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>minute</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;*/5&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>handlers</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>restart nginx</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>service</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>nginx</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>state</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>restarted</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>restart fail2ban</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>service</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>fail2ban</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>state</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>restarted</span><span style=color:#6e7681>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=ç›‘æ§ä¸å‘Šè­¦ç³»ç»Ÿ>ç›‘æ§ä¸å‘Šè­¦ç³»ç»Ÿ<a hidden class=anchor aria-hidden=true href=#ç›‘æ§ä¸å‘Šè­¦ç³»ç»Ÿ>#</a></h2><h3 id=prometheusç›‘æ§ç³»ç»Ÿ>Prometheusç›‘æ§ç³»ç»Ÿ<a hidden class=anchor aria-hidden=true href=#prometheusç›‘æ§ç³»ç»Ÿ>#</a></h3><p>é…ç½®å…¨æ–¹ä½çš„æœåŠ¡å™¨ç›‘æ§ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">118
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8b949e;font-style:italic># prometheus/prometheus.yml</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>global</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>scrape_interval</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>15s</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>evaluation_interval</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>15s</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>rule_files</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>- <span style=color:#a5d6ff>&#34;rules/*.yml&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>alerting</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>alertmanagers</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>- <span style=color:#7ee787>static_configs</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#7ee787>targets</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span>- <span style=color:#a5d6ff>alertmanager:9093</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>scrape_configs</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># æœåŠ¡å™¨èŠ‚ç‚¹ç›‘æ§</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>- <span style=color:#7ee787>job_name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#39;node-exporter&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>static_configs</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>targets</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;server1:9100&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;server2:9100&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;server3:9100&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>scrape_interval</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>30s</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># ç³»ç»ŸæœåŠ¡ç›‘æ§</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>- <span style=color:#7ee787>job_name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#39;systemd-exporter&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>static_configs</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>targets</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;server1:9551&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;server2:9551&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;server3:9551&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># MySQLæ•°æ®åº“ç›‘æ§</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>- <span style=color:#7ee787>job_name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#39;mysql-exporter&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>static_configs</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>targets</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;db1:9104&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;db2:9104&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># Redisç›‘æ§</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>- <span style=color:#7ee787>job_name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#39;redis-exporter&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>static_configs</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>targets</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;redis1:9121&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;redis2:9121&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># Nginxç›‘æ§</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>- <span style=color:#7ee787>job_name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#39;nginx-exporter&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>static_configs</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>targets</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;server1:9113&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;server2:9113&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;server3:9113&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># åº”ç”¨ç›‘æ§</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>- <span style=color:#7ee787>job_name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#39;application&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>static_configs</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>targets</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;app1:3000&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;app2:3000&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span>- <span style=color:#a5d6ff>&#39;app3:3000&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>metrics_path</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#39;/metrics&#39;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>scrape_interval</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>10s</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#8b949e;font-style:italic># å‘Šè­¦è§„åˆ™</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#8b949e;font-style:italic># prometheus/rules/server_alerts.yml</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#7ee787>groups</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>- <span style=color:#7ee787>name</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>server_alerts</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>rules</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#8b949e;font-style:italic># CPUä½¿ç”¨ç‡å‘Šè­¦</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>alert</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>HighCPUUsage</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>expr</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>100</span><span style=color:#6e7681> </span>- <span style=color:#a5d6ff>(avg by(instance) (irate(node_cpu_seconds_total{mode=&#34;idle&#34;}[5m])) * 100) &gt; 80</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>for</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>5m</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>labels</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>severity</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>warning</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>annotations</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>summary</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;High CPU usage on {{ $labels.instance }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>description</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;CPU usage is above 80% for more than 5 minutes on {{ $labels.instance }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#8b949e;font-style:italic># å†…å­˜ä½¿ç”¨ç‡å‘Šè­¦</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>alert</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>HighMemoryUsage</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>expr</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>(1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100 &gt; 90</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>for</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>5m</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>labels</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>severity</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>critical</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>annotations</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>summary</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;High memory usage on {{ $labels.instance }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>description</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;Memory usage is above 90% for more than 5 minutes on {{ $labels.instance }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#8b949e;font-style:italic># ç£ç›˜ç©ºé—´å‘Šè­¦</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>alert</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>DiskSpaceLow</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>expr</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>(1 - (node_filesystem_avail_bytes / node_filesystem_size_bytes)) * 100 &gt; 85</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>for</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>10m</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>labels</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>severity</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>warning</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>annotations</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>summary</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;Disk space low on {{ $labels.instance }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>description</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;Disk usage is above 85% on {{ $labels.instance }}:{{ $labels.mountpoint }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#8b949e;font-style:italic># ç½‘ç»œè¿æ¥æ•°å‘Šè­¦</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>alert</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>TooManyConnections</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>expr</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>node_netstat_Tcp_CurrEstab &gt; 10000</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>for</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>5m</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>labels</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>severity</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>warning</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>annotations</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>summary</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;Too many TCP connections on {{ $labels.instance }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>description</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;TCP connections count is {{ $value }} on {{ $labels.instance }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#8b949e;font-style:italic># ç³»ç»Ÿè´Ÿè½½å‘Šè­¦</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#7ee787>alert</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>HighSystemLoad</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>expr</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>node_load15 &gt; (2 * node_cpu_cores)</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>for</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>5m</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>labels</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>severity</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>warning</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#7ee787>annotations</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>summary</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;High system load on {{ $labels.instance }}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>          </span><span style=color:#7ee787>description</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>&#34;15-minute load average is {{ $value }} on {{ $labels.instance }}&#34;</span><span style=color:#6e7681>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=grafanaä»ªè¡¨æ¿>Grafanaä»ªè¡¨æ¿<a hidden class=anchor aria-hidden=true href=#grafanaä»ªè¡¨æ¿>#</a></h3><p>åˆ›å»ºç›´è§‚çš„ç›‘æ§ä»ªè¡¨æ¿ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">76
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;dashboard&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;title&#34;</span>: <span style=color:#a5d6ff>&#34;Server Monitoring Dashboard&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;tags&#34;</span>: [<span style=color:#a5d6ff>&#34;server&#34;</span>, <span style=color:#a5d6ff>&#34;monitoring&#34;</span>],
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;timezone&#34;</span>: <span style=color:#a5d6ff>&#34;browser&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;panels&#34;</span>: [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;title&#34;</span>: <span style=color:#a5d6ff>&#34;System Overview&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;type&#34;</span>: <span style=color:#a5d6ff>&#34;stat&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;gridPos&#34;</span>: {<span style=color:#7ee787>&#34;h&#34;</span>: <span style=color:#a5d6ff>8</span>, <span style=color:#7ee787>&#34;w&#34;</span>: <span style=color:#a5d6ff>12</span>, <span style=color:#7ee787>&#34;x&#34;</span>: <span style=color:#a5d6ff>0</span>, <span style=color:#7ee787>&#34;y&#34;</span>: <span style=color:#a5d6ff>0</span>},
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;targets&#34;</span>: [
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;expr&#34;</span>: <span style=color:#a5d6ff>&#34;up{job=\&#34;node-exporter\&#34;}&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;legendFormat&#34;</span>: <span style=color:#a5d6ff>&#34;{{ instance }}&#34;</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        ],
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;fieldConfig&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#7ee787>&#34;defaults&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;mappings&#34;</span>: [
</span></span><span style=display:flex><span>              {<span style=color:#7ee787>&#34;options&#34;</span>: {<span style=color:#7ee787>&#34;0&#34;</span>: {<span style=color:#7ee787>&#34;text&#34;</span>: <span style=color:#a5d6ff>&#34;DOWN&#34;</span>, <span style=color:#7ee787>&#34;color&#34;</span>: <span style=color:#a5d6ff>&#34;red&#34;</span>}}},
</span></span><span style=display:flex><span>              {<span style=color:#7ee787>&#34;options&#34;</span>: {<span style=color:#7ee787>&#34;1&#34;</span>: {<span style=color:#7ee787>&#34;text&#34;</span>: <span style=color:#a5d6ff>&#34;UP&#34;</span>, <span style=color:#7ee787>&#34;color&#34;</span>: <span style=color:#a5d6ff>&#34;green&#34;</span>}}}
</span></span><span style=display:flex><span>            ],
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;thresholds&#34;</span>: {
</span></span><span style=display:flex><span>              <span style=color:#7ee787>&#34;steps&#34;</span>: [
</span></span><span style=display:flex><span>                {<span style=color:#7ee787>&#34;color&#34;</span>: <span style=color:#a5d6ff>&#34;red&#34;</span>, <span style=color:#7ee787>&#34;value&#34;</span>: <span style=color:#79c0ff>null</span>},
</span></span><span style=display:flex><span>                {<span style=color:#7ee787>&#34;color&#34;</span>: <span style=color:#a5d6ff>&#34;green&#34;</span>, <span style=color:#7ee787>&#34;value&#34;</span>: <span style=color:#a5d6ff>1</span>}
</span></span><span style=display:flex><span>              ]
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;title&#34;</span>: <span style=color:#a5d6ff>&#34;CPU Usage&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;type&#34;</span>: <span style=color:#a5d6ff>&#34;graph&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;gridPos&#34;</span>: {<span style=color:#7ee787>&#34;h&#34;</span>: <span style=color:#a5d6ff>8</span>, <span style=color:#7ee787>&#34;w&#34;</span>: <span style=color:#a5d6ff>12</span>, <span style=color:#7ee787>&#34;x&#34;</span>: <span style=color:#a5d6ff>12</span>, <span style=color:#7ee787>&#34;y&#34;</span>: <span style=color:#a5d6ff>0</span>},
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;targets&#34;</span>: [
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;expr&#34;</span>: <span style=color:#a5d6ff>&#34;100 - (avg by(instance) (irate(node_cpu_seconds_total{mode=\&#34;idle\&#34;}[5m])) * 100)&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;legendFormat&#34;</span>: <span style=color:#a5d6ff>&#34;{{ instance }}&#34;</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        ],
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;yAxes&#34;</span>: [
</span></span><span style=display:flex><span>          {<span style=color:#7ee787>&#34;max&#34;</span>: <span style=color:#a5d6ff>100</span>, <span style=color:#7ee787>&#34;min&#34;</span>: <span style=color:#a5d6ff>0</span>, <span style=color:#7ee787>&#34;unit&#34;</span>: <span style=color:#a5d6ff>&#34;percent&#34;</span>}
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;title&#34;</span>: <span style=color:#a5d6ff>&#34;Memory Usage&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;type&#34;</span>: <span style=color:#a5d6ff>&#34;graph&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;gridPos&#34;</span>: {<span style=color:#7ee787>&#34;h&#34;</span>: <span style=color:#a5d6ff>8</span>, <span style=color:#7ee787>&#34;w&#34;</span>: <span style=color:#a5d6ff>12</span>, <span style=color:#7ee787>&#34;x&#34;</span>: <span style=color:#a5d6ff>0</span>, <span style=color:#7ee787>&#34;y&#34;</span>: <span style=color:#a5d6ff>8</span>},
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;targets&#34;</span>: [
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;expr&#34;</span>: <span style=color:#a5d6ff>&#34;(1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;legendFormat&#34;</span>: <span style=color:#a5d6ff>&#34;{{ instance }}&#34;</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        ],
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;yAxes&#34;</span>: [
</span></span><span style=display:flex><span>          {<span style=color:#7ee787>&#34;max&#34;</span>: <span style=color:#a5d6ff>100</span>, <span style=color:#7ee787>&#34;min&#34;</span>: <span style=color:#a5d6ff>0</span>, <span style=color:#7ee787>&#34;unit&#34;</span>: <span style=color:#a5d6ff>&#34;percent&#34;</span>}
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;title&#34;</span>: <span style=color:#a5d6ff>&#34;Disk Usage&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;type&#34;</span>: <span style=color:#a5d6ff>&#34;graph&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;gridPos&#34;</span>: {<span style=color:#7ee787>&#34;h&#34;</span>: <span style=color:#a5d6ff>8</span>, <span style=color:#7ee787>&#34;w&#34;</span>: <span style=color:#a5d6ff>12</span>, <span style=color:#7ee787>&#34;x&#34;</span>: <span style=color:#a5d6ff>12</span>, <span style=color:#7ee787>&#34;y&#34;</span>: <span style=color:#a5d6ff>8</span>},
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;targets&#34;</span>: [
</span></span><span style=display:flex><span>          {
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;expr&#34;</span>: <span style=color:#a5d6ff>&#34;(1 - (node_filesystem_avail_bytes / node_filesystem_size_bytes)) * 100&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;legendFormat&#34;</span>: <span style=color:#a5d6ff>&#34;{{ instance }}:{{ mountpoint }}&#34;</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        ],
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;yAxes&#34;</span>: [
</span></span><span style=display:flex><span>          {<span style=color:#7ee787>&#34;max&#34;</span>: <span style=color:#a5d6ff>100</span>, <span style=color:#7ee787>&#34;min&#34;</span>: <span style=color:#a5d6ff>0</span>, <span style=color:#7ee787>&#34;unit&#34;</span>: <span style=color:#a5d6ff>&#34;percent&#34;</span>}
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=æ—¥å¿—ç®¡ç†ä¸åˆ†æ>æ—¥å¿—ç®¡ç†ä¸åˆ†æ<a hidden class=anchor aria-hidden=true href=#æ—¥å¿—ç®¡ç†ä¸åˆ†æ>#</a></h2><h3 id=elk-stackæ—¥å¿—æ”¶é›†>ELK Stackæ—¥å¿—æ”¶é›†<a hidden class=anchor aria-hidden=true href=#elk-stackæ—¥å¿—æ”¶é›†>#</a></h3><p>é…ç½®é›†ä¸­å¼æ—¥å¿—ç®¡ç†ç³»ç»Ÿï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">83
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#8b949e;font-style:italic># logstash/pipeline/server_logs.conf</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#a5d6ff>input {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#a5d6ff>beats {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#a5d6ff>port =&gt; 5044</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#a5d6ff>filter {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># è§£æNginxè®¿é—®æ—¥å¿—</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#a5d6ff>if [fields][service] == &#34;nginx&#34; {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#a5d6ff>grok {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#a5d6ff>match =&gt; {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#a5d6ff>&#34;message&#34;</span><span style=color:#6e7681> </span><span style=color:#a5d6ff>=&gt; &#34;%{NGINXACCESS}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#a5d6ff>date {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#a5d6ff>match =&gt; [ &#34;timestamp&#34;, &#34;dd/MMM/yyyy:HH:mm:ss Z&#34; ]</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#a5d6ff>geoip {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#a5d6ff>source =&gt; &#34;client_ip&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#a5d6ff>target =&gt; &#34;geoip&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># è§£æç³»ç»Ÿæ—¥å¿—</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#a5d6ff>if [fields][service] == &#34;system&#34; {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#a5d6ff>grok {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#a5d6ff>match =&gt; {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#a5d6ff>&#34;message&#34;</span><span style=color:#6e7681> </span><span style=color:#a5d6ff>=&gt; &#34;%{SYSLOGBASE}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#a5d6ff>date {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#a5d6ff>match =&gt; [ &#34;timestamp&#34;, &#34;MMM  d HH:mm:ss&#34;, &#34;MMM dd HH:mm:ss&#34; ]</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># è§£æåº”ç”¨æ—¥å¿—</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#a5d6ff>if [fields][service] == &#34;application&#34; {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#a5d6ff>json {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#a5d6ff>source =&gt; &#34;message&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#a5d6ff>if [level] == &#34;error&#34; {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#a5d6ff>mutate {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>        </span><span style=color:#a5d6ff>add_tag =&gt; [&#34;error&#34;]</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># æ·»åŠ åœ°ç†ä½ç½®ä¿¡æ¯</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#a5d6ff>if [client_ip] {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#a5d6ff>geoip {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#a5d6ff>source =&gt; &#34;client_ip&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#a5d6ff>target =&gt; &#34;geoip&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># æ·»åŠ æ—¶é—´å­—æ®µ</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#a5d6ff>mutate {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#a5d6ff>add_field =&gt; { &#34;log_date&#34; =&gt; &#34;%{@timestamp}&#34; }</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span><span style=color:#a5d6ff>output {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#a5d6ff>elasticsearch {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#a5d6ff>hosts =&gt; [&#34;elasticsearch:9200&#34;]</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#a5d6ff>index =&gt; &#34;server-logs-%{+YYYY.MM.dd}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#a5d6ff>template_name =&gt; &#34;server-logs&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#a5d6ff>template_pattern =&gt; &#34;server-logs-*&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#8b949e;font-style:italic># é”™è¯¯æ—¥å¿—å‘Šè­¦</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#a5d6ff>if &#34;error&#34; in [tags] {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#a5d6ff>email {</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#a5d6ff>to =&gt; &#34;admin@example.com&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#a5d6ff>subject =&gt; &#34;Error Alert: %{[@metadata][beat][name]}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#a5d6ff>body =&gt; &#34;Error occurred on %{[host][name]}: %{[message]}&#34;</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span>}<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681></span>}<span style=color:#6e7681>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=è‡ªå®šä¹‰ç›‘æ§è„šæœ¬>è‡ªå®šä¹‰ç›‘æ§è„šæœ¬<a hidden class=anchor aria-hidden=true href=#è‡ªå®šä¹‰ç›‘æ§è„šæœ¬>#</a></h3><p>ç¼–å†™æœåŠ¡å™¨å¥åº·æ£€æŸ¥è„šæœ¬ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">165
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">166
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">167
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">168
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">169
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">170
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">171
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">172
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">173
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">174
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">175
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">176
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">177
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">178
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">179
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">180
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">181
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">182
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">183
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">184
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">185
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">186
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">187
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic></span><span style=color:#8b949e;font-style:italic># scripts/server_health_check.sh</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># é…ç½®å˜é‡</span>
</span></span><span style=display:flex><span><span style=color:#79c0ff>ALERT_EMAIL</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;admin@example.com&#34;</span>
</span></span><span style=display:flex><span><span style=color:#79c0ff>SLACK_WEBHOOK</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;https://hooks.slack.com/services/xxx/yyy/zzz&#34;</span>
</span></span><span style=display:flex><span><span style=color:#79c0ff>LOG_FILE</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;/var/log/health_check.log&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># æ£€æŸ¥å‡½æ•°</span>
</span></span><span style=display:flex><span>check_disk_space<span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    local <span style=color:#79c0ff>threshold</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>85</span>
</span></span><span style=display:flex><span>    local <span style=color:#79c0ff>usage</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#ff7b72>$(</span>df -h / | awk <span style=color:#a5d6ff>&#39;NR==2 {print $5}&#39;</span> | sed <span style=color:#a5d6ff>&#39;s/%//&#39;</span><span style=color:#ff7b72>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> <span style=color:#ff7b72;font-weight:700>[</span> <span style=color:#79c0ff>$usage</span> -gt <span style=color:#79c0ff>$threshold</span> <span style=color:#ff7b72;font-weight:700>]</span>; <span style=color:#ff7b72>then</span>
</span></span><span style=display:flex><span>        send_alert <span style=color:#a5d6ff>&#34;Disk space critical&#34;</span> <span style=color:#a5d6ff>&#34;Disk usage is </span><span style=color:#a5d6ff>${</span><span style=color:#79c0ff>usage</span><span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>% on </span><span style=color:#ff7b72>$(</span>hostname<span style=color:#ff7b72>)</span><span style=color:#a5d6ff>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>fi</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>check_memory_usage<span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    local <span style=color:#79c0ff>threshold</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>90</span>
</span></span><span style=display:flex><span>    local <span style=color:#79c0ff>usage</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#ff7b72>$(</span>free | awk <span style=color:#a5d6ff>&#39;NR==2{printf &#34;%.0f&#34;, $3*100/$2}&#39;</span><span style=color:#ff7b72>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> <span style=color:#ff7b72;font-weight:700>[</span> <span style=color:#79c0ff>$usage</span> -gt <span style=color:#79c0ff>$threshold</span> <span style=color:#ff7b72;font-weight:700>]</span>; <span style=color:#ff7b72>then</span>
</span></span><span style=display:flex><span>        send_alert <span style=color:#a5d6ff>&#34;Memory usage critical&#34;</span> <span style=color:#a5d6ff>&#34;Memory usage is </span><span style=color:#a5d6ff>${</span><span style=color:#79c0ff>usage</span><span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>% on </span><span style=color:#ff7b72>$(</span>hostname<span style=color:#ff7b72>)</span><span style=color:#a5d6ff>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>fi</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>check_cpu_load<span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    local <span style=color:#79c0ff>threshold</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#ff7b72>$(</span>nproc<span style=color:#ff7b72>)</span>
</span></span><span style=display:flex><span>    local <span style=color:#79c0ff>load</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#ff7b72>$(</span>uptime | awk -F<span style=color:#a5d6ff>&#39;load average:&#39;</span> <span style=color:#a5d6ff>&#39;{print $2}&#39;</span> | awk <span style=color:#a5d6ff>&#39;{print $1}&#39;</span> | sed <span style=color:#a5d6ff>&#39;s/,//&#39;</span><span style=color:#ff7b72>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> <span style=color:#ff7b72;font-weight:700>((</span> <span style=color:#ff7b72>$(</span>echo <span style=color:#a5d6ff>&#34;</span><span style=color:#79c0ff>$load</span><span style=color:#a5d6ff> &gt; </span><span style=color:#79c0ff>$threshold</span><span style=color:#a5d6ff>&#34;</span> | bc -l<span style=color:#ff7b72>)</span> <span style=color:#ff7b72;font-weight:700>))</span>; <span style=color:#ff7b72>then</span>
</span></span><span style=display:flex><span>        send_alert <span style=color:#a5d6ff>&#34;CPU load critical&#34;</span> <span style=color:#a5d6ff>&#34;CPU load is </span><span style=color:#79c0ff>$load</span><span style=color:#a5d6ff> on </span><span style=color:#ff7b72>$(</span>hostname<span style=color:#ff7b72>)</span><span style=color:#a5d6ff>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>fi</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>check_service_status<span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    local <span style=color:#79c0ff>services</span><span style=color:#ff7b72;font-weight:700>=(</span><span style=color:#a5d6ff>&#34;nginx&#34;</span> <span style=color:#a5d6ff>&#34;mysql&#34;</span> <span style=color:#a5d6ff>&#34;redis-server&#34;</span> <span style=color:#a5d6ff>&#34;nodejs&#34;</span><span style=color:#ff7b72;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>for</span> service in <span style=color:#a5d6ff>&#34;</span><span style=color:#a5d6ff>${</span><span style=color:#79c0ff>services</span>[@]<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>&#34;</span>; <span style=color:#ff7b72>do</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> ! systemctl is-active --quiet <span style=color:#a5d6ff>&#34;</span><span style=color:#79c0ff>$service</span><span style=color:#a5d6ff>&#34;</span>; <span style=color:#ff7b72>then</span>
</span></span><span style=display:flex><span>            send_alert <span style=color:#a5d6ff>&#34;Service down&#34;</span> <span style=color:#a5d6ff>&#34;</span><span style=color:#79c0ff>$service</span><span style=color:#a5d6ff> is not running on </span><span style=color:#ff7b72>$(</span>hostname<span style=color:#ff7b72>)</span><span style=color:#a5d6ff>&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>fi</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>done</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>check_network_connectivity<span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    local <span style=color:#79c0ff>hosts</span><span style=color:#ff7b72;font-weight:700>=(</span><span style=color:#a5d6ff>&#34;8.8.8.8&#34;</span> <span style=color:#a5d6ff>&#34;1.1.1.1&#34;</span> <span style=color:#a5d6ff>&#34;google.com&#34;</span><span style=color:#ff7b72;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>for</span> host in <span style=color:#a5d6ff>&#34;</span><span style=color:#a5d6ff>${</span><span style=color:#79c0ff>hosts</span>[@]<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>&#34;</span>; <span style=color:#ff7b72>do</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> ! ping -c <span style=color:#a5d6ff>1</span> -W <span style=color:#a5d6ff>5</span> <span style=color:#a5d6ff>&#34;</span><span style=color:#79c0ff>$host</span><span style=color:#a5d6ff>&#34;</span> &gt; /dev/null 2&gt;&amp;1; <span style=color:#ff7b72>then</span>
</span></span><span style=display:flex><span>            send_alert <span style=color:#a5d6ff>&#34;Network issue&#34;</span> <span style=color:#a5d6ff>&#34;Cannot reach </span><span style=color:#79c0ff>$host</span><span style=color:#a5d6ff> from </span><span style=color:#ff7b72>$(</span>hostname<span style=color:#ff7b72>)</span><span style=color:#a5d6ff>&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>fi</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>done</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>check_database_connection<span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> ! mysql -e <span style=color:#a5d6ff>&#34;SELECT 1&#34;</span> &gt; /dev/null 2&gt;&amp;1; <span style=color:#ff7b72>then</span>
</span></span><span style=display:flex><span>        send_alert <span style=color:#a5d6ff>&#34;Database connection failed&#34;</span> <span style=color:#a5d6ff>&#34;Cannot connect to MySQL on </span><span style=color:#ff7b72>$(</span>hostname<span style=color:#ff7b72>)</span><span style=color:#a5d6ff>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>fi</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>check_ssl_certificates<span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    local <span style=color:#79c0ff>domains</span><span style=color:#ff7b72;font-weight:700>=(</span><span style=color:#a5d6ff>&#34;example.com&#34;</span> <span style=color:#a5d6ff>&#34;api.example.com&#34;</span><span style=color:#ff7b72;font-weight:700>)</span>
</span></span><span style=display:flex><span>    local <span style=color:#79c0ff>warning_days</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>30</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>for</span> domain in <span style=color:#a5d6ff>&#34;</span><span style=color:#a5d6ff>${</span><span style=color:#79c0ff>domains</span>[@]<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>&#34;</span>; <span style=color:#ff7b72>do</span>
</span></span><span style=display:flex><span>        local <span style=color:#79c0ff>expiry</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#ff7b72>$(</span>echo | openssl s_client -servername <span style=color:#a5d6ff>&#34;</span><span style=color:#79c0ff>$domain</span><span style=color:#a5d6ff>&#34;</span> -connect <span style=color:#a5d6ff>&#34;</span><span style=color:#79c0ff>$domain</span><span style=color:#a5d6ff>:443&#34;</span> 2&gt;/dev/null | openssl x509 -noout -enddate | cut -d<span style=color:#ff7b72;font-weight:700>=</span> -f2<span style=color:#ff7b72>)</span>
</span></span><span style=display:flex><span>        local <span style=color:#79c0ff>expiry_timestamp</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#ff7b72>$(</span>date -d <span style=color:#a5d6ff>&#34;</span><span style=color:#79c0ff>$expiry</span><span style=color:#a5d6ff>&#34;</span> +%s<span style=color:#ff7b72>)</span>
</span></span><span style=display:flex><span>        local <span style=color:#79c0ff>current_timestamp</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#ff7b72>$(</span>date +%s<span style=color:#ff7b72>)</span>
</span></span><span style=display:flex><span>        local <span style=color:#79c0ff>days_until_expiry</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#ff7b72>$((</span> <span style=color:#ff7b72;font-weight:700>(</span>expiry_timestamp <span style=color:#ff7b72;font-weight:700>-</span> current_timestamp<span style=color:#ff7b72;font-weight:700>)</span> <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#a5d6ff>86400</span> <span style=color:#ff7b72>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> <span style=color:#ff7b72;font-weight:700>[</span> <span style=color:#79c0ff>$days_until_expiry</span> -lt <span style=color:#79c0ff>$warning_days</span> <span style=color:#ff7b72;font-weight:700>]</span>; <span style=color:#ff7b72>then</span>
</span></span><span style=display:flex><span>            send_alert <span style=color:#a5d6ff>&#34;SSL certificate expiring&#34;</span> <span style=color:#a5d6ff>&#34;</span><span style=color:#79c0ff>$domain</span><span style=color:#a5d6ff> SSL certificate expires in </span><span style=color:#79c0ff>$days_until_expiry</span><span style=color:#a5d6ff> days&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>fi</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>done</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># å‘Šè­¦å‘é€å‡½æ•°</span>
</span></span><span style=display:flex><span>send_alert<span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    local <span style=color:#79c0ff>subject</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#79c0ff>$1</span>
</span></span><span style=display:flex><span>    local <span style=color:#79c0ff>message</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#79c0ff>$2</span>
</span></span><span style=display:flex><span>    local <span style=color:#79c0ff>timestamp</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#ff7b72>$(</span>date <span style=color:#a5d6ff>&#39;+%Y-%m-%d %H:%M:%S&#39;</span><span style=color:#ff7b72>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic># è®°å½•åˆ°æ—¥å¿—</span>
</span></span><span style=display:flex><span>    echo <span style=color:#a5d6ff>&#34;[</span><span style=color:#79c0ff>$timestamp</span><span style=color:#a5d6ff>] ALERT: </span><span style=color:#79c0ff>$subject</span><span style=color:#a5d6ff> - </span><span style=color:#79c0ff>$message</span><span style=color:#a5d6ff>&#34;</span> &gt;&gt; <span style=color:#79c0ff>$LOG_FILE</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic># å‘é€é‚®ä»¶å‘Šè­¦</span>
</span></span><span style=display:flex><span>    echo <span style=color:#a5d6ff>&#34;</span><span style=color:#79c0ff>$message</span><span style=color:#a5d6ff>&#34;</span> | mail -s <span style=color:#a5d6ff>&#34;[SERVER ALERT] </span><span style=color:#79c0ff>$subject</span><span style=color:#a5d6ff>&#34;</span> <span style=color:#79c0ff>$ALERT_EMAIL</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic># å‘é€Slackå‘Šè­¦</span>
</span></span><span style=display:flex><span>    curl -X POST -H <span style=color:#a5d6ff>&#39;Content-type: application/json&#39;</span> <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>        --data <span style=color:#a5d6ff>&#34;{\&#34;text\&#34;:\&#34;ğŸš¨ Server Alert\n*Subject:* </span><span style=color:#79c0ff>$subject</span><span style=color:#a5d6ff>\n*Message:* </span><span style=color:#79c0ff>$message</span><span style=color:#a5d6ff>\n*Host:* </span><span style=color:#ff7b72>$(</span>hostname<span style=color:#ff7b72>)</span><span style=color:#a5d6ff>\n*Time:* </span><span style=color:#79c0ff>$timestamp</span><span style=color:#a5d6ff>\&#34;}&#34;</span> <span style=color:#79c0ff>\
</span></span></span><span style=display:flex><span><span style=color:#79c0ff></span>        <span style=color:#79c0ff>$SLACK_WEBHOOK</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># ç”Ÿæˆå¥åº·æŠ¥å‘Š</span>
</span></span><span style=display:flex><span>generate_health_report<span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    local <span style=color:#79c0ff>report_file</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;/tmp/health_report_</span><span style=color:#ff7b72>$(</span>date +%Y%m%d_%H%M%S<span style=color:#ff7b72>)</span><span style=color:#a5d6ff>.txt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;Server Health Report&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;====================&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;Host: </span><span style=color:#ff7b72>$(</span>hostname<span style=color:#ff7b72>)</span><span style=color:#a5d6ff>&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;Time: </span><span style=color:#ff7b72>$(</span>date<span style=color:#ff7b72>)</span><span style=color:#a5d6ff>&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;System Information:&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;------------------&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;OS: </span><span style=color:#ff7b72>$(</span>uname -s -r<span style=color:#ff7b72>)</span><span style=color:#a5d6ff>&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;Uptime: </span><span style=color:#ff7b72>$(</span>uptime -p<span style=color:#ff7b72>)</span><span style=color:#a5d6ff>&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;Load Average: </span><span style=color:#ff7b72>$(</span>uptime | awk -F<span style=color:#a5d6ff>&#39;load average:&#39;</span> <span style=color:#a5d6ff>&#39;{print $2}&#39;</span><span style=color:#ff7b72>)</span><span style=color:#a5d6ff>&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;Resource Usage:&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;---------------&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;Disk Usage:&#34;</span>
</span></span><span style=display:flex><span>        df -h | grep -E <span style=color:#a5d6ff>&#39;^/dev/&#39;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;Memory Usage:&#34;</span>
</span></span><span style=display:flex><span>        free -h
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;CPU Usage:&#34;</span>
</span></span><span style=display:flex><span>        top -bn1 | grep <span style=color:#a5d6ff>&#34;Cpu(s)&#34;</span> | awk <span style=color:#a5d6ff>&#39;{print &#34;CPU: &#34; $2}&#39;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;Service Status:&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;---------------&#34;</span>
</span></span><span style=display:flex><span>        systemctl list-units --type<span style=color:#ff7b72;font-weight:700>=</span>service --state<span style=color:#ff7b72;font-weight:700>=</span>running | head -10
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;Network Connections:&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;-------------------&#34;</span>
</span></span><span style=display:flex><span>        ss -tuln | head -10
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;Recent Log Entries:&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#a5d6ff>&#34;-------------------&#34;</span>
</span></span><span style=display:flex><span>        tail -20 /var/log/syslog | grep -i error
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>}</span> &gt; <span style=color:#79c0ff>$report_file</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic># å‘é€æŠ¥å‘Š</span>
</span></span><span style=display:flex><span>    mail -s <span style=color:#a5d6ff>&#34;Health Report for </span><span style=color:#ff7b72>$(</span>hostname<span style=color:#ff7b72>)</span><span style=color:#a5d6ff>&#34;</span> <span style=color:#79c0ff>$ALERT_EMAIL</span> &lt; <span style=color:#79c0ff>$report_file</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic># æ¸…ç†ä¸´æ—¶æ–‡ä»¶</span>
</span></span><span style=display:flex><span>    rm <span style=color:#79c0ff>$report_file</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># ä¸»å‡½æ•°</span>
</span></span><span style=display:flex><span>main<span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    echo <span style=color:#a5d6ff>&#34;Starting server health check on </span><span style=color:#ff7b72>$(</span>date<span style=color:#ff7b72>)</span><span style=color:#a5d6ff>&#34;</span> &gt;&gt; <span style=color:#79c0ff>$LOG_FILE</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    local <span style=color:#79c0ff>failed_checks</span><span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic># æ‰§è¡Œå„é¡¹æ£€æŸ¥</span>
</span></span><span style=display:flex><span>    check_disk_space <span style=color:#ff7b72;font-weight:700>||</span> <span style=color:#ff7b72;font-weight:700>((</span>failed_checks++<span style=color:#ff7b72;font-weight:700>))</span>
</span></span><span style=display:flex><span>    check_memory_usage <span style=color:#ff7b72;font-weight:700>||</span> <span style=color:#ff7b72;font-weight:700>((</span>failed_checks++<span style=color:#ff7b72;font-weight:700>))</span>
</span></span><span style=display:flex><span>    check_cpu_load <span style=color:#ff7b72;font-weight:700>||</span> <span style=color:#ff7b72;font-weight:700>((</span>failed_checks++<span style=color:#ff7b72;font-weight:700>))</span>
</span></span><span style=display:flex><span>    check_service_status <span style=color:#ff7b72;font-weight:700>||</span> <span style=color:#ff7b72;font-weight:700>((</span>failed_checks++<span style=color:#ff7b72;font-weight:700>))</span>
</span></span><span style=display:flex><span>    check_network_connectivity <span style=color:#ff7b72;font-weight:700>||</span> <span style=color:#ff7b72;font-weight:700>((</span>failed_checks++<span style=color:#ff7b72;font-weight:700>))</span>
</span></span><span style=display:flex><span>    check_database_connection <span style=color:#ff7b72;font-weight:700>||</span> <span style=color:#ff7b72;font-weight:700>((</span>failed_checks++<span style=color:#ff7b72;font-weight:700>))</span>
</span></span><span style=display:flex><span>    check_ssl_certificates <span style=color:#ff7b72;font-weight:700>||</span> <span style=color:#ff7b72;font-weight:700>((</span>failed_checks++<span style=color:#ff7b72;font-weight:700>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic># å¦‚æœæœ‰æ£€æŸ¥å¤±è´¥ï¼Œç”Ÿæˆè¯¦ç»†æŠ¥å‘Š</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> <span style=color:#ff7b72;font-weight:700>[</span> <span style=color:#79c0ff>$failed_checks</span> -gt <span style=color:#a5d6ff>0</span> <span style=color:#ff7b72;font-weight:700>]</span>; <span style=color:#ff7b72>then</span>
</span></span><span style=display:flex><span>        generate_health_report
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    echo <span style=color:#a5d6ff>&#34;Health check completed. Failed checks: </span><span style=color:#79c0ff>$failed_checks</span><span style=color:#a5d6ff>&#34;</span> &gt;&gt; <span style=color:#79c0ff>$LOG_FILE</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># æ‰§è¡Œä¸»å‡½æ•°</span>
</span></span><span style=display:flex><span>main <span style=color:#a5d6ff>&#34;</span><span style=color:#79c0ff>$@</span><span style=color:#a5d6ff>&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=æ€§èƒ½ä¼˜åŒ–ç­–ç•¥>æ€§èƒ½ä¼˜åŒ–ç­–ç•¥<a hidden class=anchor aria-hidden=true href=#æ€§èƒ½ä¼˜åŒ–ç­–ç•¥>#</a></h2><h3 id=ç³»ç»Ÿè°ƒä¼˜>ç³»ç»Ÿè°ƒä¼˜<a hidden class=anchor aria-hidden=true href=#ç³»ç»Ÿè°ƒä¼˜>#</a></h3><p>LinuxæœåŠ¡å™¨æ€§èƒ½ä¼˜åŒ–é…ç½®ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">163
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic></span><span style=color:#8b949e;font-style:italic># scripts/system_optimization.sh</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># ç½‘ç»œå‚æ•°ä¼˜åŒ–</span>
</span></span><span style=display:flex><span>optimize_network<span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    echo <span style=color:#a5d6ff>&#34;Optimizing network parameters...&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic># TCPå‚æ•°è°ƒä¼˜</span>
</span></span><span style=display:flex><span>    cat &gt;&gt; /etc/sysctl.conf <span style=color:#a5d6ff>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff># Network optimization
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>net.core.rmem_max = 16777216
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>net.core.wmem_max = 16777216
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>net.ipv4.tcp_rmem = 4096 87380 16777216
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>net.ipv4.tcp_wmem = 4096 65536 16777216
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>net.ipv4.tcp_congestion_control = bbr
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>net.core.netdev_max_backlog = 5000
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>net.ipv4.tcp_max_syn_backlog = 65536
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>net.ipv4.tcp_fin_timeout = 10
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>net.ipv4.tcp_keepalive_time = 1200
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>net.ipv4.tcp_max_tw_buckets = 5000
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic># åº”ç”¨å‚æ•°</span>
</span></span><span style=display:flex><span>    sysctl -p
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    echo <span style=color:#a5d6ff>&#34;Network optimization completed.&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># æ–‡ä»¶ç³»ç»Ÿä¼˜åŒ–</span>
</span></span><span style=display:flex><span>optimize_filesystem<span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    echo <span style=color:#a5d6ff>&#34;Optimizing filesystem...&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic># è°ƒæ•´æ–‡ä»¶æè¿°ç¬¦é™åˆ¶</span>
</span></span><span style=display:flex><span>    cat &gt;&gt; /etc/security/limits.conf <span style=color:#a5d6ff>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff># Increase open files limit
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>* soft nofile 65536
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>* hard nofile 65536
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>root soft nofile 65536
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>root hard nofile 65536
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic># è°ƒæ•´å†…æ ¸å‚æ•°</span>
</span></span><span style=display:flex><span>    cat &gt;&gt; /etc/sysctl.conf <span style=color:#a5d6ff>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff># Filesystem optimization
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>fs.file-max = 2097152
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>fs.inotify.max_user_watches = 524288
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>vm.swappiness = 10
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>vm.dirty_ratio = 15
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>vm.dirty_background_ratio = 5
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    sysctl -p
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    echo <span style=color:#a5d6ff>&#34;Filesystem optimization completed.&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># æ•°æ®åº“ä¼˜åŒ–</span>
</span></span><span style=display:flex><span>optimize_database<span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    echo <span style=color:#a5d6ff>&#34;Optimizing MySQL configuration...&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    cat &gt;&gt; /etc/mysql/mysql.conf.d/mysqld.cnf <span style=color:#a5d6ff>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff># MySQL performance optimization
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>[mysqld]
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff># Memory settings
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>innodb_buffer_pool_size = 2G
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>innodb_log_file_size = 256M
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>innodb_log_buffer_size = 16M
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>key_buffer_size = 32M
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>max_heap_table_size = 64M
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>tmp_table_size = 64M
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff># Connection settings
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>max_connections = 500
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>max_connect_errors = 10000
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff># Query cache
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>query_cache_type = 1
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>query_cache_size = 64M
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff># Slow query log
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>slow_query_log = 1
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>slow_query_log_file = /var/log/mysql/slow.log
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>long_query_time = 2
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    systemctl restart mysql
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    echo <span style=color:#a5d6ff>&#34;Database optimization completed.&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># åº”ç”¨æœåŠ¡å™¨ä¼˜åŒ–</span>
</span></span><span style=display:flex><span>optimize_web_server<span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    echo <span style=color:#a5d6ff>&#34;Optimizing Nginx configuration...&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    cat &gt; /etc/nginx/nginx.conf <span style=color:#a5d6ff>&lt;&lt; &#39;EOF&#39;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>user nginx;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>worker_processes auto;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>worker_rlimit_nofile 65535;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>events {
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    worker_connections 1024;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    use epoll;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    multi_accept on;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>}
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>http {
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    # Basic settings
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    sendfile on;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    tcp_nopush on;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    tcp_nodelay on;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    keepalive_timeout 65;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    types_hash_max_size 2048;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    server_tokens off;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    # Gzip compression
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    gzip on;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    gzip_vary on;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    gzip_min_length 1024;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    gzip_comp_level 6;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    gzip_types
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        text/plain
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        text/css
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        text/xml
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        text/javascript
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        application/json
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        application/javascript
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        application/xml+rss
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        application/atom+xml
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        image/svg+xml;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    # Caching
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    open_file_cache max=10000 inactive=20s;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    open_file_cache_valid 30s;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    open_file_cache_min_uses 2;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    open_file_cache_errors on;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    # Rate limiting
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    limit_req_zone $binary_remote_addr zone=login:10m rate=1r/s;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    include /etc/nginx/conf.d/*.conf;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    include /etc/nginx/sites-enabled/*;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>}
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    nginx -t <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> systemctl reload nginx
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    echo <span style=color:#a5d6ff>&#34;Web server optimization completed.&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># æ‰§è¡Œæ‰€æœ‰ä¼˜åŒ–</span>
</span></span><span style=display:flex><span>main<span style=color:#ff7b72;font-weight:700>()</span> <span style=color:#ff7b72;font-weight:700>{</span>
</span></span><span style=display:flex><span>    echo <span style=color:#a5d6ff>&#34;Starting system optimization...&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    optimize_network
</span></span><span style=display:flex><span>    optimize_filesystem
</span></span><span style=display:flex><span>    optimize_database
</span></span><span style=display:flex><span>    optimize_web_server
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    echo <span style=color:#a5d6ff>&#34;System optimization completed successfully!&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>main <span style=color:#a5d6ff>&#34;</span><span style=color:#79c0ff>$@</span><span style=color:#a5d6ff>&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=æ•…éšœæ’é™¤ä¸æ¢å¤>æ•…éšœæ’é™¤ä¸æ¢å¤<a hidden class=anchor aria-hidden=true href=#æ•…éšœæ’é™¤ä¸æ¢å¤>#</a></h2><h3 id=è‡ªåŠ¨åŒ–æ•…éšœè¯Šæ–­>è‡ªåŠ¨åŒ–æ•…éšœè¯Šæ–­<a hidden class=anchor aria-hidden=true href=#è‡ªåŠ¨åŒ–æ•…éšœè¯Šæ–­>#</a></h3><p>æ™ºèƒ½æ•…éšœæ£€æµ‹å’Œè¯Šæ–­ç³»ç»Ÿï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">165
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">166
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">167
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">168
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">169
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">170
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">171
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">172
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">173
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">174
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">175
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">176
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">177
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">178
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">179
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">180
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">181
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">182
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">183
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">184
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">185
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">186
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">187
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">188
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">189
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">190
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">191
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">192
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">193
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">194
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">195
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">196
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">197
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">198
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">199
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">200
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">201
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">202
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">203
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">204
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">205
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">206
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">207
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">208
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">209
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">210
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">211
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">212
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">213
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">214
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">215
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">216
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">217
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">218
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">219
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">220
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">221
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">222
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">223
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">224
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">225
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">226
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">227
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">228
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">229
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">230
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">231
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">232
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">233
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">234
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">235
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">236
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">237
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">238
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">239
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">240
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">241
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">242
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">243
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">244
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">245
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">246
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">247
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">248
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">249
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">250
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">251
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">252
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">253
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">254
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">255
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">256
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">257
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">258
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">259
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">260
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">261
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">262
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">263
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">264
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">265
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">266
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">267
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">268
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">269
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">270
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">271
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">272
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">273
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">274
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">275
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">276
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">277
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">278
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">279
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">280
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">281
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">282
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">283
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">284
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">285
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">286
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">287
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">288
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">289
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">290
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">291
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">292
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">293
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">294
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">295
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">296
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">297
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">298
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">299
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">300
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">301
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">302
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">303
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">304
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">305
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">306
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">307
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">308
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">309
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">310
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">311
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">312
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">313
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">314
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">315
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">316
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">317
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">318
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">319
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">320
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">321
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">322
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">323
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">324
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">325
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">326
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">327
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">328
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">329
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">330
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">331
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">332
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">333
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">334
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">335
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">336
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">337
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">338
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">339
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">340
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">341
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">342
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">343
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">344
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">345
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">346
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">347
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">348
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">349
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">350
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">351
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">352
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">353
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">354
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">355
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">356
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">357
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">358
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">359
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">360
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">361
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8b949e;font-style:italic>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># scripts/fault_diagnosis.py</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> <span style=color:#ff7b72>os</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> <span style=color:#ff7b72>subprocess</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> <span style=color:#ff7b72>re</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> <span style=color:#ff7b72>json</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> <span style=color:#ff7b72>time</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> <span style=color:#ff7b72>psutil</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>from</span> <span style=color:#ff7b72>datetime</span> <span style=color:#ff7b72>import</span> datetime
</span></span><span style=display:flex><span><span style=color:#ff7b72>from</span> <span style=color:#ff7b72>typing</span> <span style=color:#ff7b72>import</span> Dict, List, Tuple
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>ServerDiagnostic</span>:
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>__init__</span>(self):
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>results <span style=color:#ff7b72;font-weight:700>=</span> {}
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>thresholds <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;cpu_usage&#39;</span>: <span style=color:#a5d6ff>80.0</span>,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;memory_usage&#39;</span>: <span style=color:#a5d6ff>85.0</span>,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;disk_usage&#39;</span>: <span style=color:#a5d6ff>90.0</span>,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;load_average&#39;</span>: <span style=color:#a5d6ff>2.0</span>,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;response_time&#39;</span>: <span style=color:#a5d6ff>5.0</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>diagnose_system</span>(self) <span style=color:#ff7b72;font-weight:700>-&gt;</span> Dict:
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;æ‰§è¡Œå®Œæ•´çš„ç³»ç»Ÿè¯Šæ–­&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;timestamp&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> datetime<span style=color:#ff7b72;font-weight:700>.</span>now()<span style=color:#ff7b72;font-weight:700>.</span>isoformat()
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;hostname&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> os<span style=color:#ff7b72;font-weight:700>.</span>uname()<span style=color:#ff7b72;font-weight:700>.</span>nodename
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># åŸºç¡€ç³»ç»Ÿæ£€æŸ¥</span>
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;cpu&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>check_cpu()
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;memory&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>check_memory()
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;disk&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>check_disk()
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;network&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>check_network()
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;processes&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>check_processes()
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;services&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>check_services()
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;logs&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>check_logs()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># æ€§èƒ½æ£€æŸ¥</span>
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;performance&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>check_performance()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># å®‰å…¨æ£€æŸ¥</span>
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;security&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>check_security()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># ç”Ÿæˆè¯Šæ–­æŠ¥å‘Š</span>
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;summary&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>generate_summary()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> self<span style=color:#ff7b72;font-weight:700>.</span>results
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>check_cpu</span>(self) <span style=color:#ff7b72;font-weight:700>-&gt;</span> Dict:
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;æ£€æŸ¥CPUçŠ¶æ€&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>try</span>:
</span></span><span style=display:flex><span>            cpu_percent <span style=color:#ff7b72;font-weight:700>=</span> psutil<span style=color:#ff7b72;font-weight:700>.</span>cpu_percent(interval<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>1</span>)
</span></span><span style=display:flex><span>            load_avg <span style=color:#ff7b72;font-weight:700>=</span> os<span style=color:#ff7b72;font-weight:700>.</span>getloadavg()
</span></span><span style=display:flex><span>            cpu_count <span style=color:#ff7b72;font-weight:700>=</span> psutil<span style=color:#ff7b72;font-weight:700>.</span>cpu_count()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            cpu_info <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;usage_percent&#39;</span>: cpu_percent,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;load_average&#39;</span>: {
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;1min&#39;</span>: load_avg[<span style=color:#a5d6ff>0</span>],
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;5min&#39;</span>: load_avg[<span style=color:#a5d6ff>1</span>],
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;15min&#39;</span>: load_avg[<span style=color:#a5d6ff>2</span>]
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;cpu_count&#39;</span>: cpu_count,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;per_cpu_usage&#39;</span>: psutil<span style=color:#ff7b72;font-weight:700>.</span>cpu_percent(percpu<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#79c0ff>True</span>)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic># æ£€æŸ¥æ˜¯å¦æœ‰é—®é¢˜</span>
</span></span><span style=display:flex><span>            cpu_info[<span style=color:#a5d6ff>&#39;issues&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> cpu_percent <span style=color:#ff7b72;font-weight:700>&gt;</span> self<span style=color:#ff7b72;font-weight:700>.</span>thresholds[<span style=color:#a5d6ff>&#39;cpu_usage&#39;</span>]:
</span></span><span style=display:flex><span>                cpu_info[<span style=color:#a5d6ff>&#39;issues&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>append(<span style=color:#79c0ff>f</span><span style=color:#a5d6ff>&#34;High CPU usage: </span><span style=color:#a5d6ff>{</span>cpu_percent<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>%&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> load_avg[<span style=color:#a5d6ff>0</span>] <span style=color:#ff7b72;font-weight:700>&gt;</span> self<span style=color:#ff7b72;font-weight:700>.</span>thresholds[<span style=color:#a5d6ff>&#39;load_average&#39;</span>] <span style=color:#ff7b72;font-weight:700>*</span> cpu_count:
</span></span><span style=display:flex><span>                cpu_info[<span style=color:#a5d6ff>&#39;issues&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>append(<span style=color:#79c0ff>f</span><span style=color:#a5d6ff>&#34;High load average: </span><span style=color:#a5d6ff>{</span>load_avg[<span style=color:#a5d6ff>0</span>]<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> cpu_info
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>except</span> <span style=color:#f0883e;font-weight:700>Exception</span> <span style=color:#ff7b72>as</span> e:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> {<span style=color:#a5d6ff>&#39;error&#39;</span>: str(e)}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>check_memory</span>(self) <span style=color:#ff7b72;font-weight:700>-&gt;</span> Dict:
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;æ£€æŸ¥å†…å­˜çŠ¶æ€&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>try</span>:
</span></span><span style=display:flex><span>            memory <span style=color:#ff7b72;font-weight:700>=</span> psutil<span style=color:#ff7b72;font-weight:700>.</span>virtual_memory()
</span></span><span style=display:flex><span>            swap <span style=color:#ff7b72;font-weight:700>=</span> psutil<span style=color:#ff7b72;font-weight:700>.</span>swap_memory()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            memory_info <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;total&#39;</span>: memory<span style=color:#ff7b72;font-weight:700>.</span>total,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;available&#39;</span>: memory<span style=color:#ff7b72;font-weight:700>.</span>available,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;used&#39;</span>: memory<span style=color:#ff7b72;font-weight:700>.</span>used,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;free&#39;</span>: memory<span style=color:#ff7b72;font-weight:700>.</span>free,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;usage_percent&#39;</span>: memory<span style=color:#ff7b72;font-weight:700>.</span>percent,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;swap&#39;</span>: {
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;total&#39;</span>: swap<span style=color:#ff7b72;font-weight:700>.</span>total,
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;used&#39;</span>: swap<span style=color:#ff7b72;font-weight:700>.</span>used,
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;free&#39;</span>: swap<span style=color:#ff7b72;font-weight:700>.</span>free,
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;usage_percent&#39;</span>: swap<span style=color:#ff7b72;font-weight:700>.</span>percent
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            memory_info[<span style=color:#a5d6ff>&#39;issues&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> memory<span style=color:#ff7b72;font-weight:700>.</span>percent <span style=color:#ff7b72;font-weight:700>&gt;</span> self<span style=color:#ff7b72;font-weight:700>.</span>thresholds[<span style=color:#a5d6ff>&#39;memory_usage&#39;</span>]:
</span></span><span style=display:flex><span>                memory_info[<span style=color:#a5d6ff>&#39;issues&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>append(<span style=color:#79c0ff>f</span><span style=color:#a5d6ff>&#34;High memory usage: </span><span style=color:#a5d6ff>{</span>memory<span style=color:#ff7b72;font-weight:700>.</span>percent<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>%&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> swap<span style=color:#ff7b72;font-weight:700>.</span>percent <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>50</span>:
</span></span><span style=display:flex><span>                memory_info[<span style=color:#a5d6ff>&#39;issues&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>append(<span style=color:#79c0ff>f</span><span style=color:#a5d6ff>&#34;High swap usage: </span><span style=color:#a5d6ff>{</span>swap<span style=color:#ff7b72;font-weight:700>.</span>percent<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>%&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> memory_info
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>except</span> <span style=color:#f0883e;font-weight:700>Exception</span> <span style=color:#ff7b72>as</span> e:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> {<span style=color:#a5d6ff>&#39;error&#39;</span>: str(e)}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>check_disk</span>(self) <span style=color:#ff7b72;font-weight:700>-&gt;</span> Dict:
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;æ£€æŸ¥ç£ç›˜çŠ¶æ€&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>try</span>:
</span></span><span style=display:flex><span>            disk_partitions <span style=color:#ff7b72;font-weight:700>=</span> psutil<span style=color:#ff7b72;font-weight:700>.</span>disk_partitions()
</span></span><span style=display:flex><span>            disk_info <span style=color:#ff7b72;font-weight:700>=</span> {<span style=color:#a5d6ff>&#39;partitions&#39;</span>: [], <span style=color:#a5d6ff>&#39;issues&#39;</span>: []}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>for</span> partition <span style=color:#ff7b72;font-weight:700>in</span> disk_partitions:
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>try</span>:
</span></span><span style=display:flex><span>                    usage <span style=color:#ff7b72;font-weight:700>=</span> psutil<span style=color:#ff7b72;font-weight:700>.</span>disk_usage(partition<span style=color:#ff7b72;font-weight:700>.</span>mountpoint)
</span></span><span style=display:flex><span>                    partition_info <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;device&#39;</span>: partition<span style=color:#ff7b72;font-weight:700>.</span>device,
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;mountpoint&#39;</span>: partition<span style=color:#ff7b72;font-weight:700>.</span>mountpoint,
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;fstype&#39;</span>: partition<span style=color:#ff7b72;font-weight:700>.</span>fstype,
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;total&#39;</span>: usage<span style=color:#ff7b72;font-weight:700>.</span>total,
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;used&#39;</span>: usage<span style=color:#ff7b72;font-weight:700>.</span>used,
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;free&#39;</span>: usage<span style=color:#ff7b72;font-weight:700>.</span>free,
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;usage_percent&#39;</span>: (usage<span style=color:#ff7b72;font-weight:700>.</span>used <span style=color:#ff7b72;font-weight:700>/</span> usage<span style=color:#ff7b72;font-weight:700>.</span>total) <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>100</span>
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>if</span> partition_info[<span style=color:#a5d6ff>&#39;usage_percent&#39;</span>] <span style=color:#ff7b72;font-weight:700>&gt;</span> self<span style=color:#ff7b72;font-weight:700>.</span>thresholds[<span style=color:#a5d6ff>&#39;disk_usage&#39;</span>]:
</span></span><span style=display:flex><span>                        disk_info[<span style=color:#a5d6ff>&#39;issues&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>append(
</span></span><span style=display:flex><span>                            <span style=color:#79c0ff>f</span><span style=color:#a5d6ff>&#34;Low disk space on </span><span style=color:#a5d6ff>{</span>partition<span style=color:#ff7b72;font-weight:700>.</span>mountpoint<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>: </span><span style=color:#a5d6ff>{</span>partition_info[<span style=color:#a5d6ff>&#39;usage_percent&#39;</span>]<span style=color:#a5d6ff>:</span><span style=color:#a5d6ff>.1f</span><span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>%&#34;</span>
</span></span><span style=display:flex><span>                        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    disk_info[<span style=color:#a5d6ff>&#39;partitions&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>append(partition_info)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>except</span> <span style=color:#f0883e;font-weight:700>PermissionError</span>:
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> disk_info
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>except</span> <span style=color:#f0883e;font-weight:700>Exception</span> <span style=color:#ff7b72>as</span> e:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> {<span style=color:#a5d6ff>&#39;error&#39;</span>: str(e)}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>check_network</span>(self) <span style=color:#ff7b72;font-weight:700>-&gt;</span> Dict:
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;æ£€æŸ¥ç½‘ç»œçŠ¶æ€&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>try</span>:
</span></span><span style=display:flex><span>            network_info <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;interfaces&#39;</span>: [],
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;connections&#39;</span>: [],
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;issues&#39;</span>: []
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic># æ£€æŸ¥ç½‘ç»œæ¥å£</span>
</span></span><span style=display:flex><span>            net_io <span style=color:#ff7b72;font-weight:700>=</span> psutil<span style=color:#ff7b72;font-weight:700>.</span>net_io_counters(pernic<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#79c0ff>True</span>)
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>for</span> interface, stats <span style=color:#ff7b72;font-weight:700>in</span> net_io<span style=color:#ff7b72;font-weight:700>.</span>items():
</span></span><span style=display:flex><span>                interface_info <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;name&#39;</span>: interface,
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;bytes_sent&#39;</span>: stats<span style=color:#ff7b72;font-weight:700>.</span>bytes_sent,
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;bytes_recv&#39;</span>: stats<span style=color:#ff7b72;font-weight:700>.</span>bytes_recv,
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;packets_sent&#39;</span>: stats<span style=color:#ff7b72;font-weight:700>.</span>packets_sent,
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;packets_recv&#39;</span>: stats<span style=color:#ff7b72;font-weight:700>.</span>packets_recv,
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;errors_in&#39;</span>: stats<span style=color:#ff7b72;font-weight:700>.</span>errin,
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;errors_out&#39;</span>: stats<span style=color:#ff7b72;font-weight:700>.</span>errout,
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;drop_in&#39;</span>: stats<span style=color:#ff7b72;font-weight:700>.</span>dropin,
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;drop_out&#39;</span>: stats<span style=color:#ff7b72;font-weight:700>.</span>dropout
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                network_info[<span style=color:#a5d6ff>&#39;interfaces&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>append(interface_info)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic># æ£€æŸ¥ç½‘ç»œè¿æ¥</span>
</span></span><span style=display:flex><span>            connections <span style=color:#ff7b72;font-weight:700>=</span> psutil<span style=color:#ff7b72;font-weight:700>.</span>net_connections()
</span></span><span style=display:flex><span>            connection_stats <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;established&#39;</span>: <span style=color:#a5d6ff>0</span>,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;listening&#39;</span>: <span style=color:#a5d6ff>0</span>,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;time_wait&#39;</span>: <span style=color:#a5d6ff>0</span>,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;total&#39;</span>: len(connections)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>for</span> conn <span style=color:#ff7b72;font-weight:700>in</span> connections:
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>if</span> conn<span style=color:#ff7b72;font-weight:700>.</span>status <span style=color:#ff7b72;font-weight:700>==</span> <span style=color:#a5d6ff>&#39;ESTABLISHED&#39;</span>:
</span></span><span style=display:flex><span>                    connection_stats[<span style=color:#a5d6ff>&#39;established&#39;</span>] <span style=color:#ff7b72;font-weight:700>+=</span> <span style=color:#a5d6ff>1</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>elif</span> conn<span style=color:#ff7b72;font-weight:700>.</span>status <span style=color:#ff7b72;font-weight:700>==</span> <span style=color:#a5d6ff>&#39;LISTEN&#39;</span>:
</span></span><span style=display:flex><span>                    connection_stats[<span style=color:#a5d6ff>&#39;listening&#39;</span>] <span style=color:#ff7b72;font-weight:700>+=</span> <span style=color:#a5d6ff>1</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>elif</span> conn<span style=color:#ff7b72;font-weight:700>.</span>status <span style=color:#ff7b72;font-weight:700>==</span> <span style=color:#a5d6ff>&#39;TIME_WAIT&#39;</span>:
</span></span><span style=display:flex><span>                    connection_stats[<span style=color:#a5d6ff>&#39;time_wait&#39;</span>] <span style=color:#ff7b72;font-weight:700>+=</span> <span style=color:#a5d6ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            network_info[<span style=color:#a5d6ff>&#39;connection_stats&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> connection_stats
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic># æ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> connection_stats[<span style=color:#a5d6ff>&#39;time_wait&#39;</span>] <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>1000</span>:
</span></span><span style=display:flex><span>                network_info[<span style=color:#a5d6ff>&#39;issues&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>append(<span style=color:#79c0ff>f</span><span style=color:#a5d6ff>&#34;Too many TIME_WAIT connections: </span><span style=color:#a5d6ff>{</span>connection_stats[<span style=color:#a5d6ff>&#39;time_wait&#39;</span>]<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> network_info
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>except</span> <span style=color:#f0883e;font-weight:700>Exception</span> <span style=color:#ff7b72>as</span> e:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> {<span style=color:#a5d6ff>&#39;error&#39;</span>: str(e)}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>check_processes</span>(self) <span style=color:#ff7b72;font-weight:700>-&gt;</span> Dict:
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;æ£€æŸ¥è¿›ç¨‹çŠ¶æ€&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>try</span>:
</span></span><span style=display:flex><span>            processes <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>            top_cpu <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>            top_memory <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>for</span> proc <span style=color:#ff7b72;font-weight:700>in</span> psutil<span style=color:#ff7b72;font-weight:700>.</span>process_iter([<span style=color:#a5d6ff>&#39;pid&#39;</span>, <span style=color:#a5d6ff>&#39;name&#39;</span>, <span style=color:#a5d6ff>&#39;cpu_percent&#39;</span>, <span style=color:#a5d6ff>&#39;memory_percent&#39;</span>, <span style=color:#a5d6ff>&#39;status&#39;</span>]):
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>try</span>:
</span></span><span style=display:flex><span>                    proc_info <span style=color:#ff7b72;font-weight:700>=</span> proc<span style=color:#ff7b72;font-weight:700>.</span>info
</span></span><span style=display:flex><span>                    processes<span style=color:#ff7b72;font-weight:700>.</span>append(proc_info)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#8b949e;font-style:italic># è®°å½•CPUä½¿ç”¨ç‡æœ€é«˜çš„è¿›ç¨‹</span>
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>if</span> len(top_cpu) <span style=color:#ff7b72;font-weight:700>&lt;</span> <span style=color:#a5d6ff>10</span>:
</span></span><span style=display:flex><span>                        top_cpu<span style=color:#ff7b72;font-weight:700>.</span>append(proc_info)
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>else</span>:
</span></span><span style=display:flex><span>                        min_proc <span style=color:#ff7b72;font-weight:700>=</span> min(top_cpu, key<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#ff7b72>lambda</span> x: x[<span style=color:#a5d6ff>&#39;cpu_percent&#39;</span>])
</span></span><span style=display:flex><span>                        <span style=color:#ff7b72>if</span> proc_info[<span style=color:#a5d6ff>&#39;cpu_percent&#39;</span>] <span style=color:#ff7b72;font-weight:700>&gt;</span> min_proc[<span style=color:#a5d6ff>&#39;cpu_percent&#39;</span>]:
</span></span><span style=display:flex><span>                            top_cpu<span style=color:#ff7b72;font-weight:700>.</span>remove(min_proc)
</span></span><span style=display:flex><span>                            top_cpu<span style=color:#ff7b72;font-weight:700>.</span>append(proc_info)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#8b949e;font-style:italic># è®°å½•å†…å­˜ä½¿ç”¨ç‡æœ€é«˜çš„è¿›ç¨‹</span>
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>if</span> len(top_memory) <span style=color:#ff7b72;font-weight:700>&lt;</span> <span style=color:#a5d6ff>10</span>:
</span></span><span style=display:flex><span>                        top_memory<span style=color:#ff7b72;font-weight:700>.</span>append(proc_info)
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>else</span>:
</span></span><span style=display:flex><span>                        min_proc <span style=color:#ff7b72;font-weight:700>=</span> min(top_memory, key<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#ff7b72>lambda</span> x: x[<span style=color:#a5d6ff>&#39;memory_percent&#39;</span>])
</span></span><span style=display:flex><span>                        <span style=color:#ff7b72>if</span> proc_info[<span style=color:#a5d6ff>&#39;memory_percent&#39;</span>] <span style=color:#ff7b72;font-weight:700>&gt;</span> min_proc[<span style=color:#a5d6ff>&#39;memory_percent&#39;</span>]:
</span></span><span style=display:flex><span>                            top_memory<span style=color:#ff7b72;font-weight:700>.</span>remove(min_proc)
</span></span><span style=display:flex><span>                            top_memory<span style=color:#ff7b72;font-weight:700>.</span>append(proc_info)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>except</span> (psutil<span style=color:#ff7b72;font-weight:700>.</span>NoSuchProcess, psutil<span style=color:#ff7b72;font-weight:700>.</span>AccessDenied):
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;total_processes&#39;</span>: len(processes),
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;top_cpu_processes&#39;</span>: sorted(top_cpu, key<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#ff7b72>lambda</span> x: x[<span style=color:#a5d6ff>&#39;cpu_percent&#39;</span>], reverse<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#79c0ff>True</span>),
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;top_memory_processes&#39;</span>: sorted(top_memory, key<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#ff7b72>lambda</span> x: x[<span style=color:#a5d6ff>&#39;memory_percent&#39;</span>], reverse<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#79c0ff>True</span>)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>except</span> <span style=color:#f0883e;font-weight:700>Exception</span> <span style=color:#ff7b72>as</span> e:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> {<span style=color:#a5d6ff>&#39;error&#39;</span>: str(e)}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>check_services</span>(self) <span style=color:#ff7b72;font-weight:700>-&gt;</span> Dict:
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;æ£€æŸ¥å…³é”®æœåŠ¡çŠ¶æ€&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        critical_services <span style=color:#ff7b72;font-weight:700>=</span> [<span style=color:#a5d6ff>&#39;nginx&#39;</span>, <span style=color:#a5d6ff>&#39;mysql&#39;</span>, <span style=color:#a5d6ff>&#39;redis-server&#39;</span>, <span style=color:#a5d6ff>&#39;ssh&#39;</span>]
</span></span><span style=display:flex><span>        service_status <span style=color:#ff7b72;font-weight:700>=</span> {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>for</span> service <span style=color:#ff7b72;font-weight:700>in</span> critical_services:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>try</span>:
</span></span><span style=display:flex><span>                <span style=color:#8b949e;font-style:italic># æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ</span>
</span></span><span style=display:flex><span>                result <span style=color:#ff7b72;font-weight:700>=</span> subprocess<span style=color:#ff7b72;font-weight:700>.</span>run(
</span></span><span style=display:flex><span>                    [<span style=color:#a5d6ff>&#39;systemctl&#39;</span>, <span style=color:#a5d6ff>&#39;is-active&#39;</span>, service],
</span></span><span style=display:flex><span>                    capture_output<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#79c0ff>True</span>, text<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#79c0ff>True</span>
</span></span><span style=display:flex><span>                )
</span></span><span style=display:flex><span>                service_status[service] <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;status&#39;</span>: result<span style=color:#ff7b72;font-weight:700>.</span>stdout<span style=color:#ff7b72;font-weight:700>.</span>strip(),
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;active&#39;</span>: result<span style=color:#ff7b72;font-weight:700>.</span>stdout<span style=color:#ff7b72;font-weight:700>.</span>strip() <span style=color:#ff7b72;font-weight:700>==</span> <span style=color:#a5d6ff>&#39;active&#39;</span>
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>except</span> <span style=color:#f0883e;font-weight:700>Exception</span> <span style=color:#ff7b72>as</span> e:
</span></span><span style=display:flex><span>                service_status[service] <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;status&#39;</span>: <span style=color:#a5d6ff>&#39;unknown&#39;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;active&#39;</span>: <span style=color:#79c0ff>False</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;error&#39;</span>: str(e)
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> service_status
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>check_logs</span>(self) <span style=color:#ff7b72;font-weight:700>-&gt;</span> Dict:
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—ä¸­çš„é”™è¯¯&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        log_files <span style=color:#ff7b72;font-weight:700>=</span> [<span style=color:#a5d6ff>&#39;/var/log/syslog&#39;</span>, <span style=color:#a5d6ff>&#39;/var/log/auth.log&#39;</span>, <span style=color:#a5d6ff>&#39;/var/log/nginx/error.log&#39;</span>]
</span></span><span style=display:flex><span>        log_errors <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>for</span> log_file <span style=color:#ff7b72;font-weight:700>in</span> log_files:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> os<span style=color:#ff7b72;font-weight:700>.</span>path<span style=color:#ff7b72;font-weight:700>.</span>exists(log_file):
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>try</span>:
</span></span><span style=display:flex><span>                    <span style=color:#8b949e;font-style:italic># è¯»å–æœ€è¿‘çš„é”™è¯¯æ—¥å¿—</span>
</span></span><span style=display:flex><span>                    result <span style=color:#ff7b72;font-weight:700>=</span> subprocess<span style=color:#ff7b72;font-weight:700>.</span>run(
</span></span><span style=display:flex><span>                        [<span style=color:#a5d6ff>&#39;tail&#39;</span>, <span style=color:#a5d6ff>&#39;-100&#39;</span>, log_file],
</span></span><span style=display:flex><span>                        capture_output<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#79c0ff>True</span>, text<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#79c0ff>True</span>
</span></span><span style=display:flex><span>                    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    errors <span style=color:#ff7b72;font-weight:700>=</span> re<span style=color:#ff7b72;font-weight:700>.</span>findall(<span style=color:#79c0ff>r</span><span style=color:#a5d6ff>&#39;.*error.*|.*ERROR.*|.*Error.*&#39;</span>, result<span style=color:#ff7b72;font-weight:700>.</span>stdout, re<span style=color:#ff7b72;font-weight:700>.</span>IGNORECASE)
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>if</span> errors:
</span></span><span style=display:flex><span>                        log_errors<span style=color:#ff7b72;font-weight:700>.</span>extend([
</span></span><span style=display:flex><span>                            {<span style=color:#a5d6ff>&#39;file&#39;</span>: log_file, <span style=color:#a5d6ff>&#39;error&#39;</span>: error<span style=color:#ff7b72;font-weight:700>.</span>strip()}
</span></span><span style=display:flex><span>                            <span style=color:#ff7b72>for</span> error <span style=color:#ff7b72;font-weight:700>in</span> errors[<span style=color:#ff7b72;font-weight:700>-</span><span style=color:#a5d6ff>10</span>:]  <span style=color:#8b949e;font-style:italic># æœ€è¿‘10ä¸ªé”™è¯¯</span>
</span></span><span style=display:flex><span>                        ])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>except</span> <span style=color:#f0883e;font-weight:700>Exception</span> <span style=color:#ff7b72>as</span> e:
</span></span><span style=display:flex><span>                    log_errors<span style=color:#ff7b72;font-weight:700>.</span>append({<span style=color:#a5d6ff>&#39;file&#39;</span>: log_file, <span style=color:#a5d6ff>&#39;error&#39;</span>: <span style=color:#79c0ff>f</span><span style=color:#a5d6ff>&#39;Failed to read log: </span><span style=color:#a5d6ff>{</span>str(e)<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>&#39;</span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> {<span style=color:#a5d6ff>&#39;errors&#39;</span>: log_errors}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>generate_summary</span>(self) <span style=color:#ff7b72;font-weight:700>-&gt;</span> Dict:
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;ç”Ÿæˆè¯Šæ–­æ‘˜è¦&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        issues <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># æ”¶é›†æ‰€æœ‰é—®é¢˜</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> <span style=color:#a5d6ff>&#39;cpu&#39;</span> <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>results <span style=color:#ff7b72;font-weight:700>and</span> <span style=color:#a5d6ff>&#39;issues&#39;</span> <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;cpu&#39;</span>]:
</span></span><span style=display:flex><span>            issues<span style=color:#ff7b72;font-weight:700>.</span>extend(self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;cpu&#39;</span>][<span style=color:#a5d6ff>&#39;issues&#39;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> <span style=color:#a5d6ff>&#39;memory&#39;</span> <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>results <span style=color:#ff7b72;font-weight:700>and</span> <span style=color:#a5d6ff>&#39;issues&#39;</span> <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;memory&#39;</span>]:
</span></span><span style=display:flex><span>            issues<span style=color:#ff7b72;font-weight:700>.</span>extend(self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;memory&#39;</span>][<span style=color:#a5d6ff>&#39;issues&#39;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> <span style=color:#a5d6ff>&#39;disk&#39;</span> <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>results <span style=color:#ff7b72;font-weight:700>and</span> <span style=color:#a5d6ff>&#39;issues&#39;</span> <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;disk&#39;</span>]:
</span></span><span style=display:flex><span>            issues<span style=color:#ff7b72;font-weight:700>.</span>extend(self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;disk&#39;</span>][<span style=color:#a5d6ff>&#39;issues&#39;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> <span style=color:#a5d6ff>&#39;network&#39;</span> <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>results <span style=color:#ff7b72;font-weight:700>and</span> <span style=color:#a5d6ff>&#39;issues&#39;</span> <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;network&#39;</span>]:
</span></span><span style=display:flex><span>            issues<span style=color:#ff7b72;font-weight:700>.</span>extend(self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;network&#39;</span>][<span style=color:#a5d6ff>&#39;issues&#39;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># æ£€æŸ¥æœåŠ¡çŠ¶æ€</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> <span style=color:#a5d6ff>&#39;services&#39;</span> <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>results:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>for</span> service, status <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>results[<span style=color:#a5d6ff>&#39;services&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>items():
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>if</span> <span style=color:#ff7b72;font-weight:700>not</span> status<span style=color:#ff7b72;font-weight:700>.</span>get(<span style=color:#a5d6ff>&#39;active&#39;</span>, <span style=color:#79c0ff>False</span>):
</span></span><span style=display:flex><span>                    issues<span style=color:#ff7b72;font-weight:700>.</span>append(<span style=color:#79c0ff>f</span><span style=color:#a5d6ff>&#34;Service </span><span style=color:#a5d6ff>{</span>service<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff> is not running&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;total_issues&#39;</span>: len(issues),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;issues&#39;</span>: issues,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;health_score&#39;</span>: max(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>100</span> <span style=color:#ff7b72;font-weight:700>-</span> len(issues) <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>10</span>),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;recommendations&#39;</span>: self<span style=color:#ff7b72;font-weight:700>.</span>generate_recommendations(issues)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>generate_recommendations</span>(self, issues: List[str]) <span style=color:#ff7b72;font-weight:700>-&gt;</span> List[str]:
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;æ ¹æ®é—®é¢˜ç”Ÿæˆå»ºè®®&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        recommendations <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>for</span> issue <span style=color:#ff7b72;font-weight:700>in</span> issues:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> <span style=color:#a5d6ff>&#39;CPU&#39;</span> <span style=color:#ff7b72;font-weight:700>in</span> issue:
</span></span><span style=display:flex><span>                recommendations<span style=color:#ff7b72;font-weight:700>.</span>append(<span style=color:#a5d6ff>&#34;Consider upgrading CPU or optimizing CPU-intensive processes&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>elif</span> <span style=color:#a5d6ff>&#39;memory&#39;</span> <span style=color:#ff7b72;font-weight:700>in</span> issue<span style=color:#ff7b72;font-weight:700>.</span>lower():
</span></span><span style=display:flex><span>                recommendations<span style=color:#ff7b72;font-weight:700>.</span>append(<span style=color:#a5d6ff>&#34;Add more RAM or optimize memory usage&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>elif</span> <span style=color:#a5d6ff>&#39;disk&#39;</span> <span style=color:#ff7b72;font-weight:700>in</span> issue<span style=color:#ff7b72;font-weight:700>.</span>lower():
</span></span><span style=display:flex><span>                recommendations<span style=color:#ff7b72;font-weight:700>.</span>append(<span style=color:#a5d6ff>&#34;Clean up disk space or add more storage&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>elif</span> <span style=color:#a5d6ff>&#39;service&#39;</span> <span style=color:#ff7b72;font-weight:700>in</span> issue<span style=color:#ff7b72;font-weight:700>.</span>lower():
</span></span><span style=display:flex><span>                recommendations<span style=color:#ff7b72;font-weight:700>.</span>append(<span style=color:#a5d6ff>&#34;Restart failed services or check service configuration&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>elif</span> <span style=color:#a5d6ff>&#39;network&#39;</span> <span style=color:#ff7b72;font-weight:700>in</span> issue<span style=color:#ff7b72;font-weight:700>.</span>lower():
</span></span><span style=display:flex><span>                recommendations<span style=color:#ff7b72;font-weight:700>.</span>append(<span style=color:#a5d6ff>&#34;Check network configuration and bandwidth&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> list(set(recommendations))  <span style=color:#8b949e;font-style:italic># å»é‡</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>main</span>():
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;&#34;&#34;ä¸»å‡½æ•°&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    diagnostic <span style=color:#ff7b72;font-weight:700>=</span> ServerDiagnostic()
</span></span><span style=display:flex><span>    results <span style=color:#ff7b72;font-weight:700>=</span> diagnostic<span style=color:#ff7b72;font-weight:700>.</span>diagnose_system()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic># ä¿å­˜è¯Šæ–­ç»“æœ</span>
</span></span><span style=display:flex><span>    timestamp <span style=color:#ff7b72;font-weight:700>=</span> datetime<span style=color:#ff7b72;font-weight:700>.</span>now()<span style=color:#ff7b72;font-weight:700>.</span>strftime(<span style=color:#a5d6ff>&#39;%Y%m</span><span style=color:#a5d6ff>%d</span><span style=color:#a5d6ff>_%H%M%S&#39;</span>)
</span></span><span style=display:flex><span>    output_file <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>f</span><span style=color:#a5d6ff>&#34;/tmp/server_diagnostic_</span><span style=color:#a5d6ff>{</span>timestamp<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>.json&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>with</span> open(output_file, <span style=color:#a5d6ff>&#39;w&#39;</span>) <span style=color:#ff7b72>as</span> f:
</span></span><span style=display:flex><span>        json<span style=color:#ff7b72;font-weight:700>.</span>dump(results, f, indent<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>2</span>, default<span style=color:#ff7b72;font-weight:700>=</span>str)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#79c0ff>f</span><span style=color:#a5d6ff>&#34;Diagnostic completed. Results saved to: </span><span style=color:#a5d6ff>{</span>output_file<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic># å¦‚æœæœ‰é—®é¢˜ï¼Œå‘é€å‘Šè­¦</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> results[<span style=color:#a5d6ff>&#39;summary&#39;</span>][<span style=color:#a5d6ff>&#39;total_issues&#39;</span>] <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#79c0ff>f</span><span style=color:#a5d6ff>&#34;Found </span><span style=color:#a5d6ff>{</span>results[<span style=color:#a5d6ff>&#39;summary&#39;</span>][<span style=color:#a5d6ff>&#39;total_issues&#39;</span>]<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff> issues:&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>for</span> issue <span style=color:#ff7b72;font-weight:700>in</span> results[<span style=color:#a5d6ff>&#39;summary&#39;</span>][<span style=color:#a5d6ff>&#39;issues&#39;</span>]:
</span></span><span style=display:flex><span>            print(<span style=color:#79c0ff>f</span><span style=color:#a5d6ff>&#34;  - </span><span style=color:#a5d6ff>{</span>issue<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>if</span> <span style=color:#79c0ff>__name__</span> <span style=color:#ff7b72;font-weight:700>==</span> <span style=color:#a5d6ff>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></td></tr></table></div></div><h2 id=æ€»ç»“>æ€»ç»“<a hidden class=anchor aria-hidden=true href=#æ€»ç»“>#</a></h2><p>ç°ä»£æœåŠ¡å™¨è¿ç»´æ˜¯ä¸€ä¸ªç»¼åˆæ€§çš„æŠ€æœ¯é¢†åŸŸï¼Œéœ€è¦æŒæ¡å¤šç§æŠ€èƒ½å’Œå·¥å…·ï¼š</p><ol><li><strong>è‡ªåŠ¨åŒ–è¿ç»´</strong>ï¼šä½¿ç”¨IaCã€é…ç½®ç®¡ç†ç­‰å·¥å…·å®ç°åŸºç¡€è®¾æ–½è‡ªåŠ¨åŒ–</li><li><strong>ç›‘æ§å‘Šè­¦</strong>ï¼šå»ºç«‹å…¨é¢çš„ç›‘æ§ä½“ç³»å’Œæ™ºèƒ½å‘Šè­¦æœºåˆ¶</li><li><strong>æ—¥å¿—ç®¡ç†</strong>ï¼šé›†ä¸­åŒ–æ—¥å¿—æ”¶é›†ã€åˆ†æå’Œå­˜å‚¨</li><li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šç³»ç»Ÿè°ƒä¼˜å’Œåº”ç”¨æ€§èƒ½ä¼˜åŒ–</li><li><strong>æ•…éšœæ’é™¤</strong>ï¼šå¿«é€Ÿå®šä½å’Œè§£å†³ç³»ç»Ÿé—®é¢˜</li></ol><p>é€šè¿‡æŒç»­å­¦ä¹ å’Œå®è·µè¿™äº›æŠ€èƒ½ï¼Œè¿ç»´å›¢é˜Ÿå¯ä»¥æ„å»ºç¨³å®šã€é«˜æ•ˆã€å¯æ‰©å±•çš„æœåŠ¡å™¨è¿ç»´ä½“ç³»ï¼Œä¸ºä¸šåŠ¡çš„æŒç»­å‘å±•æä¾›åšå®çš„æŠ€æœ¯ä¿éšœã€‚</p></div><footer class=post-footer-modern><div class=post-tags-modern><span class=tags-label>ğŸ·ï¸ æ ‡ç­¾</span><div class=tags-list><a href=/blog/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4/ class=tag-pill>æœåŠ¡å™¨è¿ç»´
</a><a href=/blog/tags/devops/ class=tag-pill>DevOps
</a><a href=/blog/tags/%E7%9B%91%E6%8E%A7/ class=tag-pill>ç›‘æ§
</a><a href=/blog/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/ class=tag-pill>è‡ªåŠ¨åŒ–
</a><a href=/blog/tags/%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86/ class=tag-pill>ç³»ç»Ÿç®¡ç†</a></div></div><style>.post-footer-modern{margin-top:3rem;padding-top:2rem;border-top:1px solid var(--border,#333333)}.post-tags-modern{display:flex;align-items:center;gap:1rem;margin-bottom:2rem;flex-wrap:wrap}.tags-label{font-size:.875rem;font-weight:600;color:var(--secondary,#999999) !important;white-space:nowrap}.tags-list{display:flex;flex-wrap:wrap;gap:.5rem;flex:1}.tag-pill{display:inline-block;padding:.25rem .75rem;background:rgba(255,255,255,5%);border:1px solid var(--border,#333333);border-radius:0;color:var(--secondary,#cccccc) !important;text-decoration:none;font-size:.8rem;font-weight:500;transition:all .2s ease}.tag-pill:hover{background:var(--primary,#ffffff);color:var(--background,#000000) !important;border-color:var(--primary,#ffffff);transform:translateY(-1px)}.post-nav-modern{margin-top:2rem}.nav-grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.nav-card{display:flex;align-items:center;gap:1rem;padding:1.25rem;background:rgba(255,255,255,2%);border:1px solid var(--border,#333333);border-radius:12px;text-decoration:none;transition:all .2s ease;min-height:80px}.nav-card:hover{background:rgba(255,255,255,5%);border-color:var(--primary,#ffffff);transform:translateY(-2px)}.nav-card.nav-prev{justify-content:flex-start}.nav-card.nav-next{justify-content:flex-end;text-align:right}.nav-card.nav-next .nav-content{text-align:right}.nav-empty{display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,1%);border:1px dashed var(--border,#333333);color:var(--secondary,#666666)}.nav-arrow{font-size:1.5rem;color:var(--primary,#ffffff);font-weight:300}.nav-content{flex:1}.nav-title{font-size:.95rem;font-weight:600;color:var(--primary,#ffffff) !important;line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}[data-theme=light] .post-footer-modern{border-color:var(--border-light,#dee2e6)}[data-theme=light] .tags-label{color:var(--secondary-light,#6c757d) !important}[data-theme=light] .tag-pill{background:rgba(0,0,0,5%);border-color:var(--border-light,#dee2e6);color:var(--secondary-light,#495057) !important}[data-theme=light] .tag-pill:hover{background:var(--primary-light,#0066cc);color:var(--background-light,#ffffff) !important;border-color:var(--primary-light,#0066cc)}[data-theme=light] .nav-card{background:rgba(0,0,0,2%);border-color:var(--border-light,#dee2e6)}[data-theme=light] .nav-card:hover{background:rgba(0,102,204,5%);border-color:var(--primary-light,#0066cc)}[data-theme=light] .nav-empty{background:rgba(0,0,0,1%);border-color:var(--border-light,#dee2e6);color:var(--secondary-light,#6c757d)}[data-theme=light] .nav-arrow{color:var(--primary-light,#0066cc)}[data-theme=light] .nav-title{color:var(--primary-light,#212529) !important}@media(max-width:768px){.nav-grid{grid-template-columns:1fr;gap:.75rem}.nav-card{padding:1rem;min-height:70px}.nav-card.nav-next{text-align:left}.nav-card.nav-next .nav-content{text-align:left}.nav-title{font-size:.875rem}.post-tags-modern{flex-direction:column;gap:.75rem}}@media(max-width:480px){.nav-arrow{font-size:1.25rem}.nav-card{padding:.875rem}.nav-title{font-size:.8rem;-webkit-line-clamp:1}}</style><nav class=post-nav-modern><div class=nav-grid><a href=/blog/articles/ddos%E9%98%B2%E6%8A%A4%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E4%BB%8E%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%E5%88%B0%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2%E7%9A%84%E5%AE%8C%E6%95%B4%E9%98%B2%E6%8A%A4%E4%BD%93%E7%B3%BB/ class="nav-card nav-prev"><div class=nav-arrow>â†</div><div class=nav-content><div class=nav-title>DDoSé˜²æŠ¤å®Œå…¨æŒ‡å—ï¼šä»åŸç†åˆ†æåˆ°å®æˆ˜éƒ¨ç½²çš„å®Œæ•´é˜²æŠ¤ä½“ç³»</div></div></a><a href=/blog/articles/2025%E5%B9%B4%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E7%BB%88%E6%9E%81%E6%8C%87%E5%8D%97%E4%BB%8Ecore-web-vitals%E5%88%B0%E7%94%A8%E6%88%B7%E4%BD%93%E9%AA%8C%E4%BC%98%E5%8C%96/ class="nav-card nav-next"><div class=nav-content><div class=nav-title>2025å¹´å‰ç«¯æ€§èƒ½ä¼˜åŒ–ç»ˆææŒ‡å—ï¼šä»Core Web Vitalsåˆ°ç”¨æˆ·ä½“éªŒä¼˜åŒ–</div></div><div class=nav-arrow>â†’</div></a></div></nav></footer></main><aside class=post-sidebar><div class=sidebar-toc id=sidebar-toc><div class=toc-header><div class=toc-title>ç›®å½•</div><button class=toc-toggle id=toc-toggle aria-label="Toggle TOC">
<svg class="toc-toggle-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18M6 6l12 12"/></svg></button></div><div class=toc-content id=toc-content><ul class=toc-list><li class="toc-item toc-h2"><a href=#h2-0 class=toc-item-link><span class=toc-item-text>è‡ªåŠ¨åŒ–è¿ç»´åŸºç¡€</span></a></li><li class="toc-item toc-h2"><a href=#h2-1 class=toc-item-link><span class=toc-item-text>ç›‘æ§ä¸å‘Šè­¦ç³»ç»Ÿ</span></a></li><li class="toc-item toc-h2"><a href=#h2-2 class=toc-item-link><span class=toc-item-text>æ—¥å¿—ç®¡ç†ä¸åˆ†æ</span></a></li><li class="toc-item toc-h2"><a href=#h2-3 class=toc-item-link><span class=toc-item-text>æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</span></a></li><li class="toc-item toc-h2"><a href=#h2-4 class=toc-item-link><span class=toc-item-text>æ•…éšœæ’é™¤ä¸æ¢å¤</span></a></li><li class="toc-item toc-h2"><a href=#h2-5 class=toc-item-link><span class=toc-item-text>æ€»ç»“</span></a></li></ul></div></div><script>document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("sidebar-toc"),t=document.getElementById("toc-toggle"),o=document.getElementById("toc-content"),i=t?.querySelector(".toc-toggle-icon");if(!e)return;let n=!1;t&&t.addEventListener("click",function(){n=!n,n?(o.style.display="none",e.style.width="auto",i.innerHTML='<path d="M9 18l6-6-6-6"/>'):(o.style.display="block",e.style.width="200px",i.innerHTML='<path d="M18 6L6 18M6 6l12 12"/>')});const s=document.querySelector(".post-content");if(s){const e=s.querySelectorAll("h1");e.forEach((e,t)=>{e.id=`h1-${t}`});const t=s.querySelectorAll("h2");t.forEach((e,t)=>{e.id=`h2-${t}`})}const a=document.querySelectorAll(".toc-item-link");a.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const n=this.getAttribute("href").substring(1),t=document.getElementById(n);if(t){const e=document.querySelector(".post-header-main")?.offsetHeight||0,n=t.offsetTop-e-20;window.scrollTo({top:n,behavior:"smooth"})}})})})</script><style>.sidebar-toc{position:sticky;top:2rem;width:200px;background:#fff;border:1px solid #e5e7eb;border-radius:4px;overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,.1);z-index:100}.sidebar-toc.hidden{display:none}.toc-header{padding:12px 16px;border-bottom:1px solid #e5e7eb;background:#fafbfc;display:flex;align-items:center;justify-content:space-between}.toc-title{margin:0;font-size:13px;font-weight:500;color:#374151 !important;font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,sans-serif;text-transform:uppercase;letter-spacing:1px}.toc-toggle{background:0 0;border:none;cursor:pointer;padding:4px;border-radius:4px;display:flex;align-items:center;justify-content:center;transition:all .2s ease;color:#6b7280}.toc-toggle:hover{background:#e5e7eb;color:#374151}.toc-toggle-icon{transition:transform .2s ease}.toc-content{padding:12px 0}.toc-list{list-style:none;margin:0;padding:0}.toc-item{margin-bottom:4px;display:block !important;visibility:visible !important}.toc-h1,.toc-h2{display:block !important}.toc-h2{margin-left:0}.toc-item-link{display:flex;align-items:center;gap:8px;padding:8px 12px;color:#374151 !important;text-decoration:none;font-size:13px;line-height:1.4;border-radius:3px;transition:all .2s ease;font-weight:400}.toc-item-link:hover{background:#f8fafc;color:#1f2937 !important}.toc-item-link.active{background:#e0f2fe;color:#01579b !important;font-weight:500}.toc-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}.dot-red{background:#ef4444}.dot-blue{background:#2196f3}.toc-item-text{color:#1f2937 !important;font-weight:400;flex:1;display:inline !important;visibility:visible !important;opacity:1 !important;font-size:13px !important;line-height:1.4 !important}.toc-item-link .toc-item-text{color:#1f2937 !important;display:inline !important;visibility:visible !important;opacity:1 !important}.toc-item.active .dot-red{background:#d32f2f}.toc-item.active .dot-blue{background:#1976d2}[data-theme=dark] .sidebar-toc{background:#1f2937;border-color:#374151;box-shadow:0 1px 3px rgba(0,0,0,.3)}[data-theme=dark] .toc-header{background:#111827;border-color:#374151}[data-theme=dark] .toc-title{color:#f3f4f6 !important}[data-theme=dark] .toc-toggle{color:#9ca3af}[data-theme=dark] .toc-toggle:hover{background:#374151;color:#f3f4f6}[data-theme=dark] .toc-item-link{color:#e5e7eb !important}[data-theme=dark] .toc-item-link:hover{background:#374151;color:#f9fafb !important}[data-theme=dark] .toc-item-link.active{background:#0d47a1;color:#fff !important}[data-theme=dark] .toc-item-text{color:#f9fafb !important;display:inline !important;visibility:visible !important;opacity:1 !important}[data-theme=dark] .toc-item-link .toc-item-text{color:#f9fafb !important;display:inline !important;visibility:visible !important;opacity:1 !important}@media(max-width:1024px){.sidebar-toc{display:none}.post-content-wrapper{grid-template-columns:1fr !important;padding:0 1rem !important}}</style><style>.post-content-wrapper{display:grid;grid-template-columns:1fr 200px;gap:2rem;padding:0 2rem;max-width:100%}.post-content-main{min-width:0}.post-sidebar{position:sticky;top:2rem;height:fit-content;min-width:0}.post-header-main{margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid var(--border,#333333)}.post-header-main .post-title{color:var(--primary,#ffffff) !important;font-size:2.5rem;font-weight:700;line-height:1.2;margin-bottom:1rem}.post-header-main .post-description{color:var(--secondary,#cccccc) !important;font-size:1.1rem;line-height:1.6;margin-bottom:1rem}.post-header-main .post-meta{margin-bottom:0}@media(max-width:1024px){.post-content-wrapper{grid-template-columns:1fr !important;gap:1rem;padding:0 1rem !important}.post-sidebar{display:none}}@media(max-width:768px){.post-header-main .post-title{font-size:2rem}.post-header-main .post-description{font-size:1rem}}</style></aside></div></article></main><footer class=footer><span>Â© 2024-2025 æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢</span> Â·</footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>