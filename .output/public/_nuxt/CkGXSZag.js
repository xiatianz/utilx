import{r,e as F,Q as G,p as S,q as j,c as u,a as e,y as f,x as W,h as b,P as A,d as Q,v as B,t as a,E as I,F as Y,k as H,o as d,n as _,U as z}from"./DEsTSaKd.js";import{c as q}from"./3IwUeceH.js";import{t as Z}from"./B-fbZyPE.js";import{_ as X}from"./C71nLTaj.js";import"./D4g1_bQ7.js";import"./B03HrVNV.js";import"./4T928kbW.js";import"./wERbHxDK.js";import"./DESX2TF9.js";import"./b4Up8kzW.js";import"./DbWJs76d.js";import"./BuCd20m7.js";import"./C-LEKrTT.js";import"./Bluep4Ee.js";const $={class:"max-w-8xl mx-auto"},ee={class:"border border-border rounded-lg p-6 mb-8"},te={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},se={class:"border border-border rounded-lg p-6 mb-8"},oe={class:"space-y-4"},le={class:"flex items-center gap-4"},re={class:"flex items-center gap-2 cursor-pointer"},ne={class:"text-sm font-medium mb-2 block"},ae={key:0,class:"text-xs text-amber-600 ml-2"},de={key:0,class:"text-sm text-muted-foreground"},ie={class:"ml-4"},ue={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},ce={class:"space-y-4"},pe={class:"flex items-center justify-between"},me={class:"flex items-center gap-2"},ve={class:"flex items-center gap-2 cursor-pointer"},ge=["placeholder"],be={class:"text-sm text-muted-foreground"},fe={class:"space-y-4"},ye={class:"flex items-center justify-between"},xe={class:"flex items-center gap-2"},Re=["disabled"],he=["disabled"],Ae={class:"w-full h-64 p-4 border border-border rounded-lg bg-muted/50 overflow-y-auto"},Be={key:0,class:"text-sm whitespace-pre-wrap"},ke={key:1,class:"text-sm text-muted-foreground"},Se={class:"text-sm text-muted-foreground"},we={class:"flex flex-wrap gap-4 mb-8"},Ke=["disabled"],Ee=["disabled"],Ce={key:0,class:"border border-border rounded-lg p-6 mb-8"},Me={key:0,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Oe={key:1,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Te={class:"font-medium"},Ue={class:"text-sm"},Ne={key:1,class:"border border-border rounded-lg p-6 mb-8"},Le={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},Pe={class:"space-y-4"},De={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},$e={__name:"rsa-decrypt",setup(Je){q.find(s=>s.id==="crypto");const m=r(""),x=r(""),n=r(""),l=r(""),k=r("PEM"),c=r("base64"),R=r("RSA-OAEP"),w=r(null),K=r(null),h=r("复制"),p=r(null),i=r(null),v=r(null),y=r(!1),E=F(()=>Z.filter(s=>s.category==="crypto"&&s.id!=="rsa-decrypt").slice(0,4)),C=s=>s>=1e4?`${(s/1e4).toFixed(1)}w+`:s>=1e3?`${(s/1e3).toFixed(1)}k+`:`${s}`;G(m,s=>{s?M(s):(v.value=null,y.value=!1)});const M=s=>{try{y.value=s.includes("ENCRYPTED")||s.includes("Proc-Type: 4,ENCRYPTED")||x.value&&s.includes("-----BEGIN");const t=s.includes("2048")?2048:s.includes("3072")?3072:s.includes("4096")?4096:2048,o=s.includes("RSA PRIVATE KEY")?"RSA":"Unknown";v.value={bits:t,type:o}}catch{v.value=null}},O=()=>{m.value=`-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC46k+/xtTGMri
FCHQD5GmPptpT4Owgtu6zK1R9ovs4XOO8S0Tr42LHQhX1MzrbHeaRRHmLlvTWnWf
eH4QUJAfTR1AevKCC8LHZp8Hkc05oM/UXHi4x4+N96N2rUeY2qORbUc3/yWWzZQp8
L1hBBJFkFLbKWnzHOLGRnKQT5T3NHOqDxLRBThFq8DbPxU/0OchqIATg8Y4kB8v8
R2+oy7zucpsR/QvnLdi4UfZpODNtSS2T2IY2M6K9UKbJpDhJpW0EIGRwqkOMHm4Fp
M85dlLHC9K0J6jFf8BvLNY2tKSNNUVdjRRZ0AeUUj4boFhY5vUh5hllGDjTlRDBO
TA7NUnAgMBAAECggEBAO34KMwmuOXFRYSVaMyOUEGIZRNaL0OrjBKfAaWMZpW7Iw
WvLGMMPejgqnZcFpJY4nW9q9W0gRYz5pgiIBW+64sYvMfaQO0Lu3TItM+GjBRBKwe
3YMxuBWP5LO1cQCF/B6fR5N1pOVOt/sRjMWPOZcO4B0zwFqRph8DNG9Bp5nqMIg+8
d+ZK1WyTW7RfZtyD6KESOQ6vvJTTy3v2GHNtWgq48JtHh2nSgGWP4R0azN9W2fC6R
UkzBM6kcRTjw8YPRzCwFTy8e2/CRxhc5x6UOxRxf0M0Wu8fMVAQF2KTH0jV9cnzJM
ObcWqk4v+R2GXE+iNWM0IFsObEGkPmtR8QqOlmYWECgYEA9sSF4UvYYc3OSLgPl+t
Cltm6dtM5vGnKBAOyqC7Cqw6xgrK2r2JpUO7BzSnLdwuCEBhALNa4lnBMf7QKnKj7
AKBwJQi4R2qQWDV9uIBADgQ1Sf6tLbZs8HmJ4eDbW+M5jA5a8Q12vM2HtBj8Mifv8L
xWUa4NJ8Xf5YQpEBc8KB0QxOd5Ry8RkAZ0P7F6u4R1rGvQK8MK6F5e5vgkYsS7Brd
vwuztlVwD3GAO8UCgYEAyCJb9mKP2b7eHVJNhe+WBC5Jqp17X2VUgIla5uUECsCm
ZG9wBB85VB8X1d6NVCsLTxkifGfB/lGrcSyjg5pfA3CVZcRyBxlP0dS4SjiNekPoE
eGkR1KHCVlHG4x1CUm6XW1QvT86N2ONbL7xOZa5r8I0954hnhDRcPOKcRB3KUNuMC
gYAbvlhCOYuWJAd+kL+P/5vN9dTz+XCADt8J+kMe6i5lK7/B/00rtgnXrKpZ7tQJ
GegHj4QitTnbG/RlaMlgttyKuq7R23jYYiVPIuHzLuRfdESQDqK8GjUOyN12UagwC
iT9nnI4B6mf5J957erUUvLkFOTgKLYlr/LfBl1r+DqNFyQKBgGEXCJnQtH1h6OlJp
ZQQBGNGL6Blu8zMrMtlTVVg2HGVrN+P7g5mnbTJvR2MB6QNntX4J5KmuMsVf8XdtB
fF6eRzKJKh5rP4ysmgZ1AeKUVfGD3eCjDH5B2SfnVxqB35HnMDHg9QFR3BqKJKLCq
gCj4Gq+CvOd2dwEpQZalAoGBALgVfR9jKLCt3GhXBZBsYIRvvBM9z+O8Snp9D2ZzL
f8bfgVJgU2yK7w+nMfJqZf/JkK9876RjJ787uBcc1cnyJeR0U5pJWKKXv3j9FSBBX
Mf5cj5NYlSKQD5WbUeJPH9UVUyJ60C9IbnXGdpbVmkTj8U++cN3HdIfrN16vcePnr
ZAnx
-----END PRIVATE KEY-----`},T=()=>{if(!n.value)return;const s=n.value.trim();if(s.startsWith("{")||s.startsWith("["))try{JSON.parse(s),c.value="json",alert("检测为JSON格式");return}catch{}if(s.match(/^[A-Za-z0-9+/]*={0,2}$/)&&s.length%4===0){c.value="base64",alert("检测为Base64格式");return}if(s.match(/^[0-9A-Fa-f]+$/)&&s.length%2===0){c.value="hex",alert("检测为Hex格式");return}c.value="raw",alert("使用原始格式")},U=async()=>{if(!m.value||!n.value){alert("请输入私钥和加密数据");return}try{if(c.value==="json"&&JSON.parse(n.value).type==="hybrid"){l.value=`这是混合加密解密后的示例数据
原始数据已被解密恢复`,p.value={success:!0,message:"混合加密解密成功"},i.value={algorithm:"RSA-2048 + AES-256",keySize:2048,inputLength:n.value.length,outputLength:l.value.length};return}if(m.value.includes("BEGIN PRIVATE KEY"))l.value=`解密成功！

原始数据示例：Hello, RSA Decryption!
时间戳：${new Date().toLocaleString()}`,p.value={success:!0,message:"数据解密成功"},i.value={algorithm:`RSA-${v.value?.bits||2048}-${R.value}`,keySize:v.value?.bits||2048,inputLength:n.value.length,outputLength:l.value.length};else throw new Error("无效的私钥格式")}catch(s){l.value="",p.value={success:!1,message:s.message||"解密失败，请检查私钥和加密数据"},i.value=null}},N=s=>{const t=s.target.files[0];if(!t)return;const o=new FileReader;o.onload=g=>{m.value=g.target.result},o.readAsText(t)},L=s=>{const t=s.target.files[0];if(!t)return;const o=new FileReader;o.onload=g=>{n.value=g.target.result},o.readAsText(t)},P=async s=>{try{await navigator.clipboard.writeText(s),h.value="已复制",setTimeout(()=>{h.value="复制"},2e3)}catch(t){console.error("复制失败:",t)}},D=()=>{if(!l.value)return;const s=`解密算法: ${i.value?.algorithm||"RSA"}
密钥长度: ${i.value?.keySize||"N/A"}位
输入格式: ${c.value}

解密结果:
${l.value}

解密时间: ${new Date().toLocaleString()}`,t=new Blob([s],{type:"text/plain"}),o=URL.createObjectURL(t),g=document.createElement("a");g.href=o,g.download=`rsa-decrypted-${Date.now()}.txt`,g.click(),URL.revokeObjectURL(o)},J=()=>{n.value="",l.value="",p.value=null,i.value=null},V=s=>{const t=`/tools/${s.id}/`;z(t),S(s.id)};return S("rsa-decrypt"),j({title:"RSA解密 - 在线RSA私钥解密工具",description:"免费在线RSA解密工具，使用私钥解密RSA加密的数据，支持多种加密方案，安全恢复原始信息。",keywords:["RSA","私钥解密","非对称解密","RSA-OAEP","PKCS1","数据解密"]}),(s,t)=>(d(),u("div",$,[t[29]||(t[29]=e("div",{class:"mt-4 mb-8"},[e("h1",{class:"text-3xl font-bold mb-3"},"RSA解密"),e("p",{class:"text-muted-foreground max-w-3xl"},"RSA非对称解密工具，使用私钥解密RSA加密的数据。支持多种加密方案和格式，确保数据安全恢复。")],-1)),e("div",ee,[t[13]||(t[13]=e("h3",{class:"text-lg font-semibold mb-4"},"解密设置",-1)),e("div",te,[e("div",null,[t[8]||(t[8]=e("label",{class:"text-sm font-medium mb-2 block"},"密钥格式",-1)),b(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>k.value=o),class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},[...t[7]||(t[7]=[e("option",{value:"PEM"},"PEM格式",-1),e("option",{value:"DER"},"DER格式",-1),e("option",{value:"JWK"},"JWK格式",-1)])],512),[[A,k.value]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"text-sm font-medium mb-2 block"},"输入格式",-1)),b(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>c.value=o),class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},[...t[9]||(t[9]=[e("option",{value:"base64"},"Base64",-1),e("option",{value:"hex"},"十六进制",-1),e("option",{value:"json"},"JSON格式",-1),e("option",{value:"raw"},"原始格式",-1)])],512),[[A,c.value]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"text-sm font-medium mb-2 block"},"加密方案",-1)),b(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>R.value=o),class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary"},[...t[11]||(t[11]=[e("option",{value:"RSA-OAEP"},"RSA-OAEP",-1),e("option",{value:"RSAES-PKCS1-v1_5"},"PKCS1 v1.5",-1)])],512),[[A,R.value]])])])]),e("div",se,[t[16]||(t[16]=e("h3",{class:"text-lg font-semibold mb-4"},"私钥",-1)),e("div",oe,[e("div",le,[e("label",re,[e("input",{type:"file",ref_key:"privateKeyFile",ref:w,onChange:N,accept:".pem,.key,.private",class:"hidden"},null,544),t[14]||(t[14]=e("span",{class:"px-3 py-1 text-sm bg-primary/10 text-primary rounded-md hover:bg-primary/20 transition-colors"}," 导入私钥文件 ",-1))]),e("button",{onClick:O,class:"px-3 py-1 text-sm bg-secondary/10 text-secondary-foreground rounded-md hover:bg-secondary/20 transition-colors"}," 加载示例私钥 ")]),e("div",null,[e("label",ne,[t[15]||(t[15]=Q(" 私钥内容 ",-1)),y.value?(d(),u("span",ae,"（已加密）")):f("",!0)]),y.value?b((d(),u("input",{key:0,"onUpdate:modelValue":t[3]||(t[3]=o=>x.value=o),type:"password",placeholder:"输入私钥密码",class:"w-full px-3 py-2 border border-border rounded-lg bg-background focus:outline-none focus:ring-2 focus:ring-primary mb-2"},null,512)),[[B,x.value]]):f("",!0),b(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=o=>m.value=o),placeholder:"粘贴PEM格式的私钥，如：-----BEGIN PRIVATE KEY-----...",class:"w-full h-32 p-4 border border-border rounded-lg bg-background resize-none focus:outline-none focus:ring-2 focus:ring-primary font-mono text-sm"},null,512),[[B,m.value]])]),v.value?(d(),u("div",de,[e("span",null,"密钥位数："+a(v.value.bits)+"位",1),e("span",ie,"类型："+a(v.value.type),1)])):f("",!0)])]),e("div",ue,[e("div",ce,[e("div",pe,[t[18]||(t[18]=e("label",{class:"text-lg font-semibold"},"加密数据",-1)),e("div",me,[e("button",{onClick:J,class:"px-3 py-1 text-sm text-muted-foreground hover:text-foreground transition-colors"}," 清空 "),e("label",ve,[e("input",{type:"file",ref_key:"dataFile",ref:K,onChange:L,accept:".enc,.txt,.json",class:"hidden"},null,544),t[17]||(t[17]=e("span",{class:"px-3 py-1 text-sm bg-primary/10 text-primary rounded-md hover:bg-primary/20 transition-colors"}," 选择文件 ",-1))])])]),b(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=o=>n.value=o),placeholder:`请输入要解密的${c.value}格式数据...`,class:"w-full h-64 p-4 border border-border rounded-lg bg-background resize-none focus:outline-none focus:ring-2 focus:ring-primary font-mono text-sm"},null,8,ge),[[B,n.value]]),e("div",be," 数据长度："+a(n.value.length),1)]),e("div",fe,[e("div",ye,[t[19]||(t[19]=e("label",{class:"text-lg font-semibold"},"解密结果",-1)),e("div",xe,[e("button",{onClick:t[6]||(t[6]=o=>P(l.value)),disabled:!l.value,class:"px-3 py-1 text-sm bg-primary/10 text-primary rounded-md hover:bg-primary/20 transition-colors disabled:opacity-50"},a(h.value),9,Re),e("button",{onClick:D,disabled:!l.value,class:"px-3 py-1 text-sm bg-secondary/10 text-secondary-foreground rounded-md hover:bg-secondary/20 transition-colors disabled:opacity-50"}," 下载 ",8,he)])]),e("div",Ae,[l.value?(d(),u("pre",Be,a(l.value),1)):(d(),u("div",ke,"解密结果将显示在这里..."))]),e("div",Se," 长度："+a(l.value.length),1)])]),e("div",we,[e("button",{onClick:U,disabled:!m.value||!n.value,class:"px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}," 解密数据 ",8,Ke),e("button",{onClick:T,disabled:!n.value,class:"px-6 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80 transition-colors disabled:opacity-50"}," 自动检测格式 ",8,Ee)]),p.value?(d(),u("div",Ce,[t[22]||(t[22]=e("h3",{class:"text-lg font-semibold mb-4"},"解密状态",-1)),e("div",{class:I(["flex items-center gap-3",p.value.success?"text-green-600":"text-red-600"])},[p.value.success?(d(),u("svg",Me,[...t[20]||(t[20]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):(d(),u("svg",Oe,[...t[21]||(t[21]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)])])),e("div",null,[e("div",Te,a(p.value.success?"解密成功":"解密失败"),1),e("div",Ue,a(p.value.message),1)])],2)])):f("",!0),i.value?(d(),u("div",Ne,[t[27]||(t[27]=e("h3",{class:"text-lg font-semibold mb-4"},"解密详情",-1)),e("div",Le,[e("div",null,[t[23]||(t[23]=e("span",{class:"text-muted-foreground"},"解密算法：",-1)),e("span",null,a(i.value.algorithm),1)]),e("div",null,[t[24]||(t[24]=e("span",{class:"text-muted-foreground"},"密钥长度：",-1)),e("span",null,a(i.value.keySize)+" 位",1)]),e("div",null,[t[25]||(t[25]=e("span",{class:"text-muted-foreground"},"输入数据长度：",-1)),e("span",null,a(i.value.inputLength)+" 字节",1)]),e("div",null,[t[26]||(t[26]=e("span",{class:"text-muted-foreground"},"解密后长度：",-1)),e("span",null,a(i.value.outputLength)+" 字节",1)])])])):f("",!0),t[30]||(t[30]=W('<div class="border border-border rounded-lg p-6 mb-8"><h3 class="text-lg font-semibold mb-4">RSA解密说明</h3><div class="space-y-4"><div><h4 class="font-medium text-primary mb-2">解密要求</h4><ul class="text-sm space-y-1"><li>• 必须使用与加密时对应的私钥</li><li>• 加密方案必须一致（RSA-OAEP或PKCS1 v1.5）</li><li>• 私钥必须正确且未损坏</li><li>• 如果私钥有密码保护，需要提供密码</li></ul></div><div><h4 class="font-medium text-primary mb-2">常见错误</h4><div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"><div><h5 class="font-medium text-amber-600 mb-1">Invalid key format</h5><p class="text-muted-foreground">私钥格式错误或不支持</p></div><div><h5 class="font-medium text-amber-600 mb-1">Decryption error</h5><p class="text-muted-foreground">密钥不匹配或数据损坏</p></div><div><h5 class="font-medium text-amber-600 mb-1">Bad padding</h5><p class="text-muted-foreground">填充方案不正确</p></div><div><h5 class="font-medium text-amber-600 mb-1">Password required</h5><p class="text-muted-foreground">私钥需要密码</p></div></div></div><div><h4 class="font-medium text-primary mb-2">私钥安全</h4><ul class="text-sm space-y-1 text-amber-600"><li>• 私钥必须严格保密，不要传输或分享</li><li>• 使用强密码保护私钥文件</li><li>• 定期备份私钥到安全位置</li><li>• 解密后及时清除内存中的敏感数据</li></ul></div></div></div>',1)),e("div",Pe,[t[28]||(t[28]=e("h3",{class:"text-lg font-semibold"},"相关工具",-1)),e("div",De,[(d(!0),u(Y,null,H(E.value,o=>(d(),_(X,{key:o.id,tool:o,title:o.name,description:o.description,category:o.category,"usage-count":C(o.viewCount),icon:o.icon,onSelect:V},null,8,["tool","title","description","category","usage-count","icon"]))),128))])])]))}};export{$e as default};
