<!doctype html><html lang=zh-cn dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>VS Codeæ‰©å±•å¼€å‘å®Œå…¨æŒ‡å—ï¼šæ‰“é€ ä¸ªæ€§åŒ–çš„å¼€å‘ç¯å¢ƒ | æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·</title><meta name=keywords content="VS Code,æ‰©å±•å¼€å‘,TypeScript,IDE,å¼€å‘å·¥å…·"><meta name=description content="æ·±å…¥ä»‹ç»VS Codeæ‰©å±•å¼€å‘çš„å®Œæ•´æµç¨‹ï¼ŒåŒ…æ‹¬APIä½¿ç”¨ã€å‘å¸ƒæµç¨‹ã€æœ€ä½³å®è·µç­‰ï¼Œå¸®åŠ©å¼€å‘è€…åˆ›å»ºå¼ºå¤§å®ç”¨çš„VS Codeæ‰©å±•ã€‚"><meta name=author content="æœ‰æ¡å·¥å…·å›¢é˜Ÿ"><link rel=canonical href=/blog/articles/vscode-extensions-guide/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.7e8505b7cdf8bb22ab2305e53c2700bb06c7e64faeb72cd3468823a9a3bd3d6e.css integrity="sha256-foUFt834uyKrIwXlPCcAuwbH5k+utyzTRogjqaO9PW4=" rel="preload stylesheet" as=style><link rel=icon href=/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/blog/favicon-32x32.png><link rel=apple-touch-icon href=/blog/apple-touch-icon.png><link rel=mask-icon href=/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=/blog/articles/vscode-extensions-guide/feed.xml title=rss><link rel=alternate hreflang=zh-cn href=/blog/articles/vscode-extensions-guide/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><script src=/js/external-link-config.js></script><script src=/js/external-link-interceptor.js></script><link rel=stylesheet href=/blog/css/custom.css media=screen><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«","url":"https://www.util.cn/blog/","description":"æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚æä¾›JSONæ ¼å¼åŒ–ã€SQLä¼˜åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰åœ¨çº¿å·¥å…·çš„è¯¦ç»†ä½¿ç”¨æŒ‡å—ï¼Œå¸®åŠ©å¼€å‘è€…æå‡å·¥ä½œæ•ˆç‡ã€‚","publisher":{"@type":"Organization","name":"æœ‰æ¡å·¥å…·","url":"https://www.util.cn","logo":{"@type":"ImageObject","url":"https://www.util.cn/blog/logo/logo-256.png","width":256,"height":256}},"potentialAction":[{"@type":"SearchAction","target":"https://www.util.cn/blog/search?q={search_term_string}","query-input":"required name=search_term_string"}]}</script><meta property="og:type" content="website"><meta property="og:title" content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«"><meta property="og:description" content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚æä¾›JSONæ ¼å¼åŒ–ã€SQLä¼˜åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰åœ¨çº¿å·¥å…·çš„è¯¦ç»†ä½¿ç”¨æŒ‡å—ï¼Œå¸®åŠ©å¼€å‘è€…æå‡å·¥ä½œæ•ˆç‡ã€‚"><meta property="og:url" content="https://www.util.cn/blog/"><meta property="og:site_name" content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢"><meta property="og:image" content="https://www.util.cn/blog/logo/logo-256.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«"><meta name=twitter:description content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚"><meta name=twitter:image content="https://www.util.cn/blog/logo/logo-256.png"><meta name=baidu-site-verification content><meta name=category content="æŠ€æœ¯åšå®¢,å¼€å‘è€…å·¥å…·,ç¼–ç¨‹æ•™ç¨‹"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=rating content="General"><script id=51la_code async crossorigin=anonymous src="https://sdk.51.la/js-sdk-pro.min.js?id=3OM52V0xJAPv6ozF&hash=pro"></script><script>window.addEventListener("load",function(){setTimeout(function(){typeof la!="undefined"?console.log("51laç»Ÿè®¡å·²åŠ è½½"):(console.warn("51laç»Ÿè®¡åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ"),function(){var e=document.createElement("script");e.src="https://sdk.51.la/js-sdk-pro.min.js?id=3OM52V0xJAPv6ozF&hash=backup",e.async=!0,document.head.appendChild(e)}())},3e3)})</script><meta property="og:url" content="/blog/articles/vscode-extensions-guide/"><meta property="og:site_name" content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·"><meta property="og:title" content="VS Codeæ‰©å±•å¼€å‘å®Œå…¨æŒ‡å—ï¼šæ‰“é€ ä¸ªæ€§åŒ–çš„å¼€å‘ç¯å¢ƒ"><meta property="og:description" content="æ·±å…¥ä»‹ç»VS Codeæ‰©å±•å¼€å‘çš„å®Œæ•´æµç¨‹ï¼ŒåŒ…æ‹¬APIä½¿ç”¨ã€å‘å¸ƒæµç¨‹ã€æœ€ä½³å®è·µç­‰ï¼Œå¸®åŠ©å¼€å‘è€…åˆ›å»ºå¼ºå¤§å®ç”¨çš„VS Codeæ‰©å±•ã€‚"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-16T00:00:00+00:00"><meta property="article:modified_time" content="2025-12-16T00:00:00+00:00"><meta property="article:tag" content="VS Code"><meta property="article:tag" content="æ‰©å±•å¼€å‘"><meta property="article:tag" content="TypeScript"><meta property="article:tag" content="IDE"><meta property="article:tag" content="å¼€å‘å·¥å…·"><meta name=twitter:card content="summary"><meta name=twitter:title content="VS Codeæ‰©å±•å¼€å‘å®Œå…¨æŒ‡å—ï¼šæ‰“é€ ä¸ªæ€§åŒ–çš„å¼€å‘ç¯å¢ƒ"><meta name=twitter:description content="æ·±å…¥ä»‹ç»VS Codeæ‰©å±•å¼€å‘çš„å®Œæ•´æµç¨‹ï¼ŒåŒ…æ‹¬APIä½¿ç”¨ã€å‘å¸ƒæµç¨‹ã€æœ€ä½³å®è·µç­‰ï¼Œå¸®åŠ©å¼€å‘è€…åˆ›å»ºå¼ºå¤§å®ç”¨çš„VS Codeæ‰©å±•ã€‚"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"æ‰€æœ‰æ–‡ç« ","item":"/blog/posts/"},{"@type":"ListItem","position":2,"name":"VS Codeæ‰©å±•å¼€å‘å®Œå…¨æŒ‡å—ï¼šæ‰“é€ ä¸ªæ€§åŒ–çš„å¼€å‘ç¯å¢ƒ","item":"/blog/articles/vscode-extensions-guide/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"VS Codeæ‰©å±•å¼€å‘å®Œå…¨æŒ‡å—ï¼šæ‰“é€ ä¸ªæ€§åŒ–çš„å¼€å‘ç¯å¢ƒ","name":"VS Codeæ‰©å±•å¼€å‘å®Œå…¨æŒ‡å—ï¼šæ‰“é€ ä¸ªæ€§åŒ–çš„å¼€å‘ç¯å¢ƒ","description":"æ·±å…¥ä»‹ç»VS Codeæ‰©å±•å¼€å‘çš„å®Œæ•´æµç¨‹ï¼ŒåŒ…æ‹¬APIä½¿ç”¨ã€å‘å¸ƒæµç¨‹ã€æœ€ä½³å®è·µç­‰ï¼Œå¸®åŠ©å¼€å‘è€…åˆ›å»ºå¼ºå¤§å®ç”¨çš„VS Codeæ‰©å±•ã€‚","keywords":["VS Code","æ‰©å±•å¼€å‘","TypeScript","IDE","å¼€å‘å·¥å…·"],"articleBody":"Visual Studio Codeå› å…¶å¼ºå¤§çš„æ‰©å±•ç”Ÿæ€ç³»ç»Ÿè€Œæ·±å—å¼€å‘è€…å–œçˆ±ã€‚é€šè¿‡åˆ›å»ºè‡ªå®šä¹‰æ‰©å±•ï¼Œå¯ä»¥è¿›ä¸€æ­¥æå‡å¼€å‘æ•ˆç‡ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»VS Codeæ‰©å±•å¼€å‘çš„å…¨è¿‡ç¨‹ã€‚\n1. å¼€å‘ç¯å¢ƒæ­å»º åŸºç¡€å·¥å…·å®‰è£… 1 2 3 4 5 6 7 8 9 10 11 # å®‰è£…Node.js (æ¨èv16+) node --version # å®‰è£…Yeomanå’ŒVS Codeæ‰©å±•ç”Ÿæˆå™¨ npm install -g yo generator-code # å®‰è£…TypeScriptç¼–è¯‘å™¨ npm install -g typescript # å®‰è£…vsce (VS Codeæ‰©å±•æ‰“åŒ…å·¥å…·) npm install -g vsce åˆ›å»ºæ‰©å±•é¡¹ç›® 1 2 3 4 5 6 7 8 9 10 11 12 # ä½¿ç”¨ç”Ÿæˆå™¨åˆ›å»ºæ–°æ‰©å±• yo code # é€‰æ‹©æ‰©å±•ç±»å‹ï¼š # ? What type of extension do you want to create? # â¯ New Extension (TypeScript) # New Extension (JavaScript) # New Color Theme # New Language Support # New Code Snippets # New Keymap # New Extension Pack ç”Ÿæˆçš„é¡¹ç›®ç»“æ„ï¼š\nmy-extension/ â”œâ”€â”€ .vscode/ â”‚ â”œâ”€â”€ launch.json # è°ƒè¯•é…ç½® â”‚ â”œâ”€â”€ tasks.json # æ„å»ºä»»åŠ¡ â”‚ â””â”€â”€ settings.json # VS Codeè®¾ç½® â”œâ”€â”€ src/ â”‚ â”œâ”€â”€ extension.ts # ä¸»æ‰©å±•æ–‡ä»¶ â”‚ â””â”€â”€ test/ â”‚ â””â”€â”€ extension.test.ts # æµ‹è¯•æ–‡ä»¶ â”œâ”€â”€ package.json # æ‰©å±•é…ç½® â”œâ”€â”€ tsconfig.json # TypeScripté…ç½® â”œâ”€â”€ README.md # æ‰©å±•è¯´æ˜ â””â”€â”€ CHANGELOG.md # æ›´æ–°æ—¥å¿— 2. æ‰©å±•é…ç½®æ–‡ä»¶ package.jsonè¯¦è§£ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 { \"name\": \"my-awesome-extension\", \"displayName\": \"My Awesome Extension\", \"description\": \"A helpful description of what this extension does\", \"version\": \"0.0.1\", \"engines\": { \"vscode\": \"^1.75.0\" }, \"categories\": [ \"Other\", \"Snippets\", \"Linters\" ], \"activationEvents\": [ \"onCommand:extension.myCommand\", \"onLanguage:javascript\" ], \"main\": \"./out/extension.js\", \"contributes\": { \"commands\": [ { \"command\": \"extension.myCommand\", \"title\": \"My Command\", \"category\": \"My Extension\" } ], \"keybindings\": [ { \"command\": \"extension.myCommand\", \"key\": \"ctrl+shift+u\", \"mac\": \"cmd+shift+u\" } ], \"menus\": { \"editor/context\": [ { \"command\": \"extension.myCommand\", \"group\": \"navigation\" } ] }, \"configuration\": { \"title\": \"My Extension\", \"properties\": { \"myExtension.enable\": { \"type\": \"boolean\", \"default\": true, \"description\": \"Enable my extension\" } } } }, \"scripts\": { \"vscode:prepublish\": \"npm run compile\", \"compile\": \"tsc -p ./\", \"watch\": \"tsc -watch -p ./\", \"pretest\": \"npm run compile \u0026\u0026 npm run lint\", \"lint\": \"eslint src --ext ts\", \"test\": \"node ./out/test/runTest.js\" }, \"devDependencies\": { \"@types/vscode\": \"^1.75.0\", \"@types/mocha\": \"^10.0.1\", \"@types/node\": \"16.x\", \"typescript\": \"^4.9.4\", \"eslint\": \"^8.28.0\", \"@typescript-eslint/eslint-plugin\": \"^5.45.0\", \"@typescript-eslint/parser\": \"^5.45.0\", \"mocha\": \"^10.1.0\" }, \"publisher\": \"your-publisher-name\" } TypeScripté…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 { \"compilerOptions\": { \"module\": \"commonjs\", \"target\": \"ES2020\", \"outDir\": \"out\", \"lib\": [\"ES2020\"], \"sourceMap\": true, \"rootDir\": \"src\", \"strict\": true, \"esModuleInterop\": true, \"skipLibCheck\": true, \"forceConsistentCasingInFileNames\": true }, \"exclude\": [\"node_modules\", \".vscode-test\"] } 3. æ‰©å±•æ ¸å¿ƒAPI åŸºç¡€å‘½ä»¤æ³¨å†Œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 // src/extension.ts import * as vscode from 'vscode'; // æ¿€æ´»å‡½æ•° export function activate(context: vscode.ExtensionContext) { console.log('Extension \"my-extension\" is now active!'); // æ³¨å†Œå‘½ä»¤ const disposable = vscode.commands.registerCommand( 'extension.helloWorld', () =\u003e { vscode.window.showInformationMessage('Hello World from My Extension!'); } ); context.subscriptions.push(disposable); // æ³¨å†Œå¤æ‚å‘½ä»¤ const advancedCommand = vscode.commands.registerCommand( 'extension.openFile', async (uri?: vscode.Uri) =\u003e { if (uri) { const document = await vscode.workspace.openTextDocument(uri); await vscode.window.showTextDocument(document); } else { const fileUri = await vscode.window.showOpenDialog({ canSelectMany: false, openLabel: 'Select a file to open' }); if (fileUri) { const document = await vscode.workspace.openTextDocument(fileUri[0]); await vscode.window.showTextDocument(document); } } } ); context.subscriptions.push(advancedCommand); } // åœç”¨å‡½æ•° export function deactivate() {} çŠ¶æ€æ å’ŒçŠ¶æ€é¡¹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 // æ·»åŠ çŠ¶æ€æ é¡¹ const statusBarItem = vscode.window.createStatusBarItem( vscode.StatusBarAlignment.Right, 100 ); statusBarItem.text = '$(sync~spin) Loading...'; statusBarItem.tooltip = 'My Extension Status'; statusBarItem.command = 'extension.showStatus'; context.subscriptions.push(statusBarItem); // æ›´æ–°çŠ¶æ€æ  function updateStatus(text: string, tooltip?: string) { statusBarItem.text = text; if (tooltip) { statusBarItem.tooltip = tooltip; } } // å®šæ—¶æ›´æ–°çŠ¶æ€ let updateInterval: NodeJS.Timer; function startStatusUpdates() { updateInterval = setInterval(() =\u003e { const time = new Date().toLocaleTimeString(); updateStatus(`$(clock) ${time}`, `å½“å‰æ—¶é—´: ${time}`); }, 1000); } // æ¸…ç†èµ„æº function stopStatusUpdates() { if (updateInterval) { clearInterval(updateInterval); } } è¾“å‡ºé€šé“ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 // åˆ›å»ºè¾“å‡ºé€šé“ const outputChannel = vscode.window.createOutputChannel( 'My Extension', { log: true } ); context.subscriptions.push(outputChannel); // å†™å…¥è¾“å‡º outputChannel.appendLine('Extension started'); outputChannel.appendLine(`Timestamp: ${new Date().toISOString()}`); // æ˜¾ç¤ºè¾“å‡ºé€šé“ vscode.commands.registerCommand('extension.showOutput', () =\u003e { outputChannel.show(); }); // ä¸åŒçº§åˆ«çš„æ—¥å¿— function log(level: 'info' | 'warn' | 'error', message: string) { const timestamp = new Date().toISOString(); const logMessage = `[${timestamp}] [${level.toUpperCase()}] ${message}`; outputChannel.appendLine(logMessage); if (level === 'error') { vscode.window.showErrorMessage(message); } else if (level === 'warn') { vscode.window.showWarningMessage(message); } } é…ç½®å’Œè®¾ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 // è·å–æ‰©å±•é…ç½® function getConfig\u003cT\u003e(key: string): T | undefined { const config = vscode.workspace.getConfiguration('myExtension'); return config.get\u003cT\u003e(key); } // ç›‘å¬é…ç½®å˜åŒ– vscode.workspace.onDidChangeConfiguration(event =\u003e { if (event.affectsConfiguration('myExtension')) { const newConfig = getConfig('enable'); vscode.window.showInformationMessage( `Extension ${newConfig ? 'enabled' : 'disabled'}` ); } }); // è®¾ç½®é…ç½® function setConfig(key: string, value: any) { const config = vscode.workspace.getConfiguration('myExtension'); return config.update(key, value, vscode.ConfigurationTarget.Global); } 4. ç¼–è¾‘å™¨åŠŸèƒ½æ‰©å±• æ–‡æ¡£ç¼–è¾‘å™¨ä¿®æ”¹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 // æ³¨å†Œæ–‡æœ¬ç¼–è¾‘å™¨å‘½ä»¤ vscode.commands.registerCommand( 'extension.insertCurrentTime', () =\u003e { const editor = vscode.window.activeTextEditor; if (editor) { const currentTime = new Date().toLocaleString(); editor.edit(editBuilder =\u003e { const position = editor.selection.active; editBuilder.insert(position, currentTime); }); } } ); // æ–‡æ¡£å†…å®¹ä¿®æ”¹ vscode.commands.registerCommand( 'extension.formatDocument', async () =\u003e { const editor = vscode.window.activeTextEditor; if (editor) { const document = editor.document; const fullRange = new vscode.Range( document.positionAt(0), document.positionAt(document.getText().length) ); const formattedText = formatCode(document.getText()); await editor.edit(editBuilder =\u003e { editBuilder.replace(fullRange, formattedText); }); } } ); function formatCode(code: string): string { // ç®€å•çš„æ ¼å¼åŒ–é€»è¾‘ return code .split('\\n') .map(line =\u003e line.trim()) .join('\\n'); } è£…é¥°å™¨ï¼ˆDecorationsï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 // åˆ›å»ºè£…é¥°ç±»å‹ const decorationType = vscode.window.createTextEditorDecorationType({ backgroundColor: new vscode.ThemeColor('editor.wordHighlightBackground'), border: '1px solid', borderColor: new vscode.ThemeColor('editor.wordHighlightBorder'), borderRadius: '3px' }); // åº”ç”¨è£…é¥° function highlightWords(editor: vscode.TextEditor, words: string[]) { const text = editor.document.getText(); const decorations: vscode.DecorationOptions[] = []; words.forEach(word =\u003e { const regex = new RegExp(word, 'gi'); let match; while ((match = regex.exec(text)) !== null) { const startPos = editor.document.positionAt(match.index); const endPos = editor.document.positionAt(match.index + match[0].length); decorations.push({ range: new vscode.Range(startPos, endPos), hoverMessage: `Found word: ${word}`, isWholeLine: false }); } }); editor.setDecorations(decorationType, decorations); } // æ¸…é™¤è£…é¥° function clearDecorations(editor: vscode.TextEditor) { editor.setDecorations(decorationType, []); } ä»£ç å®Œæˆæä¾›è€… 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 // æ³¨å†Œä»£ç å®Œæˆæä¾›è€… const completionProvider = vscode.languages.registerCompletionItemProvider( { scheme: 'file', language: 'javascript' }, { provideCompletionItems( document: vscode.TextDocument, position: vscode.Position, token: vscode.CancellationToken, context: vscode.CompletionContext ): vscode.CompletionItem[] { const completions: vscode.CompletionItem[] = []; // è‡ªå®šä¹‰ä»£ç ç‰‡æ®µ const snippet = new vscode.CompletionItem( 'myFunction', vscode.CompletionItemKind.Snippet ); snippet.insertText = new vscode.SnippetString( 'function ${1:functionName}(${2:parameters}) {\\n\\t${3:// function body}\\n}' ); snippet.documentation = 'Creates a new function'; snippet.detail = 'Custom function template'; completions.push(snippet); // æ ¹æ®ä¸Šä¸‹æ–‡æä¾›ä¸åŒçš„å®Œæˆé¡¹ const linePrefix = document.getText( new vscode.Range(position.line, 0, position.line, position.character) ); if (linePrefix.includes('console.')) { completions.push( new vscode.CompletionItem( 'logCustom', vscode.CompletionItemKind.Method ) ); } return completions; } } ); context.subscriptions.push(completionProvider); æ‚¬åœæç¤º 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 // æ³¨å†Œæ‚¬åœæç¤ºæä¾›è€… const hoverProvider = vscode.languages.registerHoverProvider( { scheme: 'file', language: 'typescript' }, { provideHover( document: vscode.TextDocument, position: vscode.Position, token: vscode.CancellationToken ): vscode.Hover | null { const word = document.getText( document.getWordRangeAtPosition(position) ); if (word \u0026\u0026 ['API', 'HTTP', 'JSON'].includes(word)) { const markdown = new vscode.MarkdownString(); markdown.appendMarkdown(`### ${word}\\n\\n`); switch (word) { case 'API': markdown.appendMarkdown( 'Application Programming Interface\\n\\n' + 'åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼Œå®šä¹‰äº†è½¯ä»¶ç»„ä»¶ä¹‹é—´çš„é€šä¿¡æ–¹å¼' ); break; case 'HTTP': markdown.appendMarkdown( 'HyperText Transfer Protocol\\n\\n' + 'è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œç”¨äºä¼ è¾“è¶…åª’ä½“æ–‡æ¡£' ); break; case 'JSON': markdown.appendMarkdown( 'JavaScript Object Notation\\n\\n' + 'è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼' ); break; } return new vscode.Hover(markdown); } return null; } } ); context.subscriptions.push(hoverProvider); 5. WebViewæ‰©å±• åˆ›å»ºWebView 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 // WebView Panelç±» class MyWebView { private readonly _panel: vscode.WebviewPanel; private readonly _extensionUri: vscode.Uri; constructor(extensionUri: vscode.Uri) { this._extensionUri = extensionUri; // åˆ›å»ºWebviewé¢æ¿ this._panel = vscode.window.createWebviewPanel( 'myWebView', 'My WebView', vscode.ViewColumn.One, { enableScripts: true, retainContextWhenHidden: true } ); // è®¾ç½®HTMLå†…å®¹ this._panel.webview.html = this._getHtmlForWebview(); // ç›‘å¬æ¶ˆæ¯ this._panel.webview.onDidReceiveMessage( message =\u003e this._onMessage(message) ); } private _getHtmlForWebview(): string { return `\u003c!DOCTYPE html\u003e My WebView My WebView This is a custom WebView panel.\nSend Message `; } private _onMessage(message: any) { switch (message.command) { case 'hello': vscode.window.showInformationMessage( `WebView says: ${message.text}` ); // å‘é€å“åº”åˆ°WebView this._panel.webview.postMessage({ command: 'update', text: 'Extension received your message!' }); break; } } } // æ³¨å†ŒWebViewå‘½ä»¤ vscode.commands.registerCommand( 'extension.openWebView', () =\u003e { const webView = new MyWebView(context.extensionUri); } ); WebViewä¸æ‰©å±•é€šä¿¡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 // æ›´å¤æ‚çš„WebViewé€šä¿¡ class AdvancedWebView { private _panel: vscode.WebviewPanel; constructor(extensionUri: vscode.Uri) { this._panel = vscode.window.createWebviewPanel( 'advancedWebView', 'Advanced WebView', vscode.ViewColumn.One, { enableScripts: true, retainContextWhenHidden: true } ); this._panel.webview.html = this._getHtml(); this._setupMessageHandlers(); } private _setupMessageHandlers() { this._panel.webview.onDidReceiveMessage( async message =\u003e { switch (message.command) { case 'openFile': const fileUri = await vscode.window.showOpenDialog({ canSelectMany: false, openLabel: 'Select a file' }); if (fileUri) { this._panel.webview.postMessage({ command: 'fileOpened', path: fileUri[0].fsPath }); } break; case 'saveData': try { await vscode.workspace.fs.writeFile( vscode.Uri.file(message.path), Buffer.from(message.content, 'utf8') ); this._panel.webview.postMessage({ command: 'dataSaved', success: true }); } catch (error) { this._panel.webview.postMessage({ command: 'dataSaved', success: false, error: error.message }); } break; } } ); } // å…¬å¼€æ–¹æ³•ä¾›å¤–éƒ¨è°ƒç”¨ public updateContent(data: any) { this._panel.webview.postMessage({ command: 'updateContent', data }); } } 6. æ–‡ä»¶ç³»ç»Ÿæ“ä½œ å·¥ä½œåŒºæ–‡ä»¶æ“ä½œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 // è¯»å–æ–‡ä»¶å†…å®¹ async function readFile(uri: vscode.Uri): Promise\u003cstring\u003e { const content = await vscode.workspace.fs.readFile(uri); return Buffer.from(content).toString('utf8'); } // å†™å…¥æ–‡ä»¶ async function writeFile(uri: vscode.Uri, content: string): Promise\u003cvoid\u003e { await vscode.workspace.fs.writeFile( uri, Buffer.from(content, 'utf8') ); } // åˆ›å»ºæ–‡ä»¶ vscode.commands.registerCommand( 'extension.createFile', async () =\u003e { const fileName = await vscode.window.showInputBox({ prompt: 'Enter file name', placeHolder: 'example.txt' }); if (fileName) { const workspaceFolders = vscode.workspace.workspaceFolders; if (workspaceFolders) { const fileUri = vscode.Uri.joinPath( workspaceFolders[0].uri, fileName ); await writeFile(fileUri, ''); const document = await vscode.workspace.openTextDocument(fileUri); await vscode.window.showTextDocument(document); } } } ); // æ‰¹é‡æ–‡ä»¶æ“ä½œ async function processFilesInDirectory(directoryUri: vscode.Uri) { const entries = await vscode.workspace.fs.readDirectory(directoryUri); for (const [name, type] of entries) { const entryUri = vscode.Uri.joinPath(directoryUri, name); if (type === vscode.FileType.File) { // å¤„ç†æ–‡ä»¶ const content = await readFile(entryUri); console.log(`Processing file: ${name}, size: ${content.length}`); } else if (type === vscode.FileType.Directory) { // é€’å½’å¤„ç†ç›®å½• await processFilesInDirectory(entryUri); } } } å·¥ä½œåŒºç›‘å¬ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 // ç›‘å¬æ–‡ä»¶å˜åŒ– const fileWatcher = vscode.workspace.createFileSystemWatcher( '**/*.{js,ts,json}' ); fileWatcher.onDidCreate(uri =\u003e { console.log(`File created: ${uri.fsPath}`); }); fileWatcher.onDidChange(uri =\u003e { console.log(`File changed: ${uri.fsPath}`); }); fileWatcher.onDidDelete(uri =\u003e { console.log(`File deleted: ${uri.fsPath}`); }); // ç›‘å¬æ–‡æ¡£ä¿å­˜ vscode.workspace.onDidSaveTextDocument( (document) =\u003e { if (document.languageId === 'javascript') { // è‡ªåŠ¨æ ¼å¼åŒ–JavaScriptæ–‡ä»¶ formatDocument(document); } } ); // ç›‘å¬æ–‡æœ¬ç¼–è¾‘å™¨å˜åŒ– vscode.window.onDidChangeActiveTextEditor( (editor) =\u003e { if (editor) { console.log(`Active editor: ${editor.document.fileName}`); } } ); 7. æµ‹è¯•å’Œè°ƒè¯• å•å…ƒæµ‹è¯• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 // src/test/extension.test.ts import * as assert from 'assert'; import * as vscode from 'vscode'; import * as extension from '../extension'; suite('Extension Test Suite', () =\u003e { vscode.window.showInformationMessage('Start all tests.'); test('Extension should be present', () =\u003e { assert.ok(extension); }); test('Command should register', async () =\u003e { const command = 'extension.helloWorld'; const result = await vscode.commands.executeCommand(command); assert.strictEqual(result, undefined); }); test('Command should show message', async () =\u003e { let messageShown = false; const disposable = vscode.window.onDidShowInformationMessage(() =\u003e { messageShown = true; }); await vscode.commands.executeCommand('extension.helloWorld'); assert.ok(messageShown); disposable.dispose(); }); }); // é›†æˆæµ‹è¯• suite('Integration Tests', () =\u003e { test('Should create and open file', async () =\u003e { const fileName = 'test-file.txt'; const fileContent = 'Hello, World!'; const workspaceFolders = vscode.workspace.workspaceFolders; assert.ok(workspaceFolders, 'No workspace folder found'); const fileUri = vscode.Uri.joinPath( workspaceFolders[0].uri, fileName ); // å†™å…¥æ–‡ä»¶ await vscode.workspace.fs.writeFile( fileUri, Buffer.from(fileContent) ); // æ‰“å¼€æ–‡ä»¶ const document = await vscode.workspace.openTextDocument(fileUri); await vscode.window.showTextDocument(document); assert.strictEqual(document.getText(), fileContent); }); }); è°ƒè¯•é…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 // .vscode/launch.json { \"version\": \"0.2.0\", \"configurations\": [ { \"name\": \"Run Extension\", \"type\": \"extensionHost\", \"request\": \"launch\", \"args\": [ \"--extensionDevelopmentPath=${workspaceFolder}\" ], \"outFiles\": [ \"${workspaceFolder}/out/**/*.js\" ], \"preLaunchTask\": \"${workspaceFolder}/npm: compile\" }, { \"name\": \"Extension Tests\", \"type\": \"extensionHost\", \"request\": \"launch\", \"args\": [ \"--extensionDevelopmentPath=${workspaceFolder}\", \"--extensionTestsPath=${workspaceFolder}/out/test/suite/index\" ], \"outFiles\": [ \"${workspaceFolder}/out/test/**/*.js\" ], \"preLaunchTask\": \"${workspaceFolder}/npm: compile\" } ] } 8. å‘å¸ƒå’Œæ‰“åŒ… å‡†å¤‡å‘å¸ƒ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # å®‰è£…vsceå·¥å…· npm install -g vsce # æ›´æ–°package.jsonç‰ˆæœ¬ npm version patch # æˆ– minor, major # æ„å»ºæ‰©å±• npm run vscode:prepublish # æ£€æŸ¥åŒ… vsce ls --publish # å‘å¸ƒåˆ°å¸‚åœº vsce publish # æ‰“åŒ…ä¸º.vsixæ–‡ä»¶ vsce package å‘å¸ƒé…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 // package.jsonä¸­çš„å‘å¸ƒç›¸å…³é…ç½® { \"name\": \"my-extension\", \"displayName\": \"My Awesome Extension\", \"description\": \"A helpful description\", \"version\": \"1.0.0\", \"publisher\": \"your-publisher-name\", \"repository\": { \"type\": \"git\", \"url\": \"https://github.com/your-username/my-extension.git\" }, \"bugs\": { \"url\": \"https://github.com/your-username/my-extension/issues\" }, \"homepage\": \"https://github.com/your-username/my-extension#readme\", \"keywords\": [ \"vscode\", \"extension\", \"tool\" ], \"engines\": { \"vscode\": \"^1.75.0\" }, \"categories\": [ \"Other\" ], \"icon\": \"images/icon.png\", \"gallery\": [ { \"feature\": \"images/screenshot1.png\", \"label\": \"Feature 1\" }, { \"feature\": \"images/screenshot2.png\", \"label\": \"Feature 2\" } ] } 9. æœ€ä½³å®è·µ ä»£ç ç»„ç»‡ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 // æ¨¡å—åŒ–å‘½ä»¤ class CommandManager { private commands: vscode.Disposable[] = []; constructor(private context: vscode.ExtensionContext) {} register(command: string, callback: (...args: any[]) =\u003e any) { const disposable = vscode.commands.registerCommand(command, callback); this.commands.push(disposable); return disposable; } dispose() { this.commands.forEach(disposable =\u003e disposable.dispose()); this.commands = []; } } // æ¨¡å—åŒ–é…ç½® class ConfigManager { constructor(private configSection: string) {} get\u003cT\u003e(key: string): T | undefined { return vscode.workspace.getConfiguration(this.configSection).get\u003cT\u003e(key); } async set(key: string, value: any): Promise\u003cvoid\u003e { const config = vscode.workspace.getConfiguration(this.configSection); await config.update(key, value, vscode.ConfigurationTarget.Global); } } // ä½¿ç”¨ç¤ºä¾‹ export function activate(context: vscode.ExtensionContext) { const commandManager = new CommandManager(context); const configManager = new ConfigManager('myExtension'); commandManager.register('extension.myCommand', () =\u003e { const setting = configManager.get\u003cboolean\u003e('enable'); vscode.window.showInformationMessage(`Setting: ${setting}`); }); } æ€§èƒ½ä¼˜åŒ– 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 // æ‡’åŠ è½½åŠŸèƒ½ let featureModule: any; async function loadFeatureModule() { if (!featureModule) { featureModule = await import('./feature-module'); } return featureModule; } vscode.commands.registerCommand( 'extension.feature', async () =\u003e { const module = await loadFeatureModule(); module.execute(); } ); // ç¼“å­˜è®¡ç®—ç»“æœ const cache = new Map\u003cstring, any\u003e(); function expensiveCalculation(input: string): any { if (cache.has(input)) { return cache.get(input); } const result = performExpensiveCalculation(input); cache.set(input, result); return result; } // äº‹ä»¶é˜²æŠ– function debounce\u003cT extends (...args: any[]) =\u003e void\u003e( fn: T, delay: number ): T { let timeoutId: NodeJS.Timeout; return ((...args: any[]) =\u003e { clearTimeout(timeoutId); timeoutId = setTimeout(() =\u003e fn(...args), delay); }) as T; } // ä½¿ç”¨ç¤ºä¾‹ const debouncedCommand = debounce( (args: string[]) =\u003e { vscode.window.showInformationMessage(args.join(', ')); }, 300 ); 10. å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ å¸¸è§é”™è¯¯å¤„ç† 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 // å¤„ç†æ‰©å±•æ¿€æ´»å¤±è´¥ export function activate(context: vscode.ExtensionContext) { try { // æ‰©å±•åˆå§‹åŒ–é€»è¾‘ initializeExtension(context); } catch (error) { console.error('Extension activation failed:', error); vscode.window.showErrorMessage( `Extension activation failed: ${error.message}` ); } } // å®‰å…¨çš„ç±»å‹æ£€æŸ¥ function getActiveEditor(): vscode.TextEditor | undefined { const editor = vscode.window.activeTextEditor; if (!editor) { vscode.window.showWarningMessage('No active editor'); return undefined; } return editor; } // ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥ function checkVSCodeVersion() { const vscodeVersion = vscode.version; const requiredVersion = '1.75.0'; if (vscode.version \u003c requiredVersion) { vscode.window.showErrorMessage( `This extension requires VS Code ${requiredVersion} or higher. ` + `Current version: ${vscodeVersion}` ); return false; } return true; } æ€»ç»“ VS Codeæ‰©å±•å¼€å‘ä¸ºå¼€å‘è€…æä¾›äº†å¼ºå¤§çš„å®šåˆ¶åŒ–èƒ½åŠ›ã€‚é€šè¿‡æœ¬æ–‡ä»‹ç»çš„æŠ€æœ¯å’Œæœ€ä½³å®è·µï¼Œä½ å¯ä»¥ï¼š\næ ¸å¿ƒæŠ€èƒ½ï¼š\næŒæ¡æ‰©å±•APIçš„ä½¿ç”¨ ç†è§£æ‰©å±•ç”Ÿå‘½å‘¨æœŸç®¡ç† å®ç°ä¸°å¯Œçš„ç¼–è¾‘å™¨åŠŸèƒ½ é«˜çº§ç‰¹æ€§ï¼š\nå¼€å‘è‡ªå®šä¹‰WebView åˆ›å»ºå¤æ‚çš„è¯­è¨€æ”¯æŒ å®ç°é«˜æ•ˆçš„æ–‡ä»¶æ“ä½œ å¼€å‘æµç¨‹ï¼š\nå»ºç«‹å®Œæ•´çš„æµ‹è¯•ä½“ç³» å®ç°æŒç»­é›†æˆ/éƒ¨ç½² éµå¾ªå‘å¸ƒæœ€ä½³å®è·µ è®°ä½ï¼Œå¥½çš„æ‰©å±•åº”è¯¥è§£å†³å®é™…é—®é¢˜ã€æä¾›è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œå¹¶ä¸”ä¿æŒç¨³å®šå’Œé«˜æ•ˆã€‚å¼€å§‹ä½ çš„VS Codeæ‰©å±•å¼€å‘ä¹‹æ—…å§ï¼\n","wordCount":"3106","inLanguage":"zh-cn","datePublished":"2025-12-16T00:00:00Z","dateModified":"2025-12-16T00:00:00Z","author":{"@type":"Person","name":"æœ‰æ¡å·¥å…·å›¢é˜Ÿ"},"mainEntityOfPage":{"@type":"WebPage","@id":"/blog/articles/vscode-extensions-guide/"},"publisher":{"@type":"Organization","name":"æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·","logo":{"@type":"ImageObject","url":"/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=/blog/ accesskey=h title="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· (Alt + H)">æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=/blog/posts/ title="æ‰€æœ‰æ–‡ç« åˆ—è¡¨ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŸ¥çœ‹æ‰€æœ‰æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹"><span>æ–‡ç« </span></a></li><li><a href=https://www.util.cn title="æœ‰æ¡å·¥å…· - å¼€å‘è€…çš„å¸¸ç”¨å·¥å…·é›†åˆï¼šæ— å¹¿å‘Š Â· æœ¬åœ°è®¡ç®— Â· å³å¼€å³ç”¨çš„åœ¨çº¿å·¥å…·å¹³å°ï¼Œæä¾›JSONæ ¼å¼åŒ–ã€SQLæ ¼å¼åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰å®ç”¨å·¥å…·"><span>æœ‰æ¡å·¥å…·</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=/blog/categories/ title="æ–‡ç« åˆ†ç±» - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŒ‰æŠ€æœ¯é¢†åŸŸåˆ†ç±»çš„ä¼˜è´¨æ–‡ç« ï¼ŒåŒ…æ‹¬å‰ç«¯å¼€å‘ã€å·¥å…·ä½¿ç”¨ã€ç¼–ç¨‹æŠ€å·§ç­‰"><span>åˆ†ç±»</span></a></li><li><a href=/blog/tags/ title="æ ‡ç­¾äº‘ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šé€šè¿‡æ ‡ç­¾å¿«é€Ÿæ‰¾åˆ°æ„Ÿå…´è¶£çš„æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹"><span>æ ‡ç­¾</span></a></li><li><a href=/blog/archives/ title="æ–‡ç« å½’æ¡£ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŒ‰æ—¶é—´æŸ¥çœ‹å†å²æ–‡ç« "><span>å½’æ¡£</span></a></li><li><a href=/blog/search/ title="æœç´¢æ–‡ç«  - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šé€šè¿‡å…³é”®è¯æœç´¢æ‰¾åˆ°æ„Ÿå…´è¶£çš„æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹ï¼Œæ”¯æŒæ ‡é¢˜ã€å†…å®¹ã€åˆ†ç±»å’Œæ ‡ç­¾æœç´¢"><span>æœç´¢</span></a></li></ul></nav></header><main class=main><article class=post-single><div class=post-content-wrapper><main class=post-content-main><header class=post-header-main><h1 class="post-title entry-hint-parent">VS Codeæ‰©å±•å¼€å‘å®Œå…¨æŒ‡å—ï¼šæ‰“é€ ä¸ªæ€§åŒ–çš„å¼€å‘ç¯å¢ƒ</h1><div class=post-meta><div class=post-meta-content><div class=post-categories-inline><a href=/blog/categories/%E5%B7%A5%E5%85%B7%E6%95%99%E7%A8%8B/ class=category-link>å·¥å…·æ•™ç¨‹</a></div><span class=post-date>2025-12-16</span><span class=post-author>æœ‰æ¡å·¥å…·å›¢é˜Ÿ</span></div><style>.post-meta-content{display:flex;align-items:center;flex-wrap:wrap;gap:.75rem;font-family:sf mono,monaco,courier new,monospace;font-size:.875rem;color:#9ca3af !important}.post-categories-inline{display:inline-flex;align-items:center;gap:.5rem}.category-link{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .75rem;background:rgba(255,255,255,.1);color:#e5e7eb !important;text-decoration:none;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;border:1px solid rgba(255,255,255,.2);border-radius:0;transition:all .3s ease;white-space:nowrap}.category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3);transform:translateY(-1px)}.category-link::before{content:'ğŸ“';font-size:.7rem;opacity:.8}.post-date,.post-reading-time,.post-word-count,.post-author{color:#9ca3af !important}[data-theme=dark] .post-meta-content{color:#9ca3af !important}[data-theme=dark] .category-link{background:rgba(255,255,255,.1);color:#e5e7eb !important;border-color:rgba(255,255,255,.2)}[data-theme=dark] .category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3)}[data-theme=dark] .post-date,[data-theme=dark] .post-reading-time,[data-theme=dark] .post-word-count,[data-theme=dark] .post-author{color:#9ca3af !important}[data-theme=light] .post-meta-content{color:#6c757d !important}[data-theme=light] .category-link{background:rgba(0,0,0,5%);color:#495057 !important;border-color:rgba(0,0,0,.15)}[data-theme=light] .category-link:hover{background:rgba(0,102,204,.1);color:#212529 !important;border-color:rgba(0,102,204,.3)}[data-theme=light] .post-date,[data-theme=light] .post-reading-time,[data-theme=light] .post-word-count,[data-theme=light] .post-author{color:#6c757d !important}@media(max-width:768px){.post-meta-content{gap:.5rem;font-size:.8rem}.category-link{padding:.2rem .6rem;font-size:.7rem}}</style></div></header><div class=post-content><p>Visual Studio Codeå› å…¶å¼ºå¤§çš„æ‰©å±•ç”Ÿæ€ç³»ç»Ÿè€Œæ·±å—å¼€å‘è€…å–œçˆ±ã€‚é€šè¿‡åˆ›å»ºè‡ªå®šä¹‰æ‰©å±•ï¼Œå¯ä»¥è¿›ä¸€æ­¥æå‡å¼€å‘æ•ˆç‡ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»VS Codeæ‰©å±•å¼€å‘çš„å…¨è¿‡ç¨‹ã€‚</p><h2 id=1-å¼€å‘ç¯å¢ƒæ­å»º>1. å¼€å‘ç¯å¢ƒæ­å»º<a hidden class=anchor aria-hidden=true href=#1-å¼€å‘ç¯å¢ƒæ­å»º>#</a></h2><h3 id=åŸºç¡€å·¥å…·å®‰è£…>åŸºç¡€å·¥å…·å®‰è£…<a hidden class=anchor aria-hidden=true href=#åŸºç¡€å·¥å…·å®‰è£…>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8b949e;font-style:italic># å®‰è£…Node.js (æ¨èv16+)</span>
</span></span><span style=display:flex><span>node --version
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># å®‰è£…Yeomanå’ŒVS Codeæ‰©å±•ç”Ÿæˆå™¨</span>
</span></span><span style=display:flex><span>npm install -g yo generator-code
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># å®‰è£…TypeScriptç¼–è¯‘å™¨</span>
</span></span><span style=display:flex><span>npm install -g typescript
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># å®‰è£…vsce (VS Codeæ‰©å±•æ‰“åŒ…å·¥å…·)</span>
</span></span><span style=display:flex><span>npm install -g vsce
</span></span></code></pre></td></tr></table></div></div><h3 id=åˆ›å»ºæ‰©å±•é¡¹ç›®>åˆ›å»ºæ‰©å±•é¡¹ç›®<a hidden class=anchor aria-hidden=true href=#åˆ›å»ºæ‰©å±•é¡¹ç›®>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8b949e;font-style:italic># ä½¿ç”¨ç”Ÿæˆå™¨åˆ›å»ºæ–°æ‰©å±•</span>
</span></span><span style=display:flex><span>yo code
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># é€‰æ‹©æ‰©å±•ç±»å‹ï¼š</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># ? What type of extension do you want to create?</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># â¯ New Extension (TypeScript)</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>#   New Extension (JavaScript)</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>#   New Color Theme</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>#   New Language Support</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>#   New Code Snippets</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>#   New Keymap</span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>#   New Extension Pack</span>
</span></span></code></pre></td></tr></table></div></div><p>ç”Ÿæˆçš„é¡¹ç›®ç»“æ„ï¼š</p><pre tabindex=0><code>my-extension/
â”œâ”€â”€ .vscode/
â”‚   â”œâ”€â”€ launch.json          # è°ƒè¯•é…ç½®
â”‚   â”œâ”€â”€ tasks.json           # æ„å»ºä»»åŠ¡
â”‚   â””â”€â”€ settings.json        # VS Codeè®¾ç½®
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ extension.ts         # ä¸»æ‰©å±•æ–‡ä»¶
â”‚   â””â”€â”€ test/
â”‚       â””â”€â”€ extension.test.ts # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ package.json             # æ‰©å±•é…ç½®
â”œâ”€â”€ tsconfig.json           # TypeScripté…ç½®
â”œâ”€â”€ README.md                # æ‰©å±•è¯´æ˜
â””â”€â”€ CHANGELOG.md             # æ›´æ–°æ—¥å¿—
</code></pre><h2 id=2-æ‰©å±•é…ç½®æ–‡ä»¶>2. æ‰©å±•é…ç½®æ–‡ä»¶<a hidden class=anchor aria-hidden=true href=#2-æ‰©å±•é…ç½®æ–‡ä»¶>#</a></h2><h3 id=packagejsonè¯¦è§£>package.jsonè¯¦è§£<a hidden class=anchor aria-hidden=true href=#packagejsonè¯¦è§£>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">72
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;name&#34;</span>: <span style=color:#a5d6ff>&#34;my-awesome-extension&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;displayName&#34;</span>: <span style=color:#a5d6ff>&#34;My Awesome Extension&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;description&#34;</span>: <span style=color:#a5d6ff>&#34;A helpful description of what this extension does&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;version&#34;</span>: <span style=color:#a5d6ff>&#34;0.0.1&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;engines&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;vscode&#34;</span>: <span style=color:#a5d6ff>&#34;^1.75.0&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;categories&#34;</span>: [
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;Other&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;Snippets&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;Linters&#34;</span>
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;activationEvents&#34;</span>: [
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;onCommand:extension.myCommand&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;onLanguage:javascript&#34;</span>
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;main&#34;</span>: <span style=color:#a5d6ff>&#34;./out/extension.js&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;contributes&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;commands&#34;</span>: [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;command&#34;</span>: <span style=color:#a5d6ff>&#34;extension.myCommand&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;title&#34;</span>: <span style=color:#a5d6ff>&#34;My Command&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;category&#34;</span>: <span style=color:#a5d6ff>&#34;My Extension&#34;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;keybindings&#34;</span>: [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;command&#34;</span>: <span style=color:#a5d6ff>&#34;extension.myCommand&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;key&#34;</span>: <span style=color:#a5d6ff>&#34;ctrl+shift+u&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;mac&#34;</span>: <span style=color:#a5d6ff>&#34;cmd+shift+u&#34;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;menus&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;editor/context&#34;</span>: [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          <span style=color:#7ee787>&#34;command&#34;</span>: <span style=color:#a5d6ff>&#34;extension.myCommand&#34;</span>,
</span></span><span style=display:flex><span>          <span style=color:#7ee787>&#34;group&#34;</span>: <span style=color:#a5d6ff>&#34;navigation&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      ]
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;configuration&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;title&#34;</span>: <span style=color:#a5d6ff>&#34;My Extension&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;properties&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#7ee787>&#34;myExtension.enable&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#7ee787>&#34;type&#34;</span>: <span style=color:#a5d6ff>&#34;boolean&#34;</span>,
</span></span><span style=display:flex><span>          <span style=color:#7ee787>&#34;default&#34;</span>: <span style=color:#79c0ff>true</span>,
</span></span><span style=display:flex><span>          <span style=color:#7ee787>&#34;description&#34;</span>: <span style=color:#a5d6ff>&#34;Enable my extension&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;scripts&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;vscode:prepublish&#34;</span>: <span style=color:#a5d6ff>&#34;npm run compile&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;compile&#34;</span>: <span style=color:#a5d6ff>&#34;tsc -p ./&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;watch&#34;</span>: <span style=color:#a5d6ff>&#34;tsc -watch -p ./&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;pretest&#34;</span>: <span style=color:#a5d6ff>&#34;npm run compile &amp;&amp; npm run lint&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;lint&#34;</span>: <span style=color:#a5d6ff>&#34;eslint src --ext ts&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;test&#34;</span>: <span style=color:#a5d6ff>&#34;node ./out/test/runTest.js&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;devDependencies&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;@types/vscode&#34;</span>: <span style=color:#a5d6ff>&#34;^1.75.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;@types/mocha&#34;</span>: <span style=color:#a5d6ff>&#34;^10.0.1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;@types/node&#34;</span>: <span style=color:#a5d6ff>&#34;16.x&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;typescript&#34;</span>: <span style=color:#a5d6ff>&#34;^4.9.4&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;eslint&#34;</span>: <span style=color:#a5d6ff>&#34;^8.28.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;@typescript-eslint/eslint-plugin&#34;</span>: <span style=color:#a5d6ff>&#34;^5.45.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;@typescript-eslint/parser&#34;</span>: <span style=color:#a5d6ff>&#34;^5.45.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;mocha&#34;</span>: <span style=color:#a5d6ff>&#34;^10.1.0&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;publisher&#34;</span>: <span style=color:#a5d6ff>&#34;your-publisher-name&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=typescripté…ç½®>TypeScripté…ç½®<a hidden class=anchor aria-hidden=true href=#typescripté…ç½®>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;compilerOptions&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;module&#34;</span>: <span style=color:#a5d6ff>&#34;commonjs&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;target&#34;</span>: <span style=color:#a5d6ff>&#34;ES2020&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;outDir&#34;</span>: <span style=color:#a5d6ff>&#34;out&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;lib&#34;</span>: [<span style=color:#a5d6ff>&#34;ES2020&#34;</span>],
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;sourceMap&#34;</span>: <span style=color:#79c0ff>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;rootDir&#34;</span>: <span style=color:#a5d6ff>&#34;src&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;strict&#34;</span>: <span style=color:#79c0ff>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;esModuleInterop&#34;</span>: <span style=color:#79c0ff>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;skipLibCheck&#34;</span>: <span style=color:#79c0ff>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;forceConsistentCasingInFileNames&#34;</span>: <span style=color:#79c0ff>true</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;exclude&#34;</span>: [<span style=color:#a5d6ff>&#34;node_modules&#34;</span>, <span style=color:#a5d6ff>&#34;.vscode-test&#34;</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=3-æ‰©å±•æ ¸å¿ƒapi>3. æ‰©å±•æ ¸å¿ƒAPI<a hidden class=anchor aria-hidden=true href=#3-æ‰©å±•æ ¸å¿ƒapi>#</a></h2><h3 id=åŸºç¡€å‘½ä»¤æ³¨å†Œ>åŸºç¡€å‘½ä»¤æ³¨å†Œ<a hidden class=anchor aria-hidden=true href=#åŸºç¡€å‘½ä»¤æ³¨å†Œ>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// src/extension.ts
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>import</span> <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#ff7b72>as</span> vscode <span style=color:#ff7b72>from</span> <span style=color:#a5d6ff>&#39;vscode&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ¿€æ´»å‡½æ•°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>export</span> <span style=color:#ff7b72>function</span> activate(context: <span style=color:#ff7b72>vscode.ExtensionContext</span>) {
</span></span><span style=display:flex><span>    console.log(<span style=color:#a5d6ff>&#39;Extension &#34;my-extension&#34; is now active!&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// æ³¨å†Œå‘½ä»¤
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>const</span> disposable <span style=color:#ff7b72;font-weight:700>=</span> vscode.commands.registerCommand(
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#39;extension.helloWorld&#39;</span>,
</span></span><span style=display:flex><span>        () <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>            vscode.window.showInformationMessage(<span style=color:#a5d6ff>&#39;Hello World from My Extension!&#39;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    context.subscriptions.push(disposable);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// æ³¨å†Œå¤æ‚å‘½ä»¤
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>const</span> advancedCommand <span style=color:#ff7b72;font-weight:700>=</span> vscode.commands.registerCommand(
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#39;extension.openFile&#39;</span>,
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>async</span> (uri?: <span style=color:#ff7b72>vscode.Uri</span>) <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> (uri) {
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>const</span> document <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> vscode.workspace.openTextDocument(uri);
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>await</span> vscode.window.showTextDocument(document);
</span></span><span style=display:flex><span>            } <span style=color:#ff7b72>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>const</span> fileUri <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> vscode.window.showOpenDialog({
</span></span><span style=display:flex><span>                    canSelectMany: <span style=color:#ff7b72>false</span>,
</span></span><span style=display:flex><span>                    openLabel<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;Select a file to open&#39;</span>
</span></span><span style=display:flex><span>                });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>if</span> (fileUri) {
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>const</span> document <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> vscode.workspace.openTextDocument(fileUri[<span style=color:#a5d6ff>0</span>]);
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>await</span> vscode.window.showTextDocument(document);
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    context.subscriptions.push(advancedCommand);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// åœç”¨å‡½æ•°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>export</span> <span style=color:#ff7b72>function</span> deactivate() {}
</span></span></code></pre></td></tr></table></div></div><h3 id=çŠ¶æ€æ å’ŒçŠ¶æ€é¡¹>çŠ¶æ€æ å’ŒçŠ¶æ€é¡¹<a hidden class=anchor aria-hidden=true href=#çŠ¶æ€æ å’ŒçŠ¶æ€é¡¹>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ·»åŠ çŠ¶æ€æ é¡¹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> statusBarItem <span style=color:#ff7b72;font-weight:700>=</span> vscode.window.createStatusBarItem(
</span></span><span style=display:flex><span>    vscode.StatusBarAlignment.Right,
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>100</span>
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>statusBarItem.text <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#39;$(sync~spin) Loading...&#39;</span>;
</span></span><span style=display:flex><span>statusBarItem.tooltip <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#39;My Extension Status&#39;</span>;
</span></span><span style=display:flex><span>statusBarItem.command <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#39;extension.showStatus&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>context.subscriptions.push(statusBarItem);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ›´æ–°çŠ¶æ€æ 
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> updateStatus(text: <span style=color:#ff7b72>string</span>, tooltip?: <span style=color:#ff7b72>string</span>) {
</span></span><span style=display:flex><span>    statusBarItem.text <span style=color:#ff7b72;font-weight:700>=</span> text;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (tooltip) {
</span></span><span style=display:flex><span>        statusBarItem.tooltip <span style=color:#ff7b72;font-weight:700>=</span> tooltip;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// å®šæ—¶æ›´æ–°çŠ¶æ€
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>let</span> updateInterval: <span style=color:#ff7b72>NodeJS.Timer</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>function</span> startStatusUpdates() {
</span></span><span style=display:flex><span>    updateInterval <span style=color:#ff7b72;font-weight:700>=</span> setInterval(() <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> time <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> Date().toLocaleTimeString();
</span></span><span style=display:flex><span>        updateStatus(<span style=color:#a5d6ff>`$(clock) </span><span style=color:#a5d6ff>${</span>time<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>, <span style=color:#a5d6ff>`å½“å‰æ—¶é—´: </span><span style=color:#a5d6ff>${</span>time<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>);
</span></span><span style=display:flex><span>    }, <span style=color:#a5d6ff>1000</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ¸…ç†èµ„æº
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> stopStatusUpdates() {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (updateInterval) {
</span></span><span style=display:flex><span>        clearInterval(updateInterval);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=è¾“å‡ºé€šé“>è¾“å‡ºé€šé“<a hidden class=anchor aria-hidden=true href=#è¾“å‡ºé€šé“>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// åˆ›å»ºè¾“å‡ºé€šé“
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> outputChannel <span style=color:#ff7b72;font-weight:700>=</span> vscode.window.createOutputChannel(
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#39;My Extension&#39;</span>,
</span></span><span style=display:flex><span>    { log: <span style=color:#ff7b72>true</span> }
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>context.subscriptions.push(outputChannel);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// å†™å…¥è¾“å‡º
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>outputChannel.appendLine(<span style=color:#a5d6ff>&#39;Extension started&#39;</span>);
</span></span><span style=display:flex><span>outputChannel.appendLine(<span style=color:#a5d6ff>`Timestamp: </span><span style=color:#a5d6ff>${</span><span style=color:#ff7b72>new</span> Date().toISOString()<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ˜¾ç¤ºè¾“å‡ºé€šé“
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>vscode.commands.registerCommand(<span style=color:#a5d6ff>&#39;extension.showOutput&#39;</span>, () <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>    outputChannel.show();
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ä¸åŒçº§åˆ«çš„æ—¥å¿—
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> log(level<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;info&#39;</span> <span style=color:#ff7b72;font-weight:700>|</span> <span style=color:#a5d6ff>&#39;warn&#39;</span> <span style=color:#ff7b72;font-weight:700>|</span> <span style=color:#a5d6ff>&#39;error&#39;</span>, message: <span style=color:#ff7b72>string</span>) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> timestamp <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> Date().toISOString();
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> logMessage <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>`[</span><span style=color:#a5d6ff>${</span>timestamp<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>] [</span><span style=color:#a5d6ff>${</span>level.toUpperCase()<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>] </span><span style=color:#a5d6ff>${</span>message<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    outputChannel.appendLine(logMessage);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (level <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;error&#39;</span>) {
</span></span><span style=display:flex><span>        vscode.window.showErrorMessage(message);
</span></span><span style=display:flex><span>    } <span style=color:#ff7b72>else</span> <span style=color:#ff7b72>if</span> (level <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;warn&#39;</span>) {
</span></span><span style=display:flex><span>        vscode.window.showWarningMessage(message);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=é…ç½®å’Œè®¾ç½®>é…ç½®å’Œè®¾ç½®<a hidden class=anchor aria-hidden=true href=#é…ç½®å’Œè®¾ç½®>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// è·å–æ‰©å±•é…ç½®
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> getConfig&lt;<span style=color:#7ee787>T</span>&gt;(key: <span style=color:#ff7b72>string</span>)<span style=color:#ff7b72;font-weight:700>:</span> T <span style=color:#ff7b72;font-weight:700>|</span> <span style=color:#79c0ff>undefined</span> {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> config <span style=color:#ff7b72;font-weight:700>=</span> vscode.workspace.getConfiguration(<span style=color:#a5d6ff>&#39;myExtension&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> config.<span style=color:#ff7b72>get</span>&lt;<span style=color:#7ee787>T</span>&gt;(key);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ç›‘å¬é…ç½®å˜åŒ–
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>vscode.workspace.onDidChangeConfiguration(event <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (event.affectsConfiguration(<span style=color:#a5d6ff>&#39;myExtension&#39;</span>)) {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> newConfig <span style=color:#ff7b72;font-weight:700>=</span> getConfig(<span style=color:#a5d6ff>&#39;enable&#39;</span>);
</span></span><span style=display:flex><span>        vscode.window.showInformationMessage(
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>`Extension </span><span style=color:#a5d6ff>${</span>newConfig <span style=color:#ff7b72;font-weight:700>?</span> <span style=color:#a5d6ff>&#39;enabled&#39;</span> <span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;disabled&#39;</span><span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// è®¾ç½®é…ç½®
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> setConfig(key: <span style=color:#ff7b72>string</span>, value: <span style=color:#ff7b72>any</span>) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> config <span style=color:#ff7b72;font-weight:700>=</span> vscode.workspace.getConfiguration(<span style=color:#a5d6ff>&#39;myExtension&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> config.update(key, value, vscode.ConfigurationTarget.Global);
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=4-ç¼–è¾‘å™¨åŠŸèƒ½æ‰©å±•>4. ç¼–è¾‘å™¨åŠŸèƒ½æ‰©å±•<a hidden class=anchor aria-hidden=true href=#4-ç¼–è¾‘å™¨åŠŸèƒ½æ‰©å±•>#</a></h2><h3 id=æ–‡æ¡£ç¼–è¾‘å™¨ä¿®æ”¹>æ–‡æ¡£ç¼–è¾‘å™¨ä¿®æ”¹<a hidden class=anchor aria-hidden=true href=#æ–‡æ¡£ç¼–è¾‘å™¨ä¿®æ”¹>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ³¨å†Œæ–‡æœ¬ç¼–è¾‘å™¨å‘½ä»¤
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>vscode.commands.registerCommand(
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#39;extension.insertCurrentTime&#39;</span>,
</span></span><span style=display:flex><span>    () <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> editor <span style=color:#ff7b72;font-weight:700>=</span> vscode.window.activeTextEditor;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> (editor) {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>const</span> currentTime <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> Date().toLocaleString();
</span></span><span style=display:flex><span>            editor.edit(editBuilder <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>const</span> position <span style=color:#ff7b72;font-weight:700>=</span> editor.selection.active;
</span></span><span style=display:flex><span>                editBuilder.insert(position, currentTime);
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ–‡æ¡£å†…å®¹ä¿®æ”¹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>vscode.commands.registerCommand(
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#39;extension.formatDocument&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>async</span> () <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> editor <span style=color:#ff7b72;font-weight:700>=</span> vscode.window.activeTextEditor;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> (editor) {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>const</span> document <span style=color:#ff7b72;font-weight:700>=</span> editor.document;
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>const</span> fullRange <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> vscode.Range(
</span></span><span style=display:flex><span>                document.positionAt(<span style=color:#a5d6ff>0</span>),
</span></span><span style=display:flex><span>                document.positionAt(document.getText().length)
</span></span><span style=display:flex><span>            );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>const</span> formattedText <span style=color:#ff7b72;font-weight:700>=</span> formatCode(document.getText());
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>await</span> editor.edit(editBuilder <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>                editBuilder.replace(fullRange, formattedText);
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>function</span> formatCode(code: <span style=color:#ff7b72>string</span>)<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ç®€å•çš„æ ¼å¼åŒ–é€»è¾‘
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>return</span> code
</span></span><span style=display:flex><span>        .split(<span style=color:#a5d6ff>&#39;\n&#39;</span>)
</span></span><span style=display:flex><span>        .map(line <span style=color:#ff7b72;font-weight:700>=&gt;</span> line.trim())
</span></span><span style=display:flex><span>        .join(<span style=color:#a5d6ff>&#39;\n&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=è£…é¥°å™¨decorations>è£…é¥°å™¨ï¼ˆDecorationsï¼‰<a hidden class=anchor aria-hidden=true href=#è£…é¥°å™¨decorations>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// åˆ›å»ºè£…é¥°ç±»å‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> decorationType <span style=color:#ff7b72;font-weight:700>=</span> vscode.window.createTextEditorDecorationType({
</span></span><span style=display:flex><span>    backgroundColor: <span style=color:#ff7b72>new</span> vscode.ThemeColor(<span style=color:#a5d6ff>&#39;editor.wordHighlightBackground&#39;</span>),
</span></span><span style=display:flex><span>    border<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;1px solid&#39;</span>,
</span></span><span style=display:flex><span>    borderColor: <span style=color:#ff7b72>new</span> vscode.ThemeColor(<span style=color:#a5d6ff>&#39;editor.wordHighlightBorder&#39;</span>),
</span></span><span style=display:flex><span>    borderRadius<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;3px&#39;</span>
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// åº”ç”¨è£…é¥°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> highlightWords(editor: <span style=color:#ff7b72>vscode.TextEditor</span>, words: <span style=color:#ff7b72>string</span>[]) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> text <span style=color:#ff7b72;font-weight:700>=</span> editor.document.getText();
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> decorations: <span style=color:#ff7b72>vscode.DecorationOptions</span>[] <span style=color:#ff7b72;font-weight:700>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    words.forEach(word <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> regex <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> RegExp(word, <span style=color:#a5d6ff>&#39;gi&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>let</span> match;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>while</span> ((match <span style=color:#ff7b72;font-weight:700>=</span> regex.exec(text)) <span style=color:#ff7b72;font-weight:700>!==</span> <span style=color:#79c0ff>null</span>) {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>const</span> startPos <span style=color:#ff7b72;font-weight:700>=</span> editor.document.positionAt(match.index);
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>const</span> endPos <span style=color:#ff7b72;font-weight:700>=</span> editor.document.positionAt(match.index <span style=color:#ff7b72;font-weight:700>+</span> match[<span style=color:#a5d6ff>0</span>].length);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            decorations.push({
</span></span><span style=display:flex><span>                range: <span style=color:#ff7b72>new</span> vscode.Range(startPos, endPos),
</span></span><span style=display:flex><span>                hoverMessage<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>`Found word: </span><span style=color:#a5d6ff>${</span>word<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>,
</span></span><span style=display:flex><span>                isWholeLine: <span style=color:#ff7b72>false</span>
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    editor.setDecorations(decorationType, decorations);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ¸…é™¤è£…é¥°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> clearDecorations(editor: <span style=color:#ff7b72>vscode.TextEditor</span>) {
</span></span><span style=display:flex><span>    editor.setDecorations(decorationType, []);
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=ä»£ç å®Œæˆæä¾›è€…>ä»£ç å®Œæˆæä¾›è€…<a hidden class=anchor aria-hidden=true href=#ä»£ç å®Œæˆæä¾›è€…>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ³¨å†Œä»£ç å®Œæˆæä¾›è€…
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> completionProvider <span style=color:#ff7b72;font-weight:700>=</span> vscode.languages.registerCompletionItemProvider(
</span></span><span style=display:flex><span>    { scheme<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;file&#39;</span>, language<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;javascript&#39;</span> },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        provideCompletionItems(
</span></span><span style=display:flex><span>            document<span style=color:#ff7b72;font-weight:700>:</span> vscode.TextDocument,
</span></span><span style=display:flex><span>            position: <span style=color:#ff7b72>vscode.Position</span>,
</span></span><span style=display:flex><span>            token: <span style=color:#ff7b72>vscode.CancellationToken</span>,
</span></span><span style=display:flex><span>            context: <span style=color:#ff7b72>vscode.CompletionContext</span>
</span></span><span style=display:flex><span>        )<span style=color:#ff7b72;font-weight:700>:</span> vscode.CompletionItem[] {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>const</span> completions: <span style=color:#ff7b72>vscode.CompletionItem</span>[] <span style=color:#ff7b72;font-weight:700>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic>// è‡ªå®šä¹‰ä»£ç ç‰‡æ®µ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>            <span style=color:#ff7b72>const</span> snippet <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> vscode.CompletionItem(
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;myFunction&#39;</span>,
</span></span><span style=display:flex><span>                vscode.CompletionItemKind.Snippet
</span></span><span style=display:flex><span>            );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            snippet.insertText <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> vscode.SnippetString(
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;function ${1:functionName}(${2:parameters}) {\n\t${3:// function body}\n}&#39;</span>
</span></span><span style=display:flex><span>            );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            snippet.documentation <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#39;Creates a new function&#39;</span>;
</span></span><span style=display:flex><span>            snippet.detail <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#39;Custom function template&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            completions.push(snippet);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic>// æ ¹æ®ä¸Šä¸‹æ–‡æä¾›ä¸åŒçš„å®Œæˆé¡¹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>            <span style=color:#ff7b72>const</span> linePrefix <span style=color:#ff7b72;font-weight:700>=</span> document.getText(
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>new</span> vscode.Range(position.line, <span style=color:#a5d6ff>0</span>, position.line, position.character)
</span></span><span style=display:flex><span>            );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> (linePrefix.includes(<span style=color:#a5d6ff>&#39;console.&#39;</span>)) {
</span></span><span style=display:flex><span>                completions.push(
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>new</span> vscode.CompletionItem(
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;logCustom&#39;</span>,
</span></span><span style=display:flex><span>                        vscode.CompletionItemKind.Method
</span></span><span style=display:flex><span>                    )
</span></span><span style=display:flex><span>                );
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> completions;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>context.subscriptions.push(completionProvider);
</span></span></code></pre></td></tr></table></div></div><h3 id=æ‚¬åœæç¤º>æ‚¬åœæç¤º<a hidden class=anchor aria-hidden=true href=#æ‚¬åœæç¤º>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ³¨å†Œæ‚¬åœæç¤ºæä¾›è€…
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> hoverProvider <span style=color:#ff7b72;font-weight:700>=</span> vscode.languages.registerHoverProvider(
</span></span><span style=display:flex><span>    { scheme<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;file&#39;</span>, language<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;typescript&#39;</span> },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        provideHover(
</span></span><span style=display:flex><span>            document<span style=color:#ff7b72;font-weight:700>:</span> vscode.TextDocument,
</span></span><span style=display:flex><span>            position: <span style=color:#ff7b72>vscode.Position</span>,
</span></span><span style=display:flex><span>            token: <span style=color:#ff7b72>vscode.CancellationToken</span>
</span></span><span style=display:flex><span>        )<span style=color:#ff7b72;font-weight:700>:</span> vscode.Hover <span style=color:#ff7b72;font-weight:700>|</span> <span style=color:#79c0ff>null</span> {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>const</span> word <span style=color:#ff7b72;font-weight:700>=</span> document.getText(
</span></span><span style=display:flex><span>                document.getWordRangeAtPosition(position)
</span></span><span style=display:flex><span>            );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> (word <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> [<span style=color:#a5d6ff>&#39;API&#39;</span>, <span style=color:#a5d6ff>&#39;HTTP&#39;</span>, <span style=color:#a5d6ff>&#39;JSON&#39;</span>].includes(word)) {
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>const</span> markdown <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> vscode.MarkdownString();
</span></span><span style=display:flex><span>                markdown.appendMarkdown(<span style=color:#a5d6ff>`### </span><span style=color:#a5d6ff>${</span>word<span style=color:#a5d6ff>}</span><span style=color:#f85149>\</span><span style=color:#a5d6ff>n</span><span style=color:#f85149>\</span><span style=color:#a5d6ff>n`</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>switch</span> (word) {
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#39;API&#39;</span><span style=color:#ff7b72;font-weight:700>:</span>
</span></span><span style=display:flex><span>                        markdown.appendMarkdown(
</span></span><span style=display:flex><span>                            <span style=color:#a5d6ff>&#39;Application Programming Interface\n\n&#39;</span> <span style=color:#ff7b72;font-weight:700>+</span>
</span></span><span style=display:flex><span>                            <span style=color:#a5d6ff>&#39;åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼Œå®šä¹‰äº†è½¯ä»¶ç»„ä»¶ä¹‹é—´çš„é€šä¿¡æ–¹å¼&#39;</span>
</span></span><span style=display:flex><span>                        );
</span></span><span style=display:flex><span>                        <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#39;HTTP&#39;</span><span style=color:#ff7b72;font-weight:700>:</span>
</span></span><span style=display:flex><span>                        markdown.appendMarkdown(
</span></span><span style=display:flex><span>                            <span style=color:#a5d6ff>&#39;HyperText Transfer Protocol\n\n&#39;</span> <span style=color:#ff7b72;font-weight:700>+</span>
</span></span><span style=display:flex><span>                            <span style=color:#a5d6ff>&#39;è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œç”¨äºä¼ è¾“è¶…åª’ä½“æ–‡æ¡£&#39;</span>
</span></span><span style=display:flex><span>                        );
</span></span><span style=display:flex><span>                        <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#39;JSON&#39;</span><span style=color:#ff7b72;font-weight:700>:</span>
</span></span><span style=display:flex><span>                        markdown.appendMarkdown(
</span></span><span style=display:flex><span>                            <span style=color:#a5d6ff>&#39;JavaScript Object Notation\n\n&#39;</span> <span style=color:#ff7b72;font-weight:700>+</span>
</span></span><span style=display:flex><span>                            <span style=color:#a5d6ff>&#39;è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼&#39;</span>
</span></span><span style=display:flex><span>                        );
</span></span><span style=display:flex><span>                        <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>return</span> <span style=color:#ff7b72>new</span> vscode.Hover(markdown);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> <span style=color:#79c0ff>null</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>context.subscriptions.push(hoverProvider);
</span></span></code></pre></td></tr></table></div></div><h2 id=5-webviewæ‰©å±•>5. WebViewæ‰©å±•<a hidden class=anchor aria-hidden=true href=#5-webviewæ‰©å±•>#</a></h2><h3 id=åˆ›å»ºwebview>åˆ›å»ºWebView<a hidden class=anchor aria-hidden=true href=#åˆ›å»ºwebview>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// WebView Panelç±»
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>class</span> MyWebView {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>private</span> <span style=color:#ff7b72>readonly</span> _panel: <span style=color:#ff7b72>vscode.WebviewPanel</span>;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>private</span> <span style=color:#ff7b72>readonly</span> _extensionUri: <span style=color:#ff7b72>vscode.Uri</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>constructor</span>(extensionUri: <span style=color:#ff7b72>vscode.Uri</span>) {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>this</span>._extensionUri <span style=color:#ff7b72;font-weight:700>=</span> extensionUri;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// åˆ›å»ºWebviewé¢æ¿
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        <span style=color:#ff7b72>this</span>._panel <span style=color:#ff7b72;font-weight:700>=</span> vscode.window.createWebviewPanel(
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;myWebView&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;My WebView&#39;</span>,
</span></span><span style=display:flex><span>            vscode.ViewColumn.One,
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                enableScripts: <span style=color:#ff7b72>true</span>,
</span></span><span style=display:flex><span>                retainContextWhenHidden: <span style=color:#ff7b72>true</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// è®¾ç½®HTMLå†…å®¹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        <span style=color:#ff7b72>this</span>._panel.webview.html <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>._getHtmlForWebview();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// ç›‘å¬æ¶ˆæ¯
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        <span style=color:#ff7b72>this</span>._panel.webview.onDidReceiveMessage(
</span></span><span style=display:flex><span>            message <span style=color:#ff7b72;font-weight:700>=&gt;</span> <span style=color:#ff7b72>this</span>._onMessage(message)
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>private</span> _getHtmlForWebview()<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>string</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>`&lt;!DOCTYPE html&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>&lt;html lang=&#34;en&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>&lt;head&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    &lt;meta charset=&#34;UTF-8&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1.0&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    &lt;title&gt;My WebView&lt;/title&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    &lt;style&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        body {
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            font-family: Arial, sans-serif;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            padding: 20px;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        }
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        .container {
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            max-width: 800px;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            margin: 0 auto;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        }
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        button {
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            background: #007acc;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            color: white;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            border: none;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            padding: 8px 16px;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            border-radius: 4px;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            cursor: pointer;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        }
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        button:hover {
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            background: #005a9e;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        }
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    &lt;/style&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>&lt;/head&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>&lt;body&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    &lt;div class=&#34;container&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &lt;h1&gt;My WebView&lt;/h1&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &lt;p&gt;This is a custom WebView panel.&lt;/p&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &lt;button onclick=&#34;sendMessage()&#34;&gt;Send Message&lt;/button&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &lt;div id=&#34;response&#34;&gt;&lt;/div&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    &lt;/div&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    &lt;script&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        const vscode = acquireVsCodeApi();
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        function sendMessage() {
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            vscode.postMessage({
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>                command: &#39;hello&#39;,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>                text: &#39;Hello from WebView!&#39;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            });
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        }
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        window.addEventListener(&#39;message&#39;, event =&gt; {
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            const message = event.data;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            switch (message.command) {
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>                case &#39;update&#39;:
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>                    document.getElementById(&#39;response&#39;).textContent = message.text;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>                    break;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            }
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        });
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>    &lt;/script&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>&lt;/body&gt;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>&lt;/html&gt;`</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>private</span> _onMessage(message: <span style=color:#ff7b72>any</span>) {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>switch</span> (message.command) {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#39;hello&#39;</span><span style=color:#ff7b72;font-weight:700>:</span>
</span></span><span style=display:flex><span>                vscode.window.showInformationMessage(
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>`WebView says: </span><span style=color:#a5d6ff>${</span>message.text<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>
</span></span><span style=display:flex><span>                );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#8b949e;font-style:italic>// å‘é€å“åº”åˆ°WebView
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>                <span style=color:#ff7b72>this</span>._panel.webview.postMessage({
</span></span><span style=display:flex><span>                    command<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;update&#39;</span>,
</span></span><span style=display:flex><span>                    text<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;Extension received your message!&#39;</span>
</span></span><span style=display:flex><span>                });
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ³¨å†ŒWebViewå‘½ä»¤
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>vscode.commands.registerCommand(
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#39;extension.openWebView&#39;</span>,
</span></span><span style=display:flex><span>    () <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> webView <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> MyWebView(context.extensionUri);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>);
</span></span></code></pre></td></tr></table></div></div><h3 id=webviewä¸æ‰©å±•é€šä¿¡>WebViewä¸æ‰©å±•é€šä¿¡<a hidden class=anchor aria-hidden=true href=#webviewä¸æ‰©å±•é€šä¿¡>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">69
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ›´å¤æ‚çš„WebViewé€šä¿¡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>class</span> AdvancedWebView {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>private</span> _panel: <span style=color:#ff7b72>vscode.WebviewPanel</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>constructor</span>(extensionUri: <span style=color:#ff7b72>vscode.Uri</span>) {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>this</span>._panel <span style=color:#ff7b72;font-weight:700>=</span> vscode.window.createWebviewPanel(
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;advancedWebView&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;Advanced WebView&#39;</span>,
</span></span><span style=display:flex><span>            vscode.ViewColumn.One,
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>                enableScripts: <span style=color:#ff7b72>true</span>,
</span></span><span style=display:flex><span>                retainContextWhenHidden: <span style=color:#ff7b72>true</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>this</span>._panel.webview.html <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>this</span>._getHtml();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>this</span>._setupMessageHandlers();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>private</span> _setupMessageHandlers() {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>this</span>._panel.webview.onDidReceiveMessage(
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>async</span> message <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>switch</span> (message.command) {
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#39;openFile&#39;</span><span style=color:#ff7b72;font-weight:700>:</span>
</span></span><span style=display:flex><span>                        <span style=color:#ff7b72>const</span> fileUri <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> vscode.window.showOpenDialog({
</span></span><span style=display:flex><span>                            canSelectMany: <span style=color:#ff7b72>false</span>,
</span></span><span style=display:flex><span>                            openLabel<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;Select a file&#39;</span>
</span></span><span style=display:flex><span>                        });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        <span style=color:#ff7b72>if</span> (fileUri) {
</span></span><span style=display:flex><span>                            <span style=color:#ff7b72>this</span>._panel.webview.postMessage({
</span></span><span style=display:flex><span>                                command<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;fileOpened&#39;</span>,
</span></span><span style=display:flex><span>                                path: <span style=color:#ff7b72>fileUri</span>[<span style=color:#a5d6ff>0</span>].fsPath
</span></span><span style=display:flex><span>                            });
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                        <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#39;saveData&#39;</span><span style=color:#ff7b72;font-weight:700>:</span>
</span></span><span style=display:flex><span>                        <span style=color:#ff7b72>try</span> {
</span></span><span style=display:flex><span>                            <span style=color:#ff7b72>await</span> vscode.workspace.fs.writeFile(
</span></span><span style=display:flex><span>                                vscode.Uri.file(message.path),
</span></span><span style=display:flex><span>                                Buffer.<span style=color:#ff7b72>from</span>(message.content, <span style=color:#a5d6ff>&#39;utf8&#39;</span>)
</span></span><span style=display:flex><span>                            );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                            <span style=color:#ff7b72>this</span>._panel.webview.postMessage({
</span></span><span style=display:flex><span>                                command<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;dataSaved&#39;</span>,
</span></span><span style=display:flex><span>                                success: <span style=color:#ff7b72>true</span>
</span></span><span style=display:flex><span>                            });
</span></span><span style=display:flex><span>                        } <span style=color:#ff7b72>catch</span> (error) {
</span></span><span style=display:flex><span>                            <span style=color:#ff7b72>this</span>._panel.webview.postMessage({
</span></span><span style=display:flex><span>                                command<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;dataSaved&#39;</span>,
</span></span><span style=display:flex><span>                                success: <span style=color:#ff7b72>false</span>,
</span></span><span style=display:flex><span>                                error: <span style=color:#ff7b72>error.message</span>
</span></span><span style=display:flex><span>                            });
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                        <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// å…¬å¼€æ–¹æ³•ä¾›å¤–éƒ¨è°ƒç”¨
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    <span style=color:#ff7b72>public</span> updateContent(data: <span style=color:#ff7b72>any</span>) {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>this</span>._panel.webview.postMessage({
</span></span><span style=display:flex><span>            command<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;updateContent&#39;</span>,
</span></span><span style=display:flex><span>            data
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=6-æ–‡ä»¶ç³»ç»Ÿæ“ä½œ>6. æ–‡ä»¶ç³»ç»Ÿæ“ä½œ<a hidden class=anchor aria-hidden=true href=#6-æ–‡ä»¶ç³»ç»Ÿæ“ä½œ>#</a></h2><h3 id=å·¥ä½œåŒºæ–‡ä»¶æ“ä½œ>å·¥ä½œåŒºæ–‡ä»¶æ“ä½œ<a hidden class=anchor aria-hidden=true href=#å·¥ä½œåŒºæ–‡ä»¶æ“ä½œ>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">57
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// è¯»å–æ–‡ä»¶å†…å®¹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>async</span> <span style=color:#ff7b72>function</span> readFile(uri: <span style=color:#ff7b72>vscode.Uri</span>)<span style=color:#ff7b72;font-weight:700>:</span> Promise&lt;<span style=color:#7ee787>string</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> content <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> vscode.workspace.fs.readFile(uri);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> Buffer.<span style=color:#ff7b72>from</span>(content).toString(<span style=color:#a5d6ff>&#39;utf8&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// å†™å…¥æ–‡ä»¶
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>async</span> <span style=color:#ff7b72>function</span> writeFile(uri: <span style=color:#ff7b72>vscode.Uri</span>, content: <span style=color:#ff7b72>string</span>)<span style=color:#ff7b72;font-weight:700>:</span> Promise&lt;<span style=color:#7ee787>void</span>&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>await</span> vscode.workspace.fs.writeFile(
</span></span><span style=display:flex><span>        uri,
</span></span><span style=display:flex><span>        Buffer.<span style=color:#ff7b72>from</span>(content, <span style=color:#a5d6ff>&#39;utf8&#39;</span>)
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// åˆ›å»ºæ–‡ä»¶
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>vscode.commands.registerCommand(
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#39;extension.createFile&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>async</span> () <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> fileName <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> vscode.window.showInputBox({
</span></span><span style=display:flex><span>            prompt<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;Enter file name&#39;</span>,
</span></span><span style=display:flex><span>            placeHolder<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;example.txt&#39;</span>
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> (fileName) {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>const</span> workspaceFolders <span style=color:#ff7b72;font-weight:700>=</span> vscode.workspace.workspaceFolders;
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> (workspaceFolders) {
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>const</span> fileUri <span style=color:#ff7b72;font-weight:700>=</span> vscode.Uri.joinPath(
</span></span><span style=display:flex><span>                    workspaceFolders[<span style=color:#a5d6ff>0</span>].uri,
</span></span><span style=display:flex><span>                    fileName
</span></span><span style=display:flex><span>                );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>await</span> writeFile(fileUri, <span style=color:#a5d6ff>&#39;&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>const</span> document <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> vscode.workspace.openTextDocument(fileUri);
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>await</span> vscode.window.showTextDocument(document);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ‰¹é‡æ–‡ä»¶æ“ä½œ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>async</span> <span style=color:#ff7b72>function</span> processFilesInDirectory(directoryUri: <span style=color:#ff7b72>vscode.Uri</span>) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> entries <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> vscode.workspace.fs.readDirectory(directoryUri);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>for</span> (<span style=color:#ff7b72>const</span> [name, <span style=color:#ff7b72>type</span>] <span style=color:#ff7b72>of</span> entries) {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> entryUri <span style=color:#ff7b72;font-weight:700>=</span> vscode.Uri.joinPath(directoryUri, name);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72>type</span> <span style=color:#ff7b72;font-weight:700>===</span> vscode.FileType.File) {
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic>// å¤„ç†æ–‡ä»¶
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>            <span style=color:#ff7b72>const</span> content <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> readFile(entryUri);
</span></span><span style=display:flex><span>            console.log(<span style=color:#a5d6ff>`Processing file: </span><span style=color:#a5d6ff>${</span>name<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>, size: </span><span style=color:#a5d6ff>${</span>content.length<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>);
</span></span><span style=display:flex><span>        } <span style=color:#ff7b72>else</span> <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72>type</span> <span style=color:#ff7b72;font-weight:700>===</span> vscode.FileType.Directory) {
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic>// é€’å½’å¤„ç†ç›®å½•
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>            <span style=color:#ff7b72>await</span> processFilesInDirectory(entryUri);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=å·¥ä½œåŒºç›‘å¬>å·¥ä½œåŒºç›‘å¬<a hidden class=anchor aria-hidden=true href=#å·¥ä½œåŒºç›‘å¬>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ç›‘å¬æ–‡ä»¶å˜åŒ–
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> fileWatcher <span style=color:#ff7b72;font-weight:700>=</span> vscode.workspace.createFileSystemWatcher(
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#39;**/*.{js,ts,json}&#39;</span>
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fileWatcher.onDidCreate(uri <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>    console.log(<span style=color:#a5d6ff>`File created: </span><span style=color:#a5d6ff>${</span>uri.fsPath<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fileWatcher.onDidChange(uri <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>    console.log(<span style=color:#a5d6ff>`File changed: </span><span style=color:#a5d6ff>${</span>uri.fsPath<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fileWatcher.onDidDelete(uri <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>    console.log(<span style=color:#a5d6ff>`File deleted: </span><span style=color:#a5d6ff>${</span>uri.fsPath<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ç›‘å¬æ–‡æ¡£ä¿å­˜
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>vscode.workspace.onDidSaveTextDocument(
</span></span><span style=display:flex><span>    (document) <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> (document.languageId <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;javascript&#39;</span>) {
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic>// è‡ªåŠ¨æ ¼å¼åŒ–JavaScriptæ–‡ä»¶
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>            formatDocument(document);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ç›‘å¬æ–‡æœ¬ç¼–è¾‘å™¨å˜åŒ–
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>vscode.window.onDidChangeActiveTextEditor(
</span></span><span style=display:flex><span>    (editor) <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> (editor) {
</span></span><span style=display:flex><span>            console.log(<span style=color:#a5d6ff>`Active editor: </span><span style=color:#a5d6ff>${</span>editor.document.fileName<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>);
</span></span></code></pre></td></tr></table></div></div><h2 id=7-æµ‹è¯•å’Œè°ƒè¯•>7. æµ‹è¯•å’Œè°ƒè¯•<a hidden class=anchor aria-hidden=true href=#7-æµ‹è¯•å’Œè°ƒè¯•>#</a></h2><h3 id=å•å…ƒæµ‹è¯•>å•å…ƒæµ‹è¯•<a hidden class=anchor aria-hidden=true href=#å•å…ƒæµ‹è¯•>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">60
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// src/test/extension.test.ts
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>import</span> <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#ff7b72>as</span> assert <span style=color:#ff7b72>from</span> <span style=color:#a5d6ff>&#39;assert&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#ff7b72>as</span> vscode <span style=color:#ff7b72>from</span> <span style=color:#a5d6ff>&#39;vscode&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#ff7b72>as</span> extension <span style=color:#ff7b72>from</span> <span style=color:#a5d6ff>&#39;../extension&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>suite(<span style=color:#a5d6ff>&#39;Extension Test Suite&#39;</span>, () <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>    vscode.window.showInformationMessage(<span style=color:#a5d6ff>&#39;Start all tests.&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    test(<span style=color:#a5d6ff>&#39;Extension should be present&#39;</span>, () <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>        assert.ok(extension);
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    test(<span style=color:#a5d6ff>&#39;Command should register&#39;</span>, <span style=color:#ff7b72>async</span> () <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> command <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#39;extension.helloWorld&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> result <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> vscode.commands.executeCommand(command);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        assert.strictEqual(result, <span style=color:#79c0ff>undefined</span>);
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    test(<span style=color:#a5d6ff>&#39;Command should show message&#39;</span>, <span style=color:#ff7b72>async</span> () <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>let</span> messageShown <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>false</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> disposable <span style=color:#ff7b72;font-weight:700>=</span> vscode.window.onDidShowInformationMessage(() <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>            messageShown <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>true</span>;
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>await</span> vscode.commands.executeCommand(<span style=color:#a5d6ff>&#39;extension.helloWorld&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        assert.ok(messageShown);
</span></span><span style=display:flex><span>        disposable.dispose();
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// é›†æˆæµ‹è¯•
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>suite(<span style=color:#a5d6ff>&#39;Integration Tests&#39;</span>, () <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>    test(<span style=color:#a5d6ff>&#39;Should create and open file&#39;</span>, <span style=color:#ff7b72>async</span> () <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> fileName <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#39;test-file.txt&#39;</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> fileContent <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#39;Hello, World!&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> workspaceFolders <span style=color:#ff7b72;font-weight:700>=</span> vscode.workspace.workspaceFolders;
</span></span><span style=display:flex><span>        assert.ok(workspaceFolders, <span style=color:#a5d6ff>&#39;No workspace folder found&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> fileUri <span style=color:#ff7b72;font-weight:700>=</span> vscode.Uri.joinPath(
</span></span><span style=display:flex><span>            workspaceFolders[<span style=color:#a5d6ff>0</span>].uri,
</span></span><span style=display:flex><span>            fileName
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// å†™å…¥æ–‡ä»¶
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        <span style=color:#ff7b72>await</span> vscode.workspace.fs.writeFile(
</span></span><span style=display:flex><span>            fileUri,
</span></span><span style=display:flex><span>            Buffer.<span style=color:#ff7b72>from</span>(fileContent)
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// æ‰“å¼€æ–‡ä»¶
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        <span style=color:#ff7b72>const</span> document <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> vscode.workspace.openTextDocument(fileUri);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>await</span> vscode.window.showTextDocument(document);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        assert.strictEqual(document.getText(), fileContent);
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>});
</span></span></code></pre></td></tr></table></div></div><h3 id=è°ƒè¯•é…ç½®>è°ƒè¯•é…ç½®<a hidden class=anchor aria-hidden=true href=#è°ƒè¯•é…ç½®>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// .vscode/launch.json
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>{
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;version&#34;</span>: <span style=color:#a5d6ff>&#34;0.2.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;configurations&#34;</span>: [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;name&#34;</span>: <span style=color:#a5d6ff>&#34;Run Extension&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;type&#34;</span>: <span style=color:#a5d6ff>&#34;extensionHost&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;request&#34;</span>: <span style=color:#a5d6ff>&#34;launch&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;args&#34;</span>: [
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#34;--extensionDevelopmentPath=${workspaceFolder}&#34;</span>
</span></span><span style=display:flex><span>            ],
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;outFiles&#34;</span>: [
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#34;${workspaceFolder}/out/**/*.js&#34;</span>
</span></span><span style=display:flex><span>            ],
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;preLaunchTask&#34;</span>: <span style=color:#a5d6ff>&#34;${workspaceFolder}/npm: compile&#34;</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;name&#34;</span>: <span style=color:#a5d6ff>&#34;Extension Tests&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;type&#34;</span>: <span style=color:#a5d6ff>&#34;extensionHost&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;request&#34;</span>: <span style=color:#a5d6ff>&#34;launch&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;args&#34;</span>: [
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#34;--extensionDevelopmentPath=${workspaceFolder}&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#34;--extensionTestsPath=${workspaceFolder}/out/test/suite/index&#34;</span>
</span></span><span style=display:flex><span>            ],
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;outFiles&#34;</span>: [
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#34;${workspaceFolder}/out/test/**/*.js&#34;</span>
</span></span><span style=display:flex><span>            ],
</span></span><span style=display:flex><span>            <span style=color:#7ee787>&#34;preLaunchTask&#34;</span>: <span style=color:#a5d6ff>&#34;${workspaceFolder}/npm: compile&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=8-å‘å¸ƒå’Œæ‰“åŒ…>8. å‘å¸ƒå’Œæ‰“åŒ…<a hidden class=anchor aria-hidden=true href=#8-å‘å¸ƒå’Œæ‰“åŒ…>#</a></h2><h3 id=å‡†å¤‡å‘å¸ƒ>å‡†å¤‡å‘å¸ƒ<a hidden class=anchor aria-hidden=true href=#å‡†å¤‡å‘å¸ƒ>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8b949e;font-style:italic># å®‰è£…vsceå·¥å…·</span>
</span></span><span style=display:flex><span>npm install -g vsce
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># æ›´æ–°package.jsonç‰ˆæœ¬</span>
</span></span><span style=display:flex><span>npm version patch  <span style=color:#8b949e;font-style:italic># æˆ– minor, major</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># æ„å»ºæ‰©å±•</span>
</span></span><span style=display:flex><span>npm run vscode:prepublish
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># æ£€æŸ¥åŒ…</span>
</span></span><span style=display:flex><span>vsce ls --publish
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># å‘å¸ƒåˆ°å¸‚åœº</span>
</span></span><span style=display:flex><span>vsce publish
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic># æ‰“åŒ…ä¸º.vsixæ–‡ä»¶</span>
</span></span><span style=display:flex><span>vsce package
</span></span></code></pre></td></tr></table></div></div><h3 id=å‘å¸ƒé…ç½®>å‘å¸ƒé…ç½®<a hidden class=anchor aria-hidden=true href=#å‘å¸ƒé…ç½®>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// package.jsonä¸­çš„å‘å¸ƒç›¸å…³é…ç½®
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>{
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;name&#34;</span>: <span style=color:#a5d6ff>&#34;my-extension&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;displayName&#34;</span>: <span style=color:#a5d6ff>&#34;My Awesome Extension&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;description&#34;</span>: <span style=color:#a5d6ff>&#34;A helpful description&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;version&#34;</span>: <span style=color:#a5d6ff>&#34;1.0.0&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;publisher&#34;</span>: <span style=color:#a5d6ff>&#34;your-publisher-name&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;repository&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;type&#34;</span>: <span style=color:#a5d6ff>&#34;git&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;url&#34;</span>: <span style=color:#a5d6ff>&#34;https://github.com/your-username/my-extension.git&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;bugs&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;url&#34;</span>: <span style=color:#a5d6ff>&#34;https://github.com/your-username/my-extension/issues&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;homepage&#34;</span>: <span style=color:#a5d6ff>&#34;https://github.com/your-username/my-extension#readme&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;keywords&#34;</span>: [
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;vscode&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;extension&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;tool&#34;</span>
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;engines&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#7ee787>&#34;vscode&#34;</span>: <span style=color:#a5d6ff>&#34;^1.75.0&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;categories&#34;</span>: [
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;Other&#34;</span>
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;icon&#34;</span>: <span style=color:#a5d6ff>&#34;images/icon.png&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#7ee787>&#34;gallery&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;feature&#34;</span>: <span style=color:#a5d6ff>&#34;images/screenshot1.png&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;label&#34;</span>: <span style=color:#a5d6ff>&#34;Feature 1&#34;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;feature&#34;</span>: <span style=color:#a5d6ff>&#34;images/screenshot2.png&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#7ee787>&#34;label&#34;</span>: <span style=color:#a5d6ff>&#34;Feature 2&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=9-æœ€ä½³å®è·µ>9. æœ€ä½³å®è·µ<a hidden class=anchor aria-hidden=true href=#9-æœ€ä½³å®è·µ>#</a></h2><h3 id=ä»£ç ç»„ç»‡>ä»£ç ç»„ç»‡<a hidden class=anchor aria-hidden=true href=#ä»£ç ç»„ç»‡>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ¨¡å—åŒ–å‘½ä»¤
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>class</span> CommandManager {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>private</span> commands: <span style=color:#ff7b72>vscode.Disposable</span>[] <span style=color:#ff7b72;font-weight:700>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>constructor</span>(<span style=color:#ff7b72>private</span> context: <span style=color:#ff7b72>vscode.ExtensionContext</span>) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    register(command: <span style=color:#ff7b72>string</span>, callback<span style=color:#ff7b72;font-weight:700>:</span> (...args: <span style=color:#ff7b72>any</span>[]) <span style=color:#ff7b72;font-weight:700>=&gt;</span> <span style=color:#ff7b72>any</span>) {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> disposable <span style=color:#ff7b72;font-weight:700>=</span> vscode.commands.registerCommand(command, callback);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>this</span>.commands.push(disposable);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> disposable;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    dispose() {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>this</span>.commands.forEach(disposable <span style=color:#ff7b72;font-weight:700>=&gt;</span> disposable.dispose());
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>this</span>.commands <span style=color:#ff7b72;font-weight:700>=</span> [];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ¨¡å—åŒ–é…ç½®
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>class</span> ConfigManager {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>constructor</span>(<span style=color:#ff7b72>private</span> configSection: <span style=color:#ff7b72>string</span>) {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>get</span>&lt;<span style=color:#7ee787>T</span>&gt;(key: <span style=color:#ff7b72>string</span>)<span style=color:#ff7b72;font-weight:700>:</span> T <span style=color:#ff7b72;font-weight:700>|</span> <span style=color:#79c0ff>undefined</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> vscode.workspace.getConfiguration(<span style=color:#ff7b72>this</span>.configSection).<span style=color:#ff7b72>get</span>&lt;<span style=color:#7ee787>T</span>&gt;(key);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>async</span> <span style=color:#ff7b72>set</span>(key: <span style=color:#ff7b72>string</span>, value: <span style=color:#ff7b72>any</span>)<span style=color:#ff7b72;font-weight:700>:</span> Promise&lt;<span style=color:#7ee787>void</span>&gt; {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> config <span style=color:#ff7b72;font-weight:700>=</span> vscode.workspace.getConfiguration(<span style=color:#ff7b72>this</span>.configSection);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>await</span> config.update(key, value, vscode.ConfigurationTarget.Global);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ä½¿ç”¨ç¤ºä¾‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>export</span> <span style=color:#ff7b72>function</span> activate(context: <span style=color:#ff7b72>vscode.ExtensionContext</span>) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> commandManager <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> CommandManager(context);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> configManager <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> ConfigManager(<span style=color:#a5d6ff>&#39;myExtension&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    commandManager.register(<span style=color:#a5d6ff>&#39;extension.myCommand&#39;</span>, () <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> setting <span style=color:#ff7b72;font-weight:700>=</span> configManager.<span style=color:#ff7b72>get</span>&lt;<span style=color:#7ee787>boolean</span>&gt;(<span style=color:#a5d6ff>&#39;enable&#39;</span>);
</span></span><span style=display:flex><span>        vscode.window.showInformationMessage(<span style=color:#a5d6ff>`Setting: </span><span style=color:#a5d6ff>${</span>setting<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>);
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=æ€§èƒ½ä¼˜åŒ–>æ€§èƒ½ä¼˜åŒ–<a hidden class=anchor aria-hidden=true href=#æ€§èƒ½ä¼˜åŒ–>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æ‡’åŠ è½½åŠŸèƒ½
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>let</span> featureModule: <span style=color:#ff7b72>any</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>async</span> <span style=color:#ff7b72>function</span> loadFeatureModule() {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72;font-weight:700>!</span>featureModule) {
</span></span><span style=display:flex><span>        featureModule <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> <span style=color:#ff7b72>import</span>(<span style=color:#a5d6ff>&#39;./feature-module&#39;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> featureModule;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>vscode.commands.registerCommand(
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#39;extension.feature&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>async</span> () <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>const</span> module <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> loadFeatureModule();
</span></span><span style=display:flex><span>        module.execute();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ç¼“å­˜è®¡ç®—ç»“æœ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> cache <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>new</span> Map&lt;<span style=color:#7ee787>string</span>, any&gt;();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>function</span> expensiveCalculation(input: <span style=color:#ff7b72>string</span>)<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>any</span> {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (cache.has(input)) {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> cache.<span style=color:#ff7b72>get</span>(input);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> result <span style=color:#ff7b72;font-weight:700>=</span> performExpensiveCalculation(input);
</span></span><span style=display:flex><span>    cache.<span style=color:#ff7b72>set</span>(input, result);
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> result;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// äº‹ä»¶é˜²æŠ–
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> debounce&lt;<span style=color:#7ee787>T</span> extends <span style=color:#f85149>(</span>...args<span style=color:#f85149>:</span> any<span style=color:#f85149>[])</span> <span style=color:#f85149>=</span>&gt; <span style=color:#ff7b72>void</span><span style=color:#ff7b72;font-weight:700>&gt;</span>(
</span></span><span style=display:flex><span>    fn: <span style=color:#ff7b72>T</span>,
</span></span><span style=display:flex><span>    delay: <span style=color:#ff7b72>number</span>
</span></span><span style=display:flex><span>)<span style=color:#ff7b72;font-weight:700>:</span> T {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>let</span> timeoutId: <span style=color:#ff7b72>NodeJS.Timeout</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> ((...args: <span style=color:#ff7b72>any</span>[]) <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>        clearTimeout(timeoutId);
</span></span><span style=display:flex><span>        timeoutId <span style=color:#ff7b72;font-weight:700>=</span> setTimeout(() <span style=color:#ff7b72;font-weight:700>=&gt;</span> fn(...args), delay);
</span></span><span style=display:flex><span>    }) <span style=color:#ff7b72>as</span> T;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ä½¿ç”¨ç¤ºä¾‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> debouncedCommand <span style=color:#ff7b72;font-weight:700>=</span> debounce(
</span></span><span style=display:flex><span>    (args: <span style=color:#ff7b72>string</span>[]) <span style=color:#ff7b72;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span>        vscode.window.showInformationMessage(args.join(<span style=color:#a5d6ff>&#39;, &#39;</span>));
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>300</span>
</span></span><span style=display:flex><span>);
</span></span></code></pre></td></tr></table></div></div><h2 id=10-å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ>10. å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ<a hidden class=anchor aria-hidden=true href=#10-å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ>#</a></h2><h3 id=å¸¸è§é”™è¯¯å¤„ç†>å¸¸è§é”™è¯¯å¤„ç†<a hidden class=anchor aria-hidden=true href=#å¸¸è§é”™è¯¯å¤„ç†>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// å¤„ç†æ‰©å±•æ¿€æ´»å¤±è´¥
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>export</span> <span style=color:#ff7b72>function</span> activate(context: <span style=color:#ff7b72>vscode.ExtensionContext</span>) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// æ‰©å±•åˆå§‹åŒ–é€»è¾‘
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>        initializeExtension(context);
</span></span><span style=display:flex><span>    } <span style=color:#ff7b72>catch</span> (error) {
</span></span><span style=display:flex><span>        console.error(<span style=color:#a5d6ff>&#39;Extension activation failed:&#39;</span>, error);
</span></span><span style=display:flex><span>        vscode.window.showErrorMessage(
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>`Extension activation failed: </span><span style=color:#a5d6ff>${</span>error.message<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// å®‰å…¨çš„ç±»å‹æ£€æŸ¥
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> getActiveEditor()<span style=color:#ff7b72;font-weight:700>:</span> vscode.TextEditor <span style=color:#ff7b72;font-weight:700>|</span> <span style=color:#79c0ff>undefined</span> {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> editor <span style=color:#ff7b72;font-weight:700>=</span> vscode.window.activeTextEditor;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72;font-weight:700>!</span>editor) {
</span></span><span style=display:flex><span>        vscode.window.showWarningMessage(<span style=color:#a5d6ff>&#39;No active editor&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> <span style=color:#79c0ff>undefined</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> editor;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ç‰ˆæœ¬å…¼å®¹æ€§æ£€æŸ¥
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> checkVSCodeVersion() {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> vscodeVersion <span style=color:#ff7b72;font-weight:700>=</span> vscode.version;
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> requiredVersion <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>&#39;1.75.0&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (vscode.version <span style=color:#ff7b72;font-weight:700>&lt;</span> requiredVersion) {
</span></span><span style=display:flex><span>        vscode.window.showErrorMessage(
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>`This extension requires VS Code </span><span style=color:#a5d6ff>${</span>requiredVersion<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff> or higher. `</span> <span style=color:#ff7b72;font-weight:700>+</span>
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>`Current version: </span><span style=color:#a5d6ff>${</span>vscodeVersion<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> <span style=color:#79c0ff>false</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> <span style=color:#79c0ff>true</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=æ€»ç»“>æ€»ç»“<a hidden class=anchor aria-hidden=true href=#æ€»ç»“>#</a></h2><p>VS Codeæ‰©å±•å¼€å‘ä¸ºå¼€å‘è€…æä¾›äº†å¼ºå¤§çš„å®šåˆ¶åŒ–èƒ½åŠ›ã€‚é€šè¿‡æœ¬æ–‡ä»‹ç»çš„æŠ€æœ¯å’Œæœ€ä½³å®è·µï¼Œä½ å¯ä»¥ï¼š</p><p><strong>æ ¸å¿ƒæŠ€èƒ½ï¼š</strong></p><ul><li>æŒæ¡æ‰©å±•APIçš„ä½¿ç”¨</li><li>ç†è§£æ‰©å±•ç”Ÿå‘½å‘¨æœŸç®¡ç†</li><li>å®ç°ä¸°å¯Œçš„ç¼–è¾‘å™¨åŠŸèƒ½</li></ul><p><strong>é«˜çº§ç‰¹æ€§ï¼š</strong></p><ul><li>å¼€å‘è‡ªå®šä¹‰WebView</li><li>åˆ›å»ºå¤æ‚çš„è¯­è¨€æ”¯æŒ</li><li>å®ç°é«˜æ•ˆçš„æ–‡ä»¶æ“ä½œ</li></ul><p><strong>å¼€å‘æµç¨‹ï¼š</strong></p><ul><li>å»ºç«‹å®Œæ•´çš„æµ‹è¯•ä½“ç³»</li><li>å®ç°æŒç»­é›†æˆ/éƒ¨ç½²</li><li>éµå¾ªå‘å¸ƒæœ€ä½³å®è·µ</li></ul><p>è®°ä½ï¼Œå¥½çš„æ‰©å±•åº”è¯¥è§£å†³å®é™…é—®é¢˜ã€æä¾›è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œå¹¶ä¸”ä¿æŒç¨³å®šå’Œé«˜æ•ˆã€‚å¼€å§‹ä½ çš„VS Codeæ‰©å±•å¼€å‘ä¹‹æ—…å§ï¼</p><hr></div><footer class=post-footer-modern><div class=post-tags-modern><span class=tags-label>ğŸ·ï¸ æ ‡ç­¾</span><div class=tags-list><a href=/blog/tags/vs-code/ class=tag-pill>VS Code
</a><a href=/blog/tags/%E6%89%A9%E5%B1%95%E5%BC%80%E5%8F%91/ class=tag-pill>æ‰©å±•å¼€å‘
</a><a href=/blog/tags/typescript/ class=tag-pill>TypeScript
</a><a href=/blog/tags/ide/ class=tag-pill>IDE
</a><a href=/blog/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/ class=tag-pill>å¼€å‘å·¥å…·</a></div></div><style>.post-footer-modern{margin-top:3rem;padding-top:2rem;border-top:1px solid var(--border,#333333)}.post-tags-modern{display:flex;align-items:center;gap:1rem;margin-bottom:2rem;flex-wrap:wrap}.tags-label{font-size:.875rem;font-weight:600;color:var(--secondary,#999999) !important;white-space:nowrap}.tags-list{display:flex;flex-wrap:wrap;gap:.5rem;flex:1}.tag-pill{display:inline-block;padding:.25rem .75rem;background:rgba(255,255,255,5%);border:1px solid var(--border,#333333);border-radius:0;color:var(--secondary,#cccccc) !important;text-decoration:none;font-size:.8rem;font-weight:500;transition:all .2s ease}.tag-pill:hover{background:var(--primary,#ffffff);color:var(--background,#000000) !important;border-color:var(--primary,#ffffff);transform:translateY(-1px)}.post-nav-modern{margin-top:2rem}.nav-grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.nav-card{display:flex;align-items:center;gap:1rem;padding:1.25rem;background:rgba(255,255,255,2%);border:1px solid var(--border,#333333);border-radius:12px;text-decoration:none;transition:all .2s ease;min-height:80px}.nav-card:hover{background:rgba(255,255,255,5%);border-color:var(--primary,#ffffff);transform:translateY(-2px)}.nav-card.nav-prev{justify-content:flex-start}.nav-card.nav-next{justify-content:flex-end;text-align:right}.nav-card.nav-next .nav-content{text-align:right}.nav-empty{display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,1%);border:1px dashed var(--border,#333333);color:var(--secondary,#666666)}.nav-arrow{font-size:1.5rem;color:var(--primary,#ffffff);font-weight:300}.nav-content{flex:1}.nav-title{font-size:.95rem;font-weight:600;color:var(--primary,#ffffff) !important;line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}[data-theme=light] .post-footer-modern{border-color:var(--border-light,#dee2e6)}[data-theme=light] .tags-label{color:var(--secondary-light,#6c757d) !important}[data-theme=light] .tag-pill{background:rgba(0,0,0,5%);border-color:var(--border-light,#dee2e6);color:var(--secondary-light,#495057) !important}[data-theme=light] .tag-pill:hover{background:var(--primary-light,#0066cc);color:var(--background-light,#ffffff) !important;border-color:var(--primary-light,#0066cc)}[data-theme=light] .nav-card{background:rgba(0,0,0,2%);border-color:var(--border-light,#dee2e6)}[data-theme=light] .nav-card:hover{background:rgba(0,102,204,5%);border-color:var(--primary-light,#0066cc)}[data-theme=light] .nav-empty{background:rgba(0,0,0,1%);border-color:var(--border-light,#dee2e6);color:var(--secondary-light,#6c757d)}[data-theme=light] .nav-arrow{color:var(--primary-light,#0066cc)}[data-theme=light] .nav-title{color:var(--primary-light,#212529) !important}@media(max-width:768px){.nav-grid{grid-template-columns:1fr;gap:.75rem}.nav-card{padding:1rem;min-height:70px}.nav-card.nav-next{text-align:left}.nav-card.nav-next .nav-content{text-align:left}.nav-title{font-size:.875rem}.post-tags-modern{flex-direction:column;gap:.75rem}}@media(max-width:480px){.nav-arrow{font-size:1.25rem}.nav-card{padding:.875rem}.nav-title{font-size:.8rem;-webkit-line-clamp:1}}</style><nav class=post-nav-modern><div class=nav-grid><a href=/blog/articles/web-accessibility-guide/ class="nav-card nav-prev"><div class=nav-arrow>â†</div><div class=nav-content><div class=nav-title>Webæ— éšœç¢å®Œå…¨æŒ‡å—ï¼šæ„å»ºäººäººå¯è®¿é—®çš„ç½‘ç«™</div></div></a><a href=/blog/articles/api-design-principles/ class="nav-card nav-next"><div class=nav-content><div class=nav-title>RESTful APIè®¾è®¡åŸåˆ™ï¼šæ„å»ºå¯æ‰©å±•çš„WebæœåŠ¡æ¥å£</div></div><div class=nav-arrow>â†’</div></a></div></nav></footer></main><aside class=post-sidebar><div class=sidebar-toc id=sidebar-toc><div class=toc-header><div class=toc-title>ç›®å½•</div><button class=toc-toggle id=toc-toggle aria-label="Toggle TOC">
<svg class="toc-toggle-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18M6 6l12 12"/></svg></button></div><div class=toc-content id=toc-content><ul class=toc-list><li class="toc-item toc-h2"><a href=#h2-0 class=toc-item-link><span class=toc-item-text>1. å¼€å‘ç¯å¢ƒæ­å»º</span></a></li><li class="toc-item toc-h2"><a href=#h2-1 class=toc-item-link><span class=toc-item-text>2. æ‰©å±•é…ç½®æ–‡ä»¶</span></a></li><li class="toc-item toc-h2"><a href=#h2-2 class=toc-item-link><span class=toc-item-text>3. æ‰©å±•æ ¸å¿ƒAPI</span></a></li><li class="toc-item toc-h2"><a href=#h2-3 class=toc-item-link><span class=toc-item-text>4. ç¼–è¾‘å™¨åŠŸèƒ½æ‰©å±•</span></a></li><li class="toc-item toc-h2"><a href=#h2-4 class=toc-item-link><span class=toc-item-text>5. WebViewæ‰©å±•</span></a></li><li class="toc-item toc-h2"><a href=#h2-5 class=toc-item-link><span class=toc-item-text>6. æ–‡ä»¶ç³»ç»Ÿæ“ä½œ</span></a></li><li class="toc-item toc-h2"><a href=#h2-6 class=toc-item-link><span class=toc-item-text>7. æµ‹è¯•å’Œè°ƒè¯•</span></a></li><li class="toc-item toc-h2"><a href=#h2-7 class=toc-item-link><span class=toc-item-text>8. å‘å¸ƒå’Œæ‰“åŒ…</span></a></li><li class="toc-item toc-h2"><a href=#h2-8 class=toc-item-link><span class=toc-item-text>9. æœ€ä½³å®è·µ</span></a></li><li class="toc-item toc-h2"><a href=#h2-9 class=toc-item-link><span class=toc-item-text>10. å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ</span></a></li><li class="toc-item toc-h2"><a href=#h2-10 class=toc-item-link><span class=toc-item-text>æ€»ç»“</span></a></li></ul></div></div><script>document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("sidebar-toc"),t=document.getElementById("toc-toggle"),o=document.getElementById("toc-content"),i=t?.querySelector(".toc-toggle-icon");if(!e)return;let n=!1;t&&t.addEventListener("click",function(){n=!n,n?(o.style.display="none",e.style.width="auto",i.innerHTML='<path d="M9 18l6-6-6-6"/>'):(o.style.display="block",e.style.width="200px",i.innerHTML='<path d="M18 6L6 18M6 6l12 12"/>')});const s=document.querySelector(".post-content");if(s){const e=s.querySelectorAll("h1");e.forEach((e,t)=>{e.id=`h1-${t}`});const t=s.querySelectorAll("h2");t.forEach((e,t)=>{e.id=`h2-${t}`})}const a=document.querySelectorAll(".toc-item-link");a.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const n=this.getAttribute("href").substring(1),t=document.getElementById(n);if(t){const e=document.querySelector(".post-header-main")?.offsetHeight||0,n=t.offsetTop-e-20;window.scrollTo({top:n,behavior:"smooth"})}})})})</script><style>.sidebar-toc{position:sticky;top:2rem;width:200px;background:#fff;border:1px solid #e5e7eb;border-radius:4px;overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,.1);z-index:100}.sidebar-toc.hidden{display:none}.toc-header{padding:12px 16px;border-bottom:1px solid #e5e7eb;background:#fafbfc;display:flex;align-items:center;justify-content:space-between}.toc-title{margin:0;font-size:13px;font-weight:500;color:#374151 !important;font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,sans-serif;text-transform:uppercase;letter-spacing:1px}.toc-toggle{background:0 0;border:none;cursor:pointer;padding:4px;border-radius:4px;display:flex;align-items:center;justify-content:center;transition:all .2s ease;color:#6b7280}.toc-toggle:hover{background:#e5e7eb;color:#374151}.toc-toggle-icon{transition:transform .2s ease}.toc-content{padding:12px 0}.toc-list{list-style:none;margin:0;padding:0}.toc-item{margin-bottom:4px;display:block !important;visibility:visible !important}.toc-h1,.toc-h2{display:block !important}.toc-h2{margin-left:0}.toc-item-link{display:flex;align-items:center;gap:8px;padding:8px 12px;color:#374151 !important;text-decoration:none;font-size:13px;line-height:1.4;border-radius:3px;transition:all .2s ease;font-weight:400}.toc-item-link:hover{background:#f8fafc;color:#1f2937 !important}.toc-item-link.active{background:#e0f2fe;color:#01579b !important;font-weight:500}.toc-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}.dot-red{background:#ef4444}.dot-blue{background:#2196f3}.toc-item-text{color:#1f2937 !important;font-weight:400;flex:1;display:inline !important;visibility:visible !important;opacity:1 !important;font-size:13px !important;line-height:1.4 !important}.toc-item-link .toc-item-text{color:#1f2937 !important;display:inline !important;visibility:visible !important;opacity:1 !important}.toc-item.active .dot-red{background:#d32f2f}.toc-item.active .dot-blue{background:#1976d2}[data-theme=dark] .sidebar-toc{background:#1f2937;border-color:#374151;box-shadow:0 1px 3px rgba(0,0,0,.3)}[data-theme=dark] .toc-header{background:#111827;border-color:#374151}[data-theme=dark] .toc-title{color:#f3f4f6 !important}[data-theme=dark] .toc-toggle{color:#9ca3af}[data-theme=dark] .toc-toggle:hover{background:#374151;color:#f3f4f6}[data-theme=dark] .toc-item-link{color:#e5e7eb !important}[data-theme=dark] .toc-item-link:hover{background:#374151;color:#f9fafb !important}[data-theme=dark] .toc-item-link.active{background:#0d47a1;color:#fff !important}[data-theme=dark] .toc-item-text{color:#f9fafb !important;display:inline !important;visibility:visible !important;opacity:1 !important}[data-theme=dark] .toc-item-link .toc-item-text{color:#f9fafb !important;display:inline !important;visibility:visible !important;opacity:1 !important}@media(max-width:1024px){.sidebar-toc{display:none}.post-content-wrapper{grid-template-columns:1fr !important;padding:0 1rem !important}}</style><style>.post-content-wrapper{display:grid;grid-template-columns:1fr 200px;gap:2rem;padding:0 2rem;max-width:100%}.post-content-main{min-width:0}.post-sidebar{position:sticky;top:2rem;height:fit-content;min-width:0}.post-header-main{margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid var(--border,#333333)}.post-header-main .post-title{color:var(--primary,#ffffff) !important;font-size:2.5rem;font-weight:700;line-height:1.2;margin-bottom:1rem}.post-header-main .post-description{color:var(--secondary,#cccccc) !important;font-size:1.1rem;line-height:1.6;margin-bottom:1rem}.post-header-main .post-meta{margin-bottom:0}@media(max-width:1024px){.post-content-wrapper{grid-template-columns:1fr !important;gap:1rem;padding:0 1rem !important}.post-sidebar{display:none}}@media(max-width:768px){.post-header-main .post-title{font-size:2rem}.post-header-main .post-description{font-size:1rem}}</style></aside></div></article></main><footer class=footer><span>Â© 2024-2025 æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢</span> Â·</footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>