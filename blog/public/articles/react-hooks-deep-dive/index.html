<!doctype html><html lang=zh-cn dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>React Hooksæ·±åº¦è§£æï¼šåŸç†ã€æœ€ä½³å®è·µå’Œæ€§èƒ½ä¼˜åŒ– | æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·</title><meta name=keywords content="React Hooks,HooksåŸç†,è‡ªå®šä¹‰Hooks,Reactæ€§èƒ½ä¼˜åŒ–,Reactæœ€ä½³å®è·µ"><meta name=description content="React Hooksæ·±åº¦è§£ææ–‡ç« ï¼Œè¯¦ç»†è®²è§£HooksåŸç†ã€è‡ªå®šä¹‰Hookså¼€å‘ã€æ€§èƒ½ä¼˜åŒ–æŠ€å·§ã€å¸¸è§é™·é˜±åŠæœ€ä½³å®è·µï¼Œæ˜¯Reactå¼€å‘è€…å¿…è¯»æŒ‡å—"><meta name=author content="æœ‰æ¡å·¥å…·å›¢é˜Ÿ"><link rel=canonical href=/blog/articles/react-hooks-deep-dive/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.7e8505b7cdf8bb22ab2305e53c2700bb06c7e64faeb72cd3468823a9a3bd3d6e.css integrity="sha256-foUFt834uyKrIwXlPCcAuwbH5k+utyzTRogjqaO9PW4=" rel="preload stylesheet" as=style><link rel=icon href=/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/blog/favicon-32x32.png><link rel=apple-touch-icon href=/blog/apple-touch-icon.png><link rel=mask-icon href=/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=/blog/articles/react-hooks-deep-dive/feed.xml title=rss><link rel=alternate hreflang=zh-cn href=/blog/articles/react-hooks-deep-dive/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><script src=/js/external-link-config.js></script><script src=/js/external-link-interceptor.js></script><link rel=stylesheet href=/blog/css/custom.css media=screen><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«","url":"https://www.util.cn/blog/","description":"æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚æä¾›JSONæ ¼å¼åŒ–ã€SQLä¼˜åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰åœ¨çº¿å·¥å…·çš„è¯¦ç»†ä½¿ç”¨æŒ‡å—ï¼Œå¸®åŠ©å¼€å‘è€…æå‡å·¥ä½œæ•ˆç‡ã€‚","publisher":{"@type":"Organization","name":"æœ‰æ¡å·¥å…·","url":"https://www.util.cn","logo":{"@type":"ImageObject","url":"https://www.util.cn/blog/logo/logo-256.png","width":256,"height":256}},"potentialAction":[{"@type":"SearchAction","target":"https://www.util.cn/blog/search?q={search_term_string}","query-input":"required name=search_term_string"}]}</script><meta property="og:type" content="website"><meta property="og:title" content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«"><meta property="og:description" content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚æä¾›JSONæ ¼å¼åŒ–ã€SQLä¼˜åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰åœ¨çº¿å·¥å…·çš„è¯¦ç»†ä½¿ç”¨æŒ‡å—ï¼Œå¸®åŠ©å¼€å‘è€…æå‡å·¥ä½œæ•ˆç‡ã€‚"><meta property="og:url" content="https://www.util.cn/blog/"><meta property="og:site_name" content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢"><meta property="og:image" content="https://www.util.cn/blog/logo/logo-256.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«"><meta name=twitter:description content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚"><meta name=twitter:image content="https://www.util.cn/blog/logo/logo-256.png"><meta name=baidu-site-verification content><meta name=category content="æŠ€æœ¯åšå®¢,å¼€å‘è€…å·¥å…·,ç¼–ç¨‹æ•™ç¨‹"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=rating content="General"><script id=51la_code async crossorigin=anonymous src="https://sdk.51.la/js-sdk-pro.min.js?id=3OM52V0xJAPv6ozF&hash=pro"></script><script>window.addEventListener("load",function(){setTimeout(function(){typeof la!="undefined"?console.log("51laç»Ÿè®¡å·²åŠ è½½"):(console.warn("51laç»Ÿè®¡åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ"),function(){var e=document.createElement("script");e.src="https://sdk.51.la/js-sdk-pro.min.js?id=3OM52V0xJAPv6ozF&hash=backup",e.async=!0,document.head.appendChild(e)}())},3e3)})</script><meta property="og:url" content="/blog/articles/react-hooks-deep-dive/"><meta property="og:site_name" content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·"><meta property="og:title" content="React Hooksæ·±åº¦è§£æï¼šåŸç†ã€æœ€ä½³å®è·µå’Œæ€§èƒ½ä¼˜åŒ–"><meta property="og:description" content="React Hooksæ·±åº¦è§£ææ–‡ç« ï¼Œè¯¦ç»†è®²è§£HooksåŸç†ã€è‡ªå®šä¹‰Hookså¼€å‘ã€æ€§èƒ½ä¼˜åŒ–æŠ€å·§ã€å¸¸è§é™·é˜±åŠæœ€ä½³å®è·µï¼Œæ˜¯Reactå¼€å‘è€…å¿…è¯»æŒ‡å—"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-18T17:00:00+08:00"><meta property="article:modified_time" content="2025-12-18T17:00:00+08:00"><meta property="article:tag" content="React"><meta property="article:tag" content="Hooks"><meta property="article:tag" content="å‰ç«¯å¼€å‘"><meta property="article:tag" content="JavaScript"><meta property="article:tag" content="çŠ¶æ€ç®¡ç†"><meta name=twitter:card content="summary"><meta name=twitter:title content="React Hooksæ·±åº¦è§£æï¼šåŸç†ã€æœ€ä½³å®è·µå’Œæ€§èƒ½ä¼˜åŒ–"><meta name=twitter:description content="React Hooksæ·±åº¦è§£ææ–‡ç« ï¼Œè¯¦ç»†è®²è§£HooksåŸç†ã€è‡ªå®šä¹‰Hookså¼€å‘ã€æ€§èƒ½ä¼˜åŒ–æŠ€å·§ã€å¸¸è§é™·é˜±åŠæœ€ä½³å®è·µï¼Œæ˜¯Reactå¼€å‘è€…å¿…è¯»æŒ‡å—"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"æ‰€æœ‰æ–‡ç« ","item":"/blog/posts/"},{"@type":"ListItem","position":2,"name":"React Hooksæ·±åº¦è§£æï¼šåŸç†ã€æœ€ä½³å®è·µå’Œæ€§èƒ½ä¼˜åŒ–","item":"/blog/articles/react-hooks-deep-dive/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"React Hooksæ·±åº¦è§£æï¼šåŸç†ã€æœ€ä½³å®è·µå’Œæ€§èƒ½ä¼˜åŒ–","name":"React Hooksæ·±åº¦è§£æï¼šåŸç†ã€æœ€ä½³å®è·µå’Œæ€§èƒ½ä¼˜åŒ–","description":"React Hooksæ·±åº¦è§£ææ–‡ç« ï¼Œè¯¦ç»†è®²è§£HooksåŸç†ã€è‡ªå®šä¹‰Hookså¼€å‘ã€æ€§èƒ½ä¼˜åŒ–æŠ€å·§ã€å¸¸è§é™·é˜±åŠæœ€ä½³å®è·µï¼Œæ˜¯Reactå¼€å‘è€…å¿…è¯»æŒ‡å—","keywords":["React Hooks","HooksåŸç†","è‡ªå®šä¹‰Hooks","Reactæ€§èƒ½ä¼˜åŒ–","Reactæœ€ä½³å®è·µ"],"articleBody":"React Hookså½»åº•æ”¹å˜äº†æˆ‘ä»¬ç¼–å†™Reactç»„ä»¶çš„æ–¹å¼ï¼Œè®©å‡½æ•°ç»„ä»¶æ‹¥æœ‰äº†ç±»ç»„ä»¶çš„æ‰€æœ‰èƒ½åŠ›ï¼ŒåŒæ—¶è¿˜å¸¦æ¥äº†æ›´ç®€æ´çš„ä»£ç ç»„ç»‡æ–¹å¼å’Œæ›´å¥½çš„é€»è¾‘å¤ç”¨ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨Hooksçš„å†…éƒ¨åŸç†ã€æœ€ä½³å®è·µå’Œæ€§èƒ½ä¼˜åŒ–ç­–ç•¥ã€‚\nHooksåŸºç¡€å›é¡¾ åŸºæœ¬Hooksç±»å‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 import { useState, useEffect, useContext, useReducer, useCallback, useMemo, useRef, useLayoutEffect, useImperativeHandle } from 'react' // useState - çŠ¶æ€ç®¡ç† const [count, setCount] = useState(0) // useEffect - å‰¯ä½œç”¨å¤„ç† useEffect(() =\u003e { document.title = `Count: ${count}` return () =\u003e { // æ¸…ç†å‡½æ•° } }, [count]) // useContext - Contextæ¶ˆè´¹ const theme = useContext(ThemeContext) // useReducer - å¤æ‚çŠ¶æ€ç®¡ç† const [state, dispatch] = useReducer(reducer, initialState) // useCallback - å‡½æ•°ç¼“å­˜ const handleClick = useCallback(() =\u003e { setCount(count + 1) }, [count]) // useMemo - å€¼ç¼“å­˜ const expensiveValue = useMemo(() =\u003e { return computeExpensiveValue(count) }, [count]) // useRef - å¼•ç”¨ç®¡ç† const inputRef = useRef(null) // useLayoutEffect - åŒæ­¥å‰¯ä½œç”¨ useLayoutEffect(() =\u003e { // åœ¨DOMæ›´æ–°ååŒæ­¥æ‰§è¡Œ }) // useImperativeHandle - æš´éœ²å®ä¾‹æ–¹æ³• useImperativeHandle(ref, () =\u003e ({ focus: () =\u003e inputRef.current.focus() }), []) Hookså†…éƒ¨åŸç† 1. Hooksçš„æ•°æ®ç»“æ„ Reactä½¿ç”¨é“¾è¡¨æ¥å­˜å‚¨Hooksçš„çŠ¶æ€ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 // ç®€åŒ–çš„Hookså†…éƒ¨å®ç° let currentlyRenderingComponent = null let workInProgressHook = null let currentHook = null // HookèŠ‚ç‚¹ç»“æ„ const hook = { memoizedState: null, // Hookçš„å½“å‰çŠ¶æ€ baseState: null, // åŸºç¡€çŠ¶æ€ baseQueue: null, // åŸºç¡€æ›´æ–°é˜Ÿåˆ— queue: null, // æ›´æ–°é˜Ÿåˆ— next: null // ä¸‹ä¸€ä¸ªHook } // Hookåˆå§‹åŒ– function mountWorkInProgressHook() { const hook = { memoizedState: null, baseState: null, baseQueue: null, queue: null, next: null } if (workInProgressHook === null) { currentlyRenderingComponent.memoizedState = workInProgressHook = hook } else { workInProgressHook = workInProgressHook.next = hook } return workInProgressHook } // Hookæ›´æ–° function updateWorkInProgressHook() { let nextCurrentHook if (currentHook === null) { const current = currentlyRenderingComponent.alternate.memoizedState nextCurrentHook = current.next } else { nextCurrentHook = currentHook.next } let nextWorkInProgressHook if (workInProgressHook === null) { nextWorkInProgressHook = currentlyRenderingComponent.memoizedState } else { nextWorkInProgressHook = workInProgressHook.next } if (nextWorkInProgressHook !== null) { workInProgressHook = nextWorkInProgressHook nextWorkInProgressHook = createHook(nextCurrentHook) } else { // æ²¡æœ‰å¯¹åº”çš„Hookï¼Œå¯èƒ½æ˜¯æ–°å¢çš„Hook workInProgressHook = createHook(null) } currentHook = nextCurrentHook return workInProgressHook } 2. useStateçš„å®ç°åŸç† 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 // useStateçš„ç®€åŒ–å®ç° function useState(initialState) { return useReducer( (state, action) =\u003e { return typeof action === 'function' ? action(state) : action }, typeof initialState === 'function' ? initialState() : initialState ) } // useReducerçš„ç®€åŒ–å®ç° function useReducer(reducer, initialState, init) { const hook = updateWorkInProgressHook() const queue = hook.queue // æ‰§è¡Œæ›´æ–°é˜Ÿåˆ— if (numberOfLanes \u003e 1) { return hook.memoizedState } if (queue !== null) { let newState = hook.baseState let update = queue.first let didSkip = false while (update !== null) { const action = update.action if (shouldSkipUpdate(update.lane)) { didSkip = true } else { newState = reducer(newState, action) } update = update.next } if (!didSkip) { hook.baseState = newState hook.baseQueue = null } hook.memoizedState = newState } const dispatch = dispatchAction.bind(null, currentlyRenderingComponent, queue) return [hook.memoizedState, dispatch] } function dispatchAction(component, queue, action) { const update = { lane, action, next: null } const pending = queue.pending if (pending === null) { update.next = update } else { update.next = pending.next pending.next = update } queue.pending = update scheduleUpdateOnFiber(component, lane) } 3. useEffectçš„å®ç°åŸç† 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 function useEffect(create, deps) { return mountEffectImpl( UpdateEffect | PassEffect, HookPassive, create, deps ) } function mountEffectImpl(fiberFlags, hookFlags, create, deps) { const hook = mountWorkInProgressHook() const nextDeps = deps === undefined ? null : deps currentlyRenderingComponent.flags |= fiberFlags hook.memoizedState = pushEffect(HookHasEffect | hookFlags, create, undefined, nextDeps) } function pushEffect(tag, create, destroy, deps) { const effect = { tag, create, destroy, deps, next: null } let componentUpdateQueue = currentlyRenderingComponent.updateQueue if (componentUpdateQueue === null) { componentUpdateQueue = createFunctionComponentUpdateQueue() currentlyRenderingComponent.updateQueue = componentUpdateQueue componentUpdateQueue.lastEffect = effect.next = effect } else { const lastEffect = componentUpdateQueue.lastEffect if (lastEffect === null) { componentUpdateQueue.lastEffect = effect.next = effect } else { const firstEffect = lastEffect.next lastEffect.next = effect effect.next = firstEffect componentUpdateQueue.lastEffect = effect } } return effect } è‡ªå®šä¹‰Hookså¼€å‘ 1. åŸºç¡€è‡ªå®šä¹‰Hook 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 // useCounter - è®¡æ•°å™¨Hook function useCounter(initialValue = 0, step = 1) { const [count, setCount] = useState(initialValue) const increment = useCallback(() =\u003e { setCount(prevCount =\u003e prevCount + step) }, [step]) const decrement = useCallback(() =\u003e { setCount(prevCount =\u003e prevCount - step) }, [step]) const reset = useCallback(() =\u003e { setCount(initialValue) }, [initialValue]) return { count, increment, decrement, reset } } // ä½¿ç”¨ç¤ºä¾‹ function Counter() { const { count, increment, decrement, reset } = useCounter(0, 2) return ( \u003cdiv\u003e \u003cp\u003eCount: {count}\u003c/p\u003e \u003cbutton onClick={increment}\u003e+2\u003c/button\u003e \u003cbutton onClick={decrement}\u003e-2\u003c/button\u003e \u003cbutton onClick={reset}\u003eReset\u003c/button\u003e \u003c/div\u003e ) } 2. å¤æ‚ä¸šåŠ¡é€»è¾‘Hook 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 // useApi - APIè¯·æ±‚Hook function useApi(url, options = {}) { const [data, setData] = useState(null) const [loading, setLoading] = useState(true) const [error, setError] = useState(null) const fetchData = useCallback(async () =\u003e { try { setLoading(true) setError(null) const response = await fetch(url, options) if (!response.ok) { throw new Error(`HTTP error! status: ${response.status}`) } const result = await response.json() setData(result) } catch (err) { setError(err.message) } finally { setLoading(false) } }, [url, options]) useEffect(() =\u003e { fetchData() }, [fetchData]) const refetch = useCallback(() =\u003e { fetchData() }, [fetchData]) return { data, loading, error, refetch } } // ä½¿ç”¨ç¤ºä¾‹ function UserProfile({ userId }) { const { data: user, loading, error, refetch } = useApi(`/api/users/${userId}`) if (loading) return \u003cdiv\u003eLoading...\u003c/div\u003e if (error) return \u003cdiv\u003eError: {error}\u003c/div\u003e if (!user) return \u003cdiv\u003eNo user found\u003c/div\u003e return ( \u003cdiv\u003e \u003ch1\u003e{user.name}\u003c/h1\u003e \u003cp\u003e{user.email}\u003c/p\u003e \u003cbutton onClick={refetch}\u003eRefresh\u003c/button\u003e \u003c/div\u003e ) } 3. localStorageåŒæ­¥Hook 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 // useLocalStorage - localStorageåŒæ­¥Hook function useLocalStorage(key, initialValue) { // è·å–åˆå§‹å€¼ const [storedValue, setStoredValue] = useState(() =\u003e { try { const item = window.localStorage.getItem(key) return item ? JSON.parse(item) : initialValue } catch (error) { console.error(`Error reading localStorage key \"${key}\":`, error) return initialValue } }) // è®¾ç½®å€¼åˆ°localStorageå’Œstate const setValue = useCallback((value) =\u003e { try { const valueToStore = value instanceof Function ? value(storedValue) : value setStoredValue(valueToStore) window.localStorage.setItem(key, JSON.stringify(valueToStore)) } catch (error) { console.error(`Error setting localStorage key \"${key}\":`, error) } }, [key, storedValue]) // ç›‘å¬å…¶ä»–tabçš„å˜åŒ– useEffect(() =\u003e { const handleStorageChange = (e) =\u003e { if (e.key === key) { try { setStoredValue(JSON.parse(e.newValue)) } catch (error) { console.error(`Error parsing storage value for key \"${key}\":`, error) } } } window.addEventListener('storage', handleStorageChange) return () =\u003e window.removeEventListener('storage', handleStorageChange) }, [key]) return [storedValue, setValue] } // ä½¿ç”¨ç¤ºä¾‹ function Settings() { const [theme, setTheme] = useLocalStorage('theme', 'light') const [language, setLanguage] = useLocalStorage('language', 'en') return ( \u003cdiv\u003e \u003cselect value={theme} onChange={(e) =\u003e setTheme(e.target.value)}\u003e \u003coption value=\"light\"\u003eLight\u003c/option\u003e \u003coption value=\"dark\"\u003eDark\u003c/option\u003e \u003c/select\u003e \u003cselect value={language} onChange={(e) =\u003e setLanguage(e.target.value)}\u003e \u003coption value=\"en\"\u003eEnglish\u003c/option\u003e \u003coption value=\"zh\"\u003eä¸­æ–‡\u003c/option\u003e \u003c/select\u003e \u003c/div\u003e ) } 4. é˜²æŠ–Hook 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 // useDebounce - é˜²æŠ–Hook function useDebounce(value, delay) { const [debouncedValue, setDebouncedValue] = useState(value) useEffect(() =\u003e { const handler = setTimeout(() =\u003e { setDebouncedValue(value) }, delay) return () =\u003e { clearTimeout(handler) } }, [value, delay]) return debouncedValue } // useDebouncedCallback - é˜²æŠ–å›è°ƒHook function useDebouncedCallback(callback, delay, deps = []) { const callbackRef = useRef(callback) const timeoutRef = useRef(null) useEffect(() =\u003e { callbackRef.current = callback }, [callback]) return useCallback((...args) =\u003e { if (timeoutRef.current) { clearTimeout(timeoutRef.current) } timeoutRef.current = setTimeout(() =\u003e { callbackRef.current(...args) }, delay) }, [delay, ...deps]) } // ä½¿ç”¨ç¤ºä¾‹ function SearchInput() { const [searchTerm, setSearchTerm] = useState('') const debouncedSearchTerm = useDebounce(searchTerm, 500) const handleSearch = useDebouncedCallback((term) =\u003e { // æ‰§è¡Œæœç´¢APIè°ƒç”¨ console.log('Searching for:', term) }, 500) useEffect(() =\u003e { if (debouncedSearchTerm) { handleSearch(debouncedSearchTerm) } }, [debouncedSearchTerm, handleSearch]) return ( \u003cinput type=\"text\" value={searchTerm} onChange={(e) =\u003e setSearchTerm(e.target.value)} placeholder=\"Search...\" /\u003e ) } æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ 1. useCallbackå’ŒuseMemoçš„æ­£ç¡®ä½¿ç”¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 // âŒ è¿‡åº¦ä½¿ç”¨useCallback function BadExample({ items, onItemClick }) { const handleClick = useCallback((item) =\u003e { onItemClick(item.id) }, [onItemClick]) // æ¯æ¬¡onItemClickå˜åŒ–éƒ½åˆ›å»ºæ–°å‡½æ•° return ( \u003cul\u003e {items.map(item =\u003e ( \u003cli key={item.id} onClick={() =\u003e handleClick(item)}\u003e {item.name} \u003c/li\u003e ))} \u003c/ul\u003e ) } // âœ… åˆç†ä½¿ç”¨useCallback function GoodExample({ items, onItemClick }) { const handleClick = useCallback((itemId) =\u003e { onItemClick(itemId) }, [onItemClick]) return ( \u003cul\u003e {items.map(item =\u003e ( \u003cItem key={item.id} item={item} onClick={handleClick} /\u003e ))} \u003c/ul\u003e ) } // å­ç»„ä»¶ const Item = React.memo(({ item, onClick }) =\u003e ( \u003cli onClick={() =\u003e onClick(item.id)}\u003e {item.name} \u003c/li\u003e )) 2. çŠ¶æ€ä¼˜åŒ–ç­–ç•¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 // âŒ ä¸å¿…è¦çš„çŠ¶æ€åˆ†ç¦» function BadCounter() { const [count, setCount] = useState(0) const [double, setDouble] = useState(0) useEffect(() =\u003e { setDouble(count * 2) }, [count]) return ( \u003cdiv\u003e \u003cp\u003eCount: {count}\u003c/p\u003e \u003cp\u003eDouble: {double}\u003c/p\u003e \u003c/div\u003e ) } // âœ… ä½¿ç”¨æ´¾ç”ŸçŠ¶æ€ function GoodCounter() { const [count, setCount] = useState(0) const double = useMemo(() =\u003e count * 2, [count]) return ( \u003cdiv\u003e \u003cp\u003eCount: {count}\u003c/p\u003e \u003cp\u003eDouble: {double}\u003c/p\u003e \u003c/div\u003e ) } // âœ… å¤æ‚çŠ¶æ€çš„ä¼˜åŒ– function useComplexState(initialState) { const [state, setState] = useState(initialState) const updateState = useCallback((updater) =\u003e { setState(prevState =\u003e { const newState = typeof updater === 'function' ? updater(prevState) : updater return { ...prevState, ...newState } }) }, []) return [state, updateState] } 3. ç»„ä»¶æ¸²æŸ“ä¼˜åŒ– 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 // âœ… ä½¿ç”¨React.memoä¼˜åŒ–å‡½æ•°ç»„ä»¶ const ExpensiveComponent = React.memo(({ data, onUpdate }) =\u003e { return ( \u003cdiv\u003e {data.map(item =\u003e ( \u003cdiv key={item.id}\u003e{item.name}\u003c/div\u003e ))} \u003c/div\u003e ) }, (prevProps, nextProps) =\u003e { // è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•° return prevProps.data.length === nextProps.data.length }) // âœ… ä½¿ç”¨useMemoç¼“å­˜å¤æ‚è®¡ç®— function DataProcessor({ items }) { const processedData = useMemo(() =\u003e { return items .filter(item =\u003e item.active) .map(item =\u003e ({ ...item, value: complexCalculation(item) })) .sort((a, b) =\u003e a.value - b.value) }, [items]) return \u003cDataList data={processedData} /\u003e } // âœ… ä½¿ç”¨useRefé¿å…ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“ function Timer() { const [count, setCount] = useState(0) const intervalRef = useRef(null) useEffect(() =\u003e { intervalRef.current = setInterval(() =\u003e { setCount(c =\u003e c + 1) }, 1000) return () =\u003e { if (intervalRef.current) { clearInterval(intervalRef.current) } } }, []) return \u003cdiv\u003eCount: {count}\u003c/div\u003e } å¸¸è§é™·é˜±å’Œè§£å†³æ–¹æ¡ˆ 1. Hooksè°ƒç”¨è§„åˆ™ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 // âŒ åœ¨æ¡ä»¶è¯­å¥ä¸­è°ƒç”¨Hook function BadComponent({ condition }) { if (condition) { const [state, setState] = useState(0) // é”™è¯¯ï¼ } useEffect(() =\u003e { // ... }, []) // é”™è¯¯ï¼Hookè°ƒç”¨é¡ºåºä¸ç¨³å®š return \u003cdiv\u003eBad Component\u003c/div\u003e } // âœ… æ­£ç¡®çš„Hookè°ƒç”¨ function GoodComponent({ condition }) { const [state, setState] = useState(0) useEffect(() =\u003e { if (condition) { // åœ¨effectå†…éƒ¨ä½¿ç”¨æ¡ä»¶é€»è¾‘ console.log('Condition is true') } }, [condition]) return \u003cdiv\u003eGood Component\u003c/div\u003e } 2. é—­åŒ…é™·é˜± 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 // âŒ é—­åŒ…é™·é˜± function CounterWithBug() { const [count, setCount] = useState(0) useEffect(() =\u003e { const interval = setInterval(() =\u003e { setCount(count + 1) // æ€»æ˜¯ä»0å¼€å§‹ }, 1000) return () =\u003e clearInterval(interval) }, [count]) // æ¯æ¬¡countå˜åŒ–éƒ½é‡æ–°åˆ›å»ºinterval return \u003cdiv\u003eCount: {count}\u003c/div\u003e } // âœ… ä½¿ç”¨å‡½æ•°å¼æ›´æ–° function CounterWithFix() { const [count, setCount] = useState(0) useEffect(() =\u003e { const interval = setInterval(() =\u003e { setCount(prevCount =\u003e prevCount + 1) // ä½¿ç”¨å‡½æ•°å¼æ›´æ–° }, 1000) return () =\u003e clearInterval(interval) }, []) // åªåœ¨ç»„ä»¶æŒ‚è½½æ—¶åˆ›å»ºä¸€æ¬¡ return \u003cdiv\u003eCount: {count}\u003c/div\u003e } // âœ… ä½¿ç”¨useRefå­˜å‚¨å¯å˜å€¼ function CounterWithRef() { const [count, setCount] = useState(0) const countRef = useRef(count) useEffect(() =\u003e { countRef.current = count }) useEffect(() =\u003e { const interval = setInterval(() =\u003e { setCount(countRef.current + 1) }, 1000) return () =\u003e clearInterval(interval) }, []) return \u003cdiv\u003eCount: {count}\u003c/div\u003e } 3. ä¾èµ–æ•°ç»„é™·é˜± 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 // âŒ ç¼ºå°‘ä¾èµ–é¡¹ function BadExample({ id }) { const [data, setData] = useState(null) useEffect(() =\u003e { fetchData(id).then(setData) }, []) // ç¼ºå°‘idä¾èµ–ï¼Œå½“idå˜åŒ–æ—¶ä¸ä¼šé‡æ–°è·å–æ•°æ® return \u003cdiv\u003e{data?.name}\u003c/div\u003e } // âœ… æ­£ç¡®çš„ä¾èµ–é¡¹ function GoodExample({ id }) { const [data, setData] = useState(null) useEffect(() =\u003e { fetchData(id).then(setData) }, [id]) // åŒ…å«æ‰€æœ‰å¤–éƒ¨ä¾èµ– return \u003cdiv\u003e{data?.name}\u003c/div\u003e } // âœ… ä½¿ç”¨è‡ªå®šä¹‰Hookç®¡ç†å¤æ‚ä¾èµ– function useApiData(url, dependencies = []) { const [data, setData] = useState(null) const [loading, setLoading] = useState(true) useEffect(() =\u003e { let isMounted = true setLoading(true) fetch(url) .then(response =\u003e response.json()) .then(result =\u003e { if (isMounted) { setData(result) } }) .catch(error =\u003e { if (isMounted) { console.error('API Error:', error) } }) .finally(() =\u003e { if (isMounted) { setLoading(false) } }) return () =\u003e { isMounted = false } }, [url, ...dependencies]) return { data, loading } } é«˜çº§Hooksæ¨¡å¼ 1. çŠ¶æ€æœºHook 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 // useStateMachine - çŠ¶æ€æœºHook function useStateMachine(initialState, transitions) { const [currentState, setCurrentState] = useState(initialState) const [context, setContext] = useState({}) const transition = useCallback((action, payload) =\u003e { setCurrentState(prevState =\u003e { const stateConfig = transitions[prevState] if (!stateConfig || !stateConfig.on || !stateConfig.on[action]) { console.warn(`No transition defined for action ${action} in state ${prevState}`) return prevState } const transitionConfig = stateConfig.on[action] const nextState = typeof transitionConfig.target === 'function' ? transitionConfig.target(prevState, payload) : transitionConfig.target if (transitionConfig.action) { transitionConfig.action(prevState, payload, context) } return nextState }) }, [transitions, context]) const can = useCallback((action) =\u003e { const stateConfig = transitions[currentState] return stateConfig \u0026\u0026 stateConfig.on \u0026\u0026 stateConfig.on[action] }, [currentState, transitions]) return { currentState, transition, can, context, setContext } } // ä½¿ç”¨ç¤ºä¾‹ - ç™»å½•çŠ¶æ€æœº const loginMachine = { idle: { on: { login: { target: 'loading', action: (state, payload) =\u003e ({ ...state, username: payload.username }) } } }, loading: { on: { success: 'authenticated', error: 'error' } }, authenticated: { on: { logout: 'idle' } }, error: { on: { retry: 'loading', cancel: 'idle' } } } function LoginComponent() { const { currentState, transition, can } = useStateMachine('idle', loginMachine) const handleLogin = async (username, password) =\u003e { transition('login', { username }) try { await performLogin(username, password) transition('success') } catch (error) { transition('error', { error: error.message }) } } return ( \u003cdiv\u003e \u003cp\u003eCurrent state: {currentState}\u003c/p\u003e {currentState === 'idle' \u0026\u0026 ( \u003cbutton onClick={() =\u003e handleLogin('user', 'pass')}\u003eLogin\u003c/button\u003e )} {currentState === 'loading' \u0026\u0026 \u003cp\u003eLoading...\u003c/p\u003e} {currentState === 'authenticated' \u0026\u0026 ( \u003cdiv\u003e \u003cp\u003eAuthenticated!\u003c/p\u003e \u003cbutton onClick={() =\u003e transition('logout')}\u003eLogout\u003c/button\u003e \u003c/div\u003e )} {currentState === 'error' \u0026\u0026 ( \u003cdiv\u003e \u003cp\u003eError occurred\u003c/p\u003e \u003cbutton onClick={() =\u003e transition('retry')}\u003eRetry\u003c/button\u003e \u003cbutton onClick={() =\u003e transition('cancel')}\u003eCancel\u003c/button\u003e \u003c/div\u003e )} \u003c/div\u003e ) } 2. è™šæ‹Ÿåˆ—è¡¨Hook 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 // useVirtualList - è™šæ‹Ÿåˆ—è¡¨Hook function useVirtualList(items, itemHeight, containerHeight) { const [scrollTop, setScrollTop] = useState(0) const visibleStart = Math.floor(scrollTop / itemHeight) const visibleEnd = Math.min( visibleStart + Math.ceil(containerHeight / itemHeight) + 1, items.length ) const visibleItems = useMemo(() =\u003e { return items.slice(visibleStart, visibleEnd).map((item, index) =\u003e ({ ...item, index: visibleStart + index })) }, [items, visibleStart, visibleEnd]) const totalHeight = items.length * itemHeight const offsetY = visibleStart * itemHeight const handleScroll = useCallback((e) =\u003e { setScrollTop(e.target.scrollTop) }, []) return { visibleItems, totalHeight, offsetY, handleScroll } } // ä½¿ç”¨ç¤ºä¾‹ function VirtualList({ items, itemHeight = 50, containerHeight = 400 }) { const { visibleItems, totalHeight, offsetY, handleScroll } = useVirtualList(items, itemHeight, containerHeight) return ( \u003cdiv style={{ height: containerHeight, overflow: 'auto' }} onScroll={handleScroll}\u003e \u003cdiv style={{ height: totalHeight, position: 'relative' }}\u003e \u003cdiv style={{ transform: `translateY(${offsetY}px)` }}\u003e {visibleItems.map((item, index) =\u003e ( \u003cdiv key={item.id} style={{ height: itemHeight, borderBottom: '1px solid #eee', display: 'flex', alignItems: 'center', padding: '0 16px', background: index % 2 === 0 ? '#f9f9f9' : 'white' }} \u003e {item.name} \u003c/div\u003e ))} \u003c/div\u003e \u003c/div\u003e \u003c/div\u003e ) } 3. è¡¨å•ç®¡ç†Hook 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 // useForm - è¡¨å•ç®¡ç†Hook function useForm(initialValues, validationSchema = {}) { const [values, setValues] = useState(initialValues) const [errors, setErrors] = useState({}) const [touched, setTouched] = useState({}) const setValue = useCallback((name, value) =\u003e { setValues(prev =\u003e ({ ...prev, [name]: value })) }, []) const setError = useCallback((name, error) =\u003e { setErrors(prev =\u003e ({ ...prev, [name]: error })) }, []) const setTouched = useCallback((name, isTouched = true) =\u003e { setTouched(prev =\u003e ({ ...prev, [name]: isTouched })) }, []) const handleChange = useCallback((e) =\u003e { const { name, value, type, checked } = e.target const fieldValue = type === 'checkbox' ? checked : value setValue(name, fieldValue) if (touched[name]) { validateField(name, fieldValue) } }, [setValue, touched, validationSchema]) const validateField = useCallback((name, value) =\u003e { if (!validationSchema[name]) { setError(name, '') return true } const validator = validationSchema[name] const result = validator(value) if (typeof result === 'string') { setError(name, result) return false } else if (result === false) { setError(name, 'Invalid field') return false } else { setError(name, '') return true } }, [validationSchema, setError]) const handleBlur = useCallback((e) =\u003e { const { name, value } = e.target setTouched(name, true) validateField(name, value) }, [setTouched, validateField]) const validate = useCallback(() =\u003e { let isValid = true const newErrors = {} Object.keys(validationSchema).forEach(name =\u003e { if (!validateField(name, values[name])) { isValid = false newErrors[name] = errors[name] } }) setErrors(newErrors) return isValid }, [validationSchema, values, errors, validateField]) const reset = useCallback(() =\u003e { setValues(initialValues) setErrors({}) setTouched({}) }, [initialValues]) return { values, errors, touched, setValue, setError, setTouched, handleChange, handleBlur, validate, reset, isValid: Object.keys(errors).every(key =\u003e !errors[key]) } } // ä½¿ç”¨ç¤ºä¾‹ function LoginForm() { const validationSchema = { email: (value) =\u003e { if (!value) return 'Email is required' if (!/\\S+@\\S+\\.\\S+/.test(value)) return 'Email is invalid' return true }, password: (value) =\u003e { if (!value) return 'Password is required' if (value.length \u003c 6) return 'Password must be at least 6 characters' return true } } const { values, errors, touched, handleChange, handleBlur, validate, reset, isValid } = useForm( { email: '', password: '' }, validationSchema ) const handleSubmit = (e) =\u003e { e.preventDefault() if (validate()) { console.log('Form submitted:', values) } } return ( \u003cform onSubmit={handleSubmit}\u003e \u003cdiv\u003e \u003clabel\u003eEmail:\u003c/label\u003e \u003cinput type=\"email\" name=\"email\" value={values.email} onChange={handleChange} onBlur={handleBlur} /\u003e {touched.email \u0026\u0026 errors.email \u0026\u0026 ( \u003cspan style={{ color: 'red' }}\u003e{errors.email}\u003c/span\u003e )} \u003c/div\u003e \u003cdiv\u003e \u003clabel\u003ePassword:\u003c/label\u003e \u003cinput type=\"password\" name=\"password\" value={values.password} onChange={handleChange} onBlur={handleBlur} /\u003e {touched.password \u0026\u0026 errors.password \u0026\u0026 ( \u003cspan style={{ color: 'red' }}\u003e{errors.password}\u003c/span\u003e )} \u003c/div\u003e \u003cbutton type=\"submit\" disabled={!isValid}\u003e Submit \u003c/button\u003e \u003cbutton type=\"button\" onClick={reset}\u003e Reset \u003c/button\u003e \u003c/form\u003e ) } Hooksæµ‹è¯•ç­–ç•¥ 1. æµ‹è¯•è‡ªå®šä¹‰Hooks 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 // ä½¿ç”¨ @testing-library/react-hooks import { renderHook, act } from '@testing-library/react-hooks' // æµ‹è¯•useCounter Hook import { useCounter } from './useCounter' describe('useCounter', () =\u003e { test('should initialize with default value', () =\u003e { const { result } = renderHook(() =\u003e useCounter()) expect(result.current.count).toBe(0) expect(typeof result.current.increment).toBe('function') expect(typeof result.current.decrement).toBe('function') expect(typeof result.current.reset).toBe('function') }) test('should initialize with custom value', () =\u003e { const { result } = renderHook(() =\u003e useCounter(5)) expect(result.current.count).toBe(5) }) test('should increment count', () =\u003e { const { result } = renderHook(() =\u003e useCounter(0, 1)) act(() =\u003e { result.current.increment() }) expect(result.current.count).toBe(1) }) test('should decrement count', () =\u003e { const { result } = renderHook(() =\u003e useCounter(5, 2)) act(() =\u003e { result.current.decrement() }) expect(result.current.count).toBe(3) }) test('should reset count', () =\u003e { const { result } = renderHook(() =\u003e useCounter(0)) act(() =\u003e { result.current.increment() result.current.increment() }) expect(result.current.count).toBe(2) act(() =\u003e { result.current.reset() }) expect(result.current.count).toBe(0) }) }) // æµ‹è¯•useApi Hook import { useApi } from './useApi' // Mock fetch global.fetch = jest.fn() describe('useApi', () =\u003e { beforeEach(() =\u003e { fetch.mockClear() }) test('should fetch data on mount', async () =\u003e { const mockData = { id: 1, name: 'Test' } fetch.mockResolvedValueOnce({ ok: true, json: async () =\u003e mockData }) const { result, waitForNextUpdate } = renderHook(() =\u003e useApi('/api/test')) expect(result.current.loading).toBe(true) expect(result.current.data).toBe(null) expect(result.current.error).toBe(null) await waitForNextUpdate() expect(result.current.loading).toBe(false) expect(result.current.data).toEqual(mockData) expect(result.current.error).toBe(null) }) test('should handle fetch error', async () =\u003e { fetch.mockRejectedValueOnce(new Error('Network error')) const { result, waitForNextUpdate } = renderHook(() =\u003e useApi('/api/test')) await waitForNextUpdate() expect(result.current.loading).toBe(false) expect(result.current.data).toBe(null) expect(result.current.error).toBe('Network error') }) }) 2. é›†æˆæµ‹è¯• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 // æµ‹è¯•ä½¿ç”¨Hooksçš„ç»„ä»¶ import { render, screen, fireEvent, waitFor } from '@testing-library/react' import { Counter } from './Counter' describe('Counter Component', () =\u003e { test('should render initial count', () =\u003e { render(\u003cCounter /\u003e) expect(screen.getByText('Count: 0')).toBeInTheDocument() }) test('should increment count when button clicked', async () =\u003e { render(\u003cCounter /\u003e) const incrementButton = screen.getByText('+1') fireEvent.click(incrementButton) await waitFor(() =\u003e { expect(screen.getByText('Count: 1')).toBeInTheDocument() }) }) }) æ€»ç»“ React Hooksä¸ºæˆ‘ä»¬å¸¦æ¥äº†å¼ºå¤§çš„èƒ½åŠ›ï¼Œä½†ä¹Ÿéœ€è¦æ­£ç¡®ç†è§£å’Œä½¿ç”¨ï¼š\næ ¸å¿ƒè¦ç‚¹ ç†è§£åŸç†ï¼šHooksåŸºäºé“¾è¡¨ç»“æ„ï¼Œè°ƒç”¨é¡ºåºå¿…é¡»ä¸€è‡´ åˆç†ä¼˜åŒ–ï¼šé¿å…è¿‡åº¦ä¼˜åŒ–ï¼Œæ­£ç¡®ä½¿ç”¨useCallbackå’ŒuseMemo é¿å…é™·é˜±ï¼šæ³¨æ„é—­åŒ…ã€ä¾èµ–æ•°ç»„ã€è°ƒç”¨è§„åˆ™ç­‰é—®é¢˜ è‡ªå®šä¹‰Hooksï¼šæå–é€»è¾‘å¤ç”¨ï¼Œä¿æŒç»„ä»¶ç®€æ´ æµ‹è¯•ç­–ç•¥ï¼šå……åˆ†æµ‹è¯•è‡ªå®šä¹‰Hooksçš„è¡Œä¸º æœ€ä½³å®è·µ éµå¾ªHooksè§„åˆ™ åˆç†ä½¿ç”¨æ€§èƒ½ä¼˜åŒ–Hooks æå–å¤ç”¨é€»è¾‘ä¸ºè‡ªå®šä¹‰Hooks ç¼–å†™å¯æµ‹è¯•çš„Hooks æ³¨æ„å†…å­˜æ³„æ¼å’Œæ¸…ç† é€šè¿‡æ·±å…¥ç†è§£Hooksçš„åŸç†å’Œæœ€ä½³å®è·µï¼Œä½ å¯ä»¥ç¼–å†™å‡ºæ›´ç®€æ´ã€æ›´é«˜æ•ˆã€æ›´æ˜“ç»´æŠ¤çš„Reactç»„ä»¶ã€‚Hooksä¸ä»…æ˜¯æŠ€æœ¯å·¥å…·ï¼Œæ›´æ˜¯æ„å»ºç°ä»£åŒ–Reactåº”ç”¨çš„è®¾è®¡æ€ç»´ã€‚\n","wordCount":"4044","inLanguage":"zh-cn","datePublished":"2025-12-18T17:00:00+08:00","dateModified":"2025-12-18T17:00:00+08:00","author":{"@type":"Person","name":"æœ‰æ¡å·¥å…·å›¢é˜Ÿ"},"mainEntityOfPage":{"@type":"WebPage","@id":"/blog/articles/react-hooks-deep-dive/"},"publisher":{"@type":"Organization","name":"æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·","logo":{"@type":"ImageObject","url":"/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=/blog/ accesskey=h title="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· (Alt + H)">æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=/blog/posts/ title="æ‰€æœ‰æ–‡ç« åˆ—è¡¨ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŸ¥çœ‹æ‰€æœ‰æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹"><span>æ–‡ç« </span></a></li><li><a href=https://www.util.cn title="æœ‰æ¡å·¥å…· - å¼€å‘è€…çš„å¸¸ç”¨å·¥å…·é›†åˆï¼šæ— å¹¿å‘Š Â· æœ¬åœ°è®¡ç®— Â· å³å¼€å³ç”¨çš„åœ¨çº¿å·¥å…·å¹³å°ï¼Œæä¾›JSONæ ¼å¼åŒ–ã€SQLæ ¼å¼åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰å®ç”¨å·¥å…·"><span>æœ‰æ¡å·¥å…·</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=/blog/categories/ title="æ–‡ç« åˆ†ç±» - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŒ‰æŠ€æœ¯é¢†åŸŸåˆ†ç±»çš„ä¼˜è´¨æ–‡ç« ï¼ŒåŒ…æ‹¬å‰ç«¯å¼€å‘ã€å·¥å…·ä½¿ç”¨ã€ç¼–ç¨‹æŠ€å·§ç­‰"><span>åˆ†ç±»</span></a></li><li><a href=/blog/tags/ title="æ ‡ç­¾äº‘ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šé€šè¿‡æ ‡ç­¾å¿«é€Ÿæ‰¾åˆ°æ„Ÿå…´è¶£çš„æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹"><span>æ ‡ç­¾</span></a></li><li><a href=/blog/archives/ title="æ–‡ç« å½’æ¡£ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŒ‰æ—¶é—´æŸ¥çœ‹å†å²æ–‡ç« "><span>å½’æ¡£</span></a></li><li><a href=/blog/search/ title="æœç´¢æ–‡ç«  - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šé€šè¿‡å…³é”®è¯æœç´¢æ‰¾åˆ°æ„Ÿå…´è¶£çš„æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹ï¼Œæ”¯æŒæ ‡é¢˜ã€å†…å®¹ã€åˆ†ç±»å’Œæ ‡ç­¾æœç´¢"><span>æœç´¢</span></a></li></ul></nav></header><main class=main><article class=post-single><div class=post-content-wrapper><main class=post-content-main><header class=post-header-main><h1 class="post-title entry-hint-parent">React Hooksæ·±åº¦è§£æï¼šåŸç†ã€æœ€ä½³å®è·µå’Œæ€§èƒ½ä¼˜åŒ–</h1><div class=post-description>React Hooksæ·±åº¦è§£ææ–‡ç« ï¼Œè¯¦ç»†è®²è§£HooksåŸç†ã€è‡ªå®šä¹‰Hookså¼€å‘ã€æ€§èƒ½ä¼˜åŒ–æŠ€å·§ã€å¸¸è§é™·é˜±åŠæœ€ä½³å®è·µï¼Œæ˜¯Reactå¼€å‘è€…å¿…è¯»æŒ‡å—</div><div class=post-meta><div class=post-meta-content><div class=post-categories-inline><a href=/blog/categories/%E6%8A%80%E6%9C%AF%E5%8D%9A%E5%AE%A2/ class=category-link>æŠ€æœ¯åšå®¢</a></div><span class=post-date>2025-12-18</span><span class=post-author>æœ‰æ¡å·¥å…·å›¢é˜Ÿ</span></div><style>.post-meta-content{display:flex;align-items:center;flex-wrap:wrap;gap:.75rem;font-family:sf mono,monaco,courier new,monospace;font-size:.875rem;color:#9ca3af !important}.post-categories-inline{display:inline-flex;align-items:center;gap:.5rem}.category-link{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .75rem;background:rgba(255,255,255,.1);color:#e5e7eb !important;text-decoration:none;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;border:1px solid rgba(255,255,255,.2);border-radius:0;transition:all .3s ease;white-space:nowrap}.category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3);transform:translateY(-1px)}.category-link::before{content:'ğŸ“';font-size:.7rem;opacity:.8}.post-date,.post-reading-time,.post-word-count,.post-author{color:#9ca3af !important}[data-theme=dark] .post-meta-content{color:#9ca3af !important}[data-theme=dark] .category-link{background:rgba(255,255,255,.1);color:#e5e7eb !important;border-color:rgba(255,255,255,.2)}[data-theme=dark] .category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3)}[data-theme=dark] .post-date,[data-theme=dark] .post-reading-time,[data-theme=dark] .post-word-count,[data-theme=dark] .post-author{color:#9ca3af !important}[data-theme=light] .post-meta-content{color:#6c757d !important}[data-theme=light] .category-link{background:rgba(0,0,0,5%);color:#495057 !important;border-color:rgba(0,0,0,.15)}[data-theme=light] .category-link:hover{background:rgba(0,102,204,.1);color:#212529 !important;border-color:rgba(0,102,204,.3)}[data-theme=light] .post-date,[data-theme=light] .post-reading-time,[data-theme=light] .post-word-count,[data-theme=light] .post-author{color:#6c757d !important}@media(max-width:768px){.post-meta-content{gap:.5rem;font-size:.8rem}.category-link{padding:.2rem .6rem;font-size:.7rem}}</style></div></header><div class=post-content><p>React Hookså½»åº•æ”¹å˜äº†æˆ‘ä»¬ç¼–å†™Reactç»„ä»¶çš„æ–¹å¼ï¼Œè®©å‡½æ•°ç»„ä»¶æ‹¥æœ‰äº†ç±»ç»„ä»¶çš„æ‰€æœ‰èƒ½åŠ›ï¼ŒåŒæ—¶è¿˜å¸¦æ¥äº†æ›´ç®€æ´çš„ä»£ç ç»„ç»‡æ–¹å¼å’Œæ›´å¥½çš„é€»è¾‘å¤ç”¨ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨Hooksçš„å†…éƒ¨åŸç†ã€æœ€ä½³å®è·µå’Œæ€§èƒ½ä¼˜åŒ–ç­–ç•¥ã€‚</p><h2 id=hooksåŸºç¡€å›é¡¾>HooksåŸºç¡€å›é¡¾<a hidden class=anchor aria-hidden=true href=#hooksåŸºç¡€å›é¡¾>#</a></h2><h3 id=åŸºæœ¬hooksç±»å‹>åŸºæœ¬Hooksç±»å‹<a hidden class=anchor aria-hidden=true href=#åŸºæœ¬hooksç±»å‹>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#ff7b72>import</span> { useState, useEffect, useContext, useReducer, useCallback, useMemo, useRef, useLayoutEffect, useImperativeHandle } from <span style=color:#a5d6ff>&#39;react&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useState - çŠ¶æ€ç®¡ç†
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> [count, setCount] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#a5d6ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useEffect - å‰¯ä½œç”¨å¤„ç†
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>useEffect(() =&gt; {
</span></span><span style=display:flex><span>  document.title <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>`Count: </span><span style=color:#a5d6ff>${</span>count<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// æ¸…ç†å‡½æ•°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  }
</span></span><span style=display:flex><span>}, [count])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useContext - Contextæ¶ˆè´¹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> theme <span style=color:#ff7b72;font-weight:700>=</span> useContext(ThemeContext)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useReducer - å¤æ‚çŠ¶æ€ç®¡ç†
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> [state, dispatch] <span style=color:#ff7b72;font-weight:700>=</span> useReducer(reducer, initialState)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useCallback - å‡½æ•°ç¼“å­˜
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> handleClick <span style=color:#ff7b72;font-weight:700>=</span> useCallback(() =&gt; {
</span></span><span style=display:flex><span>  setCount(count <span style=color:#ff7b72;font-weight:700>+</span> <span style=color:#a5d6ff>1</span>)
</span></span><span style=display:flex><span>}, [count])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useMemo - å€¼ç¼“å­˜
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> expensiveValue <span style=color:#ff7b72;font-weight:700>=</span> useMemo(() =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> computeExpensiveValue(count)
</span></span><span style=display:flex><span>}, [count])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useRef - å¼•ç”¨ç®¡ç†
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> inputRef <span style=color:#ff7b72;font-weight:700>=</span> useRef(<span style=color:#79c0ff>null</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useLayoutEffect - åŒæ­¥å‰¯ä½œç”¨
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>useLayoutEffect(() =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// åœ¨DOMæ›´æ–°ååŒæ­¥æ‰§è¡Œ
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useImperativeHandle - æš´éœ²å®ä¾‹æ–¹æ³•
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>useImperativeHandle(ref, () =&gt; ({
</span></span><span style=display:flex><span>  focus<span style=color:#ff7b72;font-weight:700>:</span> () =&gt; inputRef.current.focus()
</span></span><span style=display:flex><span>}), [])
</span></span></code></pre></td></tr></table></div></div><h2 id=hookså†…éƒ¨åŸç†>Hookså†…éƒ¨åŸç†<a hidden class=anchor aria-hidden=true href=#hookså†…éƒ¨åŸç†>#</a></h2><h3 id=1-hooksçš„æ•°æ®ç»“æ„>1. Hooksçš„æ•°æ®ç»“æ„<a hidden class=anchor aria-hidden=true href=#1-hooksçš„æ•°æ®ç»“æ„>#</a></h3><p>Reactä½¿ç”¨é“¾è¡¨æ¥å­˜å‚¨Hooksçš„çŠ¶æ€ï¼š</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">60
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ç®€åŒ–çš„Hookså†…éƒ¨å®ç°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>let</span> currentlyRenderingComponent <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>null</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>let</span> workInProgressHook <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>null</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>let</span> currentHook <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>null</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// HookèŠ‚ç‚¹ç»“æ„
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> hook <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>  memoizedState<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#79c0ff>null</span>,  <span style=color:#8b949e;font-style:italic>// Hookçš„å½“å‰çŠ¶æ€
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  baseState<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#79c0ff>null</span>,     <span style=color:#8b949e;font-style:italic>// åŸºç¡€çŠ¶æ€
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  baseQueue<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#79c0ff>null</span>,     <span style=color:#8b949e;font-style:italic>// åŸºç¡€æ›´æ–°é˜Ÿåˆ—
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  queue<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#79c0ff>null</span>,         <span style=color:#8b949e;font-style:italic>// æ›´æ–°é˜Ÿåˆ—
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  next<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#79c0ff>null</span>          <span style=color:#8b949e;font-style:italic>// ä¸‹ä¸€ä¸ªHook
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Hookåˆå§‹åŒ–
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> mountWorkInProgressHook() {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> hook <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>    memoizedState<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#79c0ff>null</span>,
</span></span><span style=display:flex><span>    baseState<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#79c0ff>null</span>,
</span></span><span style=display:flex><span>    baseQueue<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#79c0ff>null</span>,
</span></span><span style=display:flex><span>    queue<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#79c0ff>null</span>,
</span></span><span style=display:flex><span>    next<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#79c0ff>null</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>if</span> (workInProgressHook <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#79c0ff>null</span>) {
</span></span><span style=display:flex><span>    currentlyRenderingComponent.memoizedState <span style=color:#ff7b72;font-weight:700>=</span> workInProgressHook <span style=color:#ff7b72;font-weight:700>=</span> hook
</span></span><span style=display:flex><span>  } <span style=color:#ff7b72>else</span> {
</span></span><span style=display:flex><span>    workInProgressHook <span style=color:#ff7b72;font-weight:700>=</span> workInProgressHook.next <span style=color:#ff7b72;font-weight:700>=</span> hook
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> workInProgressHook
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Hookæ›´æ–°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> updateWorkInProgressHook() {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>let</span> nextCurrentHook
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>if</span> (currentHook <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#79c0ff>null</span>) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> current <span style=color:#ff7b72;font-weight:700>=</span> currentlyRenderingComponent.alternate.memoizedState
</span></span><span style=display:flex><span>    nextCurrentHook <span style=color:#ff7b72;font-weight:700>=</span> current.next
</span></span><span style=display:flex><span>  } <span style=color:#ff7b72>else</span> {
</span></span><span style=display:flex><span>    nextCurrentHook <span style=color:#ff7b72;font-weight:700>=</span> currentHook.next
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>let</span> nextWorkInProgressHook
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>if</span> (workInProgressHook <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#79c0ff>null</span>) {
</span></span><span style=display:flex><span>    nextWorkInProgressHook <span style=color:#ff7b72;font-weight:700>=</span> currentlyRenderingComponent.memoizedState
</span></span><span style=display:flex><span>  } <span style=color:#ff7b72>else</span> {
</span></span><span style=display:flex><span>    nextWorkInProgressHook <span style=color:#ff7b72;font-weight:700>=</span> workInProgressHook.next
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>if</span> (nextWorkInProgressHook <span style=color:#ff7b72;font-weight:700>!==</span> <span style=color:#79c0ff>null</span>) {
</span></span><span style=display:flex><span>    workInProgressHook <span style=color:#ff7b72;font-weight:700>=</span> nextWorkInProgressHook
</span></span><span style=display:flex><span>    nextWorkInProgressHook <span style=color:#ff7b72;font-weight:700>=</span> createHook(nextCurrentHook)
</span></span><span style=display:flex><span>  } <span style=color:#ff7b72>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// æ²¡æœ‰å¯¹åº”çš„Hookï¼Œå¯èƒ½æ˜¯æ–°å¢çš„Hook
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    workInProgressHook <span style=color:#ff7b72;font-weight:700>=</span> createHook(<span style=color:#79c0ff>null</span>)
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  currentHook <span style=color:#ff7b72;font-weight:700>=</span> nextCurrentHook
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> workInProgressHook
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=2-usestateçš„å®ç°åŸç†>2. useStateçš„å®ç°åŸç†<a hidden class=anchor aria-hidden=true href=#2-usestateçš„å®ç°åŸç†>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">65
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useStateçš„ç®€åŒ–å®ç°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> useState(initialState) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> useReducer(
</span></span><span style=display:flex><span>    (state, action) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>return</span> <span style=color:#ff7b72>typeof</span> action <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;function&#39;</span> <span style=color:#ff7b72;font-weight:700>?</span> action(state) <span style=color:#ff7b72;font-weight:700>:</span> action
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>typeof</span> initialState <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;function&#39;</span> <span style=color:#ff7b72;font-weight:700>?</span> initialState() <span style=color:#ff7b72;font-weight:700>:</span> initialState
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useReducerçš„ç®€åŒ–å®ç°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> useReducer(reducer, initialState, init) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> hook <span style=color:#ff7b72;font-weight:700>=</span> updateWorkInProgressHook()
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> queue <span style=color:#ff7b72;font-weight:700>=</span> hook.queue
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// æ‰§è¡Œæ›´æ–°é˜Ÿåˆ—
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  <span style=color:#ff7b72>if</span> (numberOfLanes <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>1</span>) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> hook.memoizedState
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>if</span> (queue <span style=color:#ff7b72;font-weight:700>!==</span> <span style=color:#79c0ff>null</span>) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>let</span> newState <span style=color:#ff7b72;font-weight:700>=</span> hook.baseState
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>let</span> update <span style=color:#ff7b72;font-weight:700>=</span> queue.first
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>let</span> didSkip <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>false</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>while</span> (update <span style=color:#ff7b72;font-weight:700>!==</span> <span style=color:#79c0ff>null</span>) {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>const</span> action <span style=color:#ff7b72;font-weight:700>=</span> update.action
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>if</span> (shouldSkipUpdate(update.lane)) {
</span></span><span style=display:flex><span>        didSkip <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>true</span>
</span></span><span style=display:flex><span>      } <span style=color:#ff7b72>else</span> {
</span></span><span style=display:flex><span>        newState <span style=color:#ff7b72;font-weight:700>=</span> reducer(newState, action)
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      update <span style=color:#ff7b72;font-weight:700>=</span> update.next
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72;font-weight:700>!</span>didSkip) {
</span></span><span style=display:flex><span>      hook.baseState <span style=color:#ff7b72;font-weight:700>=</span> newState
</span></span><span style=display:flex><span>      hook.baseQueue <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>null</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    hook.memoizedState <span style=color:#ff7b72;font-weight:700>=</span> newState
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> dispatch <span style=color:#ff7b72;font-weight:700>=</span> dispatchAction.bind(<span style=color:#79c0ff>null</span>, currentlyRenderingComponent, queue)
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> [hook.memoizedState, dispatch]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>function</span> dispatchAction(component, queue, action) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> update <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>    lane,
</span></span><span style=display:flex><span>    action,
</span></span><span style=display:flex><span>    next<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#79c0ff>null</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> pending <span style=color:#ff7b72;font-weight:700>=</span> queue.pending
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>if</span> (pending <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#79c0ff>null</span>) {
</span></span><span style=display:flex><span>    update.next <span style=color:#ff7b72;font-weight:700>=</span> update
</span></span><span style=display:flex><span>  } <span style=color:#ff7b72>else</span> {
</span></span><span style=display:flex><span>    update.next <span style=color:#ff7b72;font-weight:700>=</span> pending.next
</span></span><span style=display:flex><span>    pending.next <span style=color:#ff7b72;font-weight:700>=</span> update
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  queue.pending <span style=color:#ff7b72;font-weight:700>=</span> update
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  scheduleUpdateOnFiber(component, lane)
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=3-useeffectçš„å®ç°åŸç†>3. useEffectçš„å®ç°åŸç†<a hidden class=anchor aria-hidden=true href=#3-useeffectçš„å®ç°åŸç†>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#ff7b72>function</span> useEffect(create, deps) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> mountEffectImpl(
</span></span><span style=display:flex><span>    UpdateEffect <span style=color:#ff7b72;font-weight:700>|</span> PassEffect,
</span></span><span style=display:flex><span>    HookPassive,
</span></span><span style=display:flex><span>    create,
</span></span><span style=display:flex><span>    deps
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>function</span> mountEffectImpl(fiberFlags, hookFlags, create, deps) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> hook <span style=color:#ff7b72;font-weight:700>=</span> mountWorkInProgressHook()
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> nextDeps <span style=color:#ff7b72;font-weight:700>=</span> deps <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#79c0ff>undefined</span> <span style=color:#ff7b72;font-weight:700>?</span> <span style=color:#79c0ff>null</span> <span style=color:#ff7b72;font-weight:700>:</span> deps
</span></span><span style=display:flex><span>  currentlyRenderingComponent.flags <span style=color:#ff7b72;font-weight:700>|=</span> fiberFlags
</span></span><span style=display:flex><span>  hook.memoizedState <span style=color:#ff7b72;font-weight:700>=</span> pushEffect(HookHasEffect <span style=color:#ff7b72;font-weight:700>|</span> hookFlags, create, <span style=color:#79c0ff>undefined</span>, nextDeps)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>function</span> pushEffect(tag, create, destroy, deps) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> effect <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>    tag,
</span></span><span style=display:flex><span>    create,
</span></span><span style=display:flex><span>    destroy,
</span></span><span style=display:flex><span>    deps,
</span></span><span style=display:flex><span>    next<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#79c0ff>null</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>let</span> componentUpdateQueue <span style=color:#ff7b72;font-weight:700>=</span> currentlyRenderingComponent.updateQueue
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>if</span> (componentUpdateQueue <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#79c0ff>null</span>) {
</span></span><span style=display:flex><span>    componentUpdateQueue <span style=color:#ff7b72;font-weight:700>=</span> createFunctionComponentUpdateQueue()
</span></span><span style=display:flex><span>    currentlyRenderingComponent.updateQueue <span style=color:#ff7b72;font-weight:700>=</span> componentUpdateQueue
</span></span><span style=display:flex><span>    componentUpdateQueue.lastEffect <span style=color:#ff7b72;font-weight:700>=</span> effect.next <span style=color:#ff7b72;font-weight:700>=</span> effect
</span></span><span style=display:flex><span>  } <span style=color:#ff7b72>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> lastEffect <span style=color:#ff7b72;font-weight:700>=</span> componentUpdateQueue.lastEffect
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (lastEffect <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#79c0ff>null</span>) {
</span></span><span style=display:flex><span>      componentUpdateQueue.lastEffect <span style=color:#ff7b72;font-weight:700>=</span> effect.next <span style=color:#ff7b72;font-weight:700>=</span> effect
</span></span><span style=display:flex><span>    } <span style=color:#ff7b72>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>const</span> firstEffect <span style=color:#ff7b72;font-weight:700>=</span> lastEffect.next
</span></span><span style=display:flex><span>      lastEffect.next <span style=color:#ff7b72;font-weight:700>=</span> effect
</span></span><span style=display:flex><span>      effect.next <span style=color:#ff7b72;font-weight:700>=</span> firstEffect
</span></span><span style=display:flex><span>      componentUpdateQueue.lastEffect <span style=color:#ff7b72;font-weight:700>=</span> effect
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> effect
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=è‡ªå®šä¹‰hookså¼€å‘>è‡ªå®šä¹‰Hookså¼€å‘<a hidden class=anchor aria-hidden=true href=#è‡ªå®šä¹‰hookså¼€å‘>#</a></h2><h3 id=1-åŸºç¡€è‡ªå®šä¹‰hook>1. åŸºç¡€è‡ªå®šä¹‰Hook<a hidden class=anchor aria-hidden=true href=#1-åŸºç¡€è‡ªå®šä¹‰hook>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useCounter - è®¡æ•°å™¨Hook
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> useCounter(initialValue <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>0</span>, step <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>1</span>) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [count, setCount] <span style=color:#ff7b72;font-weight:700>=</span> useState(initialValue)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> increment <span style=color:#ff7b72;font-weight:700>=</span> useCallback(() =&gt; {
</span></span><span style=display:flex><span>    setCount(prevCount =&gt; prevCount <span style=color:#ff7b72;font-weight:700>+</span> step)
</span></span><span style=display:flex><span>  }, [step])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> decrement <span style=color:#ff7b72;font-weight:700>=</span> useCallback(() =&gt; {
</span></span><span style=display:flex><span>    setCount(prevCount =&gt; prevCount <span style=color:#ff7b72;font-weight:700>-</span> step)
</span></span><span style=display:flex><span>  }, [step])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> reset <span style=color:#ff7b72;font-weight:700>=</span> useCallback(() =&gt; {
</span></span><span style=display:flex><span>    setCount(initialValue)
</span></span><span style=display:flex><span>  }, [initialValue])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> { count, increment, decrement, reset }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ä½¿ç”¨ç¤ºä¾‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> Counter() {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> { count, increment, decrement, reset } <span style=color:#ff7b72;font-weight:700>=</span> useCounter(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>p<span style=color:#ff7b72;font-weight:700>&gt;</span>Count<span style=color:#ff7b72;font-weight:700>:</span> {count}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/p&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>button onClick<span style=color:#ff7b72;font-weight:700>=</span>{increment}<span style=color:#ff7b72;font-weight:700>&gt;+</span><span style=color:#a5d6ff>2</span><span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/button&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>button onClick<span style=color:#ff7b72;font-weight:700>=</span>{decrement}<span style=color:#ff7b72;font-weight:700>&gt;-</span><span style=color:#a5d6ff>2</span><span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/button&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>button onClick<span style=color:#ff7b72;font-weight:700>=</span>{reset}<span style=color:#ff7b72;font-weight:700>&gt;</span>Reset<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/button&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=2-å¤æ‚ä¸šåŠ¡é€»è¾‘hook>2. å¤æ‚ä¸šåŠ¡é€»è¾‘Hook<a hidden class=anchor aria-hidden=true href=#2-å¤æ‚ä¸šåŠ¡é€»è¾‘hook>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useApi - APIè¯·æ±‚Hook
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> useApi(url, options <span style=color:#ff7b72;font-weight:700>=</span> {}) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [data, setData] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#79c0ff>null</span>)
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [loading, setLoading] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#79c0ff>true</span>)
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [error, setError] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#79c0ff>null</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> fetchData <span style=color:#ff7b72;font-weight:700>=</span> useCallback(<span style=color:#ff7b72>async</span> () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>try</span> {
</span></span><span style=display:flex><span>      setLoading(<span style=color:#79c0ff>true</span>)
</span></span><span style=display:flex><span>      setError(<span style=color:#79c0ff>null</span>)
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>const</span> response <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> fetch(url, options)
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72;font-weight:700>!</span>response.ok) {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>throw</span> <span style=color:#ff7b72>new</span> Error(<span style=color:#a5d6ff>`HTTP error! status: </span><span style=color:#a5d6ff>${</span>response.status<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>)
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>const</span> result <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>await</span> response.json()
</span></span><span style=display:flex><span>      setData(result)
</span></span><span style=display:flex><span>    } <span style=color:#ff7b72>catch</span> (err) {
</span></span><span style=display:flex><span>      setError(err.message)
</span></span><span style=display:flex><span>    } <span style=color:#ff7b72>finally</span> {
</span></span><span style=display:flex><span>      setLoading(<span style=color:#79c0ff>false</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }, [url, options])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    fetchData()
</span></span><span style=display:flex><span>  }, [fetchData])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> refetch <span style=color:#ff7b72;font-weight:700>=</span> useCallback(() =&gt; {
</span></span><span style=display:flex><span>    fetchData()
</span></span><span style=display:flex><span>  }, [fetchData])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> { data, loading, error, refetch }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ä½¿ç”¨ç¤ºä¾‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> UserProfile({ userId }) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> { data<span style=color:#ff7b72;font-weight:700>:</span> user, loading, error, refetch } <span style=color:#ff7b72;font-weight:700>=</span> useApi(<span style=color:#a5d6ff>`/api/users/</span><span style=color:#a5d6ff>${</span>userId<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>if</span> (loading) <span style=color:#ff7b72>return</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>Loading...<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>if</span> (error) <span style=color:#ff7b72>return</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>Error<span style=color:#ff7b72;font-weight:700>:</span> {error}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72;font-weight:700>!</span>user) <span style=color:#ff7b72>return</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>No user found<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>h1<span style=color:#ff7b72;font-weight:700>&gt;</span>{user.name}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/h1&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>p<span style=color:#ff7b72;font-weight:700>&gt;</span>{user.email}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/p&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>button onClick<span style=color:#ff7b72;font-weight:700>=</span>{refetch}<span style=color:#ff7b72;font-weight:700>&gt;</span>Refresh<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/button&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=3-localstorageåŒæ­¥hook>3. localStorageåŒæ­¥Hook<a hidden class=anchor aria-hidden=true href=#3-localstorageåŒæ­¥hook>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">61
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useLocalStorage - localStorageåŒæ­¥Hook
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> useLocalStorage(key, initialValue) {
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// è·å–åˆå§‹å€¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  <span style=color:#ff7b72>const</span> [storedValue, setStoredValue] <span style=color:#ff7b72;font-weight:700>=</span> useState(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>const</span> item <span style=color:#ff7b72;font-weight:700>=</span> window.localStorage.getItem(key)
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>return</span> item <span style=color:#ff7b72;font-weight:700>?</span> JSON.parse(item) <span style=color:#ff7b72;font-weight:700>:</span> initialValue
</span></span><span style=display:flex><span>    } <span style=color:#ff7b72>catch</span> (error) {
</span></span><span style=display:flex><span>      console.error(<span style=color:#a5d6ff>`Error reading localStorage key &#34;</span><span style=color:#a5d6ff>${</span>key<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>&#34;:`</span>, error)
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>return</span> initialValue
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// è®¾ç½®å€¼åˆ°localStorageå’Œstate
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  <span style=color:#ff7b72>const</span> setValue <span style=color:#ff7b72;font-weight:700>=</span> useCallback((value) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>const</span> valueToStore <span style=color:#ff7b72;font-weight:700>=</span> value <span style=color:#ff7b72>instanceof</span> Function <span style=color:#ff7b72;font-weight:700>?</span> value(storedValue) <span style=color:#ff7b72;font-weight:700>:</span> value
</span></span><span style=display:flex><span>      setStoredValue(valueToStore)
</span></span><span style=display:flex><span>      window.localStorage.setItem(key, JSON.stringify(valueToStore))
</span></span><span style=display:flex><span>    } <span style=color:#ff7b72>catch</span> (error) {
</span></span><span style=display:flex><span>      console.error(<span style=color:#a5d6ff>`Error setting localStorage key &#34;</span><span style=color:#a5d6ff>${</span>key<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>&#34;:`</span>, error)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }, [key, storedValue])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// ç›‘å¬å…¶ä»–tabçš„å˜åŒ–
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> handleStorageChange <span style=color:#ff7b72;font-weight:700>=</span> (e) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>if</span> (e.key <span style=color:#ff7b72;font-weight:700>===</span> key) {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>try</span> {
</span></span><span style=display:flex><span>          setStoredValue(JSON.parse(e.newValue))
</span></span><span style=display:flex><span>        } <span style=color:#ff7b72>catch</span> (error) {
</span></span><span style=display:flex><span>          console.error(<span style=color:#a5d6ff>`Error parsing storage value for key &#34;</span><span style=color:#a5d6ff>${</span>key<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>&#34;:`</span>, error)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    window.addEventListener(<span style=color:#a5d6ff>&#39;storage&#39;</span>, handleStorageChange)
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> () =&gt; window.removeEventListener(<span style=color:#a5d6ff>&#39;storage&#39;</span>, handleStorageChange)
</span></span><span style=display:flex><span>  }, [key])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> [storedValue, setValue]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ä½¿ç”¨ç¤ºä¾‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> Settings() {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [theme, setTheme] <span style=color:#ff7b72;font-weight:700>=</span> useLocalStorage(<span style=color:#a5d6ff>&#39;theme&#39;</span>, <span style=color:#a5d6ff>&#39;light&#39;</span>)
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [language, setLanguage] <span style=color:#ff7b72;font-weight:700>=</span> useLocalStorage(<span style=color:#a5d6ff>&#39;language&#39;</span>, <span style=color:#a5d6ff>&#39;en&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>select value<span style=color:#ff7b72;font-weight:700>=</span>{theme} onChange<span style=color:#ff7b72;font-weight:700>=</span>{(e) =&gt; setTheme(e.target.value)}<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span>option value<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;light&#34;</span><span style=color:#ff7b72;font-weight:700>&gt;</span>Light<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/option&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span>option value<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;dark&#34;</span><span style=color:#ff7b72;font-weight:700>&gt;</span>Dark<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/option&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/select&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>select value<span style=color:#ff7b72;font-weight:700>=</span>{language} onChange<span style=color:#ff7b72;font-weight:700>=</span>{(e) =&gt; setLanguage(e.target.value)}<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span>option value<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;en&#34;</span><span style=color:#ff7b72;font-weight:700>&gt;</span>English<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/option&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span>option value<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;zh&#34;</span><span style=color:#ff7b72;font-weight:700>&gt;</span>ä¸­æ–‡<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/option&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/select&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=4-é˜²æŠ–hook>4. é˜²æŠ–Hook<a hidden class=anchor aria-hidden=true href=#4-é˜²æŠ–hook>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">62
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useDebounce - é˜²æŠ–Hook
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> useDebounce(value, delay) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [debouncedValue, setDebouncedValue] <span style=color:#ff7b72;font-weight:700>=</span> useState(value)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> handler <span style=color:#ff7b72;font-weight:700>=</span> setTimeout(() =&gt; {
</span></span><span style=display:flex><span>      setDebouncedValue(value)
</span></span><span style=display:flex><span>    }, delay)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> () =&gt; {
</span></span><span style=display:flex><span>      clearTimeout(handler)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }, [value, delay])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> debouncedValue
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useDebouncedCallback - é˜²æŠ–å›è°ƒHook
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> useDebouncedCallback(callback, delay, deps <span style=color:#ff7b72;font-weight:700>=</span> []) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> callbackRef <span style=color:#ff7b72;font-weight:700>=</span> useRef(callback)
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> timeoutRef <span style=color:#ff7b72;font-weight:700>=</span> useRef(<span style=color:#79c0ff>null</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    callbackRef.current <span style=color:#ff7b72;font-weight:700>=</span> callback
</span></span><span style=display:flex><span>  }, [callback])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> useCallback((...args) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (timeoutRef.current) {
</span></span><span style=display:flex><span>      clearTimeout(timeoutRef.current)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    timeoutRef.current <span style=color:#ff7b72;font-weight:700>=</span> setTimeout(() =&gt; {
</span></span><span style=display:flex><span>      callbackRef.current(...args)
</span></span><span style=display:flex><span>    }, delay)
</span></span><span style=display:flex><span>  }, [delay, ...deps])
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ä½¿ç”¨ç¤ºä¾‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> SearchInput() {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [searchTerm, setSearchTerm] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#a5d6ff>&#39;&#39;</span>)
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> debouncedSearchTerm <span style=color:#ff7b72;font-weight:700>=</span> useDebounce(searchTerm, <span style=color:#a5d6ff>500</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> handleSearch <span style=color:#ff7b72;font-weight:700>=</span> useDebouncedCallback((term) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// æ‰§è¡Œæœç´¢APIè°ƒç”¨
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    console.log(<span style=color:#a5d6ff>&#39;Searching for:&#39;</span>, term)
</span></span><span style=display:flex><span>  }, <span style=color:#a5d6ff>500</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (debouncedSearchTerm) {
</span></span><span style=display:flex><span>      handleSearch(debouncedSearchTerm)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }, [debouncedSearchTerm, handleSearch])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span>input
</span></span><span style=display:flex><span>      type<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;text&#34;</span>
</span></span><span style=display:flex><span>      value<span style=color:#ff7b72;font-weight:700>=</span>{searchTerm}
</span></span><span style=display:flex><span>      onChange<span style=color:#ff7b72;font-weight:700>=</span>{(e) =&gt; setSearchTerm(e.target.value)}
</span></span><span style=display:flex><span>      placeholder<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;Search...&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=æ€§èƒ½ä¼˜åŒ–ç­–ç•¥>æ€§èƒ½ä¼˜åŒ–ç­–ç•¥<a hidden class=anchor aria-hidden=true href=#æ€§èƒ½ä¼˜åŒ–ç­–ç•¥>#</a></h2><h3 id=1-usecallbackå’Œusememoçš„æ­£ç¡®ä½¿ç”¨>1. useCallbackå’ŒuseMemoçš„æ­£ç¡®ä½¿ç”¨<a hidden class=anchor aria-hidden=true href=#1-usecallbackå’Œusememoçš„æ­£ç¡®ä½¿ç”¨>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// âŒ è¿‡åº¦ä½¿ç”¨useCallback
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> BadExample({ items, onItemClick }) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> handleClick <span style=color:#ff7b72;font-weight:700>=</span> useCallback((item) =&gt; {
</span></span><span style=display:flex><span>    onItemClick(item.id)
</span></span><span style=display:flex><span>  }, [onItemClick]) <span style=color:#8b949e;font-style:italic>// æ¯æ¬¡onItemClickå˜åŒ–éƒ½åˆ›å»ºæ–°å‡½æ•°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span>ul<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      {items.map(item =&gt; (
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span>li key<span style=color:#ff7b72;font-weight:700>=</span>{item.id} onClick<span style=color:#ff7b72;font-weight:700>=</span>{() =&gt; handleClick(item)}<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>          {item.name}
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/li&gt;</span>
</span></span><span style=display:flex><span>      ))}
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/ul&gt;</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// âœ… åˆç†ä½¿ç”¨useCallback
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> GoodExample({ items, onItemClick }) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> handleClick <span style=color:#ff7b72;font-weight:700>=</span> useCallback((itemId) =&gt; {
</span></span><span style=display:flex><span>    onItemClick(itemId)
</span></span><span style=display:flex><span>  }, [onItemClick])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span>ul<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      {items.map(item =&gt; (
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span>Item
</span></span><span style=display:flex><span>          key<span style=color:#ff7b72;font-weight:700>=</span>{item.id}
</span></span><span style=display:flex><span>          item<span style=color:#ff7b72;font-weight:700>=</span>{item}
</span></span><span style=display:flex><span>          onClick<span style=color:#ff7b72;font-weight:700>=</span>{handleClick}
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>      ))}
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/ul&gt;</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// å­ç»„ä»¶
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> Item <span style=color:#ff7b72;font-weight:700>=</span> React.memo(({ item, onClick }) =&gt; (
</span></span><span style=display:flex><span>  <span style=color:#ff7b72;font-weight:700>&lt;</span>li onClick<span style=color:#ff7b72;font-weight:700>=</span>{() =&gt; onClick(item.id)}<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    {item.name}
</span></span><span style=display:flex><span>  <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/li&gt;</span>
</span></span><span style=display:flex><span>))
</span></span></code></pre></td></tr></table></div></div><h3 id=2-çŠ¶æ€ä¼˜åŒ–ç­–ç•¥>2. çŠ¶æ€ä¼˜åŒ–ç­–ç•¥<a hidden class=anchor aria-hidden=true href=#2-çŠ¶æ€ä¼˜åŒ–ç­–ç•¥>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// âŒ ä¸å¿…è¦çš„çŠ¶æ€åˆ†ç¦»
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> BadCounter() {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [count, setCount] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#a5d6ff>0</span>)
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [<span style=color:#ff7b72>double</span>, setDouble] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#a5d6ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    setDouble(count <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>2</span>)
</span></span><span style=display:flex><span>  }, [count])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>p<span style=color:#ff7b72;font-weight:700>&gt;</span>Count<span style=color:#ff7b72;font-weight:700>:</span> {count}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/p&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>p<span style=color:#ff7b72;font-weight:700>&gt;</span>Double<span style=color:#ff7b72;font-weight:700>:</span> {<span style=color:#ff7b72>double</span>}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/p&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// âœ… ä½¿ç”¨æ´¾ç”ŸçŠ¶æ€
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> GoodCounter() {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [count, setCount] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#a5d6ff>0</span>)
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> <span style=color:#ff7b72>double</span> <span style=color:#ff7b72;font-weight:700>=</span> useMemo(() =&gt; count <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>2</span>, [count])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>p<span style=color:#ff7b72;font-weight:700>&gt;</span>Count<span style=color:#ff7b72;font-weight:700>:</span> {count}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/p&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>p<span style=color:#ff7b72;font-weight:700>&gt;</span>Double<span style=color:#ff7b72;font-weight:700>:</span> {<span style=color:#ff7b72>double</span>}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/p&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// âœ… å¤æ‚çŠ¶æ€çš„ä¼˜åŒ–
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> useComplexState(initialState) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [state, setState] <span style=color:#ff7b72;font-weight:700>=</span> useState(initialState)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> updateState <span style=color:#ff7b72;font-weight:700>=</span> useCallback((updater) =&gt; {
</span></span><span style=display:flex><span>    setState(prevState =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>const</span> newState <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>typeof</span> updater <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;function&#39;</span> <span style=color:#ff7b72;font-weight:700>?</span> updater(prevState) <span style=color:#ff7b72;font-weight:700>:</span> updater
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>return</span> { ...prevState, ...newState }
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>  }, [])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> [state, updateState]
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=3-ç»„ä»¶æ¸²æŸ“ä¼˜åŒ–>3. ç»„ä»¶æ¸²æŸ“ä¼˜åŒ–<a hidden class=anchor aria-hidden=true href=#3-ç»„ä»¶æ¸²æŸ“ä¼˜åŒ–>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// âœ… ä½¿ç”¨React.memoä¼˜åŒ–å‡½æ•°ç»„ä»¶
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> ExpensiveComponent <span style=color:#ff7b72;font-weight:700>=</span> React.memo(({ data, onUpdate }) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      {data.map(item =&gt; (
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span>div key<span style=color:#ff7b72;font-weight:700>=</span>{item.id}<span style=color:#ff7b72;font-weight:700>&gt;</span>{item.name}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>      ))}
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}, (prevProps, nextProps) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#8b949e;font-style:italic>// è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  <span style=color:#ff7b72>return</span> prevProps.data.length <span style=color:#ff7b72;font-weight:700>===</span> nextProps.data.length
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// âœ… ä½¿ç”¨useMemoç¼“å­˜å¤æ‚è®¡ç®—
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> DataProcessor({ items }) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> processedData <span style=color:#ff7b72;font-weight:700>=</span> useMemo(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> items
</span></span><span style=display:flex><span>      .filter(item =&gt; item.active)
</span></span><span style=display:flex><span>      .map(item =&gt; ({
</span></span><span style=display:flex><span>        ...item,
</span></span><span style=display:flex><span>        value<span style=color:#ff7b72;font-weight:700>:</span> complexCalculation(item)
</span></span><span style=display:flex><span>      }))
</span></span><span style=display:flex><span>      .sort((a, b) =&gt; a.value <span style=color:#ff7b72;font-weight:700>-</span> b.value)
</span></span><span style=display:flex><span>  }, [items])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>DataList data<span style=color:#ff7b72;font-weight:700>=</span>{processedData} <span style=color:#ff7b72;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// âœ… ä½¿ç”¨useRefé¿å…ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> Timer() {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [count, setCount] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#a5d6ff>0</span>)
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> intervalRef <span style=color:#ff7b72;font-weight:700>=</span> useRef(<span style=color:#79c0ff>null</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    intervalRef.current <span style=color:#ff7b72;font-weight:700>=</span> setInterval(() =&gt; {
</span></span><span style=display:flex><span>      setCount(c =&gt; c <span style=color:#ff7b72;font-weight:700>+</span> <span style=color:#a5d6ff>1</span>)
</span></span><span style=display:flex><span>    }, <span style=color:#a5d6ff>1000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>if</span> (intervalRef.current) {
</span></span><span style=display:flex><span>        clearInterval(intervalRef.current)
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }, [])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>Count<span style=color:#ff7b72;font-weight:700>:</span> {count}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=å¸¸è§é™·é˜±å’Œè§£å†³æ–¹æ¡ˆ>å¸¸è§é™·é˜±å’Œè§£å†³æ–¹æ¡ˆ<a hidden class=anchor aria-hidden=true href=#å¸¸è§é™·é˜±å’Œè§£å†³æ–¹æ¡ˆ>#</a></h2><h3 id=1-hooksè°ƒç”¨è§„åˆ™>1. Hooksè°ƒç”¨è§„åˆ™<a hidden class=anchor aria-hidden=true href=#1-hooksè°ƒç”¨è§„åˆ™>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// âŒ åœ¨æ¡ä»¶è¯­å¥ä¸­è°ƒç”¨Hook
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> BadComponent({ condition }) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>if</span> (condition) {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> [state, setState] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#a5d6ff>0</span>) <span style=color:#8b949e;font-style:italic>// é”™è¯¯ï¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>  }, []) <span style=color:#8b949e;font-style:italic>// é”™è¯¯ï¼Hookè°ƒç”¨é¡ºåºä¸ç¨³å®š
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>Bad Component<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// âœ… æ­£ç¡®çš„Hookè°ƒç”¨
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> GoodComponent({ condition }) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [state, setState] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#a5d6ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (condition) {
</span></span><span style=display:flex><span>      <span style=color:#8b949e;font-style:italic>// åœ¨effectå†…éƒ¨ä½¿ç”¨æ¡ä»¶é€»è¾‘
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>      console.log(<span style=color:#a5d6ff>&#39;Condition is true&#39;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }, [condition])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>Good Component<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=2-é—­åŒ…é™·é˜±>2. é—­åŒ…é™·é˜±<a hidden class=anchor aria-hidden=true href=#2-é—­åŒ…é™·é˜±>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// âŒ é—­åŒ…é™·é˜±
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> CounterWithBug() {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [count, setCount] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#a5d6ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> interval <span style=color:#ff7b72;font-weight:700>=</span> setInterval(() =&gt; {
</span></span><span style=display:flex><span>      setCount(count <span style=color:#ff7b72;font-weight:700>+</span> <span style=color:#a5d6ff>1</span>) <span style=color:#8b949e;font-style:italic>// æ€»æ˜¯ä»0å¼€å§‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    }, <span style=color:#a5d6ff>1000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> () =&gt; clearInterval(interval)
</span></span><span style=display:flex><span>  }, [count]) <span style=color:#8b949e;font-style:italic>// æ¯æ¬¡countå˜åŒ–éƒ½é‡æ–°åˆ›å»ºinterval
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>Count<span style=color:#ff7b72;font-weight:700>:</span> {count}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// âœ… ä½¿ç”¨å‡½æ•°å¼æ›´æ–°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> CounterWithFix() {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [count, setCount] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#a5d6ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> interval <span style=color:#ff7b72;font-weight:700>=</span> setInterval(() =&gt; {
</span></span><span style=display:flex><span>      setCount(prevCount =&gt; prevCount <span style=color:#ff7b72;font-weight:700>+</span> <span style=color:#a5d6ff>1</span>) <span style=color:#8b949e;font-style:italic>// ä½¿ç”¨å‡½æ•°å¼æ›´æ–°
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>    }, <span style=color:#a5d6ff>1000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> () =&gt; clearInterval(interval)
</span></span><span style=display:flex><span>  }, []) <span style=color:#8b949e;font-style:italic>// åªåœ¨ç»„ä»¶æŒ‚è½½æ—¶åˆ›å»ºä¸€æ¬¡
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>Count<span style=color:#ff7b72;font-weight:700>:</span> {count}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// âœ… ä½¿ç”¨useRefå­˜å‚¨å¯å˜å€¼
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> CounterWithRef() {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [count, setCount] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#a5d6ff>0</span>)
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> countRef <span style=color:#ff7b72;font-weight:700>=</span> useRef(count)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    countRef.current <span style=color:#ff7b72;font-weight:700>=</span> count
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> interval <span style=color:#ff7b72;font-weight:700>=</span> setInterval(() =&gt; {
</span></span><span style=display:flex><span>      setCount(countRef.current <span style=color:#ff7b72;font-weight:700>+</span> <span style=color:#a5d6ff>1</span>)
</span></span><span style=display:flex><span>    }, <span style=color:#a5d6ff>1000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> () =&gt; clearInterval(interval)
</span></span><span style=display:flex><span>  }, [])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>Count<span style=color:#ff7b72;font-weight:700>:</span> {count}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=3-ä¾èµ–æ•°ç»„é™·é˜±>3. ä¾èµ–æ•°ç»„é™·é˜±<a hidden class=anchor aria-hidden=true href=#3-ä¾èµ–æ•°ç»„é™·é˜±>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">56
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// âŒ ç¼ºå°‘ä¾èµ–é¡¹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> BadExample({ id }) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [data, setData] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#79c0ff>null</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    fetchData(id).then(setData)
</span></span><span style=display:flex><span>  }, []) <span style=color:#8b949e;font-style:italic>// ç¼ºå°‘idä¾èµ–ï¼Œå½“idå˜åŒ–æ—¶ä¸ä¼šé‡æ–°è·å–æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>{data<span style=color:#ff7b72;font-weight:700>?</span>.name}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// âœ… æ­£ç¡®çš„ä¾èµ–é¡¹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> GoodExample({ id }) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [data, setData] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#79c0ff>null</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    fetchData(id).then(setData)
</span></span><span style=display:flex><span>  }, [id]) <span style=color:#8b949e;font-style:italic>// åŒ…å«æ‰€æœ‰å¤–éƒ¨ä¾èµ–
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>{data<span style=color:#ff7b72;font-weight:700>?</span>.name}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// âœ… ä½¿ç”¨è‡ªå®šä¹‰Hookç®¡ç†å¤æ‚ä¾èµ–
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> useApiData(url, dependencies <span style=color:#ff7b72;font-weight:700>=</span> []) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [data, setData] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#79c0ff>null</span>)
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [loading, setLoading] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#79c0ff>true</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  useEffect(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>let</span> isMounted <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    setLoading(<span style=color:#79c0ff>true</span>)
</span></span><span style=display:flex><span>    fetch(url)
</span></span><span style=display:flex><span>      .then(response =&gt; response.json())
</span></span><span style=display:flex><span>      .then(result =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> (isMounted) {
</span></span><span style=display:flex><span>          setData(result)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>      .<span style=color:#ff7b72>catch</span>(error =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> (isMounted) {
</span></span><span style=display:flex><span>          console.error(<span style=color:#a5d6ff>&#39;API Error:&#39;</span>, error)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>      .<span style=color:#ff7b72>finally</span>(() =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> (isMounted) {
</span></span><span style=display:flex><span>          setLoading(<span style=color:#79c0ff>false</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> () =&gt; {
</span></span><span style=display:flex><span>      isMounted <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>false</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }, [url, ...dependencies])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> { data, loading }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=é«˜çº§hooksæ¨¡å¼>é«˜çº§Hooksæ¨¡å¼<a hidden class=anchor aria-hidden=true href=#é«˜çº§hooksæ¨¡å¼>#</a></h2><h3 id=1-çŠ¶æ€æœºhook>1. çŠ¶æ€æœºHook<a hidden class=anchor aria-hidden=true href=#1-çŠ¶æ€æœºhook>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useStateMachine - çŠ¶æ€æœºHook
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> useStateMachine(initialState, transitions) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [currentState, setCurrentState] <span style=color:#ff7b72;font-weight:700>=</span> useState(initialState)
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [context, setContext] <span style=color:#ff7b72;font-weight:700>=</span> useState({})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> transition <span style=color:#ff7b72;font-weight:700>=</span> useCallback((action, payload) =&gt; {
</span></span><span style=display:flex><span>    setCurrentState(prevState =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>const</span> stateConfig <span style=color:#ff7b72;font-weight:700>=</span> transitions[prevState]
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72;font-weight:700>!</span>stateConfig <span style=color:#ff7b72;font-weight:700>||</span> <span style=color:#ff7b72;font-weight:700>!</span>stateConfig.on <span style=color:#ff7b72;font-weight:700>||</span> <span style=color:#ff7b72;font-weight:700>!</span>stateConfig.on[action]) {
</span></span><span style=display:flex><span>        console.warn(<span style=color:#a5d6ff>`No transition defined for action </span><span style=color:#a5d6ff>${</span>action<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff> in state </span><span style=color:#a5d6ff>${</span>prevState<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>`</span>)
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> prevState
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>const</span> transitionConfig <span style=color:#ff7b72;font-weight:700>=</span> stateConfig.on[action]
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>const</span> nextState <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>typeof</span> transitionConfig.target <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;function&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>?</span> transitionConfig.target(prevState, payload)
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>:</span> transitionConfig.target
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>if</span> (transitionConfig.action) {
</span></span><span style=display:flex><span>        transitionConfig.action(prevState, payload, context)
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>return</span> nextState
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>  }, [transitions, context])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> can <span style=color:#ff7b72;font-weight:700>=</span> useCallback((action) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> stateConfig <span style=color:#ff7b72;font-weight:700>=</span> transitions[currentState]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> stateConfig <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> stateConfig.on <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> stateConfig.on[action]
</span></span><span style=display:flex><span>  }, [currentState, transitions])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> { currentState, transition, can, context, setContext }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ä½¿ç”¨ç¤ºä¾‹ - ç™»å½•çŠ¶æ€æœº
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>const</span> loginMachine <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>  idle<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>    on<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>      login<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>        target<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;loading&#39;</span>,
</span></span><span style=display:flex><span>        action<span style=color:#ff7b72;font-weight:700>:</span> (state, payload) =&gt; ({ ...state, username<span style=color:#ff7b72;font-weight:700>:</span> payload.username })
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  loading<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>    on<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>      success<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;authenticated&#39;</span>,
</span></span><span style=display:flex><span>      error<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;error&#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  authenticated<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>    on<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>      logout<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;idle&#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  error<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>    on<span style=color:#ff7b72;font-weight:700>:</span> {
</span></span><span style=display:flex><span>      retry<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;loading&#39;</span>,
</span></span><span style=display:flex><span>      cancel<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;idle&#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>function</span> LoginComponent() {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> { currentState, transition, can } <span style=color:#ff7b72;font-weight:700>=</span> useStateMachine(<span style=color:#a5d6ff>&#39;idle&#39;</span>, loginMachine)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> handleLogin <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72>async</span> (username, password) =&gt; {
</span></span><span style=display:flex><span>    transition(<span style=color:#a5d6ff>&#39;login&#39;</span>, { username })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>await</span> performLogin(username, password)
</span></span><span style=display:flex><span>      transition(<span style=color:#a5d6ff>&#39;success&#39;</span>)
</span></span><span style=display:flex><span>    } <span style=color:#ff7b72>catch</span> (error) {
</span></span><span style=display:flex><span>      transition(<span style=color:#a5d6ff>&#39;error&#39;</span>, { error<span style=color:#ff7b72;font-weight:700>:</span> error.message })
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>p<span style=color:#ff7b72;font-weight:700>&gt;</span>Current state<span style=color:#ff7b72;font-weight:700>:</span> {currentState}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/p&gt;</span>
</span></span><span style=display:flex><span>      {currentState <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;idle&#39;</span> <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> (
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span>button onClick<span style=color:#ff7b72;font-weight:700>=</span>{() =&gt; handleLogin(<span style=color:#a5d6ff>&#39;user&#39;</span>, <span style=color:#a5d6ff>&#39;pass&#39;</span>)}<span style=color:#ff7b72;font-weight:700>&gt;</span>Login<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/button&gt;</span>
</span></span><span style=display:flex><span>      )}
</span></span><span style=display:flex><span>      {currentState <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;loading&#39;</span> <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> <span style=color:#ff7b72;font-weight:700>&lt;</span>p<span style=color:#ff7b72;font-weight:700>&gt;</span>Loading...<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/p&gt;}</span>
</span></span><span style=display:flex><span>      {currentState <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;authenticated&#39;</span> <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> (
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#ff7b72;font-weight:700>&lt;</span>p<span style=color:#ff7b72;font-weight:700>&gt;</span>Authenticated<span style=color:#ff7b72;font-weight:700>!&lt;</span><span style=color:#f85149>/p&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#ff7b72;font-weight:700>&lt;</span>button onClick<span style=color:#ff7b72;font-weight:700>=</span>{() =&gt; transition(<span style=color:#a5d6ff>&#39;logout&#39;</span>)}<span style=color:#ff7b72;font-weight:700>&gt;</span>Logout<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/button&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>      )}
</span></span><span style=display:flex><span>      {currentState <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;error&#39;</span> <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> (
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#ff7b72;font-weight:700>&lt;</span>p<span style=color:#ff7b72;font-weight:700>&gt;</span>Error occurred<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/p&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#ff7b72;font-weight:700>&lt;</span>button onClick<span style=color:#ff7b72;font-weight:700>=</span>{() =&gt; transition(<span style=color:#a5d6ff>&#39;retry&#39;</span>)}<span style=color:#ff7b72;font-weight:700>&gt;</span>Retry<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/button&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#ff7b72;font-weight:700>&lt;</span>button onClick<span style=color:#ff7b72;font-weight:700>=</span>{() =&gt; transition(<span style=color:#a5d6ff>&#39;cancel&#39;</span>)}<span style=color:#ff7b72;font-weight:700>&gt;</span>Cancel<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/button&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>      )}
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=2-è™šæ‹Ÿåˆ—è¡¨hook>2. è™šæ‹Ÿåˆ—è¡¨Hook<a hidden class=anchor aria-hidden=true href=#2-è™šæ‹Ÿåˆ—è¡¨hook>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">65
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useVirtualList - è™šæ‹Ÿåˆ—è¡¨Hook
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> useVirtualList(items, itemHeight, containerHeight) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [scrollTop, setScrollTop] <span style=color:#ff7b72;font-weight:700>=</span> useState(<span style=color:#a5d6ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> visibleStart <span style=color:#ff7b72;font-weight:700>=</span> Math.floor(scrollTop <span style=color:#ff7b72;font-weight:700>/</span> itemHeight)
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> visibleEnd <span style=color:#ff7b72;font-weight:700>=</span> Math.min(
</span></span><span style=display:flex><span>    visibleStart <span style=color:#ff7b72;font-weight:700>+</span> Math.ceil(containerHeight <span style=color:#ff7b72;font-weight:700>/</span> itemHeight) <span style=color:#ff7b72;font-weight:700>+</span> <span style=color:#a5d6ff>1</span>,
</span></span><span style=display:flex><span>    items.length
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> visibleItems <span style=color:#ff7b72;font-weight:700>=</span> useMemo(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> items.slice(visibleStart, visibleEnd).map((item, index) =&gt; ({
</span></span><span style=display:flex><span>      ...item,
</span></span><span style=display:flex><span>      index<span style=color:#ff7b72;font-weight:700>:</span> visibleStart <span style=color:#ff7b72;font-weight:700>+</span> index
</span></span><span style=display:flex><span>    }))
</span></span><span style=display:flex><span>  }, [items, visibleStart, visibleEnd])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> totalHeight <span style=color:#ff7b72;font-weight:700>=</span> items.length <span style=color:#ff7b72;font-weight:700>*</span> itemHeight
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> offsetY <span style=color:#ff7b72;font-weight:700>=</span> visibleStart <span style=color:#ff7b72;font-weight:700>*</span> itemHeight
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> handleScroll <span style=color:#ff7b72;font-weight:700>=</span> useCallback((e) =&gt; {
</span></span><span style=display:flex><span>    setScrollTop(e.target.scrollTop)
</span></span><span style=display:flex><span>  }, [])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>    visibleItems,
</span></span><span style=display:flex><span>    totalHeight,
</span></span><span style=display:flex><span>    offsetY,
</span></span><span style=display:flex><span>    handleScroll
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ä½¿ç”¨ç¤ºä¾‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> VirtualList({ items, itemHeight <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>50</span>, containerHeight <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>400</span> }) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> {
</span></span><span style=display:flex><span>    visibleItems,
</span></span><span style=display:flex><span>    totalHeight,
</span></span><span style=display:flex><span>    offsetY,
</span></span><span style=display:flex><span>    handleScroll
</span></span><span style=display:flex><span>  } <span style=color:#ff7b72;font-weight:700>=</span> useVirtualList(items, itemHeight, containerHeight)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span>div style<span style=color:#ff7b72;font-weight:700>=</span>{{ height<span style=color:#ff7b72;font-weight:700>:</span> containerHeight, overflow<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;auto&#39;</span> }} onScroll<span style=color:#ff7b72;font-weight:700>=</span>{handleScroll}<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>div style<span style=color:#ff7b72;font-weight:700>=</span>{{ height<span style=color:#ff7b72;font-weight:700>:</span> totalHeight, position<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;relative&#39;</span> }}<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span>div style<span style=color:#ff7b72;font-weight:700>=</span>{{ transform<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>`translateY(</span><span style=color:#a5d6ff>${</span>offsetY<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>px)`</span> }}<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>          {visibleItems.map((item, index) =&gt; (
</span></span><span style=display:flex><span>            <span style=color:#ff7b72;font-weight:700>&lt;</span>div
</span></span><span style=display:flex><span>              key<span style=color:#ff7b72;font-weight:700>=</span>{item.id}
</span></span><span style=display:flex><span>              style<span style=color:#ff7b72;font-weight:700>=</span>{{
</span></span><span style=display:flex><span>                height<span style=color:#ff7b72;font-weight:700>:</span> itemHeight,
</span></span><span style=display:flex><span>                borderBottom<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;1px solid #eee&#39;</span>,
</span></span><span style=display:flex><span>                display<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;flex&#39;</span>,
</span></span><span style=display:flex><span>                alignItems<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;center&#39;</span>,
</span></span><span style=display:flex><span>                padding<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;0 16px&#39;</span>,
</span></span><span style=display:flex><span>                background<span style=color:#ff7b72;font-weight:700>:</span> index <span style=color:#ff7b72;font-weight:700>%</span> <span style=color:#a5d6ff>2</span> <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>0</span> <span style=color:#ff7b72;font-weight:700>?</span> <span style=color:#a5d6ff>&#39;#f9f9f9&#39;</span> <span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;white&#39;</span>
</span></span><span style=display:flex><span>              }}
</span></span><span style=display:flex><span>            <span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>              {item.name}
</span></span><span style=display:flex><span>            <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>          ))}
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h3 id=3-è¡¨å•ç®¡ç†hook>3. è¡¨å•ç®¡ç†Hook<a hidden class=anchor aria-hidden=true href=#3-è¡¨å•ç®¡ç†hook>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">165
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// useForm - è¡¨å•ç®¡ç†Hook
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> useForm(initialValues, validationSchema <span style=color:#ff7b72;font-weight:700>=</span> {}) {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [values, setValues] <span style=color:#ff7b72;font-weight:700>=</span> useState(initialValues)
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [errors, setErrors] <span style=color:#ff7b72;font-weight:700>=</span> useState({})
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> [touched, setTouched] <span style=color:#ff7b72;font-weight:700>=</span> useState({})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> setValue <span style=color:#ff7b72;font-weight:700>=</span> useCallback((name, value) =&gt; {
</span></span><span style=display:flex><span>    setValues(prev =&gt; ({ ...prev, [name]<span style=color:#ff7b72;font-weight:700>:</span> value }))
</span></span><span style=display:flex><span>  }, [])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> setError <span style=color:#ff7b72;font-weight:700>=</span> useCallback((name, error) =&gt; {
</span></span><span style=display:flex><span>    setErrors(prev =&gt; ({ ...prev, [name]<span style=color:#ff7b72;font-weight:700>:</span> error }))
</span></span><span style=display:flex><span>  }, [])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> setTouched <span style=color:#ff7b72;font-weight:700>=</span> useCallback((name, isTouched <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>true</span>) =&gt; {
</span></span><span style=display:flex><span>    setTouched(prev =&gt; ({ ...prev, [name]<span style=color:#ff7b72;font-weight:700>:</span> isTouched }))
</span></span><span style=display:flex><span>  }, [])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> handleChange <span style=color:#ff7b72;font-weight:700>=</span> useCallback((e) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> { name, value, type, checked } <span style=color:#ff7b72;font-weight:700>=</span> e.target
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> fieldValue <span style=color:#ff7b72;font-weight:700>=</span> type <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;checkbox&#39;</span> <span style=color:#ff7b72;font-weight:700>?</span> checked <span style=color:#ff7b72;font-weight:700>:</span> value
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    setValue(name, fieldValue)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (touched[name]) {
</span></span><span style=display:flex><span>      validateField(name, fieldValue)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }, [setValue, touched, validationSchema])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> validateField <span style=color:#ff7b72;font-weight:700>=</span> useCallback((name, value) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72;font-weight:700>!</span>validationSchema[name]) {
</span></span><span style=display:flex><span>      setError(name, <span style=color:#a5d6ff>&#39;&#39;</span>)
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>return</span> <span style=color:#79c0ff>true</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> validator <span style=color:#ff7b72;font-weight:700>=</span> validationSchema[name]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> result <span style=color:#ff7b72;font-weight:700>=</span> validator(value)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72>typeof</span> result <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#a5d6ff>&#39;string&#39;</span>) {
</span></span><span style=display:flex><span>      setError(name, result)
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>return</span> <span style=color:#79c0ff>false</span>
</span></span><span style=display:flex><span>    } <span style=color:#ff7b72>else</span> <span style=color:#ff7b72>if</span> (result <span style=color:#ff7b72;font-weight:700>===</span> <span style=color:#79c0ff>false</span>) {
</span></span><span style=display:flex><span>      setError(name, <span style=color:#a5d6ff>&#39;Invalid field&#39;</span>)
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>return</span> <span style=color:#79c0ff>false</span>
</span></span><span style=display:flex><span>    } <span style=color:#ff7b72>else</span> {
</span></span><span style=display:flex><span>      setError(name, <span style=color:#a5d6ff>&#39;&#39;</span>)
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>return</span> <span style=color:#79c0ff>true</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }, [validationSchema, setError])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> handleBlur <span style=color:#ff7b72;font-weight:700>=</span> useCallback((e) =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> { name, value } <span style=color:#ff7b72;font-weight:700>=</span> e.target
</span></span><span style=display:flex><span>    setTouched(name, <span style=color:#79c0ff>true</span>)
</span></span><span style=display:flex><span>    validateField(name, value)
</span></span><span style=display:flex><span>  }, [setTouched, validateField])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> validate <span style=color:#ff7b72;font-weight:700>=</span> useCallback(() =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>let</span> isValid <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>true</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> newErrors <span style=color:#ff7b72;font-weight:700>=</span> {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Object.keys(validationSchema).forEach(name =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72;font-weight:700>!</span>validateField(name, values[name])) {
</span></span><span style=display:flex><span>        isValid <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>false</span>
</span></span><span style=display:flex><span>        newErrors[name] <span style=color:#ff7b72;font-weight:700>=</span> errors[name]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    setErrors(newErrors)
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> isValid
</span></span><span style=display:flex><span>  }, [validationSchema, values, errors, validateField])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> reset <span style=color:#ff7b72;font-weight:700>=</span> useCallback(() =&gt; {
</span></span><span style=display:flex><span>    setValues(initialValues)
</span></span><span style=display:flex><span>    setErrors({})
</span></span><span style=display:flex><span>    setTouched({})
</span></span><span style=display:flex><span>  }, [initialValues])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>    values,
</span></span><span style=display:flex><span>    errors,
</span></span><span style=display:flex><span>    touched,
</span></span><span style=display:flex><span>    setValue,
</span></span><span style=display:flex><span>    setError,
</span></span><span style=display:flex><span>    setTouched,
</span></span><span style=display:flex><span>    handleChange,
</span></span><span style=display:flex><span>    handleBlur,
</span></span><span style=display:flex><span>    validate,
</span></span><span style=display:flex><span>    reset,
</span></span><span style=display:flex><span>    isValid<span style=color:#ff7b72;font-weight:700>:</span> Object.keys(errors).every(key =&gt; <span style=color:#ff7b72;font-weight:700>!</span>errors[key])
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ä½¿ç”¨ç¤ºä¾‹
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>function</span> LoginForm() {
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> validationSchema <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>    email<span style=color:#ff7b72;font-weight:700>:</span> (value) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72;font-weight:700>!</span>value) <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>&#39;Email is required&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72;font-weight:700>!</span><span style=color:#79c0ff>/\S+@\S+\.\S+/</span>.test(value)) <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>&#39;Email is invalid&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>return</span> <span style=color:#79c0ff>true</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    password<span style=color:#ff7b72;font-weight:700>:</span> (value) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>if</span> (<span style=color:#ff7b72;font-weight:700>!</span>value) <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>&#39;Password is required&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>if</span> (value.length <span style=color:#ff7b72;font-weight:700>&lt;</span> <span style=color:#a5d6ff>6</span>) <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>&#39;Password must be at least 6 characters&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72>return</span> <span style=color:#79c0ff>true</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> {
</span></span><span style=display:flex><span>    values,
</span></span><span style=display:flex><span>    errors,
</span></span><span style=display:flex><span>    touched,
</span></span><span style=display:flex><span>    handleChange,
</span></span><span style=display:flex><span>    handleBlur,
</span></span><span style=display:flex><span>    validate,
</span></span><span style=display:flex><span>    reset,
</span></span><span style=display:flex><span>    isValid
</span></span><span style=display:flex><span>  } <span style=color:#ff7b72;font-weight:700>=</span> useForm(
</span></span><span style=display:flex><span>    { email<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;&#39;</span>, password<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;&#39;</span> },
</span></span><span style=display:flex><span>    validationSchema
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>const</span> handleSubmit <span style=color:#ff7b72;font-weight:700>=</span> (e) =&gt; {
</span></span><span style=display:flex><span>    e.preventDefault()
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>if</span> (validate()) {
</span></span><span style=display:flex><span>      console.log(<span style=color:#a5d6ff>&#39;Form submitted:&#39;</span>, values)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ff7b72>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span>form onSubmit<span style=color:#ff7b72;font-weight:700>=</span>{handleSubmit}<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span>label<span style=color:#ff7b72;font-weight:700>&gt;</span>Email<span style=color:#ff7b72;font-weight:700>:&lt;</span><span style=color:#f85149>/label&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span>input
</span></span><span style=display:flex><span>          type<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;email&#34;</span>
</span></span><span style=display:flex><span>          name<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;email&#34;</span>
</span></span><span style=display:flex><span>          value<span style=color:#ff7b72;font-weight:700>=</span>{values.email}
</span></span><span style=display:flex><span>          onChange<span style=color:#ff7b72;font-weight:700>=</span>{handleChange}
</span></span><span style=display:flex><span>          onBlur<span style=color:#ff7b72;font-weight:700>=</span>{handleBlur}
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        {touched.email <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> errors.email <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> (
</span></span><span style=display:flex><span>          <span style=color:#ff7b72;font-weight:700>&lt;</span>span style<span style=color:#ff7b72;font-weight:700>=</span>{{ color<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;red&#39;</span> }}<span style=color:#ff7b72;font-weight:700>&gt;</span>{errors.email}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/span&gt;</span>
</span></span><span style=display:flex><span>        )}
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>div<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span>label<span style=color:#ff7b72;font-weight:700>&gt;</span>Password<span style=color:#ff7b72;font-weight:700>:&lt;</span><span style=color:#f85149>/label&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>&lt;</span>input
</span></span><span style=display:flex><span>          type<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;password&#34;</span>
</span></span><span style=display:flex><span>          name<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;password&#34;</span>
</span></span><span style=display:flex><span>          value<span style=color:#ff7b72;font-weight:700>=</span>{values.password}
</span></span><span style=display:flex><span>          onChange<span style=color:#ff7b72;font-weight:700>=</span>{handleChange}
</span></span><span style=display:flex><span>          onBlur<span style=color:#ff7b72;font-weight:700>=</span>{handleBlur}
</span></span><span style=display:flex><span>        <span style=color:#ff7b72;font-weight:700>/&gt;</span>
</span></span><span style=display:flex><span>        {touched.password <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> errors.password <span style=color:#ff7b72;font-weight:700>&amp;&amp;</span> (
</span></span><span style=display:flex><span>          <span style=color:#ff7b72;font-weight:700>&lt;</span>span style<span style=color:#ff7b72;font-weight:700>=</span>{{ color<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;red&#39;</span> }}<span style=color:#ff7b72;font-weight:700>&gt;</span>{errors.password}<span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/span&gt;</span>
</span></span><span style=display:flex><span>        )}
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/div&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>button type<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;submit&#34;</span> disabled<span style=color:#ff7b72;font-weight:700>=</span>{<span style=color:#ff7b72;font-weight:700>!</span>isValid}<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        Submit
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/button&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span>button type<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#34;button&#34;</span> onClick<span style=color:#ff7b72;font-weight:700>=</span>{reset}<span style=color:#ff7b72;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        Reset
</span></span><span style=display:flex><span>      <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/button&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72;font-weight:700>&lt;</span><span style=color:#f85149>/form&gt;</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><h2 id=hooksæµ‹è¯•ç­–ç•¥>Hooksæµ‹è¯•ç­–ç•¥<a hidden class=anchor aria-hidden=true href=#hooksæµ‹è¯•ç­–ç•¥>#</a></h2><h3 id=1-æµ‹è¯•è‡ªå®šä¹‰hooks>1. æµ‹è¯•è‡ªå®šä¹‰Hooks<a hidden class=anchor aria-hidden=true href=#1-æµ‹è¯•è‡ªå®šä¹‰hooks>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// ä½¿ç”¨ @testing-library/react-hooks
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>import</span> { renderHook, act } from <span style=color:#a5d6ff>&#39;@testing-library/react-hooks&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æµ‹è¯•useCounter Hook
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>import</span> { useCounter } from <span style=color:#a5d6ff>&#39;./useCounter&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>describe(<span style=color:#a5d6ff>&#39;useCounter&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>  test(<span style=color:#a5d6ff>&#39;should initialize with default value&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> { result } <span style=color:#ff7b72;font-weight:700>=</span> renderHook(() =&gt; useCounter())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    expect(result.current.count).toBe(<span style=color:#a5d6ff>0</span>)
</span></span><span style=display:flex><span>    expect(<span style=color:#ff7b72>typeof</span> result.current.increment).toBe(<span style=color:#a5d6ff>&#39;function&#39;</span>)
</span></span><span style=display:flex><span>    expect(<span style=color:#ff7b72>typeof</span> result.current.decrement).toBe(<span style=color:#a5d6ff>&#39;function&#39;</span>)
</span></span><span style=display:flex><span>    expect(<span style=color:#ff7b72>typeof</span> result.current.reset).toBe(<span style=color:#a5d6ff>&#39;function&#39;</span>)
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  test(<span style=color:#a5d6ff>&#39;should initialize with custom value&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> { result } <span style=color:#ff7b72;font-weight:700>=</span> renderHook(() =&gt; useCounter(<span style=color:#a5d6ff>5</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    expect(result.current.count).toBe(<span style=color:#a5d6ff>5</span>)
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  test(<span style=color:#a5d6ff>&#39;should increment count&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> { result } <span style=color:#ff7b72;font-weight:700>=</span> renderHook(() =&gt; useCounter(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>1</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    act(() =&gt; {
</span></span><span style=display:flex><span>      result.current.increment()
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    expect(result.current.count).toBe(<span style=color:#a5d6ff>1</span>)
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  test(<span style=color:#a5d6ff>&#39;should decrement count&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> { result } <span style=color:#ff7b72;font-weight:700>=</span> renderHook(() =&gt; useCounter(<span style=color:#a5d6ff>5</span>, <span style=color:#a5d6ff>2</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    act(() =&gt; {
</span></span><span style=display:flex><span>      result.current.decrement()
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    expect(result.current.count).toBe(<span style=color:#a5d6ff>3</span>)
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  test(<span style=color:#a5d6ff>&#39;should reset count&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> { result } <span style=color:#ff7b72;font-weight:700>=</span> renderHook(() =&gt; useCounter(<span style=color:#a5d6ff>0</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    act(() =&gt; {
</span></span><span style=display:flex><span>      result.current.increment()
</span></span><span style=display:flex><span>      result.current.increment()
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    expect(result.current.count).toBe(<span style=color:#a5d6ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    act(() =&gt; {
</span></span><span style=display:flex><span>      result.current.reset()
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    expect(result.current.count).toBe(<span style=color:#a5d6ff>0</span>)
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æµ‹è¯•useApi Hook
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>import</span> { useApi } from <span style=color:#a5d6ff>&#39;./useApi&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// Mock fetch
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span>global.fetch <span style=color:#ff7b72;font-weight:700>=</span> jest.fn()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>describe(<span style=color:#a5d6ff>&#39;useApi&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>  beforeEach(() =&gt; {
</span></span><span style=display:flex><span>    fetch.mockClear()
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  test(<span style=color:#a5d6ff>&#39;should fetch data on mount&#39;</span>, <span style=color:#ff7b72>async</span> () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> mockData <span style=color:#ff7b72;font-weight:700>=</span> { id<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>1</span>, name<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#a5d6ff>&#39;Test&#39;</span> }
</span></span><span style=display:flex><span>    fetch.mockResolvedValueOnce({
</span></span><span style=display:flex><span>      ok<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#79c0ff>true</span>,
</span></span><span style=display:flex><span>      json<span style=color:#ff7b72;font-weight:700>:</span> <span style=color:#ff7b72>async</span> () =&gt; mockData
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> { result, waitForNextUpdate } <span style=color:#ff7b72;font-weight:700>=</span> renderHook(() =&gt; useApi(<span style=color:#a5d6ff>&#39;/api/test&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    expect(result.current.loading).toBe(<span style=color:#79c0ff>true</span>)
</span></span><span style=display:flex><span>    expect(result.current.data).toBe(<span style=color:#79c0ff>null</span>)
</span></span><span style=display:flex><span>    expect(result.current.error).toBe(<span style=color:#79c0ff>null</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>await</span> waitForNextUpdate()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    expect(result.current.loading).toBe(<span style=color:#79c0ff>false</span>)
</span></span><span style=display:flex><span>    expect(result.current.data).toEqual(mockData)
</span></span><span style=display:flex><span>    expect(result.current.error).toBe(<span style=color:#79c0ff>null</span>)
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  test(<span style=color:#a5d6ff>&#39;should handle fetch error&#39;</span>, <span style=color:#ff7b72>async</span> () =&gt; {
</span></span><span style=display:flex><span>    fetch.mockRejectedValueOnce(<span style=color:#ff7b72>new</span> Error(<span style=color:#a5d6ff>&#39;Network error&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> { result, waitForNextUpdate } <span style=color:#ff7b72;font-weight:700>=</span> renderHook(() =&gt; useApi(<span style=color:#a5d6ff>&#39;/api/test&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>await</span> waitForNextUpdate()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    expect(result.current.loading).toBe(<span style=color:#79c0ff>false</span>)
</span></span><span style=display:flex><span>    expect(result.current.data).toBe(<span style=color:#79c0ff>null</span>)
</span></span><span style=display:flex><span>    expect(result.current.error).toBe(<span style=color:#a5d6ff>&#39;Network error&#39;</span>)
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>})
</span></span></code></pre></td></tr></table></div></div><h3 id=2-é›†æˆæµ‹è¯•>2. é›†æˆæµ‹è¯•<a hidden class=anchor aria-hidden=true href=#2-é›†æˆæµ‹è¯•>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#8b949e;font-style:italic>// æµ‹è¯•ä½¿ç”¨Hooksçš„ç»„ä»¶
</span></span></span><span style=display:flex><span><span style=color:#8b949e;font-style:italic></span><span style=color:#ff7b72>import</span> { render, screen, fireEvent, waitFor } from <span style=color:#a5d6ff>&#39;@testing-library/react&#39;</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> { Counter } from <span style=color:#a5d6ff>&#39;./Counter&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>describe(<span style=color:#a5d6ff>&#39;Counter Component&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>  test(<span style=color:#a5d6ff>&#39;should render initial count&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>    render(<span style=color:#ff7b72;font-weight:700>&lt;</span>Counter <span style=color:#ff7b72;font-weight:700>/&gt;</span>)
</span></span><span style=display:flex><span>    expect(screen.getByText(<span style=color:#a5d6ff>&#39;Count: 0&#39;</span>)).toBeInTheDocument()
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  test(<span style=color:#a5d6ff>&#39;should increment count when button clicked&#39;</span>, <span style=color:#ff7b72>async</span> () =&gt; {
</span></span><span style=display:flex><span>    render(<span style=color:#ff7b72;font-weight:700>&lt;</span>Counter <span style=color:#ff7b72;font-weight:700>/&gt;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>const</span> incrementButton <span style=color:#ff7b72;font-weight:700>=</span> screen.getByText(<span style=color:#a5d6ff>&#39;+1&#39;</span>)
</span></span><span style=display:flex><span>    fireEvent.click(incrementButton)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>await</span> waitFor(() =&gt; {
</span></span><span style=display:flex><span>      expect(screen.getByText(<span style=color:#a5d6ff>&#39;Count: 1&#39;</span>)).toBeInTheDocument()
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>})
</span></span></code></pre></td></tr></table></div></div><h2 id=æ€»ç»“>æ€»ç»“<a hidden class=anchor aria-hidden=true href=#æ€»ç»“>#</a></h2><p>React Hooksä¸ºæˆ‘ä»¬å¸¦æ¥äº†å¼ºå¤§çš„èƒ½åŠ›ï¼Œä½†ä¹Ÿéœ€è¦æ­£ç¡®ç†è§£å’Œä½¿ç”¨ï¼š</p><h3 id=æ ¸å¿ƒè¦ç‚¹>æ ¸å¿ƒè¦ç‚¹<a hidden class=anchor aria-hidden=true href=#æ ¸å¿ƒè¦ç‚¹>#</a></h3><ol><li><strong>ç†è§£åŸç†</strong>ï¼šHooksåŸºäºé“¾è¡¨ç»“æ„ï¼Œè°ƒç”¨é¡ºåºå¿…é¡»ä¸€è‡´</li><li><strong>åˆç†ä¼˜åŒ–</strong>ï¼šé¿å…è¿‡åº¦ä¼˜åŒ–ï¼Œæ­£ç¡®ä½¿ç”¨useCallbackå’ŒuseMemo</li><li><strong>é¿å…é™·é˜±</strong>ï¼šæ³¨æ„é—­åŒ…ã€ä¾èµ–æ•°ç»„ã€è°ƒç”¨è§„åˆ™ç­‰é—®é¢˜</li><li><strong>è‡ªå®šä¹‰Hooks</strong>ï¼šæå–é€»è¾‘å¤ç”¨ï¼Œä¿æŒç»„ä»¶ç®€æ´</li><li><strong>æµ‹è¯•ç­–ç•¥</strong>ï¼šå……åˆ†æµ‹è¯•è‡ªå®šä¹‰Hooksçš„è¡Œä¸º</li></ol><h3 id=æœ€ä½³å®è·µ>æœ€ä½³å®è·µ<a hidden class=anchor aria-hidden=true href=#æœ€ä½³å®è·µ>#</a></h3><ul><li>éµå¾ªHooksè§„åˆ™</li><li>åˆç†ä½¿ç”¨æ€§èƒ½ä¼˜åŒ–Hooks</li><li>æå–å¤ç”¨é€»è¾‘ä¸ºè‡ªå®šä¹‰Hooks</li><li>ç¼–å†™å¯æµ‹è¯•çš„Hooks</li><li>æ³¨æ„å†…å­˜æ³„æ¼å’Œæ¸…ç†</li></ul><p>é€šè¿‡æ·±å…¥ç†è§£Hooksçš„åŸç†å’Œæœ€ä½³å®è·µï¼Œä½ å¯ä»¥ç¼–å†™å‡ºæ›´ç®€æ´ã€æ›´é«˜æ•ˆã€æ›´æ˜“ç»´æŠ¤çš„Reactç»„ä»¶ã€‚Hooksä¸ä»…æ˜¯æŠ€æœ¯å·¥å…·ï¼Œæ›´æ˜¯æ„å»ºç°ä»£åŒ–Reactåº”ç”¨çš„è®¾è®¡æ€ç»´ã€‚</p></div><footer class=post-footer-modern><div class=post-tags-modern><span class=tags-label>ğŸ·ï¸ æ ‡ç­¾</span><div class=tags-list><a href=/blog/tags/react/ class=tag-pill>React
</a><a href=/blog/tags/hooks/ class=tag-pill>Hooks
</a><a href=/blog/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/ class=tag-pill>å‰ç«¯å¼€å‘
</a><a href=/blog/tags/javascript/ class=tag-pill>JavaScript
</a><a href=/blog/tags/%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86/ class=tag-pill>çŠ¶æ€ç®¡ç†</a></div></div><style>.post-footer-modern{margin-top:3rem;padding-top:2rem;border-top:1px solid var(--border,#333333)}.post-tags-modern{display:flex;align-items:center;gap:1rem;margin-bottom:2rem;flex-wrap:wrap}.tags-label{font-size:.875rem;font-weight:600;color:var(--secondary,#999999) !important;white-space:nowrap}.tags-list{display:flex;flex-wrap:wrap;gap:.5rem;flex:1}.tag-pill{display:inline-block;padding:.25rem .75rem;background:rgba(255,255,255,5%);border:1px solid var(--border,#333333);border-radius:0;color:var(--secondary,#cccccc) !important;text-decoration:none;font-size:.8rem;font-weight:500;transition:all .2s ease}.tag-pill:hover{background:var(--primary,#ffffff);color:var(--background,#000000) !important;border-color:var(--primary,#ffffff);transform:translateY(-1px)}.post-nav-modern{margin-top:2rem}.nav-grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.nav-card{display:flex;align-items:center;gap:1rem;padding:1.25rem;background:rgba(255,255,255,2%);border:1px solid var(--border,#333333);border-radius:12px;text-decoration:none;transition:all .2s ease;min-height:80px}.nav-card:hover{background:rgba(255,255,255,5%);border-color:var(--primary,#ffffff);transform:translateY(-2px)}.nav-card.nav-prev{justify-content:flex-start}.nav-card.nav-next{justify-content:flex-end;text-align:right}.nav-card.nav-next .nav-content{text-align:right}.nav-empty{display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,1%);border:1px dashed var(--border,#333333);color:var(--secondary,#666666)}.nav-arrow{font-size:1.5rem;color:var(--primary,#ffffff);font-weight:300}.nav-content{flex:1}.nav-title{font-size:.95rem;font-weight:600;color:var(--primary,#ffffff) !important;line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}[data-theme=light] .post-footer-modern{border-color:var(--border-light,#dee2e6)}[data-theme=light] .tags-label{color:var(--secondary-light,#6c757d) !important}[data-theme=light] .tag-pill{background:rgba(0,0,0,5%);border-color:var(--border-light,#dee2e6);color:var(--secondary-light,#495057) !important}[data-theme=light] .tag-pill:hover{background:var(--primary-light,#0066cc);color:var(--background-light,#ffffff) !important;border-color:var(--primary-light,#0066cc)}[data-theme=light] .nav-card{background:rgba(0,0,0,2%);border-color:var(--border-light,#dee2e6)}[data-theme=light] .nav-card:hover{background:rgba(0,102,204,5%);border-color:var(--primary-light,#0066cc)}[data-theme=light] .nav-empty{background:rgba(0,0,0,1%);border-color:var(--border-light,#dee2e6);color:var(--secondary-light,#6c757d)}[data-theme=light] .nav-arrow{color:var(--primary-light,#0066cc)}[data-theme=light] .nav-title{color:var(--primary-light,#212529) !important}@media(max-width:768px){.nav-grid{grid-template-columns:1fr;gap:.75rem}.nav-card{padding:1rem;min-height:70px}.nav-card.nav-next{text-align:left}.nav-card.nav-next .nav-content{text-align:left}.nav-title{font-size:.875rem}.post-tags-modern{flex-direction:column;gap:.75rem}}@media(max-width:480px){.nav-arrow{font-size:1.25rem}.nav-card{padding:.875rem}.nav-title{font-size:.8rem;-webkit-line-clamp:1}}</style><nav class=post-nav-modern><div class=nav-grid><a href=/blog/articles/docker-best-practices-guide/ class="nav-card nav-prev"><div class=nav-arrow>â†</div><div class=nav-content><div class=nav-title>Dockerå®¹å™¨åŒ–æœ€ä½³å®è·µï¼šä»å¼€å‘åˆ°ç”Ÿäº§çš„å®Œæ•´æŒ‡å—</div></div></a><a href=/blog/articles/webpack5-modern-frontend-toolchain/ class="nav-card nav-next"><div class=nav-content><div class=nav-title>Webpack 5ç°ä»£åŒ–å‰ç«¯å·¥å…·é“¾é…ç½®ï¼šä»é›¶å¼€å§‹æ„å»ºé«˜æ€§èƒ½é¡¹ç›®</div></div><div class=nav-arrow>â†’</div></a></div></nav></footer></main><aside class=post-sidebar><div class=sidebar-toc id=sidebar-toc><div class=toc-header><div class=toc-title>ç›®å½•</div><button class=toc-toggle id=toc-toggle aria-label="Toggle TOC">
<svg class="toc-toggle-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18M6 6l12 12"/></svg></button></div><div class=toc-content id=toc-content><ul class=toc-list><li class="toc-item toc-h2"><a href=#h2-0 class=toc-item-link><span class=toc-item-text>HooksåŸºç¡€å›é¡¾</span></a></li><li class="toc-item toc-h2"><a href=#h2-1 class=toc-item-link><span class=toc-item-text>Hookså†…éƒ¨åŸç†</span></a></li><li class="toc-item toc-h2"><a href=#h2-2 class=toc-item-link><span class=toc-item-text>è‡ªå®šä¹‰Hookså¼€å‘</span></a></li><li class="toc-item toc-h2"><a href=#h2-3 class=toc-item-link><span class=toc-item-text>æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</span></a></li><li class="toc-item toc-h2"><a href=#h2-4 class=toc-item-link><span class=toc-item-text>å¸¸è§é™·é˜±å’Œè§£å†³æ–¹æ¡ˆ</span></a></li><li class="toc-item toc-h2"><a href=#h2-5 class=toc-item-link><span class=toc-item-text>é«˜çº§Hooksæ¨¡å¼</span></a></li><li class="toc-item toc-h2"><a href=#h2-6 class=toc-item-link><span class=toc-item-text>Hooksæµ‹è¯•ç­–ç•¥</span></a></li><li class="toc-item toc-h2"><a href=#h2-7 class=toc-item-link><span class=toc-item-text>æ€»ç»“</span></a></li></ul></div></div><script>document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("sidebar-toc"),t=document.getElementById("toc-toggle"),o=document.getElementById("toc-content"),i=t?.querySelector(".toc-toggle-icon");if(!e)return;let n=!1;t&&t.addEventListener("click",function(){n=!n,n?(o.style.display="none",e.style.width="auto",i.innerHTML='<path d="M9 18l6-6-6-6"/>'):(o.style.display="block",e.style.width="200px",i.innerHTML='<path d="M18 6L6 18M6 6l12 12"/>')});const s=document.querySelector(".post-content");if(s){const e=s.querySelectorAll("h1");e.forEach((e,t)=>{e.id=`h1-${t}`});const t=s.querySelectorAll("h2");t.forEach((e,t)=>{e.id=`h2-${t}`})}const a=document.querySelectorAll(".toc-item-link");a.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const n=this.getAttribute("href").substring(1),t=document.getElementById(n);if(t){const e=document.querySelector(".post-header-main")?.offsetHeight||0,n=t.offsetTop-e-20;window.scrollTo({top:n,behavior:"smooth"})}})})})</script><style>.sidebar-toc{position:sticky;top:2rem;width:200px;background:#fff;border:1px solid #e5e7eb;border-radius:4px;overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,.1);z-index:100}.sidebar-toc.hidden{display:none}.toc-header{padding:12px 16px;border-bottom:1px solid #e5e7eb;background:#fafbfc;display:flex;align-items:center;justify-content:space-between}.toc-title{margin:0;font-size:13px;font-weight:500;color:#374151 !important;font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,sans-serif;text-transform:uppercase;letter-spacing:1px}.toc-toggle{background:0 0;border:none;cursor:pointer;padding:4px;border-radius:4px;display:flex;align-items:center;justify-content:center;transition:all .2s ease;color:#6b7280}.toc-toggle:hover{background:#e5e7eb;color:#374151}.toc-toggle-icon{transition:transform .2s ease}.toc-content{padding:12px 0}.toc-list{list-style:none;margin:0;padding:0}.toc-item{margin-bottom:4px;display:block !important;visibility:visible !important}.toc-h1,.toc-h2{display:block !important}.toc-h2{margin-left:0}.toc-item-link{display:flex;align-items:center;gap:8px;padding:8px 12px;color:#374151 !important;text-decoration:none;font-size:13px;line-height:1.4;border-radius:3px;transition:all .2s ease;font-weight:400}.toc-item-link:hover{background:#f8fafc;color:#1f2937 !important}.toc-item-link.active{background:#e0f2fe;color:#01579b !important;font-weight:500}.toc-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}.dot-red{background:#ef4444}.dot-blue{background:#2196f3}.toc-item-text{color:#1f2937 !important;font-weight:400;flex:1;display:inline !important;visibility:visible !important;opacity:1 !important;font-size:13px !important;line-height:1.4 !important}.toc-item-link .toc-item-text{color:#1f2937 !important;display:inline !important;visibility:visible !important;opacity:1 !important}.toc-item.active .dot-red{background:#d32f2f}.toc-item.active .dot-blue{background:#1976d2}[data-theme=dark] .sidebar-toc{background:#1f2937;border-color:#374151;box-shadow:0 1px 3px rgba(0,0,0,.3)}[data-theme=dark] .toc-header{background:#111827;border-color:#374151}[data-theme=dark] .toc-title{color:#f3f4f6 !important}[data-theme=dark] .toc-toggle{color:#9ca3af}[data-theme=dark] .toc-toggle:hover{background:#374151;color:#f3f4f6}[data-theme=dark] .toc-item-link{color:#e5e7eb !important}[data-theme=dark] .toc-item-link:hover{background:#374151;color:#f9fafb !important}[data-theme=dark] .toc-item-link.active{background:#0d47a1;color:#fff !important}[data-theme=dark] .toc-item-text{color:#f9fafb !important;display:inline !important;visibility:visible !important;opacity:1 !important}[data-theme=dark] .toc-item-link .toc-item-text{color:#f9fafb !important;display:inline !important;visibility:visible !important;opacity:1 !important}@media(max-width:1024px){.sidebar-toc{display:none}.post-content-wrapper{grid-template-columns:1fr !important;padding:0 1rem !important}}</style><style>.post-content-wrapper{display:grid;grid-template-columns:1fr 200px;gap:2rem;padding:0 2rem;max-width:100%}.post-content-main{min-width:0}.post-sidebar{position:sticky;top:2rem;height:fit-content;min-width:0}.post-header-main{margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid var(--border,#333333)}.post-header-main .post-title{color:var(--primary,#ffffff) !important;font-size:2.5rem;font-weight:700;line-height:1.2;margin-bottom:1rem}.post-header-main .post-description{color:var(--secondary,#cccccc) !important;font-size:1.1rem;line-height:1.6;margin-bottom:1rem}.post-header-main .post-meta{margin-bottom:0}@media(max-width:1024px){.post-content-wrapper{grid-template-columns:1fr !important;gap:1rem;padding:0 1rem !important}.post-sidebar{display:none}}@media(max-width:768px){.post-header-main .post-title{font-size:2rem}.post-header-main .post-description{font-size:1rem}}</style></aside></div></article></main><footer class=footer><span>Â© 2024-2025 æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢</span> Â·</footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>